{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewZones/viewZones.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursor.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","invalidFunc","Error","ViewZones","_super","context","_this","call","options","_context","configuration","layoutInfo","get","_lineHeight","_contentWidth","contentWidth","_contentLeft","contentLeft","domNode","document","createElement","setClassName","setPosition","setAttribute","marginDomNode","_zones","dispose","_recomputeWhitespacesProps","whitespaces","viewLayout","getWhitespaces","oldWhitespaces","Map","_i","whitespaces_1","length","whitespace","set","id","changeWhitespace","whitespaceAccessor","hadAChange","keys","i","len","zone","props","_computeWhitespaceProps","delegate","oldWhitespace","afterLineNumber","afterViewLineNumber","height","heightInPx","changeOneWhitespace","_safeCallOnComputedHeight","onConfigurationChanged","e","hasChanged","onLineMappingChanged","onHeightMaybeChanged","onLinesDeleted","onScrollChanged","scrollTopChanged","scrollWidthChanged","onZonesChanged","onLinesInserted","_getZoneOrdinal","afterColumn","_heightInPixels","minWidthInPx","_minWidthInPixels","zoneAfterModelPosition","zoneBeforeModelPosition","model","validateModelPosition","lineNumber","column","validAfterLineNumber","getModelLineMaxColumn","viewPosition","coordinatesConverter","convertModelPositionToViewPosition","isVisible","modelPositionIsVisible","changeViewZones","callback","zonesHaveChanged","changeAccessor","addZone","_addZone","removeZone","_removeZone","layoutZone","_layoutZone","safeInvoke1Arg","whitespaceId","insertWhitespace","myZone","style","width","setDisplay","appendChild","setShouldRender","removeWhitespace","removeAttribute","parentNode","removeChild","shouldSuppressMouseDownOnViewZone","Boolean","suppressMouseDown","heightInLines","onComputedHeight","_safeCallOnDomNodeTop","top","onDomNodeTop","prepareRender","ctx","render","visibleWhitespaces","viewportData","whitespaceViewportData","visibleZones","hasVisibleZone","newTop","newHeight","newDisplay","verticalOffset","bigNumbersDelta","getScrolledTopFromAbsoluteTop","setTop","setHeight","setWidth","Math","max","scrollWidth","func","arg1","ScrollDecorationViewPart","_scrollTop","_width","_updateWidth","_shouldShow","scrollbar","_useShadows","useShadows","_domNode","_updateShouldShow","newShouldShow","getDomNode","renderMinimap","minimapWidth","minimapLeft","verticalScrollbarWidth","scrollTop","theme","collector","shadow","getColor","addRule","ViewCursorRenderData","left","textContent","textContentClassName","ViewCursor","fontInfo","_cursorStyle","_typicalHalfwidthCharacterWidth","typicalHalfwidthCharacterWidth","_lineCursorWidth","min","_isVisible","setLeft","applyFontInfo","_position","_lastRenderedContent","_renderData","getPosition","show","setVisibility","hide","onCursorPositionChanged","position","_prepareRender","Line","LineThin","width_1","visibleRange","visibleRangeForPosition","outsideRenderedLine","dom","lineContent_1","getLineContent","nextCharLength_1","strings","substr","top_1","getVerticalOffsetForLineNumber","lineContent","nextCharLength","visibleRangeForCharacter","linesVisibleRangesForRange","firstVisibleRangeForCharacter","ranges","range","Block","lineData","getViewLineData","tokenIndex","tokens","findTokenIndexAtOffset","getClassName","Underline","UnderlineThin","setLineHeight","ViewCursors","_readOnly","_cursorBlinking","_cursorSmoothCaretAnimation","_selectionIsEmpty","_primaryCursor","_secondaryCursors","_updateDomClassName","_startCursorBlinkAnimation","_cursorFlatBlinkInterval","_blinkingEnabled","_editorHasFocus","_updateBlinking","_onCursorPositionChanged","secondaryPositions","addCnt","newCursor","insertBefore","nextSibling","push","removeCnt","splice","onCursorStateChanged","positions","selections","slice","selectionIsEmpty","isEmpty","onDecorationsChanged","onFlushed","onFocusChanged","isFocused","onLinesChanged","onTokensChanged","shouldRender","fromLineNumber","toLineNumber","_a","secondaryCursor","_getCursorBlinking","cancel","blinkingStyle","isHidden","isSolid","_hide","_show","cancelAndSet","BLINK_INTERVAL","setIfNotSet","_getClassName","result","BlockOutline","renderData","renderDataLen","primaryRenderData","secondaryRenderData","getLastRenderData","caret","caretBackground","opposite","type","HorizontalRangeWithStyle","other","startStyle","endStyle","LineVisibleRangesWithStyle","toStyledRange","item","toStyled","map","isIEWithZoomingIssuesNearRoundedBorders","SelectionsOverlay","_previousFrameVisibleRangesWithStyle","_roundedSelection","_selections","_renderResult","addEventHandler","removeEventHandler","_visibleRangesHaveGaps","linesVisibleRanges","lineVisibleRanges","_enrichVisibleRangesWithStyle","viewport","previousFrame","epsilon","previousFrameTop","previousFrameBottom","topLineNumber","startLineNumber","bottomLineNumber","endLineNumber","curLineRange","curLeft","curRight","bottom","prevLeft","prevRight","abs","nextLeft","nextRight","_getVisibleRangesWithStyle","selection","_linesVisibleRanges","visibleRangesHaveGaps","_createSelectionPiece","className","toString","_actualRenderOneSelection","output2","visibleStartLineNumber","hasMultipleSelections","visibleRanges","visibleRangesHaveStyle","fullLineHeight","reducedLineHeight","firstLineNumber","lastLineNumber","lineIndex","lineHeight","innerCornerOutput","restOfSelectionOutput","j","lenJ","SELECTION_CLASS_NAME","ROUNDED_PIECE_WIDTH","className_1","EDITOR_BACKGROUND_CLASS_NAME","SELECTION_TOP_RIGHT","SELECTION_BOTTOM_RIGHT","className_2","SELECTION_TOP_LEFT","SELECTION_BOTTOM_LEFT","output","visibleEndLineNumber","thisFrameVisibleRangesWithStyle","visibleRangesWithStyle","internalCorners","restOfSelection","n","editorSelectionColor","editorInactiveSelectionColor","editorSelectionForegroundColor"],"mappings":"0HAAA,sFAIIA,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAiBxCK,EAAc,WAAc,MAAM,IAAIC,MAAM,4BAC5CC,EAA2B,SAAUC,GAErC,SAASD,EAAUE,GACf,IAAIC,EAAQF,EAAOG,KAAKV,KAAMQ,IAAYR,KACtCW,EAAUF,EAAMG,SAASC,cAAcF,QACvCG,EAAaH,EAAQI,IAAI,KAe7B,OAdAN,EAAMO,YAAcL,EAAQI,IAAI,IAChCN,EAAMQ,cAAgBH,EAAWI,aACjCT,EAAMU,aAAeL,EAAWM,YAChCX,EAAMY,QAAU,eAAkBC,SAASC,cAAc,QACzDd,EAAMY,QAAQG,aAAa,cAC3Bf,EAAMY,QAAQI,YAAY,YAC1BhB,EAAMY,QAAQK,aAAa,OAAQ,gBACnCjB,EAAMY,QAAQK,aAAa,cAAe,QAC1CjB,EAAMkB,cAAgB,eAAkBL,SAASC,cAAc,QAC/Dd,EAAMkB,cAAcH,aAAa,qBACjCf,EAAMkB,cAAcF,YAAY,YAChChB,EAAMkB,cAAcD,aAAa,OAAQ,gBACzCjB,EAAMkB,cAAcD,aAAa,cAAe,QAChDjB,EAAMmB,OAAS,GACRnB,EAoSX,OAvTApB,EAAUiB,EAAWC,GAqBrBD,EAAUJ,UAAU2B,QAAU,WAC1BtB,EAAOL,UAAU2B,QAAQnB,KAAKV,MAC9BA,KAAK4B,OAAS,IAGlBtB,EAAUJ,UAAU4B,2BAA6B,WAI7C,IAHA,IAAIrB,EAAQT,KACR+B,EAAc/B,KAAKY,SAASoB,WAAWC,iBACvCC,EAAiB,IAAIC,IAChBC,EAAK,EAAGC,EAAgBN,EAAaK,EAAKC,EAAcC,OAAQF,IAAM,CAC3E,IAAIG,EAAaF,EAAcD,GAC/BF,EAAeM,IAAID,EAAWE,GAAIF,GAEtC,OAAOvC,KAAKY,SAASoB,WAAWU,kBAAiB,SAAUC,GAGvD,IAFA,IAAIC,GAAa,EACbC,EAAOpD,OAAOoD,KAAKpC,EAAMmB,QACpBkB,EAAI,EAAGC,EAAMF,EAAKP,OAAQQ,EAAIC,EAAKD,IAAK,CAC7C,IAAIL,EAAKI,EAAKC,GACVE,EAAOvC,EAAMmB,OAAOa,GACpBQ,EAAQxC,EAAMyC,wBAAwBF,EAAKG,UAC3CC,EAAgBlB,EAAenB,IAAI0B,IACnCW,GAAkBA,EAAcC,kBAAoBJ,EAAMK,qBAAuBF,EAAcG,SAAWN,EAAMO,aAChHb,EAAmBc,oBAAoBhB,EAAIQ,EAAMK,oBAAqBL,EAAMO,YAC5E/C,EAAMiD,0BAA0BV,EAAKG,SAAUF,EAAMO,YACrDZ,GAAa,GAGrB,OAAOA,MAGftC,EAAUJ,UAAUyD,uBAAyB,SAAUC,GACnD,IAAIjD,EAAUX,KAAKY,SAASC,cAAcF,QACtCG,EAAaH,EAAQI,IAAI,KAO7B,OANAf,KAAKgB,YAAcL,EAAQI,IAAI,IAC/Bf,KAAKiB,cAAgBH,EAAWI,aAChClB,KAAKmB,aAAeL,EAAWM,YAC3BwC,EAAEC,WAAW,KACb7D,KAAK8B,8BAEF,GAEXxB,EAAUJ,UAAU4D,qBAAuB,SAAUF,GACjD,IAAIhB,EAAa5C,KAAK8B,6BAItB,OAHIc,GACA5C,KAAKY,SAASoB,WAAW+B,uBAEtBnB,GAEXtC,EAAUJ,UAAU8D,eAAiB,SAAUJ,GAC3C,OAAO,GAEXtD,EAAUJ,UAAU+D,gBAAkB,SAAUL,GAC5C,OAAOA,EAAEM,kBAAoBN,EAAEO,oBAEnC7D,EAAUJ,UAAUkE,eAAiB,SAAUR,GAC3C,OAAO,GAEXtD,EAAUJ,UAAUmE,gBAAkB,SAAUT,GAC5C,OAAO,GAGXtD,EAAUJ,UAAUoE,gBAAkB,SAAUtB,GAC5C,MAAgC,qBAArBA,EAAKuB,YACLvB,EAAKuB,YAET,KAEXjE,EAAUJ,UAAUgD,wBAA0B,SAAUF,GACpD,GAA6B,IAAzBA,EAAKK,gBACL,MAAO,CACHC,oBAAqB,EACrBE,WAAYxD,KAAKwE,gBAAgBxB,GACjCyB,aAAczE,KAAK0E,kBAAkB1B,IAG7C,IAAI2B,EAcAC,EAbJ,GAAgC,qBAArB5B,EAAKuB,YACZI,EAAyB3E,KAAKY,SAASiE,MAAMC,sBAAsB,CAC/DC,WAAY/B,EAAKK,gBACjB2B,OAAQhC,EAAKuB,kBAGhB,CACD,IAAIU,EAAuBjF,KAAKY,SAASiE,MAAMC,sBAAsB,CACjEC,WAAY/B,EAAKK,gBACjB2B,OAAQ,IACTD,WACHJ,EAAyB,IAAI,OAASM,EAAsBjF,KAAKY,SAASiE,MAAMK,sBAAsBD,IAItGL,EADAD,EAAuBK,SAAWhF,KAAKY,SAASiE,MAAMK,sBAAsBP,EAAuBI,YACzE/E,KAAKY,SAASiE,MAAMC,sBAAsB,CAChEC,WAAYJ,EAAuBI,WAAa,EAChDC,OAAQ,IAIchF,KAAKY,SAASiE,MAAMC,sBAAsB,CAChEC,WAAYJ,EAAuBI,WACnCC,OAAQL,EAAuBK,OAAS,IAGhD,IAAIG,EAAenF,KAAKY,SAASiE,MAAMO,qBAAqBC,mCAAmCV,GAC3FW,EAAYtF,KAAKY,SAASiE,MAAMO,qBAAqBG,uBAAuBX,GAChF,MAAO,CACHtB,oBAAqB6B,EAAaJ,WAClCvB,WAAa8B,EAAYtF,KAAKwE,gBAAgBxB,GAAQ,EACtDyB,aAAczE,KAAK0E,kBAAkB1B,KAG7C1C,EAAUJ,UAAUsF,gBAAkB,SAAUC,GAC5C,IAAIhF,EAAQT,KACZ,OAAOA,KAAKY,SAASoB,WAAWU,kBAAiB,SAAUC,GACvD,IAAI+C,GAAmB,EACnBC,EAAiB,CACjBC,QAAS,SAAU5C,GAEf,OADA0C,GAAmB,EACZjF,EAAMoF,SAASlD,EAAoBK,IAE9C8C,WAAY,SAAUrD,GACbA,IAGLiD,EAAmBjF,EAAMsF,YAAYpD,EAAoBF,IAAOiD,IAEpEM,WAAY,SAAUvD,GACbA,IAGLiD,EAAmBjF,EAAMwF,YAAYtD,EAAoBF,IAAOiD,KAQxE,OALAQ,EAAeT,EAAUE,GAEzBA,EAAeC,QAAUxF,EACzBuF,EAAeG,WAAa1F,EAC5BuF,EAAeK,WAAa5F,EACrBsF,MAGfpF,EAAUJ,UAAU2F,SAAW,SAAUlD,EAAoBK,GACzD,IAAIC,EAAQjD,KAAKkD,wBAAwBF,GACrCmD,EAAexD,EAAmByD,iBAAiBnD,EAAMK,oBAAqBtD,KAAKsE,gBAAgBtB,GAAOC,EAAMO,WAAYP,EAAMwB,cAClI4B,EAAS,CACTF,aAAcA,EACdhD,SAAUH,EACVsC,WAAW,EACXjE,QAAS,eAAkB2B,EAAK3B,SAChCM,cAAeqB,EAAKrB,cAAgB,eAAkBqB,EAAKrB,eAAiB,MAiBhF,OAfA3B,KAAK0D,0BAA0B2C,EAAOlD,SAAUF,EAAMO,YACtD6C,EAAOhF,QAAQI,YAAY,YAC3B4E,EAAOhF,QAAQA,QAAQiF,MAAMC,MAAQ,OACrCF,EAAOhF,QAAQmF,WAAW,QAC1BH,EAAOhF,QAAQK,aAAa,mBAAoB2E,EAAOF,cACvDnG,KAAKqB,QAAQoF,YAAYJ,EAAOhF,SAC5BgF,EAAO1E,gBACP0E,EAAO1E,cAAcF,YAAY,YACjC4E,EAAO1E,cAAcN,QAAQiF,MAAMC,MAAQ,OAC3CF,EAAO1E,cAAc6E,WAAW,QAChCH,EAAO1E,cAAcD,aAAa,mBAAoB2E,EAAOF,cAC7DnG,KAAK2B,cAAc8E,YAAYJ,EAAO1E,gBAE1C3B,KAAK4B,OAAOyE,EAAOF,cAAgBE,EACnCrG,KAAK0G,kBACEL,EAAOF,cAElB7F,EAAUJ,UAAU6F,YAAc,SAAUpD,EAAoBF,GAC5D,GAAIzC,KAAK4B,OAAO9B,eAAe2C,GAAK,CAChC,IAAIO,EAAOhD,KAAK4B,OAAOa,GAYvB,cAXOzC,KAAK4B,OAAOa,GACnBE,EAAmBgE,iBAAiB3D,EAAKmD,cACzCnD,EAAK3B,QAAQuF,gBAAgB,4BAC7B5D,EAAK3B,QAAQuF,gBAAgB,oBAC7B5D,EAAK3B,QAAQA,QAAQwF,WAAWC,YAAY9D,EAAK3B,QAAQA,SACrD2B,EAAKrB,gBACLqB,EAAKrB,cAAciF,gBAAgB,4BACnC5D,EAAKrB,cAAciF,gBAAgB,oBACnC5D,EAAKrB,cAAcN,QAAQwF,WAAWC,YAAY9D,EAAKrB,cAAcN,UAEzErB,KAAK0G,mBACE,EAEX,OAAO,GAEXpG,EAAUJ,UAAU+F,YAAc,SAAUtD,EAAoBF,GAC5D,GAAIzC,KAAK4B,OAAO9B,eAAe2C,GAAK,CAChC,IAAIO,EAAOhD,KAAK4B,OAAOa,GACnBQ,EAAQjD,KAAKkD,wBAAwBF,EAAKG,UAM9C,OAJAR,EAAmBc,oBAAoBT,EAAKmD,aAAclD,EAAMK,oBAAqBL,EAAMO,YAE3FxD,KAAK0D,0BAA0BV,EAAKG,SAAUF,EAAMO,YACpDxD,KAAK0G,mBACE,EAEX,OAAO,GAEXpG,EAAUJ,UAAU6G,kCAAoC,SAAUtE,GAC9D,GAAIzC,KAAK4B,OAAO9B,eAAe2C,GAAK,CAChC,IAAIO,EAAOhD,KAAK4B,OAAOa,GACvB,OAAOuE,QAAQhE,EAAKG,SAAS8D,mBAEjC,OAAO,GAEX3G,EAAUJ,UAAUsE,gBAAkB,SAAUxB,GAC5C,MAA+B,kBAApBA,EAAKQ,WACLR,EAAKQ,WAEkB,kBAAvBR,EAAKkE,cACLlH,KAAKgB,YAAcgC,EAAKkE,cAE5BlH,KAAKgB,aAEhBV,EAAUJ,UAAUwE,kBAAoB,SAAU1B,GAC9C,MAAiC,kBAAtBA,EAAKyB,aACLzB,EAAKyB,aAET,GAEXnE,EAAUJ,UAAUwD,0BAA4B,SAAUV,EAAMO,GAC5D,GAAqC,oBAA1BP,EAAKmE,iBACZ,IACInE,EAAKmE,iBAAiB5D,GAE1B,MAAOK,GACH,eAAkBA,KAI9BtD,EAAUJ,UAAUkH,sBAAwB,SAAUpE,EAAMqE,GACxD,GAAiC,oBAAtBrE,EAAKsE,aACZ,IACItE,EAAKsE,aAAaD,GAEtB,MAAOzD,GACH,eAAkBA,KAI9BtD,EAAUJ,UAAUqH,cAAgB,SAAUC,KAG9ClH,EAAUJ,UAAUuH,OAAS,SAAUD,GAInC,IAHA,IAAIE,EAAqBF,EAAIG,aAAaC,uBACtCC,EAAe,GACfC,GAAiB,EACZhF,EAAI,EAAGC,EAAM2E,EAAmBpF,OAAQQ,EAAIC,EAAKD,IACtD+E,EAAaH,EAAmB5E,GAAGL,IAAMiF,EAAmB5E,GAC5DgF,GAAiB,EAErB,IAAIjF,EAAOpD,OAAOoD,KAAK7C,KAAK4B,QAC5B,IAASkB,EAAI,EAAGC,EAAMF,EAAKP,OAAQQ,EAAIC,EAAKD,IAAK,CAC7C,IAAIL,EAAKI,EAAKC,GACVE,EAAOhD,KAAK4B,OAAOa,GACnBsF,EAAS,EACTC,EAAY,EACZC,EAAa,OACbJ,EAAa/H,eAAe2C,IAC5BsF,EAASF,EAAapF,GAAIyF,eAAiBV,EAAIW,gBAC/CH,EAAYH,EAAapF,GAAIc,OAC7B0E,EAAa,QAERjF,EAAKsC,YACNtC,EAAK3B,QAAQK,aAAa,2BAA4B,QACtDsB,EAAKsC,WAAY,GAErBtF,KAAKoH,sBAAsBpE,EAAKG,SAAUqE,EAAIY,8BAA8BP,EAAapF,GAAIyF,mBAGzFlF,EAAKsC,YACLtC,EAAK3B,QAAQuF,gBAAgB,4BAC7B5D,EAAKsC,WAAY,GAErBtF,KAAKoH,sBAAsBpE,EAAKG,SAAUqE,EAAIY,+BAA+B,OAEjFpF,EAAK3B,QAAQgH,OAAON,GACpB/E,EAAK3B,QAAQiH,UAAUN,GACvBhF,EAAK3B,QAAQmF,WAAWyB,GACpBjF,EAAKrB,gBACLqB,EAAKrB,cAAc0G,OAAON,GAC1B/E,EAAKrB,cAAc2G,UAAUN,GAC7BhF,EAAKrB,cAAc6E,WAAWyB,IAGlCH,IACA9H,KAAKqB,QAAQkH,SAASC,KAAKC,IAAIjB,EAAIkB,YAAa1I,KAAKiB,gBACrDjB,KAAK2B,cAAc4G,SAASvI,KAAKmB,gBAGlCb,EAxTmB,CAyT5B,QAEF,SAAS4F,EAAeyC,EAAMC,GAC1B,IACI,OAAOD,EAAKC,GAEhB,MAAOhF,GACH,eAAkBA,M,oCCtV1B,gGAIIvE,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAkBxC8I,EAA0C,SAAUtI,GAEpD,SAASsI,EAAyBrI,GAC9B,IAAIC,EAAQF,EAAOG,KAAKV,KAAMQ,IAAYR,KAC1CS,EAAMqI,WAAa,EACnBrI,EAAMsI,OAAS,EACftI,EAAMuI,eACNvI,EAAMwI,aAAc,EACpB,IAAItI,EAAUF,EAAMG,SAASC,cAAcF,QACvCuI,EAAYvI,EAAQI,IAAI,IAK5B,OAJAN,EAAM0I,YAAcD,EAAUE,WAC9B3I,EAAM4I,SAAW,eAAkB/H,SAASC,cAAc,QAC1Dd,EAAM4I,SAAS3H,aAAa,OAAQ,gBACpCjB,EAAM4I,SAAS3H,aAAa,cAAe,QACpCjB,EA+CX,OA5DApB,EAAUwJ,EAA0BtI,GAepCsI,EAAyB3I,UAAU2B,QAAU,WACzCtB,EAAOL,UAAU2B,QAAQnB,KAAKV,OAElC6I,EAAyB3I,UAAUoJ,kBAAoB,WACnD,IAAIC,EAAiBvJ,KAAKmJ,aAAenJ,KAAK8I,WAAa,EAC3D,OAAI9I,KAAKiJ,cAAgBM,IACrBvJ,KAAKiJ,YAAcM,GACZ,IAIfV,EAAyB3I,UAAUsJ,WAAa,WAC5C,OAAOxJ,KAAKqJ,UAEhBR,EAAyB3I,UAAU8I,aAAe,WAC9C,IAAIrI,EAAUX,KAAKY,SAASC,cAAcF,QACtCG,EAAaH,EAAQI,IAAI,KACI,IAA7BD,EAAW2I,eAAwB3I,EAAW4I,aAAe,GAAgC,IAA3B5I,EAAW6I,YAC7E3J,KAAK+I,OAASjI,EAAWyF,MAGzBvG,KAAK+I,OAASjI,EAAWyF,MAAQzF,EAAW4I,aAAe5I,EAAW8I,wBAI9Ef,EAAyB3I,UAAUyD,uBAAyB,SAAUC,GAClE,IAAIjD,EAAUX,KAAKY,SAASC,cAAcF,QACtCuI,EAAYvI,EAAQI,IAAI,IAI5B,OAHAf,KAAKmJ,YAAcD,EAAUE,WAC7BpJ,KAAKgJ,eACLhJ,KAAKsJ,qBACE,GAEXT,EAAyB3I,UAAU+D,gBAAkB,SAAUL,GAE3D,OADA5D,KAAK8I,WAAalF,EAAEiG,UACb7J,KAAKsJ,qBAGhBT,EAAyB3I,UAAUqH,cAAgB,SAAUC,KAG7DqB,EAAyB3I,UAAUuH,OAAS,SAAUD,GAClDxH,KAAKqJ,SAASd,SAASvI,KAAK+I,QAC5B/I,KAAKqJ,SAAS7H,aAAaxB,KAAKiJ,YAAc,oBAAsB,KAEjEJ,EA7DkC,CA8D3C,QAEF,gBAA2B,SAAUiB,EAAOC,GACxC,IAAIC,EAASF,EAAMG,SAAS,SACxBD,GACAD,EAAUG,QAAQ,mDAAqDF,EAAS,gC,gMC9EpFG,EAAsC,WACtC,SAASA,EAAqB9C,EAAK+C,EAAM7D,EAAOhD,EAAQ8G,EAAaC,GACjEtK,KAAKqH,IAAMA,EACXrH,KAAKoK,KAAOA,EACZpK,KAAKuG,MAAQA,EACbvG,KAAKuD,OAASA,EACdvD,KAAKqK,YAAcA,EACnBrK,KAAKsK,qBAAuBA,EAEhC,OAAOH,EAT8B,GAWrC,EAA4B,WAC5B,SAASI,EAAW/J,GAChBR,KAAKY,SAAWJ,EAChB,IAAIG,EAAUX,KAAKY,SAASC,cAAcF,QACtC6J,EAAW7J,EAAQI,IAAI,IAC3Bf,KAAKyK,aAAe9J,EAAQI,IAAI,IAChCf,KAAKgB,YAAcL,EAAQI,IAAI,IAC/Bf,KAAK0K,gCAAkCF,EAASG,+BAChD3K,KAAK4K,iBAAmBpC,KAAKqC,IAAIlK,EAAQI,IAAI,IAAuBf,KAAK0K,iCACzE1K,KAAK8K,YAAa,EAElB9K,KAAKqJ,SAAW,eAAkB/H,SAASC,cAAc,QACzDvB,KAAKqJ,SAAS7H,aAAa,UAC3BxB,KAAKqJ,SAASf,UAAUtI,KAAKgB,aAC7BhB,KAAKqJ,SAAShB,OAAO,GACrBrI,KAAKqJ,SAAS0B,QAAQ,GACtB,OAAcC,cAAchL,KAAKqJ,SAAUmB,GAC3CxK,KAAKqJ,SAAS7C,WAAW,QACzBxG,KAAKiL,UAAY,IAAI,OAAS,EAAG,GACjCjL,KAAKkL,qBAAuB,GAC5BlL,KAAKmL,YAAc,KAuHvB,OArHAZ,EAAWrK,UAAUsJ,WAAa,WAC9B,OAAOxJ,KAAKqJ,UAEhBkB,EAAWrK,UAAUkL,YAAc,WAC/B,OAAOpL,KAAKiL,WAEhBV,EAAWrK,UAAUmL,KAAO,WACnBrL,KAAK8K,aACN9K,KAAKqJ,SAASiC,cAAc,WAC5BtL,KAAK8K,YAAa,IAG1BP,EAAWrK,UAAUqL,KAAO,WACpBvL,KAAK8K,aACL9K,KAAKqJ,SAASiC,cAAc,UAC5BtL,KAAK8K,YAAa,IAG1BP,EAAWrK,UAAUyD,uBAAyB,SAAUC,GACpD,IAAIjD,EAAUX,KAAKY,SAASC,cAAcF,QACtC6J,EAAW7J,EAAQI,IAAI,IAM3B,OALAf,KAAKyK,aAAe9J,EAAQI,IAAI,IAChCf,KAAKgB,YAAcL,EAAQI,IAAI,IAC/Bf,KAAK0K,gCAAkCF,EAASG,+BAChD3K,KAAK4K,iBAAmBpC,KAAKqC,IAAIlK,EAAQI,IAAI,IAAuBf,KAAK0K,iCACzE,OAAcM,cAAchL,KAAKqJ,SAAUmB,IACpC,GAEXD,EAAWrK,UAAUsL,wBAA0B,SAAUC,GAErD,OADAzL,KAAKiL,UAAYQ,GACV,GAEXlB,EAAWrK,UAAUwL,eAAiB,SAAUlE,GAC5C,IAAI6C,EAAc,GAClB,GAAIrK,KAAKyK,eAAiB,OAAsBkB,MAAQ3L,KAAKyK,eAAiB,OAAsBmB,SAAU,CAC1G,IAKIC,EALAC,EAAetE,EAAIuE,wBAAwB/L,KAAKiL,WACpD,IAAKa,GAAgBA,EAAaE,oBAE9B,OAAO,KAGX,GAAIhM,KAAKyK,eAAiB,OAAsBkB,MAE5C,GADAE,EAAUI,EAAA,KAA2BjM,KAAK4K,iBAAmB,EAAI5K,KAAK4K,iBAAmB,GACrFiB,EAAU,EAAG,CACb,IAAIK,EAAgBlM,KAAKY,SAASiE,MAAMsH,eAAenM,KAAKiL,UAAUlG,YAClEqH,EAAmBC,EAAA,KAAuBH,EAAelM,KAAKiL,UAAUjG,OAAS,GACrFqF,EAAc6B,EAAcI,OAAOtM,KAAKiL,UAAUjG,OAAS,EAAGoH,SAIlEP,EAAUI,EAAA,KAA2B,GAEzC,IAAI7B,EAAO0B,EAAa1B,KACpByB,GAAW,GAAKzB,GAAQ,IAExBA,GAAQ,GAEZ,IAAImC,EAAQ/E,EAAIgF,+BAA+BxM,KAAKiL,UAAUlG,YAAcyC,EAAIW,gBAChF,OAAO,IAAIgC,EAAqBoC,EAAOnC,EAAMyB,EAAS7L,KAAKgB,YAAaqJ,EAAa,IAEzF,IAAIoC,EAAczM,KAAKY,SAASiE,MAAMsH,eAAenM,KAAKiL,UAAUlG,YAChE2H,EAAiBL,EAAA,KAAuBI,EAAazM,KAAKiL,UAAUjG,OAAS,GAC7E2H,EAA2BnF,EAAIoF,2BAA2B,IAAI,OAAM5M,KAAKiL,UAAUlG,WAAY/E,KAAKiL,UAAUjG,OAAQhF,KAAKiL,UAAUlG,WAAY/E,KAAKiL,UAAUjG,OAAS0H,IAAiB,GAC9L,IAAKC,GAAgE,IAApCA,EAAyBrK,OAEtD,OAAO,KAEX,IAAIuK,EAAgCF,EAAyB,GAC7D,GAAIE,EAA8Bb,qBAAuE,IAAhDa,EAA8BC,OAAOxK,OAE1F,OAAO,KAEX,IAAIyK,EAAQF,EAA8BC,OAAO,GAC7CvG,EAAQwG,EAAMxG,MAAQ,EAAIvG,KAAK0K,gCAAkCqC,EAAMxG,MACvE+D,EAAuB,GAC3B,GAAItK,KAAKyK,eAAiB,OAAsBuC,MAAO,CACnD,IAAIC,EAAWjN,KAAKY,SAASiE,MAAMqI,gBAAgBlN,KAAKiL,UAAUlG,YAClEsF,EAAcoC,EAAYH,OAAOtM,KAAKiL,UAAUjG,OAAS,EAAG0H,GAC5D,IAAIS,EAAaF,EAASG,OAAOC,uBAAuBrN,KAAKiL,UAAUjG,OAAS,GAChFsF,EAAuB2C,EAASG,OAAOE,aAAaH,GAExD,IAAI9F,EAAMG,EAAIgF,+BAA+BxM,KAAKiL,UAAUlG,YAAcyC,EAAIW,gBAC1E5E,EAASvD,KAAKgB,YAMlB,OAJIhB,KAAKyK,eAAiB,OAAsB8C,WAAavN,KAAKyK,eAAiB,OAAsB+C,gBACrGnG,GAAOrH,KAAKgB,YAAc,EAC1BuC,EAAS,GAEN,IAAI4G,EAAqB9C,EAAK0F,EAAM3C,KAAM7D,EAAOhD,EAAQ8G,EAAaC,IAEjFC,EAAWrK,UAAUqH,cAAgB,SAAUC,GAC3CxH,KAAKmL,YAAcnL,KAAK0L,eAAelE,IAE3C+C,EAAWrK,UAAUuH,OAAS,SAAUD,GACpC,OAAKxH,KAAKmL,aAINnL,KAAKkL,uBAAyBlL,KAAKmL,YAAYd,cAC/CrK,KAAKkL,qBAAuBlL,KAAKmL,YAAYd,YAC7CrK,KAAKqJ,SAAShI,QAAQgJ,YAAcrK,KAAKkL,sBAE7ClL,KAAKqJ,SAAS7H,aAAa,UAAYxB,KAAKmL,YAAYb,sBACxDtK,KAAKqJ,SAAS7C,WAAW,SACzBxG,KAAKqJ,SAAShB,OAAOrI,KAAKmL,YAAY9D,KACtCrH,KAAKqJ,SAAS0B,QAAQ/K,KAAKmL,YAAYf,MACvCpK,KAAKqJ,SAASd,SAASvI,KAAKmL,YAAY5E,OACxCvG,KAAKqJ,SAASoE,cAAczN,KAAKmL,YAAY5H,QAC7CvD,KAAKqJ,SAASf,UAAUtI,KAAKmL,YAAY5H,QAClC,CACHlC,QAASrB,KAAKqJ,SAAShI,QACvBoK,SAAUzL,KAAKiL,UACf7J,YAAapB,KAAKmL,YAAYf,KAC9B7G,OAAQvD,KAAKmL,YAAY5H,OACzBgD,MAAO,KAnBPvG,KAAKqJ,SAAS7C,WAAW,QAClB,OAqBR+D,EA3IoB,G,wBClB3BlL,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAqBxC,EAA6B,SAAUQ,GAEvC,SAASmN,EAAYlN,GACjB,IAAIC,EAAQF,EAAOG,KAAKV,KAAMQ,IAAYR,KACtCW,EAAUF,EAAMG,SAASC,cAAcF,QAoB3C,OAnBAF,EAAMkN,UAAYhN,EAAQI,IAAI,IAC9BN,EAAMmN,gBAAkBjN,EAAQI,IAAI,IACpCN,EAAMgK,aAAe9J,EAAQI,IAAI,IACjCN,EAAMoN,4BAA8BlN,EAAQI,IAAI,IAChDN,EAAMqN,mBAAoB,EAC1BrN,EAAMqK,YAAa,EACnBrK,EAAMsN,eAAiB,IAAI,EAAWtN,EAAMG,UAC5CH,EAAMuN,kBAAoB,GAC1BvN,EAAM0K,YAAc,GACpB1K,EAAM4I,SAAW,eAAkB/H,SAASC,cAAc,QAC1Dd,EAAM4I,SAAS3H,aAAa,OAAQ,gBACpCjB,EAAM4I,SAAS3H,aAAa,cAAe,QAC3CjB,EAAMwN,sBACNxN,EAAM4I,SAAS5C,YAAYhG,EAAMsN,eAAevE,cAChD/I,EAAMyN,2BAA6B,IAAI,OACvCzN,EAAM0N,yBAA2B,IAAI,OACrC1N,EAAM2N,kBAAmB,EACzB3N,EAAM4N,iBAAkB,EACxB5N,EAAM6N,kBACC7N,EA+PX,OAtRApB,EAAUqO,EAAanN,GAyBvBmN,EAAYxN,UAAU2B,QAAU,WAC5BtB,EAAOL,UAAU2B,QAAQnB,KAAKV,MAC9BA,KAAKkO,2BAA2BrM,UAChC7B,KAAKmO,yBAAyBtM,WAElC6L,EAAYxN,UAAUsJ,WAAa,WAC/B,OAAOxJ,KAAKqJ,UAGhBqE,EAAYxN,UAAUyD,uBAAyB,SAAUC,GACrD,IAAIjD,EAAUX,KAAKY,SAASC,cAAcF,QAC1CX,KAAK2N,UAAYhN,EAAQI,IAAI,IAC7Bf,KAAK4N,gBAAkBjN,EAAQI,IAAI,IACnCf,KAAKyK,aAAe9J,EAAQI,IAAI,IAChCf,KAAK6N,4BAA8BlN,EAAQI,IAAI,IAC/Cf,KAAKsO,kBACLtO,KAAKiO,sBACLjO,KAAK+N,eAAepK,uBAAuBC,GAC3C,IAAK,IAAId,EAAI,EAAGC,EAAM/C,KAAKgO,kBAAkB1L,OAAQQ,EAAIC,EAAKD,IAC1D9C,KAAKgO,kBAAkBlL,GAAGa,uBAAuBC,GAErD,OAAO,GAEX8J,EAAYxN,UAAUqO,yBAA2B,SAAU9C,EAAU+C,GAGjE,GAFAxO,KAAK+N,eAAevC,wBAAwBC,GAC5CzL,KAAKsO,kBACDtO,KAAKgO,kBAAkB1L,OAASkM,EAAmBlM,OAGnD,IADA,IAAImM,EAASD,EAAmBlM,OAAStC,KAAKgO,kBAAkB1L,OACvDQ,EAAI,EAAGA,EAAI2L,EAAQ3L,IAAK,CAC7B,IAAI4L,EAAY,IAAI,EAAW1O,KAAKY,UACpCZ,KAAKqJ,SAAShI,QAAQsN,aAAaD,EAAUlF,aAAanI,QAASrB,KAAK+N,eAAevE,aAAanI,QAAQuN,aAC5G5O,KAAKgO,kBAAkBa,KAAKH,QAG/B,GAAI1O,KAAKgO,kBAAkB1L,OAASkM,EAAmBlM,OAExD,KAAIwM,EAAY9O,KAAKgO,kBAAkB1L,OAASkM,EAAmBlM,OACnE,IAASQ,EAAI,EAAGA,EAAIgM,EAAWhM,IAC3B9C,KAAKqJ,SAASvC,YAAY9G,KAAKgO,kBAAkB,GAAGxE,cACpDxJ,KAAKgO,kBAAkBe,OAAO,EAAG,GAGzC,IAASjM,EAAI,EAAGA,EAAI0L,EAAmBlM,OAAQQ,IAC3C9C,KAAKgO,kBAAkBlL,GAAG0I,wBAAwBgD,EAAmB1L,KAG7E4K,EAAYxN,UAAU8O,qBAAuB,SAAUpL,GAEnD,IADA,IAAIqL,EAAY,GACPnM,EAAI,EAAGC,EAAMa,EAAEsL,WAAW5M,OAAQQ,EAAIC,EAAKD,IAChDmM,EAAUnM,GAAKc,EAAEsL,WAAWpM,GAAGsI,cAEnCpL,KAAKuO,yBAAyBU,EAAU,GAAIA,EAAUE,MAAM,IAC5D,IAAIC,EAAmBxL,EAAEsL,WAAW,GAAGG,UAKvC,OAJIrP,KAAK8N,oBAAsBsB,IAC3BpP,KAAK8N,kBAAoBsB,EACzBpP,KAAKiO,wBAEF,GAEXP,EAAYxN,UAAUoP,qBAAuB,SAAU1L,GAEnD,OAAO,GAEX8J,EAAYxN,UAAUqP,UAAY,SAAU3L,GACxC,OAAO,GAEX8J,EAAYxN,UAAUsP,eAAiB,SAAU5L,GAG7C,OAFA5D,KAAKqO,gBAAkBzK,EAAE6L,UACzBzP,KAAKsO,mBACE,GAEXZ,EAAYxN,UAAUwP,eAAiB,SAAU9L,GAC7C,OAAO,GAEX8J,EAAYxN,UAAU8D,eAAiB,SAAUJ,GAC7C,OAAO,GAEX8J,EAAYxN,UAAUmE,gBAAkB,SAAUT,GAC9C,OAAO,GAEX8J,EAAYxN,UAAU+D,gBAAkB,SAAUL,GAC9C,OAAO,GAEX8J,EAAYxN,UAAUyP,gBAAkB,SAAU/L,GAC9C,IAAIgM,EAAe,SAAUnE,GACzB,IAAK,IAAI3I,EAAI,EAAGC,EAAMa,EAAEkJ,OAAOxK,OAAQQ,EAAIC,EAAKD,IAC5C,GAAIc,EAAEkJ,OAAOhK,GAAG+M,gBAAkBpE,EAAS1G,YAAc0G,EAAS1G,YAAcnB,EAAEkJ,OAAOhK,GAAGgN,aACxF,OAAO,EAGf,OAAO,GAEX,GAAIF,EAAa5P,KAAK+N,eAAe3C,eACjC,OAAO,EAEX,IAAK,IAAIhJ,EAAK,EAAG2N,EAAK/P,KAAKgO,kBAAmB5L,EAAK2N,EAAGzN,OAAQF,IAAM,CAChE,IAAI4N,EAAkBD,EAAG3N,GACzB,GAAIwN,EAAaI,EAAgB5E,eAC7B,OAAO,EAGf,OAAO,GAEXsC,EAAYxN,UAAUkE,eAAiB,SAAUR,GAC7C,OAAO,GAIX8J,EAAYxN,UAAU+P,mBAAqB,WACvC,OAAKjQ,KAAKqO,gBAGNrO,KAAK2N,UACE,EAEJ3N,KAAK4N,gBALD,GAOfF,EAAYxN,UAAUoO,gBAAkB,WACpC,IAAI7N,EAAQT,KACZA,KAAKkO,2BAA2BgC,SAChClQ,KAAKmO,yBAAyB+B,SAC9B,IAAIC,EAAgBnQ,KAAKiQ,qBAErBG,EAA8B,IAAlBD,EACZE,EAA6B,IAAlBF,EACXC,EACApQ,KAAKsQ,QAGLtQ,KAAKuQ,QAETvQ,KAAKoO,kBAAmB,EACxBpO,KAAKiO,sBACAmC,GAAaC,IACQ,IAAlBF,EAEAnQ,KAAKmO,yBAAyBqC,cAAa,WACnC/P,EAAMqK,WACNrK,EAAM6P,QAGN7P,EAAM8P,UAEX7C,EAAY+C,gBAGfzQ,KAAKkO,2BAA2BwC,aAAY,WACxCjQ,EAAM2N,kBAAmB,EACzB3N,EAAMwN,wBACPP,EAAY+C,kBAK3B/C,EAAYxN,UAAU+N,oBAAsB,WACxCjO,KAAKqJ,SAAS7H,aAAaxB,KAAK2Q,kBAEpCjD,EAAYxN,UAAUyQ,cAAgB,WAClC,IAAIC,EAAS,gBAIb,OAHK5Q,KAAK8N,oBACN8C,GAAU,kBAEN5Q,KAAKyK,cACT,KAAK,OAAsBkB,KACvBiF,GAAU,qBACV,MACJ,KAAK,OAAsB5D,MACvB4D,GAAU,sBACV,MACJ,KAAK,OAAsBrD,UACvBqD,GAAU,0BACV,MACJ,KAAK,OAAsBhF,SACvBgF,GAAU,0BACV,MACJ,KAAK,OAAsBC,aACvBD,GAAU,8BACV,MACJ,KAAK,OAAsBpD,cACvBoD,GAAU,+BACV,MACJ,QACIA,GAAU,qBAElB,GAAI5Q,KAAKoO,iBACL,OAAQpO,KAAKiQ,sBACT,KAAK,EACDW,GAAU,gBACV,MACJ,KAAK,EACDA,GAAU,iBACV,MACJ,KAAK,EACDA,GAAU,gBACV,MACJ,KAAK,EACDA,GAAU,iBACV,MACJ,KAAK,EACDA,GAAU,gBACV,MACJ,QACIA,GAAU,qBAIlBA,GAAU,gBAKd,OAHI5Q,KAAK6N,8BACL+C,GAAU,kCAEPA,GAEXlD,EAAYxN,UAAUqQ,MAAQ,WAC1BvQ,KAAK+N,eAAe1C,OACpB,IAAK,IAAIvI,EAAI,EAAGC,EAAM/C,KAAKgO,kBAAkB1L,OAAQQ,EAAIC,EAAKD,IAC1D9C,KAAKgO,kBAAkBlL,GAAGuI,OAE9BrL,KAAK8K,YAAa,GAEtB4C,EAAYxN,UAAUoQ,MAAQ,WAC1BtQ,KAAK+N,eAAexC,OACpB,IAAK,IAAIzI,EAAI,EAAGC,EAAM/C,KAAKgO,kBAAkB1L,OAAQQ,EAAIC,EAAKD,IAC1D9C,KAAKgO,kBAAkBlL,GAAGyI,OAE9BvL,KAAK8K,YAAa,GAGtB4C,EAAYxN,UAAUqH,cAAgB,SAAUC,GAC5CxH,KAAK+N,eAAexG,cAAcC,GAClC,IAAK,IAAI1E,EAAI,EAAGC,EAAM/C,KAAKgO,kBAAkB1L,OAAQQ,EAAIC,EAAKD,IAC1D9C,KAAKgO,kBAAkBlL,GAAGyE,cAAcC,IAGhDkG,EAAYxN,UAAUuH,OAAS,SAAUD,GACrC,IAAIsJ,EAAa,GAAIC,EAAgB,EACjCC,EAAoBhR,KAAK+N,eAAetG,OAAOD,GAC/CwJ,IACAF,EAAWC,KAAmBC,GAElC,IAAK,IAAIlO,EAAI,EAAGC,EAAM/C,KAAKgO,kBAAkB1L,OAAQQ,EAAIC,EAAKD,IAAK,CAC/D,IAAImO,EAAsBjR,KAAKgO,kBAAkBlL,GAAG2E,OAAOD,GACvDyJ,IACAH,EAAWC,KAAmBE,GAGtCjR,KAAKmL,YAAc2F,GAEvBpD,EAAYxN,UAAUgR,kBAAoB,WACtC,OAAOlR,KAAKmL,aAEhBuC,EAAY+C,eAAiB,IACtB/C,EAvRqB,CAwR9B,QAEF,gBAA2B,SAAU5D,EAAOC,GACxC,IAAIoH,EAAQrH,EAAMG,SAAS,QAC3B,GAAIkH,EAAO,CACP,IAAIC,EAAkBtH,EAAMG,SAAS,QAChCmH,IACDA,EAAkBD,EAAME,YAE5BtH,EAAUG,QAAQ,8CAAgDiH,EAAQ,mBAAqBA,EAAQ,YAAcC,EAAkB,OACpH,OAAftH,EAAMwH,MACNvH,EAAUG,QAAQ,gFAAkFkH,EAAkB,6BAA+BA,EAAkB,Y,oCC5TnL,gGAII/R,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAkBxCwR,EAA0C,WAC1C,SAASA,EAAyBC,GAC9BxR,KAAKoK,KAAOoH,EAAMpH,KAClBpK,KAAKuG,MAAQiL,EAAMjL,MACnBvG,KAAKyR,WAAa,KAClBzR,KAAK0R,SAAW,KAEpB,OAAOH,EAPkC,GASzCI,EAA4C,WAC5C,SAASA,EAA2B5M,EAAY+H,GAC5C9M,KAAK+E,WAAaA,EAClB/E,KAAK8M,OAASA,EAElB,OAAO6E,EALoC,GAO/C,SAASC,EAAcC,GACnB,OAAO,IAAIN,EAAyBM,GAExC,SAASC,EAASD,GACd,OAAO,IAAIF,EAA2BE,EAAK9M,WAAY8M,EAAK/E,OAAOiF,IAAIH,IAK3E,IAAII,EAA0C,OAC1CC,EAAmC,SAAU1R,GAE7C,SAAS0R,EAAkBzR,GACvB,IAAIC,EAAQF,EAAOG,KAAKV,OAASA,KACjCS,EAAMyR,qCAAuC,GAC7CzR,EAAMG,SAAWJ,EACjB,IAAIG,EAAUF,EAAMG,SAASC,cAAcF,QAO3C,OANAF,EAAMO,YAAcL,EAAQI,IAAI,IAChCN,EAAM0R,kBAAoBxR,EAAQI,IAAI,IACtCN,EAAMiK,gCAAkC/J,EAAQI,IAAI,IAAmB4J,+BACvElK,EAAM2R,YAAc,GACpB3R,EAAM4R,cAAgB,KACtB5R,EAAMG,SAAS0R,gBAAgB7R,GACxBA,EA2RX,OAvSApB,EAAU4S,EAAmB1R,GAc7B0R,EAAkB/R,UAAU2B,QAAU,WAClC7B,KAAKY,SAAS2R,mBAAmBvS,MACjCA,KAAKqS,cAAgB,KACrB9R,EAAOL,UAAU2B,QAAQnB,KAAKV,OAGlCiS,EAAkB/R,UAAUyD,uBAAyB,SAAUC,GAC3D,IAAIjD,EAAUX,KAAKY,SAASC,cAAcF,QAI1C,OAHAX,KAAKgB,YAAcL,EAAQI,IAAI,IAC/Bf,KAAKmS,kBAAoBxR,EAAQI,IAAI,IACrCf,KAAK0K,gCAAkC/J,EAAQI,IAAI,IAAmB4J,gCAC/D,GAEXsH,EAAkB/R,UAAU8O,qBAAuB,SAAUpL,GAEzD,OADA5D,KAAKoS,YAAcxO,EAAEsL,WAAWC,MAAM,IAC/B,GAEX8C,EAAkB/R,UAAUoP,qBAAuB,SAAU1L,GAEzD,OAAO,GAEXqO,EAAkB/R,UAAUqP,UAAY,SAAU3L,GAC9C,OAAO,GAEXqO,EAAkB/R,UAAUwP,eAAiB,SAAU9L,GACnD,OAAO,GAEXqO,EAAkB/R,UAAU8D,eAAiB,SAAUJ,GACnD,OAAO,GAEXqO,EAAkB/R,UAAUmE,gBAAkB,SAAUT,GACpD,OAAO,GAEXqO,EAAkB/R,UAAU+D,gBAAkB,SAAUL,GACpD,OAAOA,EAAEM,kBAEb+N,EAAkB/R,UAAUkE,eAAiB,SAAUR,GACnD,OAAO,GAGXqO,EAAkB/R,UAAUsS,uBAAyB,SAAUC,GAC3D,IAAK,IAAI3P,EAAI,EAAGC,EAAM0P,EAAmBnQ,OAAQQ,EAAIC,EAAKD,IAAK,CAC3D,IAAI4P,EAAoBD,EAAmB3P,GAC3C,GAAI4P,EAAkB5F,OAAOxK,OAAS,EAElC,OAAO,EAGf,OAAO,GAEX2P,EAAkB/R,UAAUyS,8BAAgC,SAAUC,EAAUH,EAAoBI,GAChG,IAAIC,EAAU9S,KAAK0K,gCAAkC,EACjDqI,EAAmB,KACnBC,EAAsB,KAC1B,GAAIH,GAAiBA,EAAcvQ,OAAS,GAAKmQ,EAAmBnQ,OAAS,EAAG,CAC5E,IAAI2Q,EAAgBR,EAAmB,GAAG1N,WAC1C,GAAIkO,IAAkBL,EAASM,gBAC3B,IAAK,IAAIpQ,EAAI,GAAIiQ,GAAoBjQ,EAAI+P,EAAcvQ,OAAQQ,IACvD+P,EAAc/P,GAAGiC,aAAekO,IAChCF,EAAmBF,EAAc/P,GAAGgK,OAAO,IAIvD,IAAIqG,EAAmBV,EAAmBA,EAAmBnQ,OAAS,GAAGyC,WACzE,GAAIoO,IAAqBP,EAASQ,cAC9B,IAAStQ,EAAI+P,EAAcvQ,OAAS,GAAI0Q,GAAuBlQ,GAAK,EAAGA,IAC/D+P,EAAc/P,GAAGiC,aAAeoO,IAChCH,EAAsBH,EAAc/P,GAAGgK,OAAO,IAItDiG,IAAqBA,EAAiBtB,aACtCsB,EAAmB,MAEnBC,IAAwBA,EAAoBvB,aAC5CuB,EAAsB,MAGrBlQ,EAAI,EAAb,IAAK,IAAWC,EAAM0P,EAAmBnQ,OAAQQ,EAAIC,EAAKD,IAAK,CAE3D,IAAIuQ,EAAeZ,EAAmB3P,GAAGgK,OAAO,GAC5CwG,EAAUD,EAAajJ,KACvBmJ,EAAWF,EAAajJ,KAAOiJ,EAAa9M,MAC5CkL,EAAa,CACbpK,IAAK,EACLmM,OAAQ,GAER9B,EAAW,CACXrK,IAAK,EACLmM,OAAQ,GAEZ,GAAI1Q,EAAI,EAAG,CAEP,IAAI2Q,EAAWhB,EAAmB3P,EAAI,GAAGgK,OAAO,GAAG1C,KAC/CsJ,EAAYjB,EAAmB3P,EAAI,GAAGgK,OAAO,GAAG1C,KAAOqI,EAAmB3P,EAAI,GAAGgK,OAAO,GAAGvG,MAC3FoN,EAAIL,EAAUG,GAAYX,EAC1BrB,EAAWpK,IAAM,EAEZiM,EAAUG,IACfhC,EAAWpK,IAAM,GAEjBsM,EAAIJ,EAAWG,GAAaZ,EAC5BpB,EAASrK,IAAM,EAEVoM,EAAWF,GAAYA,EAAWG,IACvChC,EAASrK,IAAM,QAGd0L,IAELtB,EAAWpK,IAAM0L,EAAiBtB,WAAWpK,IAC7CqK,EAASrK,IAAM0L,EAAiBrB,SAASrK,KAE7C,GAAIvE,EAAI,EAAIC,EAAK,CAEb,IAAI6Q,EAAWnB,EAAmB3P,EAAI,GAAGgK,OAAO,GAAG1C,KAC/CyJ,EAAYpB,EAAmB3P,EAAI,GAAGgK,OAAO,GAAG1C,KAAOqI,EAAmB3P,EAAI,GAAGgK,OAAO,GAAGvG,MAC3FoN,EAAIL,EAAUM,GAAYd,EAC1BrB,EAAW+B,OAAS,EAEfI,EAAWN,GAAWA,EAAUO,IACrCpC,EAAW+B,OAAS,GAEpBG,EAAIJ,EAAWM,GAAaf,EAC5BpB,EAAS8B,OAAS,EAEbD,EAAWM,IAChBnC,EAAS8B,OAAS,QAGjBR,IAELvB,EAAW+B,OAASR,EAAoBvB,WAAW+B,OACnD9B,EAAS8B,OAASR,EAAoBtB,SAAS8B,QAEnDH,EAAa5B,WAAaA,EAC1B4B,EAAa3B,SAAWA,IAGhCO,EAAkB/R,UAAU4T,2BAA6B,SAAUC,EAAWvM,EAAKqL,GAC/E,IAAImB,EAAsBxM,EAAIoF,2BAA2BmH,GAAW,IAAS,GACzEtB,EAAqBuB,EAAoBjC,IAAID,GAC7CmC,EAAwBjU,KAAKwS,uBAAuBC,GAKxD,OAJKT,GAA4CiC,IAAyBjU,KAAKmS,mBAC3EnS,KAAK2S,8BAA8BnL,EAAIsE,aAAc2G,EAAoBI,GAGtEJ,GAEXR,EAAkB/R,UAAUgU,sBAAwB,SAAU7M,EAAK9D,EAAQ4Q,EAAW/J,EAAM7D,GACxF,MAAQ,oBACF4N,EACA,gBACA9M,EAAI+M,WACJ,WACAhK,EAAKgK,WACL,YACA7N,EAAM6N,WACN,aACA7Q,EACA,eAEV0O,EAAkB/R,UAAUmU,0BAA4B,SAAUC,EAASC,EAAwBC,EAAuBC,GACtH,GAA6B,IAAzBA,EAAcnS,OAQlB,IALA,IAAIoS,IAA2BD,EAAc,GAAG3H,OAAO,GAAG2E,WACtDkD,EAAkB3U,KAAgB,YAAEoU,WACpCQ,GAAqB5U,KAAKgB,YAAc,GAAGoT,WAC3CS,EAAkBJ,EAAc,GAAG1P,WACnC+P,EAAiBL,EAAcA,EAAcnS,OAAS,GAAGyC,WACpDjC,EAAI,EAAGC,EAAM0R,EAAcnS,OAAQQ,EAAIC,EAAKD,IAAK,CAQtD,IAPA,IAAI4P,EAAoB+B,EAAc3R,GAClCiC,EAAa2N,EAAkB3N,WAC/BgQ,EAAYhQ,EAAawP,EACzBS,EAAaR,IAAyBzP,IAAe+P,GAAkB/P,IAAe8P,GAAkBD,EAAsCD,EAC9IpI,EAAQiI,GAAyBzP,IAAe8P,EAAkB,EAAS,EAC3EI,EAAoB,GACpBC,EAAwB,GACnBC,EAAI,EAAGC,EAAO1C,EAAkB5F,OAAOxK,OAAQ6S,EAAIC,EAAMD,IAAK,CACnE,IAAIrJ,EAAe4G,EAAkB5F,OAAOqI,GAC5C,GAAIT,EAAwB,CACxB,IAAIjD,EAAa3F,EAAa2F,WAC1BC,EAAW5F,EAAa4F,SAC5B,GAAuB,IAAnBD,EAAWpK,KAAgD,IAAtBoK,EAAW+B,OAA2B,CAG3EyB,GAAqBjV,KAAKkU,sBAAsB3H,EAAOyI,EAAY/C,EAAkBoD,qBAAsBvJ,EAAa1B,KAAO6H,EAAkBqD,oBAAqBrD,EAAkBqD,qBAExL,IAAIC,EAActD,EAAkBuD,6BACb,IAAnB/D,EAAWpK,MACXkO,GAAe,IAAMtD,EAAkBwD,qBAEjB,IAAtBhE,EAAW+B,SACX+B,GAAe,IAAMtD,EAAkByD,wBAE3CT,GAAqBjV,KAAKkU,sBAAsB3H,EAAOyI,EAAYO,EAAazJ,EAAa1B,KAAO6H,EAAkBqD,oBAAqBrD,EAAkBqD,qBAEjK,GAAqB,IAAjB5D,EAASrK,KAA8C,IAApBqK,EAAS8B,OAA2B,CAGvEyB,GAAqBjV,KAAKkU,sBAAsB3H,EAAOyI,EAAY/C,EAAkBoD,qBAAsBvJ,EAAa1B,KAAO0B,EAAavF,MAAO0L,EAAkBqD,qBAErK,IAAIK,EAAc1D,EAAkBuD,6BACf,IAAjB9D,EAASrK,MACTsO,GAAe,IAAM1D,EAAkB2D,oBAEnB,IAApBlE,EAAS8B,SACTmC,GAAe,IAAM1D,EAAkB4D,uBAE3CZ,GAAqBjV,KAAKkU,sBAAsB3H,EAAOyI,EAAYW,EAAa7J,EAAa1B,KAAO0B,EAAavF,MAAO0L,EAAkBqD,sBAGlJ,IAAInB,EAAYlC,EAAkBoD,qBAClC,GAAIX,EAAwB,CACpBjD,EAAa3F,EAAa2F,WAC1BC,EAAW5F,EAAa4F,SACL,IAAnBD,EAAWpK,MACX8M,GAAa,IAAMlC,EAAkB2D,oBAEf,IAAtBnE,EAAW+B,SACXW,GAAa,IAAMlC,EAAkB4D,uBAEpB,IAAjBnE,EAASrK,MACT8M,GAAa,IAAMlC,EAAkBwD,qBAEjB,IAApB/D,EAAS8B,SACTW,GAAa,IAAMlC,EAAkByD,wBAG7CR,GAAyBlV,KAAKkU,sBAAsB3H,EAAOyI,EAAYb,EAAWrI,EAAa1B,KAAM0B,EAAavF,OAEtH+N,EAAQS,GAAW,IAAME,EACzBX,EAAQS,GAAW,IAAMG,IAGjCjD,EAAkB/R,UAAUqH,cAAgB,SAAUC,GAOlD,IAHA,IAAIsO,EAAS,GACTvB,EAAyB/M,EAAIsE,aAAaoH,gBAC1C6C,EAAuBvO,EAAIsE,aAAasH,cACnCrO,EAAawP,EAAwBxP,GAAcgR,EAAsBhR,IAAc,CAC5F,IAAIgQ,EAAYhQ,EAAawP,EAC7BuB,EAAOf,GAAa,CAAC,GAAI,IAG7B,IADA,IAAIiB,EAAkC,GAC7BlT,EAAI,EAAGC,EAAM/C,KAAKoS,YAAY9P,OAAQQ,EAAIC,EAAKD,IAAK,CACzD,IAAIiR,EAAY/T,KAAKoS,YAAYtP,GACjC,GAAIiR,EAAU1E,UACV2G,EAAgClT,GAAK,SADzC,CAIA,IAAImT,EAAyBjW,KAAK8T,2BAA2BC,EAAWvM,EAAKxH,KAAKkS,qCAAqCpP,IACvHkT,EAAgClT,GAAKmT,EACrCjW,KAAKqU,0BAA0ByB,EAAQvB,EAAwBvU,KAAKoS,YAAY9P,OAAS,EAAG2T,IAEhGjW,KAAKkS,qCAAuC8D,EAC5ChW,KAAKqS,cAAgByD,EAAO/D,KAAI,SAAUhC,GACtC,IAAImG,EAAkBnG,EAAG,GAAIoG,EAAkBpG,EAAG,GAClD,OAAOmG,EAAkBC,MAGjClE,EAAkB/R,UAAUuH,OAAS,SAAUyL,EAAiBnO,GAC5D,IAAK/E,KAAKqS,cACN,MAAO,GAEX,IAAI0C,EAAYhQ,EAAamO,EAC7B,OAAI6B,EAAY,GAAKA,GAAa/U,KAAKqS,cAAc/P,OAC1C,GAEJtC,KAAKqS,cAAc0C,IAE9B9C,EAAkBoD,qBAAuB,gBACzCpD,EAAkB2D,mBAAqB,kBACvC3D,EAAkB4D,sBAAwB,qBAC1C5D,EAAkBwD,oBAAsB,mBACxCxD,EAAkByD,uBAAyB,sBAC3CzD,EAAkBuD,6BAA+B,2BACjDvD,EAAkBqD,oBAAsB,GACjCrD,EAxS2B,CAySpC,QAgBF,SAAS0B,EAAIyC,GACT,OAAOA,EAAI,GAAKA,EAAIA,EAfxB,gBAA2B,SAAUtM,EAAOC,GACxC,IAAIsM,EAAuBvM,EAAMG,SAAS,QACtCoM,GACAtM,EAAUG,QAAQ,8DAAgEmM,EAAuB,OAE7G,IAAIC,EAA+BxM,EAAMG,SAAS,QAC9CqM,GACAvM,EAAUG,QAAQ,qDAAuDoM,EAA+B,OAE5G,IAAIC,EAAiCzM,EAAMG,SAAS,QAChDsM,GACAxM,EAAUG,QAAQ,gEAAkEqM,EAAiC,W","file":"js/chunk-vendors~b9b2533f.7d80224d.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nvar invalidFunc = function () { throw new Error(\"Invalid change accessor\"); };\r\nvar ViewZones = /** @class */ (function (_super) {\r\n    __extends(ViewZones, _super);\r\n    function ViewZones(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._contentWidth = layoutInfo.contentWidth;\r\n        _this._contentLeft = layoutInfo.contentLeft;\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setClassName('view-zones');\r\n        _this.domNode.setPosition('absolute');\r\n        _this.domNode.setAttribute('role', 'presentation');\r\n        _this.domNode.setAttribute('aria-hidden', 'true');\r\n        _this.marginDomNode = createFastDomNode(document.createElement('div'));\r\n        _this.marginDomNode.setClassName('margin-view-zones');\r\n        _this.marginDomNode.setPosition('absolute');\r\n        _this.marginDomNode.setAttribute('role', 'presentation');\r\n        _this.marginDomNode.setAttribute('aria-hidden', 'true');\r\n        _this._zones = {};\r\n        return _this;\r\n    }\r\n    ViewZones.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._zones = {};\r\n    };\r\n    // ---- begin view event handlers\r\n    ViewZones.prototype._recomputeWhitespacesProps = function () {\r\n        var _this = this;\r\n        var whitespaces = this._context.viewLayout.getWhitespaces();\r\n        var oldWhitespaces = new Map();\r\n        for (var _i = 0, whitespaces_1 = whitespaces; _i < whitespaces_1.length; _i++) {\r\n            var whitespace = whitespaces_1[_i];\r\n            oldWhitespaces.set(whitespace.id, whitespace);\r\n        }\r\n        return this._context.viewLayout.changeWhitespace(function (whitespaceAccessor) {\r\n            var hadAChange = false;\r\n            var keys = Object.keys(_this._zones);\r\n            for (var i = 0, len = keys.length; i < len; i++) {\r\n                var id = keys[i];\r\n                var zone = _this._zones[id];\r\n                var props = _this._computeWhitespaceProps(zone.delegate);\r\n                var oldWhitespace = oldWhitespaces.get(id);\r\n                if (oldWhitespace && (oldWhitespace.afterLineNumber !== props.afterViewLineNumber || oldWhitespace.height !== props.heightInPx)) {\r\n                    whitespaceAccessor.changeOneWhitespace(id, props.afterViewLineNumber, props.heightInPx);\r\n                    _this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\r\n                    hadAChange = true;\r\n                }\r\n            }\r\n            return hadAChange;\r\n        });\r\n    };\r\n    ViewZones.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._contentWidth = layoutInfo.contentWidth;\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        if (e.hasChanged(49 /* lineHeight */)) {\r\n            this._recomputeWhitespacesProps();\r\n        }\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onLineMappingChanged = function (e) {\r\n        var hadAChange = this._recomputeWhitespacesProps();\r\n        if (hadAChange) {\r\n            this._context.viewLayout.onHeightMaybeChanged();\r\n        }\r\n        return hadAChange;\r\n    };\r\n    ViewZones.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged || e.scrollWidthChanged;\r\n    };\r\n    ViewZones.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewZones.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewZones.prototype._getZoneOrdinal = function (zone) {\r\n        if (typeof zone.afterColumn !== 'undefined') {\r\n            return zone.afterColumn;\r\n        }\r\n        return 10000;\r\n    };\r\n    ViewZones.prototype._computeWhitespaceProps = function (zone) {\r\n        if (zone.afterLineNumber === 0) {\r\n            return {\r\n                afterViewLineNumber: 0,\r\n                heightInPx: this._heightInPixels(zone),\r\n                minWidthInPx: this._minWidthInPixels(zone)\r\n            };\r\n        }\r\n        var zoneAfterModelPosition;\r\n        if (typeof zone.afterColumn !== 'undefined') {\r\n            zoneAfterModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zone.afterLineNumber,\r\n                column: zone.afterColumn\r\n            });\r\n        }\r\n        else {\r\n            var validAfterLineNumber = this._context.model.validateModelPosition({\r\n                lineNumber: zone.afterLineNumber,\r\n                column: 1\r\n            }).lineNumber;\r\n            zoneAfterModelPosition = new Position(validAfterLineNumber, this._context.model.getModelLineMaxColumn(validAfterLineNumber));\r\n        }\r\n        var zoneBeforeModelPosition;\r\n        if (zoneAfterModelPosition.column === this._context.model.getModelLineMaxColumn(zoneAfterModelPosition.lineNumber)) {\r\n            zoneBeforeModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zoneAfterModelPosition.lineNumber + 1,\r\n                column: 1\r\n            });\r\n        }\r\n        else {\r\n            zoneBeforeModelPosition = this._context.model.validateModelPosition({\r\n                lineNumber: zoneAfterModelPosition.lineNumber,\r\n                column: zoneAfterModelPosition.column + 1\r\n            });\r\n        }\r\n        var viewPosition = this._context.model.coordinatesConverter.convertModelPositionToViewPosition(zoneAfterModelPosition);\r\n        var isVisible = this._context.model.coordinatesConverter.modelPositionIsVisible(zoneBeforeModelPosition);\r\n        return {\r\n            afterViewLineNumber: viewPosition.lineNumber,\r\n            heightInPx: (isVisible ? this._heightInPixels(zone) : 0),\r\n            minWidthInPx: this._minWidthInPixels(zone)\r\n        };\r\n    };\r\n    ViewZones.prototype.changeViewZones = function (callback) {\r\n        var _this = this;\r\n        return this._context.viewLayout.changeWhitespace(function (whitespaceAccessor) {\r\n            var zonesHaveChanged = false;\r\n            var changeAccessor = {\r\n                addZone: function (zone) {\r\n                    zonesHaveChanged = true;\r\n                    return _this._addZone(whitespaceAccessor, zone);\r\n                },\r\n                removeZone: function (id) {\r\n                    if (!id) {\r\n                        return;\r\n                    }\r\n                    zonesHaveChanged = _this._removeZone(whitespaceAccessor, id) || zonesHaveChanged;\r\n                },\r\n                layoutZone: function (id) {\r\n                    if (!id) {\r\n                        return;\r\n                    }\r\n                    zonesHaveChanged = _this._layoutZone(whitespaceAccessor, id) || zonesHaveChanged;\r\n                }\r\n            };\r\n            safeInvoke1Arg(callback, changeAccessor);\r\n            // Invalidate changeAccessor\r\n            changeAccessor.addZone = invalidFunc;\r\n            changeAccessor.removeZone = invalidFunc;\r\n            changeAccessor.layoutZone = invalidFunc;\r\n            return zonesHaveChanged;\r\n        });\r\n    };\r\n    ViewZones.prototype._addZone = function (whitespaceAccessor, zone) {\r\n        var props = this._computeWhitespaceProps(zone);\r\n        var whitespaceId = whitespaceAccessor.insertWhitespace(props.afterViewLineNumber, this._getZoneOrdinal(zone), props.heightInPx, props.minWidthInPx);\r\n        var myZone = {\r\n            whitespaceId: whitespaceId,\r\n            delegate: zone,\r\n            isVisible: false,\r\n            domNode: createFastDomNode(zone.domNode),\r\n            marginDomNode: zone.marginDomNode ? createFastDomNode(zone.marginDomNode) : null\r\n        };\r\n        this._safeCallOnComputedHeight(myZone.delegate, props.heightInPx);\r\n        myZone.domNode.setPosition('absolute');\r\n        myZone.domNode.domNode.style.width = '100%';\r\n        myZone.domNode.setDisplay('none');\r\n        myZone.domNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\r\n        this.domNode.appendChild(myZone.domNode);\r\n        if (myZone.marginDomNode) {\r\n            myZone.marginDomNode.setPosition('absolute');\r\n            myZone.marginDomNode.domNode.style.width = '100%';\r\n            myZone.marginDomNode.setDisplay('none');\r\n            myZone.marginDomNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\r\n            this.marginDomNode.appendChild(myZone.marginDomNode);\r\n        }\r\n        this._zones[myZone.whitespaceId] = myZone;\r\n        this.setShouldRender();\r\n        return myZone.whitespaceId;\r\n    };\r\n    ViewZones.prototype._removeZone = function (whitespaceAccessor, id) {\r\n        if (this._zones.hasOwnProperty(id)) {\r\n            var zone = this._zones[id];\r\n            delete this._zones[id];\r\n            whitespaceAccessor.removeWhitespace(zone.whitespaceId);\r\n            zone.domNode.removeAttribute('monaco-visible-view-zone');\r\n            zone.domNode.removeAttribute('monaco-view-zone');\r\n            zone.domNode.domNode.parentNode.removeChild(zone.domNode.domNode);\r\n            if (zone.marginDomNode) {\r\n                zone.marginDomNode.removeAttribute('monaco-visible-view-zone');\r\n                zone.marginDomNode.removeAttribute('monaco-view-zone');\r\n                zone.marginDomNode.domNode.parentNode.removeChild(zone.marginDomNode.domNode);\r\n            }\r\n            this.setShouldRender();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewZones.prototype._layoutZone = function (whitespaceAccessor, id) {\r\n        if (this._zones.hasOwnProperty(id)) {\r\n            var zone = this._zones[id];\r\n            var props = this._computeWhitespaceProps(zone.delegate);\r\n            // const newOrdinal = this._getZoneOrdinal(zone.delegate);\r\n            whitespaceAccessor.changeOneWhitespace(zone.whitespaceId, props.afterViewLineNumber, props.heightInPx);\r\n            // TODO@Alex: change `newOrdinal` too\r\n            this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\r\n            this.setShouldRender();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewZones.prototype.shouldSuppressMouseDownOnViewZone = function (id) {\r\n        if (this._zones.hasOwnProperty(id)) {\r\n            var zone = this._zones[id];\r\n            return Boolean(zone.delegate.suppressMouseDown);\r\n        }\r\n        return false;\r\n    };\r\n    ViewZones.prototype._heightInPixels = function (zone) {\r\n        if (typeof zone.heightInPx === 'number') {\r\n            return zone.heightInPx;\r\n        }\r\n        if (typeof zone.heightInLines === 'number') {\r\n            return this._lineHeight * zone.heightInLines;\r\n        }\r\n        return this._lineHeight;\r\n    };\r\n    ViewZones.prototype._minWidthInPixels = function (zone) {\r\n        if (typeof zone.minWidthInPx === 'number') {\r\n            return zone.minWidthInPx;\r\n        }\r\n        return 0;\r\n    };\r\n    ViewZones.prototype._safeCallOnComputedHeight = function (zone, height) {\r\n        if (typeof zone.onComputedHeight === 'function') {\r\n            try {\r\n                zone.onComputedHeight(height);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n        }\r\n    };\r\n    ViewZones.prototype._safeCallOnDomNodeTop = function (zone, top) {\r\n        if (typeof zone.onDomNodeTop === 'function') {\r\n            try {\r\n                zone.onDomNodeTop(top);\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n            }\r\n        }\r\n    };\r\n    ViewZones.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ViewZones.prototype.render = function (ctx) {\r\n        var visibleWhitespaces = ctx.viewportData.whitespaceViewportData;\r\n        var visibleZones = {};\r\n        var hasVisibleZone = false;\r\n        for (var i = 0, len = visibleWhitespaces.length; i < len; i++) {\r\n            visibleZones[visibleWhitespaces[i].id] = visibleWhitespaces[i];\r\n            hasVisibleZone = true;\r\n        }\r\n        var keys = Object.keys(this._zones);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var id = keys[i];\r\n            var zone = this._zones[id];\r\n            var newTop = 0;\r\n            var newHeight = 0;\r\n            var newDisplay = 'none';\r\n            if (visibleZones.hasOwnProperty(id)) {\r\n                newTop = visibleZones[id].verticalOffset - ctx.bigNumbersDelta;\r\n                newHeight = visibleZones[id].height;\r\n                newDisplay = 'block';\r\n                // zone is visible\r\n                if (!zone.isVisible) {\r\n                    zone.domNode.setAttribute('monaco-visible-view-zone', 'true');\r\n                    zone.isVisible = true;\r\n                }\r\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(visibleZones[id].verticalOffset));\r\n            }\r\n            else {\r\n                if (zone.isVisible) {\r\n                    zone.domNode.removeAttribute('monaco-visible-view-zone');\r\n                    zone.isVisible = false;\r\n                }\r\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(-1000000));\r\n            }\r\n            zone.domNode.setTop(newTop);\r\n            zone.domNode.setHeight(newHeight);\r\n            zone.domNode.setDisplay(newDisplay);\r\n            if (zone.marginDomNode) {\r\n                zone.marginDomNode.setTop(newTop);\r\n                zone.marginDomNode.setHeight(newHeight);\r\n                zone.marginDomNode.setDisplay(newDisplay);\r\n            }\r\n        }\r\n        if (hasVisibleZone) {\r\n            this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\r\n            this.marginDomNode.setWidth(this._contentLeft);\r\n        }\r\n    };\r\n    return ViewZones;\r\n}(ViewPart));\r\nexport { ViewZones };\r\nfunction safeInvoke1Arg(func, arg1) {\r\n    try {\r\n        return func(arg1);\r\n    }\r\n    catch (e) {\r\n        onUnexpectedError(e);\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './scrollDecoration.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { scrollbarShadow } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar ScrollDecorationViewPart = /** @class */ (function (_super) {\r\n    __extends(ScrollDecorationViewPart, _super);\r\n    function ScrollDecorationViewPart(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._scrollTop = 0;\r\n        _this._width = 0;\r\n        _this._updateWidth();\r\n        _this._shouldShow = false;\r\n        var options = _this._context.configuration.options;\r\n        var scrollbar = options.get(78 /* scrollbar */);\r\n        _this._useShadows = scrollbar.useShadows;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        return _this;\r\n    }\r\n    ScrollDecorationViewPart.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ScrollDecorationViewPart.prototype._updateShouldShow = function () {\r\n        var newShouldShow = (this._useShadows && this._scrollTop > 0);\r\n        if (this._shouldShow !== newShouldShow) {\r\n            this._shouldShow = newShouldShow;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ScrollDecorationViewPart.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ScrollDecorationViewPart.prototype._updateWidth = function () {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        if (layoutInfo.renderMinimap === 0 || (layoutInfo.minimapWidth > 0 && layoutInfo.minimapLeft === 0)) {\r\n            this._width = layoutInfo.width;\r\n        }\r\n        else {\r\n            this._width = layoutInfo.width - layoutInfo.minimapWidth - layoutInfo.verticalScrollbarWidth;\r\n        }\r\n    };\r\n    // --- begin event handlers\r\n    ScrollDecorationViewPart.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var scrollbar = options.get(78 /* scrollbar */);\r\n        this._useShadows = scrollbar.useShadows;\r\n        this._updateWidth();\r\n        this._updateShouldShow();\r\n        return true;\r\n    };\r\n    ScrollDecorationViewPart.prototype.onScrollChanged = function (e) {\r\n        this._scrollTop = e.scrollTop;\r\n        return this._updateShouldShow();\r\n    };\r\n    // --- end event handlers\r\n    ScrollDecorationViewPart.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ScrollDecorationViewPart.prototype.render = function (ctx) {\r\n        this._domNode.setWidth(this._width);\r\n        this._domNode.setClassName(this._shouldShow ? 'scroll-decoration' : '');\r\n    };\r\n    return ScrollDecorationViewPart;\r\n}(ViewPart));\r\nexport { ScrollDecorationViewPart };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-editor .scroll-decoration { box-shadow: \" + shadow + \" 0 6px 6px -6px inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { Configuration } from '../../config/configuration.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nvar ViewCursorRenderData = /** @class */ (function () {\r\n    function ViewCursorRenderData(top, left, width, height, textContent, textContentClassName) {\r\n        this.top = top;\r\n        this.left = left;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.textContent = textContent;\r\n        this.textContentClassName = textContentClassName;\r\n    }\r\n    return ViewCursorRenderData;\r\n}());\r\nvar ViewCursor = /** @class */ (function () {\r\n    function ViewCursor(context) {\r\n        this._context = context;\r\n        var options = this._context.configuration.options;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        this._lineCursorWidth = Math.min(options.get(21 /* cursorWidth */), this._typicalHalfwidthCharacterWidth);\r\n        this._isVisible = true;\r\n        // Create the dom node\r\n        this._domNode = createFastDomNode(document.createElement('div'));\r\n        this._domNode.setClassName('cursor');\r\n        this._domNode.setHeight(this._lineHeight);\r\n        this._domNode.setTop(0);\r\n        this._domNode.setLeft(0);\r\n        Configuration.applyFontInfo(this._domNode, fontInfo);\r\n        this._domNode.setDisplay('none');\r\n        this._position = new Position(1, 1);\r\n        this._lastRenderedContent = '';\r\n        this._renderData = null;\r\n    }\r\n    ViewCursor.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    ViewCursor.prototype.getPosition = function () {\r\n        return this._position;\r\n    };\r\n    ViewCursor.prototype.show = function () {\r\n        if (!this._isVisible) {\r\n            this._domNode.setVisibility('inherit');\r\n            this._isVisible = true;\r\n        }\r\n    };\r\n    ViewCursor.prototype.hide = function () {\r\n        if (this._isVisible) {\r\n            this._domNode.setVisibility('hidden');\r\n            this._isVisible = false;\r\n        }\r\n    };\r\n    ViewCursor.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        this._lineCursorWidth = Math.min(options.get(21 /* cursorWidth */), this._typicalHalfwidthCharacterWidth);\r\n        Configuration.applyFontInfo(this._domNode, fontInfo);\r\n        return true;\r\n    };\r\n    ViewCursor.prototype.onCursorPositionChanged = function (position) {\r\n        this._position = position;\r\n        return true;\r\n    };\r\n    ViewCursor.prototype._prepareRender = function (ctx) {\r\n        var textContent = '';\r\n        if (this._cursorStyle === TextEditorCursorStyle.Line || this._cursorStyle === TextEditorCursorStyle.LineThin) {\r\n            var visibleRange = ctx.visibleRangeForPosition(this._position);\r\n            if (!visibleRange || visibleRange.outsideRenderedLine) {\r\n                // Outside viewport\r\n                return null;\r\n            }\r\n            var width_1;\r\n            if (this._cursorStyle === TextEditorCursorStyle.Line) {\r\n                width_1 = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\r\n                if (width_1 > 2) {\r\n                    var lineContent_1 = this._context.model.getLineContent(this._position.lineNumber);\r\n                    var nextCharLength_1 = strings.nextCharLength(lineContent_1, this._position.column - 1);\r\n                    textContent = lineContent_1.substr(this._position.column - 1, nextCharLength_1);\r\n                }\r\n            }\r\n            else {\r\n                width_1 = dom.computeScreenAwareSize(1);\r\n            }\r\n            var left = visibleRange.left;\r\n            if (width_1 >= 2 && left >= 1) {\r\n                // try to center cursor\r\n                left -= 1;\r\n            }\r\n            var top_1 = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\r\n            return new ViewCursorRenderData(top_1, left, width_1, this._lineHeight, textContent, '');\r\n        }\r\n        var lineContent = this._context.model.getLineContent(this._position.lineNumber);\r\n        var nextCharLength = strings.nextCharLength(lineContent, this._position.column - 1);\r\n        var visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new Range(this._position.lineNumber, this._position.column, this._position.lineNumber, this._position.column + nextCharLength), false);\r\n        if (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0) {\r\n            // Outside viewport\r\n            return null;\r\n        }\r\n        var firstVisibleRangeForCharacter = visibleRangeForCharacter[0];\r\n        if (firstVisibleRangeForCharacter.outsideRenderedLine || firstVisibleRangeForCharacter.ranges.length === 0) {\r\n            // Outside viewport\r\n            return null;\r\n        }\r\n        var range = firstVisibleRangeForCharacter.ranges[0];\r\n        var width = range.width < 1 ? this._typicalHalfwidthCharacterWidth : range.width;\r\n        var textContentClassName = '';\r\n        if (this._cursorStyle === TextEditorCursorStyle.Block) {\r\n            var lineData = this._context.model.getViewLineData(this._position.lineNumber);\r\n            textContent = lineContent.substr(this._position.column - 1, nextCharLength);\r\n            var tokenIndex = lineData.tokens.findTokenIndexAtOffset(this._position.column - 1);\r\n            textContentClassName = lineData.tokens.getClassName(tokenIndex);\r\n        }\r\n        var top = ctx.getVerticalOffsetForLineNumber(this._position.lineNumber) - ctx.bigNumbersDelta;\r\n        var height = this._lineHeight;\r\n        // Underline might interfere with clicking\r\n        if (this._cursorStyle === TextEditorCursorStyle.Underline || this._cursorStyle === TextEditorCursorStyle.UnderlineThin) {\r\n            top += this._lineHeight - 2;\r\n            height = 2;\r\n        }\r\n        return new ViewCursorRenderData(top, range.left, width, height, textContent, textContentClassName);\r\n    };\r\n    ViewCursor.prototype.prepareRender = function (ctx) {\r\n        this._renderData = this._prepareRender(ctx);\r\n    };\r\n    ViewCursor.prototype.render = function (ctx) {\r\n        if (!this._renderData) {\r\n            this._domNode.setDisplay('none');\r\n            return null;\r\n        }\r\n        if (this._lastRenderedContent !== this._renderData.textContent) {\r\n            this._lastRenderedContent = this._renderData.textContent;\r\n            this._domNode.domNode.textContent = this._lastRenderedContent;\r\n        }\r\n        this._domNode.setClassName('cursor ' + this._renderData.textContentClassName);\r\n        this._domNode.setDisplay('block');\r\n        this._domNode.setTop(this._renderData.top);\r\n        this._domNode.setLeft(this._renderData.left);\r\n        this._domNode.setWidth(this._renderData.width);\r\n        this._domNode.setLineHeight(this._renderData.height);\r\n        this._domNode.setHeight(this._renderData.height);\r\n        return {\r\n            domNode: this._domNode.domNode,\r\n            position: this._position,\r\n            contentLeft: this._renderData.left,\r\n            height: this._renderData.height,\r\n            width: 2\r\n        };\r\n    };\r\n    return ViewCursor;\r\n}());\r\nexport { ViewCursor };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './viewCursors.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { ViewCursor } from './viewCursor.js';\r\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\r\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar ViewCursors = /** @class */ (function (_super) {\r\n    __extends(ViewCursors, _super);\r\n    function ViewCursors(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        _this._readOnly = options.get(68 /* readOnly */);\r\n        _this._cursorBlinking = options.get(16 /* cursorBlinking */);\r\n        _this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        _this._cursorSmoothCaretAnimation = options.get(17 /* cursorSmoothCaretAnimation */);\r\n        _this._selectionIsEmpty = true;\r\n        _this._isVisible = false;\r\n        _this._primaryCursor = new ViewCursor(_this._context);\r\n        _this._secondaryCursors = [];\r\n        _this._renderData = [];\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._updateDomClassName();\r\n        _this._domNode.appendChild(_this._primaryCursor.getDomNode());\r\n        _this._startCursorBlinkAnimation = new TimeoutTimer();\r\n        _this._cursorFlatBlinkInterval = new IntervalTimer();\r\n        _this._blinkingEnabled = false;\r\n        _this._editorHasFocus = false;\r\n        _this._updateBlinking();\r\n        return _this;\r\n    }\r\n    ViewCursors.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._startCursorBlinkAnimation.dispose();\r\n        this._cursorFlatBlinkInterval.dispose();\r\n    };\r\n    ViewCursors.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // --- begin event handlers\r\n    ViewCursors.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._readOnly = options.get(68 /* readOnly */);\r\n        this._cursorBlinking = options.get(16 /* cursorBlinking */);\r\n        this._cursorStyle = options.get(18 /* cursorStyle */);\r\n        this._cursorSmoothCaretAnimation = options.get(17 /* cursorSmoothCaretAnimation */);\r\n        this._updateBlinking();\r\n        this._updateDomClassName();\r\n        this._primaryCursor.onConfigurationChanged(e);\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype._onCursorPositionChanged = function (position, secondaryPositions) {\r\n        this._primaryCursor.onCursorPositionChanged(position);\r\n        this._updateBlinking();\r\n        if (this._secondaryCursors.length < secondaryPositions.length) {\r\n            // Create new cursors\r\n            var addCnt = secondaryPositions.length - this._secondaryCursors.length;\r\n            for (var i = 0; i < addCnt; i++) {\r\n                var newCursor = new ViewCursor(this._context);\r\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\r\n                this._secondaryCursors.push(newCursor);\r\n            }\r\n        }\r\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\r\n            // Remove some cursors\r\n            var removeCnt = this._secondaryCursors.length - secondaryPositions.length;\r\n            for (var i = 0; i < removeCnt; i++) {\r\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\r\n                this._secondaryCursors.splice(0, 1);\r\n            }\r\n        }\r\n        for (var i = 0; i < secondaryPositions.length; i++) {\r\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\r\n        }\r\n    };\r\n    ViewCursors.prototype.onCursorStateChanged = function (e) {\r\n        var positions = [];\r\n        for (var i = 0, len = e.selections.length; i < len; i++) {\r\n            positions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._onCursorPositionChanged(positions[0], positions.slice(1));\r\n        var selectionIsEmpty = e.selections[0].isEmpty();\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            this._updateDomClassName();\r\n        }\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onFocusChanged = function (e) {\r\n        this._editorHasFocus = e.isFocused;\r\n        this._updateBlinking();\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewCursors.prototype.onTokensChanged = function (e) {\r\n        var shouldRender = function (position) {\r\n            for (var i = 0, len = e.ranges.length; i < len; i++) {\r\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        if (shouldRender(this._primaryCursor.getPosition())) {\r\n            return true;\r\n        }\r\n        for (var _i = 0, _a = this._secondaryCursors; _i < _a.length; _i++) {\r\n            var secondaryCursor = _a[_i];\r\n            if (shouldRender(secondaryCursor.getPosition())) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    ViewCursors.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    // ---- blinking logic\r\n    ViewCursors.prototype._getCursorBlinking = function () {\r\n        if (!this._editorHasFocus) {\r\n            return 0 /* Hidden */;\r\n        }\r\n        if (this._readOnly) {\r\n            return 5 /* Solid */;\r\n        }\r\n        return this._cursorBlinking;\r\n    };\r\n    ViewCursors.prototype._updateBlinking = function () {\r\n        var _this = this;\r\n        this._startCursorBlinkAnimation.cancel();\r\n        this._cursorFlatBlinkInterval.cancel();\r\n        var blinkingStyle = this._getCursorBlinking();\r\n        // hidden and solid are special as they involve no animations\r\n        var isHidden = (blinkingStyle === 0 /* Hidden */);\r\n        var isSolid = (blinkingStyle === 5 /* Solid */);\r\n        if (isHidden) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n        this._blinkingEnabled = false;\r\n        this._updateDomClassName();\r\n        if (!isHidden && !isSolid) {\r\n            if (blinkingStyle === 1 /* Blink */) {\r\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\r\n                this._cursorFlatBlinkInterval.cancelAndSet(function () {\r\n                    if (_this._isVisible) {\r\n                        _this._hide();\r\n                    }\r\n                    else {\r\n                        _this._show();\r\n                    }\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n            else {\r\n                this._startCursorBlinkAnimation.setIfNotSet(function () {\r\n                    _this._blinkingEnabled = true;\r\n                    _this._updateDomClassName();\r\n                }, ViewCursors.BLINK_INTERVAL);\r\n            }\r\n        }\r\n    };\r\n    // --- end blinking logic\r\n    ViewCursors.prototype._updateDomClassName = function () {\r\n        this._domNode.setClassName(this._getClassName());\r\n    };\r\n    ViewCursors.prototype._getClassName = function () {\r\n        var result = 'cursors-layer';\r\n        if (!this._selectionIsEmpty) {\r\n            result += ' has-selection';\r\n        }\r\n        switch (this._cursorStyle) {\r\n            case TextEditorCursorStyle.Line:\r\n                result += ' cursor-line-style';\r\n                break;\r\n            case TextEditorCursorStyle.Block:\r\n                result += ' cursor-block-style';\r\n                break;\r\n            case TextEditorCursorStyle.Underline:\r\n                result += ' cursor-underline-style';\r\n                break;\r\n            case TextEditorCursorStyle.LineThin:\r\n                result += ' cursor-line-thin-style';\r\n                break;\r\n            case TextEditorCursorStyle.BlockOutline:\r\n                result += ' cursor-block-outline-style';\r\n                break;\r\n            case TextEditorCursorStyle.UnderlineThin:\r\n                result += ' cursor-underline-thin-style';\r\n                break;\r\n            default:\r\n                result += ' cursor-line-style';\r\n        }\r\n        if (this._blinkingEnabled) {\r\n            switch (this._getCursorBlinking()) {\r\n                case 1 /* Blink */:\r\n                    result += ' cursor-blink';\r\n                    break;\r\n                case 2 /* Smooth */:\r\n                    result += ' cursor-smooth';\r\n                    break;\r\n                case 3 /* Phase */:\r\n                    result += ' cursor-phase';\r\n                    break;\r\n                case 4 /* Expand */:\r\n                    result += ' cursor-expand';\r\n                    break;\r\n                case 5 /* Solid */:\r\n                    result += ' cursor-solid';\r\n                    break;\r\n                default:\r\n                    result += ' cursor-solid';\r\n            }\r\n        }\r\n        else {\r\n            result += ' cursor-solid';\r\n        }\r\n        if (this._cursorSmoothCaretAnimation) {\r\n            result += ' cursor-smooth-caret-animation';\r\n        }\r\n        return result;\r\n    };\r\n    ViewCursors.prototype._show = function () {\r\n        this._primaryCursor.show();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].show();\r\n        }\r\n        this._isVisible = true;\r\n    };\r\n    ViewCursors.prototype._hide = function () {\r\n        this._primaryCursor.hide();\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].hide();\r\n        }\r\n        this._isVisible = false;\r\n    };\r\n    // ---- IViewPart implementation\r\n    ViewCursors.prototype.prepareRender = function (ctx) {\r\n        this._primaryCursor.prepareRender(ctx);\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            this._secondaryCursors[i].prepareRender(ctx);\r\n        }\r\n    };\r\n    ViewCursors.prototype.render = function (ctx) {\r\n        var renderData = [], renderDataLen = 0;\r\n        var primaryRenderData = this._primaryCursor.render(ctx);\r\n        if (primaryRenderData) {\r\n            renderData[renderDataLen++] = primaryRenderData;\r\n        }\r\n        for (var i = 0, len = this._secondaryCursors.length; i < len; i++) {\r\n            var secondaryRenderData = this._secondaryCursors[i].render(ctx);\r\n            if (secondaryRenderData) {\r\n                renderData[renderDataLen++] = secondaryRenderData;\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    };\r\n    ViewCursors.prototype.getLastRenderData = function () {\r\n        return this._renderData;\r\n    };\r\n    ViewCursors.BLINK_INTERVAL = 500;\r\n    return ViewCursors;\r\n}(ViewPart));\r\nexport { ViewCursors };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var caret = theme.getColor(editorCursorForeground);\r\n    if (caret) {\r\n        var caretBackground = theme.getColor(editorCursorBackground);\r\n        if (!caretBackground) {\r\n            caretBackground = caret.opposite();\r\n        }\r\n        collector.addRule(\".monaco-editor .cursor { background-color: \" + caret + \"; border-color: \" + caret + \"; color: \" + caretBackground + \"; }\");\r\n        if (theme.type === 'hc') {\r\n            collector.addRule(\".monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid \" + caretBackground + \"; border-right: 1px solid \" + caretBackground + \"; }\");\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './selections.css';\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorInactiveSelection, editorSelectionBackground, editorSelectionForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar HorizontalRangeWithStyle = /** @class */ (function () {\r\n    function HorizontalRangeWithStyle(other) {\r\n        this.left = other.left;\r\n        this.width = other.width;\r\n        this.startStyle = null;\r\n        this.endStyle = null;\r\n    }\r\n    return HorizontalRangeWithStyle;\r\n}());\r\nvar LineVisibleRangesWithStyle = /** @class */ (function () {\r\n    function LineVisibleRangesWithStyle(lineNumber, ranges) {\r\n        this.lineNumber = lineNumber;\r\n        this.ranges = ranges;\r\n    }\r\n    return LineVisibleRangesWithStyle;\r\n}());\r\nfunction toStyledRange(item) {\r\n    return new HorizontalRangeWithStyle(item);\r\n}\r\nfunction toStyled(item) {\r\n    return new LineVisibleRangesWithStyle(item.lineNumber, item.ranges.map(toStyledRange));\r\n}\r\n// TODO@Alex: Remove this once IE11 fixes Bug #524217\r\n// The problem in IE11 is that it does some sort of auto-zooming to accomodate for displays with different pixel density.\r\n// Unfortunately, this auto-zooming is buggy around dealing with rounded borders\r\nvar isIEWithZoomingIssuesNearRoundedBorders = browser.isEdgeOrIE;\r\nvar SelectionsOverlay = /** @class */ (function (_super) {\r\n    __extends(SelectionsOverlay, _super);\r\n    function SelectionsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._previousFrameVisibleRangesWithStyle = [];\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._roundedSelection = options.get(76 /* roundedSelection */);\r\n        _this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        _this._selections = [];\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    SelectionsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    SelectionsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._roundedSelection = options.get(76 /* roundedSelection */);\r\n        this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections.slice(0);\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true; //e.inlineDecorationsChanged;\r\n    };\r\n    SelectionsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    SelectionsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    SelectionsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    SelectionsOverlay.prototype._visibleRangesHaveGaps = function (linesVisibleRanges) {\r\n        for (var i = 0, len = linesVisibleRanges.length; i < len; i++) {\r\n            var lineVisibleRanges = linesVisibleRanges[i];\r\n            if (lineVisibleRanges.ranges.length > 1) {\r\n                // There are two ranges on the same line\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    SelectionsOverlay.prototype._enrichVisibleRangesWithStyle = function (viewport, linesVisibleRanges, previousFrame) {\r\n        var epsilon = this._typicalHalfwidthCharacterWidth / 4;\r\n        var previousFrameTop = null;\r\n        var previousFrameBottom = null;\r\n        if (previousFrame && previousFrame.length > 0 && linesVisibleRanges.length > 0) {\r\n            var topLineNumber = linesVisibleRanges[0].lineNumber;\r\n            if (topLineNumber === viewport.startLineNumber) {\r\n                for (var i = 0; !previousFrameTop && i < previousFrame.length; i++) {\r\n                    if (previousFrame[i].lineNumber === topLineNumber) {\r\n                        previousFrameTop = previousFrame[i].ranges[0];\r\n                    }\r\n                }\r\n            }\r\n            var bottomLineNumber = linesVisibleRanges[linesVisibleRanges.length - 1].lineNumber;\r\n            if (bottomLineNumber === viewport.endLineNumber) {\r\n                for (var i = previousFrame.length - 1; !previousFrameBottom && i >= 0; i--) {\r\n                    if (previousFrame[i].lineNumber === bottomLineNumber) {\r\n                        previousFrameBottom = previousFrame[i].ranges[0];\r\n                    }\r\n                }\r\n            }\r\n            if (previousFrameTop && !previousFrameTop.startStyle) {\r\n                previousFrameTop = null;\r\n            }\r\n            if (previousFrameBottom && !previousFrameBottom.startStyle) {\r\n                previousFrameBottom = null;\r\n            }\r\n        }\r\n        for (var i = 0, len = linesVisibleRanges.length; i < len; i++) {\r\n            // We know for a fact that there is precisely one range on each line\r\n            var curLineRange = linesVisibleRanges[i].ranges[0];\r\n            var curLeft = curLineRange.left;\r\n            var curRight = curLineRange.left + curLineRange.width;\r\n            var startStyle = {\r\n                top: 0 /* EXTERN */,\r\n                bottom: 0 /* EXTERN */\r\n            };\r\n            var endStyle = {\r\n                top: 0 /* EXTERN */,\r\n                bottom: 0 /* EXTERN */\r\n            };\r\n            if (i > 0) {\r\n                // Look above\r\n                var prevLeft = linesVisibleRanges[i - 1].ranges[0].left;\r\n                var prevRight = linesVisibleRanges[i - 1].ranges[0].left + linesVisibleRanges[i - 1].ranges[0].width;\r\n                if (abs(curLeft - prevLeft) < epsilon) {\r\n                    startStyle.top = 2 /* FLAT */;\r\n                }\r\n                else if (curLeft > prevLeft) {\r\n                    startStyle.top = 1 /* INTERN */;\r\n                }\r\n                if (abs(curRight - prevRight) < epsilon) {\r\n                    endStyle.top = 2 /* FLAT */;\r\n                }\r\n                else if (prevLeft < curRight && curRight < prevRight) {\r\n                    endStyle.top = 1 /* INTERN */;\r\n                }\r\n            }\r\n            else if (previousFrameTop) {\r\n                // Accept some hick-ups near the viewport edges to save on repaints\r\n                startStyle.top = previousFrameTop.startStyle.top;\r\n                endStyle.top = previousFrameTop.endStyle.top;\r\n            }\r\n            if (i + 1 < len) {\r\n                // Look below\r\n                var nextLeft = linesVisibleRanges[i + 1].ranges[0].left;\r\n                var nextRight = linesVisibleRanges[i + 1].ranges[0].left + linesVisibleRanges[i + 1].ranges[0].width;\r\n                if (abs(curLeft - nextLeft) < epsilon) {\r\n                    startStyle.bottom = 2 /* FLAT */;\r\n                }\r\n                else if (nextLeft < curLeft && curLeft < nextRight) {\r\n                    startStyle.bottom = 1 /* INTERN */;\r\n                }\r\n                if (abs(curRight - nextRight) < epsilon) {\r\n                    endStyle.bottom = 2 /* FLAT */;\r\n                }\r\n                else if (curRight < nextRight) {\r\n                    endStyle.bottom = 1 /* INTERN */;\r\n                }\r\n            }\r\n            else if (previousFrameBottom) {\r\n                // Accept some hick-ups near the viewport edges to save on repaints\r\n                startStyle.bottom = previousFrameBottom.startStyle.bottom;\r\n                endStyle.bottom = previousFrameBottom.endStyle.bottom;\r\n            }\r\n            curLineRange.startStyle = startStyle;\r\n            curLineRange.endStyle = endStyle;\r\n        }\r\n    };\r\n    SelectionsOverlay.prototype._getVisibleRangesWithStyle = function (selection, ctx, previousFrame) {\r\n        var _linesVisibleRanges = ctx.linesVisibleRangesForRange(selection, true) || [];\r\n        var linesVisibleRanges = _linesVisibleRanges.map(toStyled);\r\n        var visibleRangesHaveGaps = this._visibleRangesHaveGaps(linesVisibleRanges);\r\n        if (!isIEWithZoomingIssuesNearRoundedBorders && !visibleRangesHaveGaps && this._roundedSelection) {\r\n            this._enrichVisibleRangesWithStyle(ctx.visibleRange, linesVisibleRanges, previousFrame);\r\n        }\r\n        // The visible ranges are sorted TOP-BOTTOM and LEFT-RIGHT\r\n        return linesVisibleRanges;\r\n    };\r\n    SelectionsOverlay.prototype._createSelectionPiece = function (top, height, className, left, width) {\r\n        return ('<div class=\"cslr '\r\n            + className\r\n            + '\" style=\"top:'\r\n            + top.toString()\r\n            + 'px;left:'\r\n            + left.toString()\r\n            + 'px;width:'\r\n            + width.toString()\r\n            + 'px;height:'\r\n            + height\r\n            + 'px;\"></div>');\r\n    };\r\n    SelectionsOverlay.prototype._actualRenderOneSelection = function (output2, visibleStartLineNumber, hasMultipleSelections, visibleRanges) {\r\n        if (visibleRanges.length === 0) {\r\n            return;\r\n        }\r\n        var visibleRangesHaveStyle = !!visibleRanges[0].ranges[0].startStyle;\r\n        var fullLineHeight = (this._lineHeight).toString();\r\n        var reducedLineHeight = (this._lineHeight - 1).toString();\r\n        var firstLineNumber = visibleRanges[0].lineNumber;\r\n        var lastLineNumber = visibleRanges[visibleRanges.length - 1].lineNumber;\r\n        for (var i = 0, len = visibleRanges.length; i < len; i++) {\r\n            var lineVisibleRanges = visibleRanges[i];\r\n            var lineNumber = lineVisibleRanges.lineNumber;\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var lineHeight = hasMultipleSelections ? (lineNumber === lastLineNumber || lineNumber === firstLineNumber ? reducedLineHeight : fullLineHeight) : fullLineHeight;\r\n            var top_1 = hasMultipleSelections ? (lineNumber === firstLineNumber ? 1 : 0) : 0;\r\n            var innerCornerOutput = '';\r\n            var restOfSelectionOutput = '';\r\n            for (var j = 0, lenJ = lineVisibleRanges.ranges.length; j < lenJ; j++) {\r\n                var visibleRange = lineVisibleRanges.ranges[j];\r\n                if (visibleRangesHaveStyle) {\r\n                    var startStyle = visibleRange.startStyle;\r\n                    var endStyle = visibleRange.endStyle;\r\n                    if (startStyle.top === 1 /* INTERN */ || startStyle.bottom === 1 /* INTERN */) {\r\n                        // Reverse rounded corner to the left\r\n                        // First comes the selection (blue layer)\r\n                        innerCornerOutput += this._createSelectionPiece(top_1, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                        // Second comes the background (white layer) with inverse border radius\r\n                        var className_1 = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\r\n                        if (startStyle.top === 1 /* INTERN */) {\r\n                            className_1 += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\r\n                        }\r\n                        if (startStyle.bottom === 1 /* INTERN */) {\r\n                            className_1 += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\r\n                        }\r\n                        innerCornerOutput += this._createSelectionPiece(top_1, lineHeight, className_1, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                    }\r\n                    if (endStyle.top === 1 /* INTERN */ || endStyle.bottom === 1 /* INTERN */) {\r\n                        // Reverse rounded corner to the right\r\n                        // First comes the selection (blue layer)\r\n                        innerCornerOutput += this._createSelectionPiece(top_1, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                        // Second comes the background (white layer) with inverse border radius\r\n                        var className_2 = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\r\n                        if (endStyle.top === 1 /* INTERN */) {\r\n                            className_2 += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\r\n                        }\r\n                        if (endStyle.bottom === 1 /* INTERN */) {\r\n                            className_2 += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\r\n                        }\r\n                        innerCornerOutput += this._createSelectionPiece(top_1, lineHeight, className_2, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\r\n                    }\r\n                }\r\n                var className = SelectionsOverlay.SELECTION_CLASS_NAME;\r\n                if (visibleRangesHaveStyle) {\r\n                    var startStyle = visibleRange.startStyle;\r\n                    var endStyle = visibleRange.endStyle;\r\n                    if (startStyle.top === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\r\n                    }\r\n                    if (startStyle.bottom === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\r\n                    }\r\n                    if (endStyle.top === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\r\n                    }\r\n                    if (endStyle.bottom === 0 /* EXTERN */) {\r\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\r\n                    }\r\n                }\r\n                restOfSelectionOutput += this._createSelectionPiece(top_1, lineHeight, className, visibleRange.left, visibleRange.width);\r\n            }\r\n            output2[lineIndex][0] += innerCornerOutput;\r\n            output2[lineIndex][1] += restOfSelectionOutput;\r\n        }\r\n    };\r\n    SelectionsOverlay.prototype.prepareRender = function (ctx) {\r\n        // Build HTML for inner corners separate from HTML for the rest of selections,\r\n        // as the inner corner HTML can interfere with that of other selections.\r\n        // In final render, make sure to place the inner corner HTML before the rest of selection HTML. See issue #77777.\r\n        var output = [];\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = ['', ''];\r\n        }\r\n        var thisFrameVisibleRangesWithStyle = [];\r\n        for (var i = 0, len = this._selections.length; i < len; i++) {\r\n            var selection = this._selections[i];\r\n            if (selection.isEmpty()) {\r\n                thisFrameVisibleRangesWithStyle[i] = null;\r\n                continue;\r\n            }\r\n            var visibleRangesWithStyle = this._getVisibleRangesWithStyle(selection, ctx, this._previousFrameVisibleRangesWithStyle[i]);\r\n            thisFrameVisibleRangesWithStyle[i] = visibleRangesWithStyle;\r\n            this._actualRenderOneSelection(output, visibleStartLineNumber, this._selections.length > 1, visibleRangesWithStyle);\r\n        }\r\n        this._previousFrameVisibleRangesWithStyle = thisFrameVisibleRangesWithStyle;\r\n        this._renderResult = output.map(function (_a) {\r\n            var internalCorners = _a[0], restOfSelection = _a[1];\r\n            return internalCorners + restOfSelection;\r\n        });\r\n    };\r\n    SelectionsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    SelectionsOverlay.SELECTION_CLASS_NAME = 'selected-text';\r\n    SelectionsOverlay.SELECTION_TOP_LEFT = 'top-left-radius';\r\n    SelectionsOverlay.SELECTION_BOTTOM_LEFT = 'bottom-left-radius';\r\n    SelectionsOverlay.SELECTION_TOP_RIGHT = 'top-right-radius';\r\n    SelectionsOverlay.SELECTION_BOTTOM_RIGHT = 'bottom-right-radius';\r\n    SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME = 'monaco-editor-background';\r\n    SelectionsOverlay.ROUNDED_PIECE_WIDTH = 10;\r\n    return SelectionsOverlay;\r\n}(DynamicViewOverlay));\r\nexport { SelectionsOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorSelectionColor = theme.getColor(editorSelectionBackground);\r\n    if (editorSelectionColor) {\r\n        collector.addRule(\".monaco-editor .focused .selected-text { background-color: \" + editorSelectionColor + \"; }\");\r\n    }\r\n    var editorInactiveSelectionColor = theme.getColor(editorInactiveSelection);\r\n    if (editorInactiveSelectionColor) {\r\n        collector.addRule(\".monaco-editor .selected-text { background-color: \" + editorInactiveSelectionColor + \"; }\");\r\n    }\r\n    var editorSelectionForegroundColor = theme.getColor(editorSelectionForeground);\r\n    if (editorSelectionForegroundColor) {\r\n        collector.addRule(\".monaco-editor .view-line span.inline-selected-text { color: \" + editorSelectionForegroundColor + \"; }\");\r\n    }\r\n});\r\nfunction abs(n) {\r\n    return n < 0 ? -n : n;\r\n}\r\n"],"sourceRoot":""}