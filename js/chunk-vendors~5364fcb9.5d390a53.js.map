{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/rename/renameInputField.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/rename/rename.js"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","CONTEXT_RENAME_INPUT_VISIBLE","RenameInputField","_editor","_acceptKeybindings","_themeService","_keybindingService","contextKeyService","_this","this","_disposables","allowEditorOverflow","_visibleContextKey","bindTo","addContentWidget","add","onDidChangeConfiguration","e","hasChanged","_updateFont","onThemeChange","_updateStyles","prototype","dispose","removeContentWidget","getId","getDomNode","_domNode","document","createElement","className","_input","type","setAttribute","appendChild","_label","updateLabel","_a","_b","_c","accept","preview","lookupKeybinding","innerText","getLabel","onDidUpdateKeybindings","getTheme","theme","_d","widgetShadowColor","getColor","style","backgroundColor","String","boxShadow","color","border","borderWidth","borderStyle","borderColor","toString","fontInfo","getOption","fontFamily","fontWeight","fontSize","getPosition","_visible","position","_position","preference","acceptInput","wantsPreview","_currentAcceptInput","cancelInput","focusEditor","_currentCancelInput","getInput","where","value","selectionStart","selectionEnd","supportPreview","startLineNumber","startColumn","size","Math","max","endColumn","disposeOnDone","Promise","resolve","undefined","trim","newName","onCursorChanged","editorPosition","containsPosition","onDidChangeCursorSelection","onDidBlurEditorWidget","_show","finally","_hide","revealLineInCenterIfOutsideViewport","lineNumber","set","layoutContentWidget","setTimeout","focus","setSelectionRange","parseInt","getAttribute","reset","__extends","extendStatics","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__awaiter","thisArg","_arguments","P","generator","adopt","reject","fulfilled","step","next","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","push","RenameSkeleton","model","_providers","ordered","hasProvider","resolveRenameLocation","token","firstProvider","res","word","getWordAtPosition","range","text","provideRenameEdits","rejects","provider","edits","rejectReason","join","concat","nls","rename","None","RenameController","editor","_instaService","_notificationService","_bulkEditService","_progressService","_logService","_configService","_dispoableStore","_cts","_renameInputField","createInstance","get","getContribution","ID","run","skeleton","loc","resolveLocationOperation","e_1","selection","inputFieldResult","renameOperation","hasModel","getModel","showWhile","showMessage","isCancellationRequested","getSelection","isEmpty","spansMultipleLines","containsRange","min","hasPreviewHandler","getValue","uri","renameResult","info","showPreview","ariaSummary","catch","err","error","acceptRenameInput","cancelRenameInput","_super","RenameAction","id","alias","precondition","and","writable","hasRenameProvider","kbOpts","kbExpr","editorTextFocus","primary","weight","contextMenuOpts","group","order","runCommand","accessor","args","editorService","isArray","pos","isUri","isIPosition","openCodeEditor","resource","getActiveCodeEditor","setPosition","invokeWithinContext","reportTelemetry","controller","RenameCommand","bindToContribution","handler","x","has","secondary","as","Configuration","registerConfiguration","properties","scope","description","default"],"mappings":"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","file":"js/chunk-vendors~5364fcb9.5d390a53.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './renameInputField.css';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { inputBackground, inputBorder, inputForeground, widgetShadow, editorWidgetBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { toggleClass } from '../../../base/browser/dom.js';\r\nexport var CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false);\r\nvar RenameInputField = /** @class */ (function () {\r\n    function RenameInputField(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._acceptKeybindings = _acceptKeybindings;\r\n        this._themeService = _themeService;\r\n        this._keybindingService = _keybindingService;\r\n        this._disposables = new DisposableStore();\r\n        this.allowEditorOverflow = true;\r\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\r\n        this._editor.addContentWidget(this);\r\n        this._disposables.add(this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(34 /* fontInfo */)) {\r\n                _this._updateFont();\r\n            }\r\n        }));\r\n        this._disposables.add(_themeService.onThemeChange(this._updateStyles, this));\r\n    }\r\n    RenameInputField.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    RenameInputField.prototype.getId = function () {\r\n        return '__renameInputWidget';\r\n    };\r\n    RenameInputField.prototype.getDomNode = function () {\r\n        var _this = this;\r\n        if (!this._domNode) {\r\n            this._domNode = document.createElement('div');\r\n            this._domNode.className = 'monaco-editor rename-box';\r\n            this._input = document.createElement('input');\r\n            this._input.className = 'rename-input';\r\n            this._input.type = 'text';\r\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\r\n            this._domNode.appendChild(this._input);\r\n            this._label = document.createElement('div');\r\n            this._label.className = 'rename-label';\r\n            this._domNode.appendChild(this._label);\r\n            var updateLabel = function () {\r\n                var _a, _b;\r\n                var _c = _this._acceptKeybindings, accept = _c[0], preview = _c[1];\r\n                _this._keybindingService.lookupKeybinding(accept);\r\n                _this._label.innerText = localize('label', \"{0} to Rename, {1} to Preview\", (_a = _this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = _this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\r\n            };\r\n            updateLabel();\r\n            this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\r\n            this._updateFont();\r\n            this._updateStyles(this._themeService.getTheme());\r\n        }\r\n        return this._domNode;\r\n    };\r\n    RenameInputField.prototype._updateStyles = function (theme) {\r\n        var _a, _b, _c, _d;\r\n        if (!this._input || !this._domNode) {\r\n            return;\r\n        }\r\n        var widgetShadowColor = theme.getColor(widgetShadow);\r\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\r\n        this._domNode.style.boxShadow = widgetShadowColor ? \" 0 2px 8px \" + widgetShadowColor : '';\r\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\r\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\r\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\r\n        var border = theme.getColor(inputBorder);\r\n        this._input.style.borderWidth = border ? '1px' : '0px';\r\n        this._input.style.borderStyle = border ? 'solid' : 'none';\r\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\r\n    };\r\n    RenameInputField.prototype._updateFont = function () {\r\n        if (!this._input || !this._label) {\r\n            return;\r\n        }\r\n        var fontInfo = this._editor.getOption(34 /* fontInfo */);\r\n        this._input.style.fontFamily = fontInfo.fontFamily;\r\n        this._input.style.fontWeight = fontInfo.fontWeight;\r\n        this._input.style.fontSize = fontInfo.fontSize + \"px\";\r\n        this._label.style.fontSize = fontInfo.fontSize * 0.8 + \"px\";\r\n    };\r\n    RenameInputField.prototype.getPosition = function () {\r\n        if (!this._visible) {\r\n            return null;\r\n        }\r\n        return {\r\n            position: this._position,\r\n            preference: [2 /* BELOW */, 1 /* ABOVE */]\r\n        };\r\n    };\r\n    RenameInputField.prototype.acceptInput = function (wantsPreview) {\r\n        if (this._currentAcceptInput) {\r\n            this._currentAcceptInput(wantsPreview);\r\n        }\r\n    };\r\n    RenameInputField.prototype.cancelInput = function (focusEditor) {\r\n        if (this._currentCancelInput) {\r\n            this._currentCancelInput(focusEditor);\r\n        }\r\n    };\r\n    RenameInputField.prototype.getInput = function (where, value, selectionStart, selectionEnd, supportPreview) {\r\n        var _this = this;\r\n        toggleClass(this._domNode, 'preview', supportPreview);\r\n        this._position = new Position(where.startLineNumber, where.startColumn);\r\n        this._input.value = value;\r\n        this._input.setAttribute('selectionStart', selectionStart.toString());\r\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\r\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\r\n        var disposeOnDone = new DisposableStore();\r\n        return new Promise(function (resolve) {\r\n            _this._currentCancelInput = function (focusEditor) {\r\n                _this._currentAcceptInput = undefined;\r\n                _this._currentCancelInput = undefined;\r\n                resolve(focusEditor);\r\n                return true;\r\n            };\r\n            _this._currentAcceptInput = function (wantsPreview) {\r\n                if (_this._input.value.trim().length === 0 || _this._input.value === value) {\r\n                    // empty or whitespace only or not changed\r\n                    _this.cancelInput(true);\r\n                    return;\r\n                }\r\n                _this._currentAcceptInput = undefined;\r\n                _this._currentCancelInput = undefined;\r\n                resolve({\r\n                    newName: _this._input.value,\r\n                    wantsPreview: supportPreview && wantsPreview\r\n                });\r\n            };\r\n            var onCursorChanged = function () {\r\n                var editorPosition = _this._editor.getPosition();\r\n                if (!editorPosition || !Range.containsPosition(where, editorPosition)) {\r\n                    _this.cancelInput(true);\r\n                }\r\n            };\r\n            disposeOnDone.add(_this._editor.onDidChangeCursorSelection(onCursorChanged));\r\n            disposeOnDone.add(_this._editor.onDidBlurEditorWidget(function () { return _this.cancelInput(false); }));\r\n            _this._show();\r\n        }).finally(function () {\r\n            disposeOnDone.dispose();\r\n            _this._hide();\r\n        });\r\n    };\r\n    RenameInputField.prototype._show = function () {\r\n        var _this = this;\r\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* Smooth */);\r\n        this._visible = true;\r\n        this._visibleContextKey.set(true);\r\n        this._editor.layoutContentWidget(this);\r\n        setTimeout(function () {\r\n            _this._input.focus();\r\n            _this._input.setSelectionRange(parseInt(_this._input.getAttribute('selectionStart')), parseInt(_this._input.getAttribute('selectionEnd')));\r\n        }, 100);\r\n    };\r\n    RenameInputField.prototype._hide = function () {\r\n        this._visible = false;\r\n        this._visibleContextKey.reset();\r\n        this._editor.layoutContentWidget(this);\r\n    };\r\n    RenameInputField = __decorate([\r\n        __param(2, IThemeService),\r\n        __param(3, IKeybindingService),\r\n        __param(4, IContextKeyService)\r\n    ], RenameInputField);\r\n    return RenameInputField;\r\n}());\r\nexport { RenameInputField };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { illegalArgument, onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand, registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { RenameInputField, CONTEXT_RENAME_INPUT_VISIBLE } from './renameInputField.js';\r\nimport { RenameProviderRegistry } from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IBulkEditService } from '../../browser/services/bulkEditService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CancellationToken, CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { IdleValue, raceCancellation } from '../../../base/common/async.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\r\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfigurationService.js';\r\nvar RenameSkeleton = /** @class */ (function () {\r\n    function RenameSkeleton(model, position) {\r\n        this.model = model;\r\n        this.position = position;\r\n        this._providers = RenameProviderRegistry.ordered(model);\r\n    }\r\n    RenameSkeleton.prototype.hasProvider = function () {\r\n        return this._providers.length > 0;\r\n    };\r\n    RenameSkeleton.prototype.resolveRenameLocation = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var firstProvider, res, _a, word;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        firstProvider = this._providers[0];\r\n                        if (!firstProvider) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (!firstProvider.resolveRenameLocation) return [3 /*break*/, 2];\r\n                        _a = withNullAsUndefined;\r\n                        return [4 /*yield*/, firstProvider.resolveRenameLocation(this.model, this.position, token)];\r\n                    case 1:\r\n                        res = _a.apply(void 0, [_b.sent()]);\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!res) {\r\n                            word = this.model.getWordAtPosition(this.position);\r\n                            if (word) {\r\n                                return [2 /*return*/, {\r\n                                        range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\r\n                                        text: word.word\r\n                                    }];\r\n                            }\r\n                        }\r\n                        return [2 /*return*/, res];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameSkeleton.prototype.provideRenameEdits = function (newName, i, rejects, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var provider, result;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        provider = this._providers[i];\r\n                        if (!provider) {\r\n                            return [2 /*return*/, {\r\n                                    edits: [],\r\n                                    rejectReason: rejects.join('\\n')\r\n                                }];\r\n                        }\r\n                        return [4 /*yield*/, provider.provideRenameEdits(this.model, this.position, newName, token)];\r\n                    case 1:\r\n                        result = _a.sent();\r\n                        if (!result) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token)];\r\n                        }\r\n                        else if (result.rejectReason) {\r\n                            return [2 /*return*/, this.provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token)];\r\n                        }\r\n                        return [2 /*return*/, result];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return RenameSkeleton;\r\n}());\r\nexport function rename(model, position, newName) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, new RenameSkeleton(model, position).provideRenameEdits(newName, 0, [], CancellationToken.None)];\r\n        });\r\n    });\r\n}\r\n// ---  register actions and commands\r\nvar RenameController = /** @class */ (function () {\r\n    function RenameController(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._instaService = _instaService;\r\n        this._notificationService = _notificationService;\r\n        this._bulkEditService = _bulkEditService;\r\n        this._progressService = _progressService;\r\n        this._logService = _logService;\r\n        this._configService = _configService;\r\n        this._dispoableStore = new DisposableStore();\r\n        this._cts = new CancellationTokenSource();\r\n        this._renameInputField = this._dispoableStore.add(new IdleValue(function () { return _this._dispoableStore.add(_this._instaService.createInstance(RenameInputField, _this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview'])); }));\r\n    }\r\n    RenameController.get = function (editor) {\r\n        return editor.getContribution(RenameController.ID);\r\n    };\r\n    RenameController.prototype.dispose = function () {\r\n        this._dispoableStore.dispose();\r\n        this._cts.dispose(true);\r\n    };\r\n    RenameController.prototype.run = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var position, skeleton, loc, resolveLocationOperation, e_1, selection, selectionStart, selectionEnd, supportPreview, inputFieldResult, renameOperation;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this._cts.dispose(true);\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        position = this.editor.getPosition();\r\n                        skeleton = new RenameSkeleton(this.editor.getModel(), position);\r\n                        if (!skeleton.hasProvider()) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* Position */ | 1 /* Value */);\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\r\n                        this._progressService.showWhile(resolveLocationOperation, 250);\r\n                        return [4 /*yield*/, resolveLocationOperation];\r\n                    case 2:\r\n                        loc = _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        e_1 = _a.sent();\r\n                        MessageController.get(this.editor).showMessage(e_1 || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\r\n                        return [2 /*return*/, undefined];\r\n                    case 4:\r\n                        if (!loc) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (loc.rejectReason) {\r\n                            MessageController.get(this.editor).showMessage(loc.rejectReason, position);\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (this._cts.token.isCancellationRequested) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selection = this.editor.getSelection();\r\n                        selectionStart = 0;\r\n                        selectionEnd = loc.text.length;\r\n                        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\r\n                            selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\r\n                            selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\r\n                        }\r\n                        supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\r\n                        return [4 /*yield*/, this._renameInputField.getValue().getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview)];\r\n                    case 5:\r\n                        inputFieldResult = _a.sent();\r\n                        // no result, only hint to focus the editor or not\r\n                        if (typeof inputFieldResult === 'boolean') {\r\n                            if (inputFieldResult) {\r\n                                this.editor.focus();\r\n                            }\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        this.editor.focus();\r\n                        renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, 0, [], this._cts.token), this._cts.token).then(function (renameResult) { return __awaiter(_this, void 0, void 0, function () {\r\n                            var _this = this;\r\n                            return __generator(this, function (_a) {\r\n                                if (!renameResult || !this.editor.hasModel()) {\r\n                                    return [2 /*return*/];\r\n                                }\r\n                                if (renameResult.rejectReason) {\r\n                                    this._notificationService.info(renameResult.rejectReason);\r\n                                    return [2 /*return*/];\r\n                                }\r\n                                this._bulkEditService.apply(renameResult, {\r\n                                    editor: this.editor,\r\n                                    showPreview: inputFieldResult.wantsPreview,\r\n                                    label: nls.localize('label', \"Renaming '{0}'\", loc === null || loc === void 0 ? void 0 : loc.text)\r\n                                }).then(function (result) {\r\n                                    if (result.ariaSummary) {\r\n                                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\r\n                                    }\r\n                                }).catch(function (err) {\r\n                                    _this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\r\n                                    _this._logService.error(err);\r\n                                });\r\n                                return [2 /*return*/];\r\n                            });\r\n                        }); }, function (err) {\r\n                            _this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\r\n                            _this._logService.error(err);\r\n                        });\r\n                        this._progressService.showWhile(renameOperation, 250);\r\n                        return [2 /*return*/, renameOperation];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    RenameController.prototype.acceptRenameInput = function (wantsPreview) {\r\n        this._renameInputField.getValue().acceptInput(wantsPreview);\r\n    };\r\n    RenameController.prototype.cancelRenameInput = function () {\r\n        this._renameInputField.getValue().cancelInput(true);\r\n    };\r\n    RenameController.ID = 'editor.contrib.renameController';\r\n    RenameController = __decorate([\r\n        __param(1, IInstantiationService),\r\n        __param(2, INotificationService),\r\n        __param(3, IBulkEditService),\r\n        __param(4, IEditorProgressService),\r\n        __param(5, ILogService),\r\n        __param(6, ITextResourceConfigurationService)\r\n    ], RenameController);\r\n    return RenameController;\r\n}());\r\n// ---- action implementation\r\nvar RenameAction = /** @class */ (function (_super) {\r\n    __extends(RenameAction, _super);\r\n    function RenameAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.rename',\r\n            label: nls.localize('rename.label', \"Rename Symbol\"),\r\n            alias: 'Rename Symbol',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.1\r\n            }\r\n        }) || this;\r\n    }\r\n    RenameAction.prototype.runCommand = function (accessor, args) {\r\n        var _this = this;\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var _a = Array.isArray(args) && args || [undefined, undefined], uri = _a[0], pos = _a[1];\r\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\r\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(function (editor) {\r\n                if (!editor) {\r\n                    return;\r\n                }\r\n                editor.setPosition(pos);\r\n                editor.invokeWithinContext(function (accessor) {\r\n                    _this.reportTelemetry(accessor, editor);\r\n                    return _this.run(accessor, editor);\r\n                });\r\n            }, onUnexpectedError);\r\n        }\r\n        return _super.prototype.runCommand.call(this, accessor, args);\r\n    };\r\n    RenameAction.prototype.run = function (accessor, editor) {\r\n        var controller = RenameController.get(editor);\r\n        if (controller) {\r\n            return controller.run();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    return RenameAction;\r\n}(EditorAction));\r\nexport { RenameAction };\r\nregisterEditorContribution(RenameController.ID, RenameController);\r\nregisterEditorAction(RenameAction);\r\nvar RenameCommand = EditorCommand.bindToContribution(RenameController.get);\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.acceptRenameInput(false); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInputWithPreview',\r\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\r\n    handler: function (x) { return x.acceptRenameInput(true); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 1024 /* Shift */ + 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'cancelRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: function (x) { return x.cancelRenameInput(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// ---- api bridge command\r\nregisterDefaultLanguageCommand('_executeDocumentRenameProvider', function (model, position, args) {\r\n    var newName = args.newName;\r\n    if (typeof newName !== 'string') {\r\n        throw illegalArgument('newName');\r\n    }\r\n    return rename(model, position, newName);\r\n});\r\n//todo@joh use editor options world\r\nRegistry.as(Extensions.Configuration).registerConfiguration({\r\n    id: 'editor',\r\n    properties: {\r\n        'editor.rename.enablePreview': {\r\n            scope: 5 /* LANGUAGE_OVERRIDABLE */,\r\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\r\n            default: true,\r\n            type: 'boolean'\r\n        }\r\n    }\r\n});\r\n"],"sourceRoot":""}