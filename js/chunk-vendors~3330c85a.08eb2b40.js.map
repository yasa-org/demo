{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/fontZoom.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/format/formattingEdit.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/format/format.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/format/formatActions.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","EditorFontZoomIn","_super","call","id","label","alias","precondition","undefined","run","accessor","editor","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","FormattingEdit","_handleEolEdits","edits","newEol","singleEdits","_i","edits_1","length","edit","eol","range","text","push","hasModel","getModel","pushEOL","_isFullModelReplaceEdit","model","editRange","validateRange","fullModelRange","getFullModelRange","equalsRange","execute","_edits","pushUndoStop","executeEdits","map","replace","lift","replaceMove","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","alertFormattingEdits","filter","i","plusRange","startLineNumber","endLineNumber","nls","getRealAndSyntheticDocumentFormattersOrdered","seen","Set","docFormatter","ordered","docFormatter_1","formatter","extensionId","add","toKey","rangeFormatter","_loop_1","has","displayName","provideDocumentFormattingEdits","options","token","provideDocumentRangeFormattingEdits","_a","rangeFormatter_1","FormattingConflicts","select","document","mode","selector","_selectors","formatDocumentRangeWithSelectedProvider","editorOrModel","instaService","provider","selected","get","invokeFunction","formatDocumentRangeWithProvider","workerService","cts","rawEdits","range_1","initialSelection_1","getFormattingOptions","computeMoreMinimalEdits","uri","isCancellationRequested","dispose","revealPositionInCenterIfOutsideViewport","getPosition","startColumn","endColumn","pushEditOperations","forceMoveMarkers","undoEdits","undoEdits_1","range_2","areIntersectingOrTouching","formatDocumentWithSelectedProvider","formatDocumentWithProvider","initialSelection_2","undoEdits_2","range_3","getDocumentRangeFormattingEditsUntilResult","providers","providers_1","catch","getDocumentFormattingEditsUntilResult","providers_2","getOnTypeFormattingEdits","position","ch","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","None","registerCommand","args","arguments","resource","isUri","isIRange","isIPosition","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","FormatOnType","_workerService","_this","_callOnDispose","_callOnModel","_editor","onDidChangeConfiguration","_update","onDidChangeModel","onDidChangeModelLanguage","onDidChange","clear","getOption","support","triggerChars","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","getSelections","canceled","unbind","onDidChangeModelContent","isFlush","len","changes","change","lineNumber","err","ID","FormatOnPaste","_instantiationService","onDidPaste","FormatDocumentAction","and","writable","hasDocumentFormattingProvider","kbOpts","kbExpr","editorTextFocus","primary","linux","weight","contextMenuOpts","when","group","order","FormatSelectionAction","hasDocumentSelectionFormattingProvider","hasNonEmptySelection","getSelection","isEmpty","getLineMaxColumn","commandService","getFocusedCodeEditor","executeCommand"],"mappings":"0HAAA,+CAIIA,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAgBxCK,EAAkC,SAAUC,GAE5C,SAASD,IACL,OAAOC,EAAOC,KAAKN,KAAM,CACrBO,GAAI,2BACJC,MAAO,OAAa,yBAA0B,uBAC9CC,MAAO,sBACPC,kBAAcC,KACZX,KAKV,OAZAX,EAAUe,EAAkBC,GAS5BD,EAAiBF,UAAUU,IAAM,SAAUC,EAAUC,GACjD,OAAWC,aAAa,OAAWC,eAAiB,IAEjDZ,EAb0B,CAcnC,QACEa,EAAmC,SAAUZ,GAE7C,SAASY,IACL,OAAOZ,EAAOC,KAAKN,KAAM,CACrBO,GAAI,4BACJC,MAAO,OAAa,0BAA2B,wBAC/CC,MAAO,uBACPC,kBAAcC,KACZX,KAKV,OAZAX,EAAU4B,EAAmBZ,GAS7BY,EAAkBf,UAAUU,IAAM,SAAUC,EAAUC,GAClD,OAAWC,aAAa,OAAWC,eAAiB,IAEjDC,EAb2B,CAcpC,QACEC,EAAqC,SAAUb,GAE/C,SAASa,IACL,OAAOb,EAAOC,KAAKN,KAAM,CACrBO,GAAI,8BACJC,MAAO,OAAa,4BAA6B,0BACjDC,MAAO,yBACPC,kBAAcC,KACZX,KAKV,OAZAX,EAAU6B,EAAqBb,GAS/Ba,EAAoBhB,UAAUU,IAAM,SAAUC,EAAUC,GACpD,OAAWC,aAAa,IAErBG,EAb6B,CActC,QACF,eAAqBd,GACrB,eAAqBa,GACrB,eAAqBC,I,6RC7DjB,EAAgC,WAChC,SAASC,KA0CT,OAxCAA,EAAeC,gBAAkB,SAAUN,EAAQO,GAG/C,IAFA,IAAIC,OAASX,EACTY,EAAc,GACTC,EAAK,EAAGC,EAAUJ,EAAOG,EAAKC,EAAQC,OAAQF,IAAM,CACzD,IAAIG,EAAOF,EAAQD,GACK,kBAAbG,EAAKC,MACZN,EAASK,EAAKC,KAEdD,EAAKE,OAA8B,kBAAdF,EAAKG,MAC1BP,EAAYQ,KAAKJ,GAQzB,MALsB,kBAAXL,GACHR,EAAOkB,YACPlB,EAAOmB,WAAWC,QAAQZ,GAG3BC,GAEXJ,EAAegB,wBAA0B,SAAUrB,EAAQa,GACvD,IAAKb,EAAOkB,WACR,OAAO,EAEX,IAAII,EAAQtB,EAAOmB,WACfI,EAAYD,EAAME,cAAcX,EAAKE,OACrCU,EAAiBH,EAAMI,oBAC3B,OAAOD,EAAeE,YAAYJ,IAEtClB,EAAeuB,QAAU,SAAU5B,EAAQ6B,GACvC7B,EAAO8B,eACP,IAAIvB,EAAQF,EAAeC,gBAAgBN,EAAQ6B,GAC9B,IAAjBtB,EAAMK,QAAgBP,EAAegB,wBAAwBrB,EAAQO,EAAM,IAE3EP,EAAO+B,aAAa,qBAAsBxB,EAAMyB,KAAI,SAAUnB,GAAQ,OAAO,OAAcoB,QAAQ,OAAMC,KAAKrB,EAAKE,OAAQF,EAAKG,UAGhIhB,EAAO+B,aAAa,qBAAsBxB,EAAMyB,KAAI,SAAUnB,GAAQ,OAAO,OAAcsB,YAAY,OAAMD,KAAKrB,EAAKE,OAAQF,EAAKG,UAExIhB,EAAO8B,gBAEJzB,EA3CwB,G,wECF/B+B,EAAwC,SAAUC,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMC,GAAS,OAAOA,aAAiBH,EAAIG,EAAQ,IAAIH,GAAE,SAAUI,GAAWA,EAAQD,MAC/F,OAAO,IAAKH,IAAMA,EAAIK,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUJ,GAAS,IAAMK,EAAKP,EAAUQ,KAAKN,IAAW,MAAOO,GAAKJ,EAAOI,IACpF,SAASC,EAASR,GAAS,IAAMK,EAAKP,EAAU,SAASE,IAAW,MAAOO,GAAKJ,EAAOI,IACvF,SAASF,EAAKI,GAAUA,EAAOC,KAAOT,EAAQQ,EAAOT,OAASD,EAAMU,EAAOT,OAAOW,KAAKP,EAAWI,GAClGH,GAAMP,EAAYA,EAAUc,MAAMjB,EAASC,GAAc,KAAKU,YAGlEO,EAA4C,SAAUlB,EAASmB,GAC/D,IAAsGC,EAAGC,EAAGC,EAAGC,EAA3GC,EAAI,CAAEnE,MAAO,EAAGoE,KAAM,WAAa,GAAW,EAAPH,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOI,KAAM,GAAIC,IAAK,IAChG,OAAOJ,EAAI,CAAEZ,KAAMiB,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BN,EAAEM,OAAOC,UAAY,WAAa,OAAOjF,OAAU0E,EACvJ,SAASK,EAAKG,GAAK,OAAO,SAAUC,GAAK,OAAOtB,EAAK,CAACqB,EAAGC,KACzD,SAAStB,EAAKuB,GACV,GAAIb,EAAG,MAAM,IAAIc,UAAU,mCAC3B,MAAOV,EAAG,IACN,GAAIJ,EAAI,EAAGC,IAAMC,EAAY,EAARW,EAAG,GAASZ,EAAE,UAAYY,EAAG,GAAKZ,EAAE,YAAcC,EAAID,EAAE,YAAcC,EAAEnE,KAAKkE,GAAI,GAAKA,EAAEV,SAAWW,EAAIA,EAAEnE,KAAKkE,EAAGY,EAAG,KAAKlB,KAAM,OAAOO,EAE3J,OADID,EAAI,EAAGC,IAAGW,EAAK,CAAS,EAARA,EAAG,GAAQX,EAAEjB,QACzB4B,EAAG,IACP,KAAK,EAAG,KAAK,EAAGX,EAAIW,EAAI,MACxB,KAAK,EAAc,OAAXT,EAAEnE,QAAgB,CAAEgD,MAAO4B,EAAG,GAAIlB,MAAM,GAChD,KAAK,EAAGS,EAAEnE,QAASgE,EAAIY,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKT,EAAEG,IAAIQ,MAAOX,EAAEE,KAAKS,MAAO,SACxC,QACI,GAAMb,EAAIE,EAAEE,OAAMJ,EAAIA,EAAE/C,OAAS,GAAK+C,EAAEA,EAAE/C,OAAS,MAAkB,IAAV0D,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAET,EAAI,EAAG,SACjG,GAAc,IAAVS,EAAG,MAAcX,GAAMW,EAAG,GAAKX,EAAE,IAAMW,EAAG,GAAKX,EAAE,IAAM,CAAEE,EAAEnE,MAAQ4E,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYT,EAAEnE,MAAQiE,EAAE,GAAI,CAAEE,EAAEnE,MAAQiE,EAAE,GAAIA,EAAIW,EAAI,MAC7D,GAAIX,GAAKE,EAAEnE,MAAQiE,EAAE,GAAI,CAAEE,EAAEnE,MAAQiE,EAAE,GAAIE,EAAEG,IAAI/C,KAAKqD,GAAK,MACvDX,EAAE,IAAIE,EAAEG,IAAIQ,MAChBX,EAAEE,KAAKS,MAAO,SAEtBF,EAAKd,EAAKhE,KAAK6C,EAASwB,GAC1B,MAAOZ,GAAKqB,EAAK,CAAC,EAAGrB,GAAIS,EAAI,EAAK,QAAUD,EAAIE,EAAI,EACtD,GAAY,EAARW,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAE5B,MAAO4B,EAAG,GAAKA,EAAG,QAAK,EAAQlB,MAAM,KAuB3E,SAASqB,EAAqBlE,GAEjC,GADAA,EAAQA,EAAMmE,QAAO,SAAU7D,GAAQ,OAAOA,EAAKE,SAC9CR,EAAMK,OAAX,CAIA,IADA,IAAIG,EAAQR,EAAM,GAAGQ,MACZ4D,EAAI,EAAGA,EAAIpE,EAAMK,OAAQ+D,IAC9B5D,EAAQ,OAAM6D,UAAU7D,EAAOR,EAAMoE,GAAG5D,OAE5C,IAAI8D,EAAkB9D,EAAM8D,gBAAiBC,EAAgB/D,EAAM+D,cAC/DD,IAAoBC,EACC,IAAjBvE,EAAMK,OACN,eAAMmE,EAAA,KAAa,SAAU,qCAAsCF,IAGnE,eAAME,EAAA,KAAa,SAAU,wCAAyCxE,EAAMK,OAAQiE,IAInE,IAAjBtE,EAAMK,OACN,eAAMmE,EAAA,KAAa,SAAU,mDAAoDF,EAAiBC,IAGlG,eAAMC,EAAA,KAAa,SAAU,sDAAuDxE,EAAMK,OAAQiE,EAAiBC,KAIxH,SAASE,EAA6C1D,GAKzD,IAJA,IAAI6B,EAAS,GACT8B,EAAO,IAAIC,IAEXC,EAAe,OAAuCC,QAAQ9D,GACzDZ,EAAK,EAAG2E,EAAiBF,EAAczE,EAAK2E,EAAezE,OAAQF,IAAM,CAC9E,IAAI4E,EAAYD,EAAe3E,GAC/ByC,EAAOlC,KAAKqE,GACRA,EAAUC,aACVN,EAAKO,IAAI,OAAoBC,MAAMH,EAAUC,cAoBrD,IAhBA,IAAIG,EAAiB,OAA4CN,QAAQ9D,GACrEqE,EAAU,SAAUL,GACpB,GAAIA,EAAUC,YAAa,CACvB,GAAIN,EAAKW,IAAI,OAAoBH,MAAMH,EAAUC,cAC7C,MAAO,WAEXN,EAAKO,IAAI,OAAoBC,MAAMH,EAAUC,cAEjDpC,EAAOlC,KAAK,CACR4E,YAAaP,EAAUO,YACvBN,YAAaD,EAAUC,YACvBO,+BAAgC,SAAUxE,EAAOyE,EAASC,GACtD,OAAOV,EAAUW,oCAAoC3E,EAAOA,EAAMI,oBAAqBqE,EAASC,OAInGE,EAAK,EAAGC,EAAmBT,EAAgBQ,EAAKC,EAAiBvF,OAAQsF,IAAM,CAChFZ,EAAYa,EAAiBD,GACjCP,EAAQL,GAEZ,OAAOnC,EAEX,IAAI,EAAqC,WACrC,SAASiD,KAqBT,OAnBAA,EAAoBC,OAAS,SAAUf,EAAWgB,EAAUC,GACxD,OAAOnE,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAIsH,EACJ,OAAOjD,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACD,OAAyB,IAArB4F,EAAU1E,OACH,CAAC,OAAcf,IAE1B2G,EAAWJ,EAAoBK,WAAWtC,WAAWnB,OAAON,MACvD8D,EACE,CAAC,EAAaA,EAASlB,EAAWgB,EAAUC,IAD7B,CAAC,EAAa,IAExC,KAAK,EAAG,MAAO,CAAC,EAAcL,EAAGpC,QACjC,KAAK,EAAG,MAAO,CAAC,EAAcwB,EAAU,YAKxDc,EAAoBK,WAAa,IAAI,OAC9BL,EAtB6B,GAyBjC,SAASM,EAAwC3G,EAAU4G,EAAe5F,EAAOwF,EAAMP,GAC1F,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAI0H,EAActF,EAAOuF,EAAUC,EACnC,OAAOvD,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EAID,OAHAkH,EAAe7G,EAASgH,IAAI,QAC5BzF,EAAQ,eAAaqF,GAAiBA,EAAcxF,WAAawF,EACjEE,EAAW,OAA4CzB,QAAQ9D,GACxD,CAAC,EAAa,EAAoB+E,OAAOQ,EAAUvF,EAAOiF,IACrE,KAAK,EAED,OADAO,EAAWZ,EAAGpC,OACTgD,EACE,CAAC,EAAaF,EAAaI,eAAeC,EAAiCH,EAAUH,EAAe5F,EAAOiF,IAD5F,CAAC,EAAa,GAExC,KAAK,EACDE,EAAGpC,OACHoC,EAAGxG,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,UAKzB,SAASuH,EAAgClH,EAAU8G,EAAUF,EAAe5F,EAAOiF,GACtF,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAIgI,EAAe5F,EAAO6F,EAAK5G,EAAO6G,EAAUC,EAASC,EACzD,OAAO/D,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACDwH,EAAgBnH,EAASgH,IAAI,QACzB,eAAaJ,IACbrF,EAAQqF,EAAcxF,WACtBgG,EAAM,IAAI,OAAmCR,EAAe,EAAkCX,KAG9F1E,EAAQqF,EACRQ,EAAM,IAAI,OAAiCR,EAAeX,IAE9DE,EAAGxG,MAAQ,EACf,KAAK,EAED,OADAwG,EAAGnC,KAAK9C,KAAK,CAAC,EAAG,CAAE,EAAG,IACf,CAAC,EAAa4F,EAASZ,oCAAoC3E,EAAOP,EAAOO,EAAMiG,uBAAwBJ,EAAInB,QACtH,KAAK,EAED,OADAoB,EAAWlB,EAAGpC,OACP,CAAC,EAAaoD,EAAcM,wBAAwBlG,EAAMmG,IAAKL,IAC1E,KAAK,EAED,OADA7G,EAAQ2F,EAAGpC,OACPqD,EAAInB,MAAM0B,wBACH,CAAC,GAAc,GAEnB,CAAC,EAAa,GACzB,KAAK,EAED,OADAP,EAAIQ,UACG,CAAC,GACZ,KAAK,EACD,OAAKpH,GAA0B,IAAjBA,EAAMK,QAGhB,eAAa+F,IAEb,EAAe/E,QAAQ+E,EAAepG,GACtCkE,EAAqBlE,GACrBoG,EAAc7E,eACd6E,EAAciB,wCAAwCjB,EAAckB,cAAe,KAGnFR,EAAU9G,EAAM,GAAGQ,MACnBuG,EAAqB,IAAI,OAAUD,EAAQxC,gBAAiBwC,EAAQS,YAAaT,EAAQvC,cAAeuC,EAAQU,WAChHzG,EAAM0G,mBAAmB,CAACV,GAAqB/G,EAAMyB,KAAI,SAAUnB,GAC/D,MAAO,CACHG,KAAMH,EAAKG,KACXD,MAAO,OAAMmB,KAAKrB,EAAKE,OACvBkH,kBAAkB,OAEtB,SAAUC,GACV,IAAK,IAAIxH,EAAK,EAAGyH,EAAcD,EAAWxH,EAAKyH,EAAYvH,OAAQF,IAAM,CACrE,IAAI0H,EAAUD,EAAYzH,GAAIK,MAC9B,GAAI,OAAMsH,0BAA0BD,EAASd,GACzC,MAAO,CAAC,IAAI,OAAUc,EAAQvD,gBAAiBuD,EAAQN,YAAaM,EAAQtD,cAAesD,EAAQL,YAG3G,OAAO,SAGR,CAAC,GAAc,IA5BX,CAAC,GAAc,UAiCvC,SAASO,EAAmCvI,EAAU4G,EAAeJ,EAAMP,GAC9E,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAI0H,EAActF,EAAOuF,EAAUC,EACnC,OAAOvD,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EAID,OAHAkH,EAAe7G,EAASgH,IAAI,QAC5BzF,EAAQ,eAAaqF,GAAiBA,EAAcxF,WAAawF,EACjEE,EAAW7B,EAA6C1D,GACjD,CAAC,EAAa,EAAoB+E,OAAOQ,EAAUvF,EAAOiF,IACrE,KAAK,EAED,OADAO,EAAWZ,EAAGpC,OACTgD,EACE,CAAC,EAAaF,EAAaI,eAAeuB,EAA4BzB,EAAUH,EAAeJ,EAAMP,IADtF,CAAC,EAAa,GAExC,KAAK,EACDE,EAAGpC,OACHoC,EAAGxG,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,UAKzB,SAAS6I,EAA2BxI,EAAU8G,EAAUF,EAAeJ,EAAMP,GAChF,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAIgI,EAAe5F,EAAO6F,EAAK5G,EAAO6G,EAAUrG,EAAOyH,EACvD,OAAOjF,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACDwH,EAAgBnH,EAASgH,IAAI,QACzB,eAAaJ,IACbrF,EAAQqF,EAAcxF,WACtBgG,EAAM,IAAI,OAAmCR,EAAe,EAAkCX,KAG9F1E,EAAQqF,EACRQ,EAAM,IAAI,OAAiCR,EAAeX,IAE9DE,EAAGxG,MAAQ,EACf,KAAK,EAED,OADAwG,EAAGnC,KAAK9C,KAAK,CAAC,EAAG,CAAE,EAAG,IACf,CAAC,EAAa4F,EAASf,+BAA+BxE,EAAOA,EAAMiG,uBAAwBJ,EAAInB,QAC1G,KAAK,EAED,OADAoB,EAAWlB,EAAGpC,OACP,CAAC,EAAaoD,EAAcM,wBAAwBlG,EAAMmG,IAAKL,IAC1E,KAAK,EAED,OADA7G,EAAQ2F,EAAGpC,OACPqD,EAAInB,MAAM0B,wBACH,CAAC,GAAc,GAEnB,CAAC,EAAa,GACzB,KAAK,EAED,OADAP,EAAIQ,UACG,CAAC,GACZ,KAAK,EACD,OAAKpH,GAA0B,IAAjBA,EAAMK,QAGhB,eAAa+F,IAEb,EAAe/E,QAAQ+E,EAAepG,GACzB,IAATgG,IACA9B,EAAqBlE,GACrBoG,EAAc7E,eACd6E,EAAciB,wCAAwCjB,EAAckB,cAAe,MAIvF9G,EAAQR,EAAM,GAAGQ,MACjByH,EAAqB,IAAI,OAAUzH,EAAM8D,gBAAiB9D,EAAM+G,YAAa/G,EAAM+D,cAAe/D,EAAMgH,WACxGzG,EAAM0G,mBAAmB,CAACQ,GAAqBjI,EAAMyB,KAAI,SAAUnB,GAC/D,MAAO,CACHG,KAAMH,EAAKG,KACXD,MAAO,OAAMmB,KAAKrB,EAAKE,OACvBkH,kBAAkB,OAEtB,SAAUC,GACV,IAAK,IAAIxH,EAAK,EAAG+H,EAAcP,EAAWxH,EAAK+H,EAAY7H,OAAQF,IAAM,CACrE,IAAIgI,EAAUD,EAAY/H,GAAIK,MAC9B,GAAI,OAAMsH,0BAA0BK,EAASF,GACzC,MAAO,CAAC,IAAI,OAAUE,EAAQ7D,gBAAiB6D,EAAQZ,YAAaY,EAAQ5D,cAAe4D,EAAQX,YAG3G,OAAO,SAGR,CAAC,GAAc,IA9BX,CAAC,GAAc,UAmCvC,SAASY,EAA2CzB,EAAe5F,EAAOP,EAAOgF,EAASC,GAC7F,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAI0J,EAAWlI,EAAImI,EAAahC,EAAUO,EAC1C,OAAO7D,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACDkJ,EAAY,OAA4CxD,QAAQ9D,GAChEZ,EAAK,EAAGmI,EAAcD,EACtB1C,EAAGxG,MAAQ,EACf,KAAK,EACD,OAAMgB,EAAKmI,EAAYjI,QACvBiG,EAAWgC,EAAYnI,GAChB,CAAC,EAAakC,QAAQD,QAAQkE,EAASZ,oCAAoC3E,EAAOP,EAAOgF,EAASC,IAAQ8C,MAAM,UAFhF,CAAC,EAAa,GAGzD,KAAK,EAED,OADA1B,EAAWlB,EAAGpC,OACT,eAAgBsD,GACd,CAAC,EAAaF,EAAcM,wBAAwBlG,EAAMmG,IAAKL,IAD/B,CAAC,EAAa,GAEzD,KAAK,EAAG,MAAO,CAAC,EAAclB,EAAGpC,QACjC,KAAK,EAED,OADApD,IACO,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,OAAcb,UAKvC,SAASkJ,EAAsC7B,EAAe5F,EAAOyE,EAASC,GACjF,OAAO5D,EAAUlD,UAAM,OAAQ,GAAQ,WACnC,IAAI0J,EAAWlI,EAAIsI,EAAanC,EAAUO,EAC1C,OAAO7D,EAAYrE,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACDkJ,EAAY5D,EAA6C1D,GACzDZ,EAAK,EAAGsI,EAAcJ,EACtB1C,EAAGxG,MAAQ,EACf,KAAK,EACD,OAAMgB,EAAKsI,EAAYpI,QACvBiG,EAAWmC,EAAYtI,GAChB,CAAC,EAAakC,QAAQD,QAAQkE,EAASf,+BAA+BxE,EAAOyE,EAASC,IAAQ8C,MAAM,UAFpE,CAAC,EAAa,GAGzD,KAAK,EAED,OADA1B,EAAWlB,EAAGpC,OACT,eAAgBsD,GACd,CAAC,EAAaF,EAAcM,wBAAwBlG,EAAMmG,IAAKL,IAD/B,CAAC,EAAa,GAEzD,KAAK,EAAG,MAAO,CAAC,EAAclB,EAAGpC,QACjC,KAAK,EAED,OADApD,IACO,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,OAAcb,UAKvC,SAASoJ,EAAyB/B,EAAe5F,EAAO4H,EAAUC,EAAIpD,GACzE,IAAI6C,EAAY,OAAqCxD,QAAQ9D,GAC7D,OAAyB,IAArBsH,EAAUhI,QAGVgI,EAAU,GAAGQ,4BAA4BC,QAAQF,GAAM,EAFhDvG,QAAQD,aAAQ9C,GAKpB+C,QAAQD,QAAQiG,EAAU,GAAGU,6BAA6BhI,EAAO4H,EAAUC,EAAIpD,EAAS,OAAkBwD,OAAOT,MAAM,QAA2BzF,MAAK,SAAU9C,GACpK,OAAO2G,EAAcM,wBAAwBlG,EAAMmG,IAAKlH,MAGhE,OAAiBiJ,gBAAgB,+BAA+B,SAAUzJ,GAEtE,IADA,IAAI0J,EAAO,GACF/I,EAAK,EAAGA,EAAKgJ,UAAU9I,OAAQF,IACpC+I,EAAK/I,EAAK,GAAKgJ,UAAUhJ,GAE7B,IAAIiJ,EAAWF,EAAK,GAAI1I,EAAQ0I,EAAK,GAAI1D,EAAU0D,EAAK,GACxD,eAAW,OAAIG,MAAMD,IACrB,eAAW,OAAME,SAAS9I,IAC1B,IAAIO,EAAQvB,EAASgH,IAAI,QAAe5F,SAASwI,GACjD,IAAKrI,EACD,MAAM,eAAgB,YAE1B,OAAOqH,EAA2C5I,EAASgH,IAAI,QAAuBzF,EAAO,OAAMY,KAAKnB,GAAQgF,EAAS,OAAkBwD,SAE/I,OAAiBC,gBAAgB,kCAAkC,SAAUzJ,GAEzE,IADA,IAAI0J,EAAO,GACF/I,EAAK,EAAGA,EAAKgJ,UAAU9I,OAAQF,IACpC+I,EAAK/I,EAAK,GAAKgJ,UAAUhJ,GAE7B,IAAIiJ,EAAWF,EAAK,GAAI1D,EAAU0D,EAAK,GACvC,eAAW,OAAIG,MAAMD,IACrB,IAAIrI,EAAQvB,EAASgH,IAAI,QAAe5F,SAASwI,GACjD,IAAKrI,EACD,MAAM,eAAgB,YAE1B,OAAOyH,EAAsChJ,EAASgH,IAAI,QAAuBzF,EAAOyE,EAAS,OAAkBwD,SAEvH,OAAiBC,gBAAgB,gCAAgC,SAAUzJ,GAEvE,IADA,IAAI0J,EAAO,GACF/I,EAAK,EAAGA,EAAKgJ,UAAU9I,OAAQF,IACpC+I,EAAK/I,EAAK,GAAKgJ,UAAUhJ,GAE7B,IAAIiJ,EAAWF,EAAK,GAAIP,EAAWO,EAAK,GAAIN,EAAKM,EAAK,GAAI1D,EAAU0D,EAAK,GACzE,eAAW,OAAIG,MAAMD,IACrB,eAAW,OAASG,YAAYZ,IAChC,eAAyB,kBAAPC,GAClB,IAAI7H,EAAQvB,EAASgH,IAAI,QAAe5F,SAASwI,GACjD,IAAKrI,EACD,MAAM,eAAgB,YAE1B,OAAO2H,EAAyBlJ,EAASgH,IAAI,QAAuBzF,EAAO,OAASY,KAAKgH,GAAWC,EAAIpD,M,gBCzaxGxH,EAAwC,WACxC,IAAIC,EAAgB,SAAUC,EAAGC,GAI7B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,KAClEP,EAAcC,EAAGC,IAE5B,OAAO,SAAUD,EAAGC,GAEhB,SAASO,IAAOC,KAAKC,YAAcV,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEW,UAAkB,OAANV,EAAaC,OAAOU,OAAOX,IAAMO,EAAGG,UAAYV,EAAEU,UAAW,IAAIH,IAV3C,GAaxC8K,EAA0C,SAAUC,EAAYC,EAAQC,EAAKC,GAC7E,IAA2H1L,EAAvH2L,EAAIV,UAAU9I,OAAQyJ,EAAID,EAAI,EAAIH,EAAkB,OAATE,EAAgBA,EAAOxL,OAAO2L,yBAAyBL,EAAQC,GAAOC,EACrH,GAAuB,kBAAZI,SAAoD,oBAArBA,QAAQC,SAAyBH,EAAIE,QAAQC,SAASR,EAAYC,EAAQC,EAAKC,QACpH,IAAK,IAAIxF,EAAIqF,EAAWpJ,OAAS,EAAG+D,GAAK,EAAGA,KAASlG,EAAIuL,EAAWrF,MAAI0F,GAAKD,EAAI,EAAI3L,EAAE4L,GAAKD,EAAI,EAAI3L,EAAEwL,EAAQC,EAAKG,GAAK5L,EAAEwL,EAAQC,KAASG,GAChJ,OAAOD,EAAI,GAAKC,GAAK1L,OAAO8L,eAAeR,EAAQC,EAAKG,GAAIA,GAE5DK,EAAoC,SAAUC,EAAYC,GAC1D,OAAO,SAAUX,EAAQC,GAAOU,EAAUX,EAAQC,EAAKS,KAEvD,EAAwC,SAAUtI,EAASC,EAAYC,EAAGC,GAC1E,SAASC,EAAMC,GAAS,OAAOA,aAAiBH,EAAIG,EAAQ,IAAIH,GAAE,SAAUI,GAAWA,EAAQD,MAC/F,OAAO,IAAKH,IAAMA,EAAIK,WAAU,SAAUD,EAASE,GAC/C,SAASC,EAAUJ,GAAS,IAAMK,EAAKP,EAAUQ,KAAKN,IAAW,MAAOO,GAAKJ,EAAOI,IACpF,SAASC,EAASR,GAAS,IAAMK,EAAKP,EAAU,SAASE,IAAW,MAAOO,GAAKJ,EAAOI,IACvF,SAASF,EAAKI,GAAUA,EAAOC,KAAOT,EAAQQ,EAAOT,OAASD,EAAMU,EAAOT,OAAOW,KAAKP,EAAWI,GAClGH,GAAMP,EAAYA,EAAUc,MAAMjB,EAASC,GAAc,KAAKU,YAGlE,EAA4C,SAAUX,EAASmB,GAC/D,IAAsGC,EAAGC,EAAGC,EAAGC,EAA3GC,EAAI,CAAEnE,MAAO,EAAGoE,KAAM,WAAa,GAAW,EAAPH,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOI,KAAM,GAAIC,IAAK,IAChG,OAAOJ,EAAI,CAAEZ,KAAMiB,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,oBAAXC,SAA0BN,EAAEM,OAAOC,UAAY,WAAa,OAAOjF,OAAU0E,EACvJ,SAASK,EAAKG,GAAK,OAAO,SAAUC,GAAK,OAAOtB,EAAK,CAACqB,EAAGC,KACzD,SAAStB,EAAKuB,GACV,GAAIb,EAAG,MAAM,IAAIc,UAAU,mCAC3B,MAAOV,EAAG,IACN,GAAIJ,EAAI,EAAGC,IAAMC,EAAY,EAARW,EAAG,GAASZ,EAAE,UAAYY,EAAG,GAAKZ,EAAE,YAAcC,EAAID,EAAE,YAAcC,EAAEnE,KAAKkE,GAAI,GAAKA,EAAEV,SAAWW,EAAIA,EAAEnE,KAAKkE,EAAGY,EAAG,KAAKlB,KAAM,OAAOO,EAE3J,OADID,EAAI,EAAGC,IAAGW,EAAK,CAAS,EAARA,EAAG,GAAQX,EAAEjB,QACzB4B,EAAG,IACP,KAAK,EAAG,KAAK,EAAGX,EAAIW,EAAI,MACxB,KAAK,EAAc,OAAXT,EAAEnE,QAAgB,CAAEgD,MAAO4B,EAAG,GAAIlB,MAAM,GAChD,KAAK,EAAGS,EAAEnE,QAASgE,EAAIY,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKT,EAAEG,IAAIQ,MAAOX,EAAEE,KAAKS,MAAO,SACxC,QACI,GAAMb,EAAIE,EAAEE,OAAMJ,EAAIA,EAAE/C,OAAS,GAAK+C,EAAEA,EAAE/C,OAAS,MAAkB,IAAV0D,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAET,EAAI,EAAG,SACjG,GAAc,IAAVS,EAAG,MAAcX,GAAMW,EAAG,GAAKX,EAAE,IAAMW,EAAG,GAAKX,EAAE,IAAM,CAAEE,EAAEnE,MAAQ4E,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYT,EAAEnE,MAAQiE,EAAE,GAAI,CAAEE,EAAEnE,MAAQiE,EAAE,GAAIA,EAAIW,EAAI,MAC7D,GAAIX,GAAKE,EAAEnE,MAAQiE,EAAE,GAAI,CAAEE,EAAEnE,MAAQiE,EAAE,GAAIE,EAAEG,IAAI/C,KAAKqD,GAAK,MACvDX,EAAE,IAAIE,EAAEG,IAAIQ,MAChBX,EAAEE,KAAKS,MAAO,SAEtBF,EAAKd,EAAKhE,KAAK6C,EAASwB,GAC1B,MAAOZ,GAAKqB,EAAK,CAAC,EAAGrB,GAAIS,EAAI,EAAK,QAAUD,EAAIE,EAAI,EACtD,GAAY,EAARW,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAE5B,MAAO4B,EAAG,GAAKA,EAAG,QAAK,EAAQlB,MAAM,KAqB9E,EAA8B,WAC9B,SAASyH,EAAa7K,EAAQ8K,GAC1B,IAAIC,EAAQ7L,KACZA,KAAK4L,eAAiBA,EACtB5L,KAAK8L,eAAiB,IAAI,OAC1B9L,KAAK+L,aAAe,IAAI,OACxB/L,KAAKgM,QAAUlL,EACfd,KAAK8L,eAAexF,IAAIxF,EAAOmL,0BAAyB,WAAc,OAAOJ,EAAMK,cACnFlM,KAAK8L,eAAexF,IAAIxF,EAAOqL,kBAAiB,WAAc,OAAON,EAAMK,cAC3ElM,KAAK8L,eAAexF,IAAIxF,EAAOsL,0BAAyB,WAAc,OAAOP,EAAMK,cACnFlM,KAAK8L,eAAexF,IAAI,OAAqC+F,YAAYrM,KAAKkM,QAASlM,OAuF3F,OArFA2L,EAAazL,UAAUuI,QAAU,WAC7BzI,KAAK8L,eAAerD,UACpBzI,KAAK+L,aAAatD,WAEtBkD,EAAazL,UAAUgM,QAAU,WAC7B,IAAIL,EAAQ7L,KAIZ,GAFAA,KAAK+L,aAAaO,QAEbtM,KAAKgM,QAAQO,UAAU,KAIvBvM,KAAKgM,QAAQhK,WAAlB,CAGA,IAAII,EAAQpC,KAAKgM,QAAQ/J,WAErBuK,EAAU,OAAqCtG,QAAQ9D,GAAO,GAClE,GAAKoK,GAAYA,EAAQtC,4BAAzB,CAKA,IADA,IAAIuC,EAAe,IAAI,OACdjL,EAAK,EAAGwF,EAAKwF,EAAQtC,4BAA6B1I,EAAKwF,EAAGtF,OAAQF,IAAM,CAC7E,IAAIyI,EAAKjD,EAAGxF,GACZiL,EAAanG,IAAI2D,EAAGyC,WAAW,IAEnC1M,KAAK+L,aAAazF,IAAItG,KAAKgM,QAAQW,WAAU,SAAU7K,GACnD,IAAI8K,EAAe9K,EAAK4K,WAAW5K,EAAKJ,OAAS,GAC7C+K,EAAa/F,IAAIkG,IACjBf,EAAMgB,SAASC,OAAOC,aAAaH,WAI/CjB,EAAazL,UAAU2M,SAAW,SAAU5C,GACxC,IAAI4B,EAAQ7L,KACZ,GAAKA,KAAKgM,QAAQhK,cAGdhC,KAAKgM,QAAQgB,gBAAgBtL,OAAS,GAA1C,CAGA,IAAIU,EAAQpC,KAAKgM,QAAQ/J,WACrB+H,EAAWhK,KAAKgM,QAAQrD,cACxBsE,GAAW,EAIXC,EAASlN,KAAKgM,QAAQmB,yBAAwB,SAAUpJ,GACxD,GAAIA,EAAEqJ,QAKF,OAFAH,GAAW,OACXC,EAAOzE,UAGX,IAAK,IAAIhD,EAAI,EAAG4H,EAAMtJ,EAAEuJ,QAAQ5L,OAAQ+D,EAAI4H,EAAK5H,IAAK,CAClD,IAAI8H,EAASxJ,EAAEuJ,QAAQ7H,GACvB,GAAI8H,EAAO1L,MAAM+D,eAAiBoE,EAASwD,WAIvC,OAFAP,GAAW,OACXC,EAAOzE,cAKnBsB,EAAyB/J,KAAK4L,eAAgBxJ,EAAO4H,EAAUC,EAAI7H,EAAMiG,wBAAwBlE,MAAK,SAAU9C,GAC5G6L,EAAOzE,UACHwE,GAGA,eAAgB5L,KAChB,EAAeqB,QAAQmJ,EAAMG,QAAS3K,GACtCkE,EAAqBlE,OAE1B,SAAUoM,GAET,MADAP,EAAOzE,UACDgF,OAGd9B,EAAa+B,GAAK,4BAClB/B,EAAed,EAAW,CACtBW,EAAQ,EAAG,SACZG,GACIA,EAjGsB,GAmG7B,EAA+B,WAC/B,SAASgC,EAAc7M,EAAQ8M,GAC3B,IAAI/B,EAAQ7L,KACZA,KAAKc,OAASA,EACdd,KAAK4N,sBAAwBA,EAC7B5N,KAAK8L,eAAiB,IAAI,OAC1B9L,KAAK+L,aAAe,IAAI,OACxB/L,KAAK8L,eAAexF,IAAIxF,EAAOmL,0BAAyB,WAAc,OAAOJ,EAAMK,cACnFlM,KAAK8L,eAAexF,IAAIxF,EAAOqL,kBAAiB,WAAc,OAAON,EAAMK,cAC3ElM,KAAK8L,eAAexF,IAAIxF,EAAOsL,0BAAyB,WAAc,OAAOP,EAAMK,cACnFlM,KAAK8L,eAAexF,IAAI,OAA4C+F,YAAYrM,KAAKkM,QAASlM,OAwClG,OAtCA2N,EAAczN,UAAUuI,QAAU,WAC9BzI,KAAK8L,eAAerD,UACpBzI,KAAK+L,aAAatD,WAEtBkF,EAAczN,UAAUgM,QAAU,WAC9B,IAAIL,EAAQ7L,KAEZA,KAAK+L,aAAaO,QAEbtM,KAAKc,OAAOyL,UAAU,KAItBvM,KAAKc,OAAOkB,YAIZ,OAA4C0E,IAAI1G,KAAKc,OAAOmB,aAGjEjC,KAAK+L,aAAazF,IAAItG,KAAKc,OAAO+M,YAAW,SAAU7G,GACnD,IAAInF,EAAQmF,EAAGnF,MACf,OAAOgK,EAAMgB,SAAShL,QAG9B8L,EAAczN,UAAU2M,SAAW,SAAUhL,GACpC7B,KAAKc,OAAOkB,aAGbhC,KAAKc,OAAOkM,gBAAgBtL,OAAS,GAGzC1B,KAAK4N,sBAAsB9F,eAAeN,EAAyCxH,KAAKc,OAAQe,EAAO,EAAgB,OAAkBwI,MAAMT,MAAM,UAEzJ+D,EAAcD,GAAK,+BACnBC,EAAgB9C,EAAW,CACvBW,EAAQ,EAAG,SACZmC,GACIA,EAlDuB,GAoD9B,EAAsC,SAAUtN,GAEhD,SAASyN,IACL,OAAOzN,EAAOC,KAAKN,KAAM,CACrBO,GAAI,+BACJC,MAAOqF,EAAA,KAAa,uBAAwB,mBAC5CpF,MAAO,kBACPC,aAAc,OAAeqN,IAAI,OAAkBC,SAAU,OAAkBC,+BAC/EC,OAAQ,CACJC,OAAQ,OAAeJ,IAAI,OAAkBK,gBAAiB,OAAkBH,+BAChFI,QAAS,KACTC,MAAO,CAAED,QAAS,MAClBE,OAAQ,KAEZC,gBAAiB,CACbC,KAAM,OAAkBR,8BACxBS,MAAO,iBACPC,MAAO,QAET3O,KAmBV,OArCAX,EAAUyO,EAAsBzN,GAoBhCyN,EAAqB5N,UAAUU,IAAM,SAAUC,EAAUC,GACrD,OAAO,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI0H,EACJ,OAAO,EAAY1H,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACD,OAAKM,EAAOkB,YACZ0F,EAAe7G,EAASgH,IAAI,QACrB,CAAC,EAAaH,EAAaI,eAAesB,EAAoCtI,EAAQ,EAAkB,OAAkBuJ,QAFlG,CAAC,EAAa,GAGjD,KAAK,EACDrD,EAAGpC,OACHoC,EAAGxG,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC,WAKzBsN,EAtC8B,CAuCvC,QACE,EAAuC,SAAUzN,GAEjD,SAASuO,IACL,OAAOvO,EAAOC,KAAKN,KAAM,CACrBO,GAAI,gCACJC,MAAOqF,EAAA,KAAa,wBAAyB,oBAC7CpF,MAAO,mBACPC,aAAc,OAAeqN,IAAI,OAAkBC,SAAU,OAAkBa,wCAC/EX,OAAQ,CACJC,OAAQ,OAAeJ,IAAI,OAAkBK,gBAAiB,OAAkBS,wCAChFR,QAAS,eAAS,KAAqC,MACvDE,OAAQ,KAEZC,gBAAiB,CACbC,KAAM,OAAeV,IAAI,OAAkBc,uCAAwC,OAAkBC,sBACrGJ,MAAO,iBACPC,MAAO,SAET3O,KAyBV,OA1CAX,EAAUuP,EAAuBvO,GAmBjCuO,EAAsB1O,UAAUU,IAAM,SAAUC,EAAUC,GACtD,OAAO,EAAUd,UAAM,OAAQ,GAAQ,WACnC,IAAI0H,EAActF,EAAOP,EACzB,OAAO,EAAY7B,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EACD,OAAKM,EAAOkB,YAGZ0F,EAAe7G,EAASgH,IAAI,QAC5BzF,EAAQtB,EAAOmB,WACfJ,EAAQf,EAAOiO,eACXlN,EAAMmN,YACNnN,EAAQ,IAAI,OAAMA,EAAM8D,gBAAiB,EAAG9D,EAAM8D,gBAAiBvD,EAAM6M,iBAAiBpN,EAAM8D,mBAE7F,CAAC,EAAa+B,EAAaI,eAAeN,EAAyC1G,EAAQe,EAAO,EAAkB,OAAkBwI,QARlI,CAAC,GAShB,KAAK,EAED,OADArD,EAAGpC,OACI,CAAC,WAKrBgK,EA3C+B,CA4CxC,QACF,eAA2B,EAAalB,GAAI,GAC5C,eAA2B,EAAcA,GAAI,GAC7C,eAAqB,GACrB,eAAqB,GAGrB,OAAiBpD,gBAAgB,wBAAwB,SAAUzJ,GAAY,OAAO,OAAU,OAAQ,OAAQ,GAAQ,WACpH,IAAIC,EAAQoO,EACZ,OAAO,EAAYlP,MAAM,SAAUgH,GAC/B,OAAQA,EAAGxG,OACP,KAAK,EAED,OADAM,EAASD,EAASgH,IAAI,QAAoBsH,uBACrCrO,GAAWA,EAAOkB,YAGvBkN,EAAiBrO,EAASgH,IAAI,QACzB/G,EAAOiO,eAAeC,UACpB,CAAC,EAAaE,EAAeE,eAAe,iCADN,CAAC,EAAa,IAHhD,CAAC,GAKhB,KAAK,EAED,OADApI,EAAGpC,OACI,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,EAAasK,EAAeE,eAAe,kCAC3D,KAAK,EACDpI,EAAGpC,OACHoC,EAAGxG,MAAQ,EACf,KAAK,EAAG,MAAO,CAAC","file":"js/chunk-vendors~3330c85a.08eb2b40.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorZoom } from '../../common/config/editorZoom.js';\r\nvar EditorFontZoomIn = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomIn, _super);\r\n    function EditorFontZoomIn() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomIn',\r\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\r\n            alias: 'Editor Font Zoom In',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomIn.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\r\n    };\r\n    return EditorFontZoomIn;\r\n}(EditorAction));\r\nvar EditorFontZoomOut = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomOut, _super);\r\n    function EditorFontZoomOut() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomOut',\r\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\r\n            alias: 'Editor Font Zoom Out',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomOut.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\r\n    };\r\n    return EditorFontZoomOut;\r\n}(EditorAction));\r\nvar EditorFontZoomReset = /** @class */ (function (_super) {\r\n    __extends(EditorFontZoomReset, _super);\r\n    function EditorFontZoomReset() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.fontZoomReset',\r\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\r\n            alias: 'Editor Font Zoom Reset',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    EditorFontZoomReset.prototype.run = function (accessor, editor) {\r\n        EditorZoom.setZoomLevel(0);\r\n    };\r\n    return EditorFontZoomReset;\r\n}(EditorAction));\r\nregisterEditorAction(EditorFontZoomIn);\r\nregisterEditorAction(EditorFontZoomOut);\r\nregisterEditorAction(EditorFontZoomReset);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar FormattingEdit = /** @class */ (function () {\r\n    function FormattingEdit() {\r\n    }\r\n    FormattingEdit._handleEolEdits = function (editor, edits) {\r\n        var newEol = undefined;\r\n        var singleEdits = [];\r\n        for (var _i = 0, edits_1 = edits; _i < edits_1.length; _i++) {\r\n            var edit = edits_1[_i];\r\n            if (typeof edit.eol === 'number') {\r\n                newEol = edit.eol;\r\n            }\r\n            if (edit.range && typeof edit.text === 'string') {\r\n                singleEdits.push(edit);\r\n            }\r\n        }\r\n        if (typeof newEol === 'number') {\r\n            if (editor.hasModel()) {\r\n                editor.getModel().pushEOL(newEol);\r\n            }\r\n        }\r\n        return singleEdits;\r\n    };\r\n    FormattingEdit._isFullModelReplaceEdit = function (editor, edit) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        var model = editor.getModel();\r\n        var editRange = model.validateRange(edit.range);\r\n        var fullModelRange = model.getFullModelRange();\r\n        return fullModelRange.equalsRange(editRange);\r\n    };\r\n    FormattingEdit.execute = function (editor, _edits) {\r\n        editor.pushUndoStop();\r\n        var edits = FormattingEdit._handleEolEdits(editor, _edits);\r\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\r\n            // We use replace semantics and hope that markers stay put...\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replace(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        else {\r\n            editor.executeEdits('formatEditsCommand', edits.map(function (edit) { return EditOperation.replaceMove(Range.lift(edit.range), edit.text); }));\r\n        }\r\n        editor.pushUndoStop();\r\n    };\r\n    return FormattingEdit;\r\n}());\r\nexport { FormattingEdit };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DocumentFormattingEditProviderRegistry, DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ExtensionIdentifier } from '../../../platform/extensions/common/extensions.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport function alertFormattingEdits(edits) {\r\n    edits = edits.filter(function (edit) { return edit.range; });\r\n    if (!edits.length) {\r\n        return;\r\n    }\r\n    var range = edits[0].range;\r\n    for (var i = 1; i < edits.length; i++) {\r\n        range = Range.plusRange(range, edits[i].range);\r\n    }\r\n    var startLineNumber = range.startLineNumber, endLineNumber = range.endLineNumber;\r\n    if (startLineNumber === endLineNumber) {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\r\n        }\r\n    }\r\n    else {\r\n        if (edits.length === 1) {\r\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\r\n        }\r\n        else {\r\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\r\n        }\r\n    }\r\n}\r\nexport function getRealAndSyntheticDocumentFormattersOrdered(model) {\r\n    var result = [];\r\n    var seen = new Set();\r\n    // (1) add all document formatter\r\n    var docFormatter = DocumentFormattingEditProviderRegistry.ordered(model);\r\n    for (var _i = 0, docFormatter_1 = docFormatter; _i < docFormatter_1.length; _i++) {\r\n        var formatter = docFormatter_1[_i];\r\n        result.push(formatter);\r\n        if (formatter.extensionId) {\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n    }\r\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\r\n    var rangeFormatter = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n    var _loop_1 = function (formatter) {\r\n        if (formatter.extensionId) {\r\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\r\n                return \"continue\";\r\n            }\r\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\r\n        }\r\n        result.push({\r\n            displayName: formatter.displayName,\r\n            extensionId: formatter.extensionId,\r\n            provideDocumentFormattingEdits: function (model, options, token) {\r\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\r\n            }\r\n        });\r\n    };\r\n    for (var _a = 0, rangeFormatter_1 = rangeFormatter; _a < rangeFormatter_1.length; _a++) {\r\n        var formatter = rangeFormatter_1[_a];\r\n        _loop_1(formatter);\r\n    }\r\n    return result;\r\n}\r\nvar FormattingConflicts = /** @class */ (function () {\r\n    function FormattingConflicts() {\r\n    }\r\n    FormattingConflicts.select = function (formatter, document, mode) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var selector;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (formatter.length === 0) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        selector = FormattingConflicts._selectors.iterator().next().value;\r\n                        if (!selector) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, selector(formatter, document, mode)];\r\n                    case 1: return [2 /*return*/, _a.sent()];\r\n                    case 2: return [2 /*return*/, formatter[0]];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    FormattingConflicts._selectors = new LinkedList();\r\n    return FormattingConflicts;\r\n}());\r\nexport { FormattingConflicts };\r\nexport function formatDocumentRangeWithSelectedProvider(accessor, editorOrModel, range, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithProvider, selected, editorOrModel, range, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentRangeWithProvider(accessor, provider, editorOrModel, range, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range_1, initialSelection_1;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        alertFormattingEdits(edits);\r\n                        editorOrModel.pushUndoStop();\r\n                        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                    }\r\n                    else {\r\n                        range_1 = edits[0].range;\r\n                        initialSelection_1 = new Selection(range_1.startLineNumber, range_1.startColumn, range_1.endLineNumber, range_1.endColumn);\r\n                        model.pushEditOperations([initialSelection_1], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_1 = undoEdits; _i < undoEdits_1.length; _i++) {\r\n                                var range_2 = undoEdits_1[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_2, initialSelection_1)) {\r\n                                    return [new Selection(range_2.startLineNumber, range_2.startColumn, range_2.endLineNumber, range_2.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var instaService, model, provider, selected;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    instaService = accessor.get(IInstantiationService);\r\n                    model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\r\n                    provider = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    return [4 /*yield*/, FormattingConflicts.select(provider, model, mode)];\r\n                case 1:\r\n                    selected = _a.sent();\r\n                    if (!selected) return [3 /*break*/, 3];\r\n                    return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token)];\r\n                case 2:\r\n                    _a.sent();\r\n                    _a.label = 3;\r\n                case 3: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var workerService, model, cts, edits, rawEdits, range, initialSelection_2;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    workerService = accessor.get(IEditorWorkerService);\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        model = editorOrModel.getModel();\r\n                        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* Value */ | 4 /* Position */, token);\r\n                    }\r\n                    else {\r\n                        model = editorOrModel;\r\n                        cts = new TextModelCancellationTokenSource(editorOrModel, token);\r\n                    }\r\n                    _a.label = 1;\r\n                case 1:\r\n                    _a.trys.push([1, , 4, 5]);\r\n                    return [4 /*yield*/, provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3:\r\n                    edits = _a.sent();\r\n                    if (cts.token.isCancellationRequested) {\r\n                        return [2 /*return*/, true];\r\n                    }\r\n                    return [3 /*break*/, 5];\r\n                case 4:\r\n                    cts.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5:\r\n                    if (!edits || edits.length === 0) {\r\n                        return [2 /*return*/, false];\r\n                    }\r\n                    if (isCodeEditor(editorOrModel)) {\r\n                        // use editor to apply edits\r\n                        FormattingEdit.execute(editorOrModel, edits);\r\n                        if (mode !== 2 /* Silent */) {\r\n                            alertFormattingEdits(edits);\r\n                            editorOrModel.pushUndoStop();\r\n                            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* Immediate */);\r\n                        }\r\n                    }\r\n                    else {\r\n                        range = edits[0].range;\r\n                        initialSelection_2 = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n                        model.pushEditOperations([initialSelection_2], edits.map(function (edit) {\r\n                            return {\r\n                                text: edit.text,\r\n                                range: Range.lift(edit.range),\r\n                                forceMoveMarkers: true\r\n                            };\r\n                        }), function (undoEdits) {\r\n                            for (var _i = 0, undoEdits_2 = undoEdits; _i < undoEdits_2.length; _i++) {\r\n                                var range_3 = undoEdits_2[_i].range;\r\n                                if (Range.areIntersectingOrTouching(range_3, initialSelection_2)) {\r\n                                    return [new Selection(range_3.startLineNumber, range_3.startColumn, range_3.endLineNumber, range_3.endColumn)];\r\n                                }\r\n                            }\r\n                            return null;\r\n                        });\r\n                    }\r\n                    return [2 /*return*/, true];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, model, range, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_1, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = DocumentRangeFormattingEditProviderRegistry.ordered(model);\r\n                    _i = 0, providers_1 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_1.length)) return [3 /*break*/, 5];\r\n                    provider = providers_1[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getDocumentFormattingEditsUntilResult(workerService, model, options, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var providers, _i, providers_2, provider, rawEdits;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    providers = getRealAndSyntheticDocumentFormattersOrdered(model);\r\n                    _i = 0, providers_2 = providers;\r\n                    _a.label = 1;\r\n                case 1:\r\n                    if (!(_i < providers_2.length)) return [3 /*break*/, 5];\r\n                    provider = providers_2[_i];\r\n                    return [4 /*yield*/, Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError)];\r\n                case 2:\r\n                    rawEdits = _a.sent();\r\n                    if (!isNonEmptyArray(rawEdits)) return [3 /*break*/, 4];\r\n                    return [4 /*yield*/, workerService.computeMoreMinimalEdits(model.uri, rawEdits)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    _i++;\r\n                    return [3 /*break*/, 1];\r\n                case 5: return [2 /*return*/, undefined];\r\n            }\r\n        });\r\n    });\r\n}\r\nexport function getOnTypeFormattingEdits(workerService, model, position, ch, options) {\r\n    var providers = OnTypeFormattingEditProviderRegistry.ordered(model);\r\n    if (providers.length === 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\r\n        return Promise.resolve(undefined);\r\n    }\r\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, CancellationToken.None)).catch(onUnexpectedExternalError).then(function (edits) {\r\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], range = args[1], options = args[2];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Range.isIRange(range));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentRangeFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, Range.lift(range), options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], options = args[1];\r\n    assertType(URI.isUri(resource));\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getDocumentFormattingEditsUntilResult(accessor.get(IEditorWorkerService), model, options, CancellationToken.None);\r\n});\r\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    var resource = args[0], position = args[1], ch = args[2], options = args[3];\r\n    assertType(URI.isUri(resource));\r\n    assertType(Position.isIPosition(position));\r\n    assertType(typeof ch === 'string');\r\n    var model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument('resource');\r\n    }\r\n    return getOnTypeFormattingEdits(accessor.get(IEditorWorkerService), model, Position.lift(position), ch, options);\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { getOnTypeFormattingEdits, alertFormattingEdits, formatDocumentRangeWithSelectedProvider, formatDocumentWithSelectedProvider } from './format.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar FormatOnType = /** @class */ (function () {\r\n    function FormatOnType(editor, _workerService) {\r\n        var _this = this;\r\n        this._workerService = _workerService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._editor = editor;\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(OnTypeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnType.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnType.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this._editor.getOption(39 /* formatOnType */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        // no support\r\n        var support = OnTypeFormattingEditProviderRegistry.ordered(model)[0];\r\n        if (!support || !support.autoFormatTriggerCharacters) {\r\n            return;\r\n        }\r\n        // register typing listeners that will trigger the format\r\n        var triggerChars = new CharacterSet();\r\n        for (var _i = 0, _a = support.autoFormatTriggerCharacters; _i < _a.length; _i++) {\r\n            var ch = _a[_i];\r\n            triggerChars.add(ch.charCodeAt(0));\r\n        }\r\n        this._callOnModel.add(this._editor.onDidType(function (text) {\r\n            var lastCharCode = text.charCodeAt(text.length - 1);\r\n            if (triggerChars.has(lastCharCode)) {\r\n                _this._trigger(String.fromCharCode(lastCharCode));\r\n            }\r\n        }));\r\n    };\r\n    FormatOnType.prototype._trigger = function (ch) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        var model = this._editor.getModel();\r\n        var position = this._editor.getPosition();\r\n        var canceled = false;\r\n        // install a listener that checks if edits happens before the\r\n        // position on which we format right now. If so, we won't\r\n        // apply the format edits\r\n        var unbind = this._editor.onDidChangeModelContent(function (e) {\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                // cancel only once\r\n                canceled = true;\r\n                unbind.dispose();\r\n                return;\r\n            }\r\n            for (var i = 0, len = e.changes.length; i < len; i++) {\r\n                var change = e.changes[i];\r\n                if (change.range.endLineNumber <= position.lineNumber) {\r\n                    // cancel only once\r\n                    canceled = true;\r\n                    unbind.dispose();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        getOnTypeFormattingEdits(this._workerService, model, position, ch, model.getFormattingOptions()).then(function (edits) {\r\n            unbind.dispose();\r\n            if (canceled) {\r\n                return;\r\n            }\r\n            if (isNonEmptyArray(edits)) {\r\n                FormattingEdit.execute(_this._editor, edits);\r\n                alertFormattingEdits(edits);\r\n            }\r\n        }, function (err) {\r\n            unbind.dispose();\r\n            throw err;\r\n        });\r\n    };\r\n    FormatOnType.ID = 'editor.contrib.autoFormat';\r\n    FormatOnType = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], FormatOnType);\r\n    return FormatOnType;\r\n}());\r\nvar FormatOnPaste = /** @class */ (function () {\r\n    function FormatOnPaste(editor, _instantiationService) {\r\n        var _this = this;\r\n        this.editor = editor;\r\n        this._instantiationService = _instantiationService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModel(function () { return _this._update(); }));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(function () { return _this._update(); }));\r\n        this._callOnDispose.add(DocumentRangeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    FormatOnPaste.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    };\r\n    FormatOnPaste.prototype._update = function () {\r\n        var _this = this;\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this.editor.getOption(38 /* formatOnPaste */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        // no formatter\r\n        if (!DocumentRangeFormattingEditProviderRegistry.has(this.editor.getModel())) {\r\n            return;\r\n        }\r\n        this._callOnModel.add(this.editor.onDidPaste(function (_a) {\r\n            var range = _a.range;\r\n            return _this._trigger(range);\r\n        }));\r\n    };\r\n    FormatOnPaste.prototype._trigger = function (range) {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this.editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        this._instantiationService.invokeFunction(formatDocumentRangeWithSelectedProvider, this.editor, range, 2 /* Silent */, CancellationToken.None).catch(onUnexpectedError);\r\n    };\r\n    FormatOnPaste.ID = 'editor.contrib.formatOnPaste';\r\n    FormatOnPaste = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], FormatOnPaste);\r\n    return FormatOnPaste;\r\n}());\r\nvar FormatDocumentAction = /** @class */ (function (_super) {\r\n    __extends(FormatDocumentAction, _super);\r\n    function FormatDocumentAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatDocument',\r\n            label: nls.localize('formatDocument.label', \"Format Document\"),\r\n            alias: 'Format Document',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentFormattingProvider),\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 36 /* KEY_F */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 39 /* KEY_I */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: EditorContextKeys.hasDocumentFormattingProvider,\r\n                group: '1_modification',\r\n                order: 1.3\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatDocumentAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) return [3 /*break*/, 2];\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatDocumentAction;\r\n}(EditorAction));\r\nvar FormatSelectionAction = /** @class */ (function (_super) {\r\n    __extends(FormatSelectionAction, _super);\r\n    function FormatSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.formatSelection',\r\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\r\n            alias: 'Format Selection',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 36 /* KEY_F */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: ContextKeyExpr.and(EditorContextKeys.hasDocumentSelectionFormattingProvider, EditorContextKeys.hasNonEmptySelection),\r\n                group: '1_modification',\r\n                order: 1.31\r\n            }\r\n        }) || this;\r\n    }\r\n    FormatSelectionAction.prototype.run = function (accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var instaService, model, range;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!editor.hasModel()) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        instaService = accessor.get(IInstantiationService);\r\n                        model = editor.getModel();\r\n                        range = editor.getSelection();\r\n                        if (range.isEmpty()) {\r\n                            range = new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber));\r\n                        }\r\n                        return [4 /*yield*/, instaService.invokeFunction(formatDocumentRangeWithSelectedProvider, editor, range, 1 /* Explicit */, CancellationToken.None)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return FormatSelectionAction;\r\n}(EditorAction));\r\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\r\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\r\nregisterEditorAction(FormatDocumentAction);\r\nregisterEditorAction(FormatSelectionAction);\r\n// this is the old format action that does both (format document OR format selection)\r\n// and we keep it here such that existing keybinding configurations etc will still work\r\nCommandsRegistry.registerCommand('editor.action.format', function (accessor) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var editor, commandService;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0:\r\n                editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n                if (!editor || !editor.hasModel()) {\r\n                    return [2 /*return*/];\r\n                }\r\n                commandService = accessor.get(ICommandService);\r\n                if (!editor.getSelection().isEmpty()) return [3 /*break*/, 2];\r\n                return [4 /*yield*/, commandService.executeCommand('editor.action.formatDocument')];\r\n            case 1:\r\n                _a.sent();\r\n                return [3 /*break*/, 4];\r\n            case 2: return [4 /*yield*/, commandService.executeCommand('editor.action.formatSelection')];\r\n            case 3:\r\n                _a.sent();\r\n                _a.label = 4;\r\n            case 4: return [2 /*return*/];\r\n        }\r\n    });\r\n}); });\r\n"],"sourceRoot":""}