{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplaceCommand.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplace.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/message/messageController.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/provideSignatureHelp.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsModel.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsWidget.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHints.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/copyLinesCommand.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentUtils.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/moveLinesCommand.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/sortLinesCommand.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/linesOperations.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/peekView/peekView.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/links/getLinks.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/markdown/markdownRenderer.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/multicursor.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/quickOpen/quickOpen.js"],"names":["InPlaceReplaceCommand","editRange","originalSelection","text","this","_editRange","_originalSelection","_text","prototype","getEditOperations","model","builder","addTrackedEditOperation","computeCursorState","helper","inverseEditOperations","getInverseEditOperations","srcRange","range","isEmpty","endLineNumber","Math","min","positionColumn","endColumn","length","__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","target","key","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","InPlaceReplaceController","editor","editorWorkerService","decorationIds","get","getContribution","ID","dispose","run","source","up","_this","currentRequest","cancel","editorSelection","getSelection","getModel","selection","startLineNumber","state","modelURI","uri","canNavigateValueSet","token","navigateValueSet","then","result","value","validate","lift","highlightRange","diff","startColumn","command","pushUndoStop","executeCommand","deltaDecorations","options","DECORATION","decorationRemover","catch","Promise","resolve","undefined","register","className","_super","InPlaceReplaceUp","call","id","label","nls","alias","precondition","writable","kbOpts","kbExpr","editorTextFocus","primary","weight","accessor","controller","InPlaceReplaceDown","theme","collector","border","getColor","addRule","MessageController","contextKeyService","closeTimeout","_messageWidget","_register","_messageListeners","_editor","_visible","MESSAGE_VISIBLE","bindTo","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","reset","showMessage","message","position","bounds","set","clear","MessageWidget","add","onDidBlurEditorText","closeMessage","onDidChangeCursorPosition","onDidDispose","onDidChangeModel","onMouseMove","e","containsPosition","lineNumber","fadeOut","hasModel","getPosition","MessageCommand","bindToContribution","handler","_a","column","allowEditorOverflow","suppressMouseDown","revealLinesInCenterIfOutsideViewport","_position","_domNode","document","createElement","classList","textContent","appendChild","anchor","addContentWidget","messageWidget","handle","clearTimeout","getDomNode","removeEventListener","setTimeout","addEventListener","removeContentWidget","getId","preference","borderWidth","type","background","foreground","__awaiter","thisArg","_arguments","P","generator","adopt","reject","fulfilled","step","next","rejected","done","apply","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","pop","push","Context","Visible","MultipleSignatures","provideSignatureHelp","context","supports","modes","ordered","map","support","args","triggerKind","Invoke","isRetrigger","triggerCharacter","None","ParameterHintState","__assign","assign","s","Default","Pending","request","Active","hints","ParameterHintsModel","delay","DEFAULT_DELAY","_onChangedHints","onChangedHints","event","triggerOnType","_state","_pendingTriggers","_lastSignatureHelpResult","triggerChars","retriggerChars","triggerId","throttledDelayer","onDidChangeConfiguration","onEditorConfigurationChange","onModelChanged","onDidChangeModelLanguage","onDidChangeCursorSelection","onCursorChange","onDidChangeModelContent","onModelContentChange","onDidChange","onDidType","enumerable","configurable","silent","fire","trigger","has","doTrigger","signatures","activeSignature","last","cycle","getOption","updateActiveSignature","previous","first","activeSignatureHelp","triggerContext","error_1","reduce","mergeTriggerContexts","isTriggered","_i","_b","_c","signatureHelpTriggerCharacters","ch","charCodeAt","_d","_e","signatureHelpRetriggerCharacters","lastCharIndex","triggerCharCode","TriggerCharacter","charAt","ContentChange","enabled","current","$","dom","ParameterHintsWidget","openerService","modeService","renderDisposeables","visible","announcedLabel","markdownRenderer","keyVisible","keyMultipleSignatures","newParameterHints","show","render","hide","createParamaterHintDOMNodes","element","wrapper","tabIndex","controls","overloads","onPreviousClick","onNextClick","scrollbar","signature","docs","style","userSelect","domNodes","layoutContentWidget","updateFont","fontInfo","fontSize","chain","bind","filter","hasChanged","on","onDidLayoutChange","updateMaxHeight","multiple","innerHTML","code","hasParameters","parameters","fontFamily","renderParameters","activeParameter","documentation","renderedContents","hasDocs","toString","labelToAnnounce","getParameterLabel","aria","scanDomNode","parent","currentParameter","getParameterLabelOffsets","start","end","beforeSpan","substring","paramSpan","afterSpan","paramIdx","param","isArray","idx","lastIndexOf","focus","height","max","getLayoutInfo","maxHeight","getElementsByClassName","transparent","link","codeBackground","ParameterHintsController","instantiationService","widget","createInstance","TriggerParameterHintsAction","hasSignatureHelpProvider","ParameterHintsCommand","x","secondary","and","mac","CopyLinesCommand","isCopyingDown","_selection","_isCopyingDown","_selectionDirection","_selectionId","_startLineNumberDelta","_endLineNumberDelta","setEndPosition","getLineMaxColumn","sourceLines","getLineContent","sourceText","join","addEditOperation","trackSelection","getDirection","getTrackedSelection","createWithDirection","getSpaceCnt","str","tabSize","spacesCnt","generateIndent","insertSpaces","tabsCnt","floor","MoveLinesCommand","isMovingDown","autoIndent","_isMovingDown","_autoIndent","_moveEndLineSelectionShrink","modelLineCount","getLineCount","_moveEndPositionDown","getOptions","indentSize","indentConverter","buildIndentConverter","virtualModel","getLineTokens","getLanguageIdentifier","getLanguageIdAtPosition","otherLineNumber","movingLineNumber_1","movingLineText","insertingText_1","shouldAutoIndent","movingLineMatchResult","matchEnterRule","oldIndentation","strings","newSpaceCnt","newIndentation","trimLeft","indentOfMovingLine","getGoodIndentForLine","oldSpaceCnt","ret","getIndentEditsOfMovingBlock","newIndentatOfMovingBlock","spaceCntOffset","indentOfFirstLine","oldIndent","shiftIndent","indentation","unshiftIndent","line","oneLineAbove","oneLineAboveText","validPrecedingLine","lineContent","nonWhitespaceIdx","maxColumn","enter","getEnterAction","enterPrefix","indentAction","Indent","appendText","IndentOutdent","Outdent","indexOf","indentMetadataOfMovelingLine","getIndentMetadata","replace","isCheapToTokenize","languageAtSelectionStart","languageAtSelectionEnd","getIndentRulesSupport","offset","originalIndent","originalSpacesCnt","newSpacesCnt","newIndent","SortLinesCommand","descending","selectionId","getCollator","_COLLATOR","Intl","Collator","sortLines","canRun","data","getSortData","len","before","after","linesToSort","sorted","slice","sort","compare","reverse","AbstractCopyLinesAction","down","opts","_accessor","commands","selections","getSelections","selections_1","executeCommands","CopyLinesUpAction","linux","menuOpts","menuId","group","title","comment","order","CopyLinesDownAction","DuplicateSelectionAction","selections_2","insertSelection","getValueInRange","AbstractMoveLinesAction","selections_3","MoveLinesUpAction","MoveLinesDownAction","AbstractSortLinesAction","selections_4","SortLinesAscendingAction","SortLinesDescendingAction","TrimTrailingWhitespaceAction","cursors","reason","positionLineNumber","DeleteLinesAction","textInputFocus","_getLinesToRemove","linesDeleted","edits","cursorState","executeEdits","operations","selectionStartColumn","a","mergedOperations","previousOperation","IndentLinesAction","_getCursors","indent","config","OutdentLinesAction","runEditorCommand","InsertLineBeforeAction","lineInsertBefore","InsertLineAfterAction","lineInsertAfter","AbstractDeleteAllToBoundaryAction","primaryCursor","rangesToDelete","_getRangesToDelete","effectiveRanges","count","nextRange","intersectRanges","plusRange","endCursorState","_getEndCursorState","DeleteAllLeftAction","endPrimaryCursor","deletedLines","forEach","endCursor","newStartLine","unshift","compareRangesUsingStarts","deleteFromLine","deleteFromColumn","DeleteAllRightAction","sel","JoinLinesAction","reducedSelections","lastSelection","previousValue","currentValue","equalsSelection","lineOffset","columnDeltaOffset","selectionEndPositionOffset","getStartPosition","trimmedLinesContent","i_1","lineText","firstNonWhitespaceIdx","getLineFirstNonWhitespaceColumn","insertSpace","lineTextWithoutIndent","substr","deleteSelection","resultSelection","TransposeAction","cursor","chars","split","AbstractCaseAction","wordSeparators","word","getWordAtPosition","wordRange","_modifyText","UpperCaseAction","toLocaleUpperCase","LowerCaseAction","toLocaleLowerCase","TitleCaseAction","separators","excludedChars","startUpperCase","currentChar","PeekContext","IPeekViewService","class_1","_widgets","Map","addExclusiveWidget","existing","listener","remove","delete","onDidClose","inPeekEditor","notInPeekEditor","toNegated","PeekContextController","getOuterEditor","getFocusedCodeEditor","getParentEditor","defaultOptions","headerBackgroundColor","white","primaryHeadingColor","fromHex","secondaryHeadingColor","PeekViewWidget","_onDidClose","styles","_applyStyles","_headElement","backgroundColor","_primaryHeading","color","_secondaryHeading","_bodyElement","frameColor","borderColor","_fillContainer","container","setCssClass","_fillHead","_fillBody","titleElement","_onTitleClick","_fillTitleIcon","_metaHeading","actionsContainer","actionBarOptions","_getActionBarOptions","_actionbarWidget","_disposables","icon","setTitle","primaryHeading","secondaryHeading","setAttribute","setMetaTitle","_doLayout","heightInPixel","widthInPixel","_isShowing","headHeight","ceil","bodyHeight","round","_doLayoutHead","_doLayoutBody","lineHeight","peekViewTitleBackground","dark","light","hc","peekViewTitleForeground","peekViewTitleInfoForeground","peekViewBorder","peekViewResultsBackground","black","peekViewResultsMatchForeground","peekViewResultsFileForeground","peekViewResultsSelectionBackground","peekViewResultsSelectionForeground","peekViewEditorBackground","peekViewEditorGutterBackground","peekViewResultsMatchHighlight","peekViewEditorMatchHighlight","peekViewEditorMatchHighlightBorder","Link","provider","_link","_provider","toJSON","url","tooltip","resolveLink","Error","LinksList","tuples","links","_loop_1","list","newLinks","_union","this_1","tuples_1","oldLinks","oldIndex","oldLen","newIndex","newLen","oldLink","newLink","areIntersectingOrTouching","comparisonResult","getLinks","lists","promises","provideLinks","all","isCancellationRequested","registerCommand","getHoverMessage","useMetaKey","executeCmd","test","kb","platform","hoverMessage","appendMarkdown","decoration","general","stickiness","collapseOnReplaceEdit","inlineClassName","active","LinkOccurrence","decorationId","_getOptions","isActive","activate","changeAccessor","changeDecorationOptions","deactivate","LinkDetector","notificationService","listenersToRemove","clickLinkGesture","onMouseMoveOrRelevantKeyDown","mouseEvent","keyboardEvent","_onEditorMouseMove","onExecute","onEditorMouseUp","onCancel","cleanUpActiveLinkDecoration","updateDecorations","stop","beginCompute","onChange","onModelModeChanged","timeout","computePromise","activeLinksList","currentOccurrences","activeLinkDecorationId","setIfNotSet","RECOMPUTE_TIME","err_1","oldDecorations","keys","occurance","newDecorations","links_1","decorations","withKey","isEnabled","occurrence_1","getLinkOccurrence","changeDecorations","occurrence_2","occurrence","openLinkOccurrence","hasSideBySideModifier","openToSide","fromUserGesture","open","err","messageOrError","warn","getDecorationsInRange","decorations_1","decoration_1","currentOccurrence","Boolean","hasTriggerModifier","keyCodeIsTriggerKey","OpenLinkAction","linkDetector","getEndPosition","activeLinkForeground","MarkdownRenderer","_modeService","_openerService","_onDidRenderCodeBlock","onDidRenderCodeBlock","disposeables","codeBlockRenderer","languageAlias","modeId","getModeIdForLanguageName","language","triggerMode","promise","getPromise","codeBlockRenderCallback","actionHandler","callback","content","markdown","InsertCursorAbove","useLogicalLine","logicalLine","readOnly","pushStackElement","setStates","addCursorUp","getAll","reveal","InsertCursorBelow","addCursorDown","InsertCursorAtEndOfEachLineSelected","getCursorsForSelection","currentLineMaxColumn","newSelections","setSelections","InsertCursorAtEndOfLineSelected","lineCount","InsertCursorAtTopOfLineSelected","MultiCursorSessionResult","revealRange","revealScrollType","MultiCursorSession","findController","isDisconnectedFromFindController","searchText","wholeWord","matchCase","currentMatch","findState","getState","hasTextFocus","isRevealed","searchString","addSelectionToNextFindMatch","nextMatch","_getNextMatch","allSelections","concat","moveSelectionToNextFindMatch","highlightFindOptions","lastAddedSelection","findNextMatch","addSelectionToPreviousFindMatch","previousMatch","_getPreviousMatch","moveSelectionToPreviousFindMatch","findPreviousMatch","selectAll","findMatches","MultiCursorSelectionController","_sessionDispose","_ignoreSelectionChange","_session","_endSession","_beginSessionIfNeeded","session","newState","wholeWordOverride","matchCaseOverride","isRegexOverride","change","onFindReplaceStateChange","_setSelections","_expandEmptyToWord","_applySessionResult","revealRangeInCenterIfOutsideViewport","getSession","selectionsContainSameText","modelRangesContainSameText","resultingSelections","matches","isRegex","searchScope","inSelection","match","intersection","m","MultiCursorSelectionControllerAction","multiCursorController","_run","AddSelectionToNextFindMatchAction","AddSelectionToPreviousFindMatchAction","MoveSelectionToNextFindMatchAction","MoveSelectionToPreviousFindMatchAction","SelectHighlightsAction","CompatChangeAll","contextMenuOpts","SelectionHighlighterState","softEquals","SelectionHighlighter","_isEnabled","updateSoon","_update","_setState","schedule","_createState","findState_1","caseSensitive","findStateSearchString","toLowerCase","mySearchString","isTooLargeForTokenization","hasFindOccurrences","allMatches","j","lenJ","cmp","areIntersecting","_SELECTION_HIGHLIGHT","_SELECTION_HIGHLIGHT_OVERVIEW","overviewRuler","Center","ranges","selectedText","thisSelectedText","getDocumentSymbols","flat","roots","child","flatEntries","children","symbol","flatten","compareEntriesUsingStart","bucket","entries","overrideContainerLabel","entries_1","entry","kind","tags","name","detail","containerName","selectionRange","resource","reference","isUri","createModelReference","object","textEditorModel"],"mappings":"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","file":"js/chunk-vendors~6c43a7dc.0b7ff491.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar InPlaceReplaceCommand = /** @class */ (function () {\r\n    function InPlaceReplaceCommand(editRange, originalSelection, text) {\r\n        this._editRange = editRange;\r\n        this._originalSelection = originalSelection;\r\n        this._text = text;\r\n    }\r\n    InPlaceReplaceCommand.prototype.getEditOperations = function (model, builder) {\r\n        builder.addTrackedEditOperation(this._editRange, this._text);\r\n    };\r\n    InPlaceReplaceCommand.prototype.computeCursorState = function (model, helper) {\r\n        var inverseEditOperations = helper.getInverseEditOperations();\r\n        var srcRange = inverseEditOperations[0].range;\r\n        if (!this._originalSelection.isEmpty()) {\r\n            // Preserve selection and extends to typed text\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\r\n        }\r\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\r\n    };\r\n    return InPlaceReplaceCommand;\r\n}());\r\nexport { InPlaceReplaceCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { registerEditorAction, EditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\r\nimport { EditorState } from '../../browser/core/editorState.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { createCancelablePromise, timeout } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nvar InPlaceReplaceController = /** @class */ (function () {\r\n    function InPlaceReplaceController(editor, editorWorkerService) {\r\n        this.decorationIds = [];\r\n        this.editor = editor;\r\n        this.editorWorkerService = editorWorkerService;\r\n    }\r\n    InPlaceReplaceController.get = function (editor) {\r\n        return editor.getContribution(InPlaceReplaceController.ID);\r\n    };\r\n    InPlaceReplaceController.prototype.dispose = function () {\r\n    };\r\n    InPlaceReplaceController.prototype.run = function (source, up) {\r\n        var _this = this;\r\n        // cancel any pending request\r\n        if (this.currentRequest) {\r\n            this.currentRequest.cancel();\r\n        }\r\n        var editorSelection = this.editor.getSelection();\r\n        var model = this.editor.getModel();\r\n        if (!model || !editorSelection) {\r\n            return undefined;\r\n        }\r\n        var selection = editorSelection;\r\n        if (selection.startLineNumber !== selection.endLineNumber) {\r\n            // Can't accept multiline selection\r\n            return undefined;\r\n        }\r\n        var state = new EditorState(this.editor, 1 /* Value */ | 4 /* Position */);\r\n        var modelURI = model.uri;\r\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        this.currentRequest = createCancelablePromise(function (token) { return _this.editorWorkerService.navigateValueSet(modelURI, selection, up); });\r\n        return this.currentRequest.then(function (result) {\r\n            if (!result || !result.range || !result.value) {\r\n                // No proper result\r\n                return;\r\n            }\r\n            if (!state.validate(_this.editor)) {\r\n                // state has changed\r\n                return;\r\n            }\r\n            // Selection\r\n            var editRange = Range.lift(result.range);\r\n            var highlightRange = result.range;\r\n            var diff = result.value.length - (selection.endColumn - selection.startColumn);\r\n            // highlight\r\n            highlightRange = {\r\n                startLineNumber: highlightRange.startLineNumber,\r\n                startColumn: highlightRange.startColumn,\r\n                endLineNumber: highlightRange.endLineNumber,\r\n                endColumn: highlightRange.startColumn + result.value.length\r\n            };\r\n            if (diff > 1) {\r\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\r\n            }\r\n            // Insert new text\r\n            var command = new InPlaceReplaceCommand(editRange, selection, result.value);\r\n            _this.editor.pushUndoStop();\r\n            _this.editor.executeCommand(source, command);\r\n            _this.editor.pushUndoStop();\r\n            // add decoration\r\n            _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, [{\r\n                    range: highlightRange,\r\n                    options: InPlaceReplaceController.DECORATION\r\n                }]);\r\n            // remove decoration after delay\r\n            if (_this.decorationRemover) {\r\n                _this.decorationRemover.cancel();\r\n            }\r\n            _this.decorationRemover = timeout(350);\r\n            _this.decorationRemover.then(function () { return _this.decorationIds = _this.editor.deltaDecorations(_this.decorationIds, []); }).catch(onUnexpectedError);\r\n        }).catch(onUnexpectedError);\r\n    };\r\n    InPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\r\n    InPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\r\n        className: 'valueSetReplacement'\r\n    });\r\n    InPlaceReplaceController = __decorate([\r\n        __param(1, IEditorWorkerService)\r\n    ], InPlaceReplaceController);\r\n    return InPlaceReplaceController;\r\n}());\r\nvar InPlaceReplaceUp = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceUp, _super);\r\n    function InPlaceReplaceUp() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.up',\r\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\r\n            alias: 'Replace with Previous Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 82 /* US_COMMA */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceUp.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, true);\r\n    };\r\n    return InPlaceReplaceUp;\r\n}(EditorAction));\r\nvar InPlaceReplaceDown = /** @class */ (function (_super) {\r\n    __extends(InPlaceReplaceDown, _super);\r\n    function InPlaceReplaceDown() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.inPlaceReplace.down',\r\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\r\n            alias: 'Replace with Next Value',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InPlaceReplaceDown.prototype.run = function (accessor, editor) {\r\n        var controller = InPlaceReplaceController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        return controller.run(this.id, false);\r\n    };\r\n    return InPlaceReplaceDown;\r\n}(EditorAction));\r\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController);\r\nregisterEditorAction(InPlaceReplaceUp);\r\nregisterEditorAction(InPlaceReplaceDown);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorBracketMatchBorder);\r\n    if (border) {\r\n        collector.addRule(\".monaco-editor.vs .valueSetReplacement { outline: solid 2px \" + border + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './messageController.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { Disposable, DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant, HIGH_CONTRAST } from '../../../platform/theme/common/themeService.js';\r\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nvar MessageController = /** @class */ (function (_super) {\r\n    __extends(MessageController, _super);\r\n    function MessageController(editor, contextKeyService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.closeTimeout = 3000; // close after 3s\r\n        _this._messageWidget = _this._register(new MutableDisposable());\r\n        _this._messageListeners = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\r\n        _this._register(_this._editor.onDidAttemptReadOnlyEdit(function () { return _this._onDidAttemptReadOnlyEdit(); }));\r\n        return _this;\r\n    }\r\n    MessageController.get = function (editor) {\r\n        return editor.getContribution(MessageController.ID);\r\n    };\r\n    MessageController.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._visible.reset();\r\n    };\r\n    MessageController.prototype.showMessage = function (message, position) {\r\n        var _this = this;\r\n        alert(message);\r\n        this._visible.set(true);\r\n        this._messageWidget.clear();\r\n        this._messageListeners.clear();\r\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\r\n        // close on blur, cursor, model change, dispose\r\n        this._messageListeners.add(this._editor.onDidBlurEditorText(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidDispose(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(this._editor.onDidChangeModel(function () { return _this.closeMessage(); }));\r\n        this._messageListeners.add(new TimeoutTimer(function () { return _this.closeMessage(); }, this.closeTimeout));\r\n        // close on mouse move\r\n        var bounds;\r\n        this._messageListeners.add(this._editor.onMouseMove(function (e) {\r\n            // outside the text area\r\n            if (!e.target.position) {\r\n                return;\r\n            }\r\n            if (!bounds) {\r\n                // define bounding box around position and first mouse occurance\r\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\r\n            }\r\n            else if (!bounds.containsPosition(e.target.position)) {\r\n                // check if position is still in bounds\r\n                _this.closeMessage();\r\n            }\r\n        }));\r\n    };\r\n    MessageController.prototype.closeMessage = function () {\r\n        this._visible.reset();\r\n        this._messageListeners.clear();\r\n        if (this._messageWidget.value) {\r\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\r\n        }\r\n    };\r\n    MessageController.prototype._onDidAttemptReadOnlyEdit = function () {\r\n        if (this._editor.hasModel()) {\r\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\r\n        }\r\n    };\r\n    MessageController.ID = 'editor.contrib.messageController';\r\n    MessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false);\r\n    MessageController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], MessageController);\r\n    return MessageController;\r\n}(Disposable));\r\nexport { MessageController };\r\nvar MessageCommand = EditorCommand.bindToContribution(MessageController.get);\r\nregisterEditorCommand(new MessageCommand({\r\n    id: 'leaveEditorMessage',\r\n    precondition: MessageController.MESSAGE_VISIBLE,\r\n    handler: function (c) { return c.closeMessage(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        primary: 9 /* Escape */\r\n    }\r\n}));\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(editor, _a, text) {\r\n        var lineNumber = _a.lineNumber, column = _a.column;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._editor = editor;\r\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\r\n        this._position = { lineNumber: lineNumber, column: column - 1 };\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.classList.add('monaco-editor-overlaymessage');\r\n        var message = document.createElement('div');\r\n        message.classList.add('message');\r\n        message.textContent = text;\r\n        this._domNode.appendChild(message);\r\n        var anchor = document.createElement('div');\r\n        anchor.classList.add('anchor');\r\n        this._domNode.appendChild(anchor);\r\n        this._editor.addContentWidget(this);\r\n        this._domNode.classList.add('fadeIn');\r\n    }\r\n    MessageWidget.fadeOut = function (messageWidget) {\r\n        var handle;\r\n        var dispose = function () {\r\n            messageWidget.dispose();\r\n            clearTimeout(handle);\r\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\r\n        };\r\n        handle = setTimeout(dispose, 110);\r\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\r\n        messageWidget.getDomNode().classList.add('fadeOut');\r\n        return { dispose: dispose };\r\n    };\r\n    MessageWidget.prototype.dispose = function () {\r\n        this._editor.removeContentWidget(this);\r\n    };\r\n    MessageWidget.prototype.getId = function () {\r\n        return 'messageoverlay';\r\n    };\r\n    MessageWidget.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    MessageWidget.prototype.getPosition = function () {\r\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\r\n    };\r\n    return MessageWidget;\r\n}());\r\nregisterEditorContribution(MessageController.ID, MessageController);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(inputValidationInfoBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .anchor { border-top-color: \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n    }\r\n    var background = theme.getColor(inputValidationInfoBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { background-color: \" + background + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(inputValidationInfoForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .monaco-editor-overlaymessage .message { color: \" + foreground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { first } from '../../../base/common/async.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerDefaultLanguageCommand } from '../../browser/editorExtensions.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nexport var Context = {\r\n    Visible: new RawContextKey('parameterHintsVisible', false),\r\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\r\n};\r\nexport function provideSignatureHelp(model, position, context, token) {\r\n    var supports = modes.SignatureHelpProviderRegistry.ordered(model);\r\n    return first(supports.map(function (support) { return function () {\r\n        return Promise.resolve(support.provideSignatureHelp(model, position, token, context))\r\n            .catch(function (e) { return onUnexpectedExternalError(e); });\r\n    }; }));\r\n}\r\nregisterDefaultLanguageCommand('_executeSignatureHelpProvider', function (model, position, args) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var result;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4 /*yield*/, provideSignatureHelp(model, position, {\r\n                    triggerKind: modes.SignatureHelpTriggerKind.Invoke,\r\n                    isRetrigger: false,\r\n                    triggerCharacter: args['triggerCharacter']\r\n                }, CancellationToken.None)];\r\n            case 1:\r\n                result = _a.sent();\r\n                if (!result) {\r\n                    return [2 /*return*/, undefined];\r\n                }\r\n                setTimeout(function () { return result.dispose(); }, 0);\r\n                return [2 /*return*/, result.value];\r\n        }\r\n    });\r\n}); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { createCancelablePromise, Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\r\nvar ParameterHintState;\r\n(function (ParameterHintState) {\r\n    ParameterHintState.Default = { type: 0 /* Default */ };\r\n    var Pending = /** @class */ (function () {\r\n        function Pending(request) {\r\n            this.request = request;\r\n            this.type = 2 /* Pending */;\r\n        }\r\n        return Pending;\r\n    }());\r\n    ParameterHintState.Pending = Pending;\r\n    var Active = /** @class */ (function () {\r\n        function Active(hints) {\r\n            this.hints = hints;\r\n            this.type = 1 /* Active */;\r\n        }\r\n        return Active;\r\n    }());\r\n    ParameterHintState.Active = Active;\r\n})(ParameterHintState || (ParameterHintState = {}));\r\nvar ParameterHintsModel = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsModel, _super);\r\n    function ParameterHintsModel(editor, delay) {\r\n        if (delay === void 0) { delay = ParameterHintsModel.DEFAULT_DELAY; }\r\n        var _this = _super.call(this) || this;\r\n        _this._onChangedHints = _this._register(new Emitter());\r\n        _this.onChangedHints = _this._onChangedHints.event;\r\n        _this.triggerOnType = false;\r\n        _this._state = ParameterHintState.Default;\r\n        _this._pendingTriggers = [];\r\n        _this._lastSignatureHelpResult = _this._register(new MutableDisposable());\r\n        _this.triggerChars = new CharacterSet();\r\n        _this.retriggerChars = new CharacterSet();\r\n        _this.triggerId = 0;\r\n        _this.editor = editor;\r\n        _this.throttledDelayer = new Delayer(delay);\r\n        _this._register(_this.editor.onDidChangeConfiguration(function () { return _this.onEditorConfigurationChange(); }));\r\n        _this._register(_this.editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeModelLanguage(function (_) { return _this.onModelChanged(); }));\r\n        _this._register(_this.editor.onDidChangeCursorSelection(function (e) { return _this.onCursorChange(e); }));\r\n        _this._register(_this.editor.onDidChangeModelContent(function (e) { return _this.onModelContentChange(); }));\r\n        _this._register(modes.SignatureHelpProviderRegistry.onDidChange(_this.onModelChanged, _this));\r\n        _this._register(_this.editor.onDidType(function (text) { return _this.onDidType(text); }));\r\n        _this.onEditorConfigurationChange();\r\n        _this.onModelChanged();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"state\", {\r\n        get: function () { return this._state; },\r\n        set: function (value) {\r\n            if (this._state.type === 2 /* Pending */) {\r\n                this._state.request.cancel();\r\n            }\r\n            this._state = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.cancel = function (silent) {\r\n        if (silent === void 0) { silent = false; }\r\n        this.state = ParameterHintState.Default;\r\n        this.throttledDelayer.cancel();\r\n        if (!silent) {\r\n            this._onChangedHints.fire(undefined);\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.trigger = function (context, delay) {\r\n        var _this = this;\r\n        var model = this.editor.getModel();\r\n        if (!model || !modes.SignatureHelpProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        var triggerId = ++this.triggerId;\r\n        this._pendingTriggers.push(context);\r\n        this.throttledDelayer.trigger(function () {\r\n            return _this.doTrigger(triggerId);\r\n        }, delay)\r\n            .catch(onUnexpectedError);\r\n    };\r\n    ParameterHintsModel.prototype.next = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var last = (activeSignature % length) === (length - 1);\r\n        var cycle = this.editor.getOption(64 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on last signature of list\r\n        if ((length < 2 || last) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\r\n    };\r\n    ParameterHintsModel.prototype.previous = function () {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        var length = this.state.hints.signatures.length;\r\n        var activeSignature = this.state.hints.activeSignature;\r\n        var first = activeSignature === 0;\r\n        var cycle = this.editor.getOption(64 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on first signature of list\r\n        if ((length < 2 || first) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\r\n    };\r\n    ParameterHintsModel.prototype.updateActiveSignature = function (activeSignature) {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        this.state = new ParameterHintState.Active(__assign(__assign({}, this.state.hints), { activeSignature: activeSignature }));\r\n        this._onChangedHints.fire(this.state.hints);\r\n    };\r\n    ParameterHintsModel.prototype.doTrigger = function (triggerId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var isRetrigger, activeSignatureHelp, context, triggerContext, model, position, result, error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        isRetrigger = this.state.type === 1 /* Active */ || this.state.type === 2 /* Pending */;\r\n                        activeSignatureHelp = this.state.type === 1 /* Active */ ? this.state.hints : undefined;\r\n                        this.cancel(true);\r\n                        if (this._pendingTriggers.length === 0) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        context = this._pendingTriggers.reduce(mergeTriggerContexts);\r\n                        this._pendingTriggers = [];\r\n                        triggerContext = {\r\n                            triggerKind: context.triggerKind,\r\n                            triggerCharacter: context.triggerCharacter,\r\n                            isRetrigger: isRetrigger,\r\n                            activeSignatureHelp: activeSignatureHelp\r\n                        };\r\n                        if (!this.editor.hasModel()) {\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        position = this.editor.getPosition();\r\n                        this.state = new ParameterHintState.Pending(createCancelablePromise(function (token) {\r\n                            return provideSignatureHelp(model, position, triggerContext, token);\r\n                        }));\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this.state.request];\r\n                    case 2:\r\n                        result = _a.sent();\r\n                        // Check that we are still resolving the correct signature help\r\n                        if (triggerId !== this.triggerId) {\r\n                            result === null || result === void 0 ? void 0 : result.dispose();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        if (!result || !result.value.signatures || result.value.signatures.length === 0) {\r\n                            result === null || result === void 0 ? void 0 : result.dispose();\r\n                            this._lastSignatureHelpResult.clear();\r\n                            this.cancel();\r\n                            return [2 /*return*/, false];\r\n                        }\r\n                        else {\r\n                            this.state = new ParameterHintState.Active(result.value);\r\n                            this._lastSignatureHelpResult.value = result;\r\n                            this._onChangedHints.fire(this.state.hints);\r\n                            return [2 /*return*/, true];\r\n                        }\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        error_1 = _a.sent();\r\n                        if (triggerId === this.triggerId) {\r\n                            this.state = ParameterHintState.Default;\r\n                        }\r\n                        onUnexpectedError(error_1);\r\n                        return [2 /*return*/, false];\r\n                    case 4: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(ParameterHintsModel.prototype, \"isTriggered\", {\r\n        get: function () {\r\n            return this.state.type === 1 /* Active */\r\n                || this.state.type === 2 /* Pending */\r\n                || this.throttledDelayer.isTriggered();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ParameterHintsModel.prototype.onModelChanged = function () {\r\n        this.cancel();\r\n        // Update trigger characters\r\n        this.triggerChars = new CharacterSet();\r\n        this.retriggerChars = new CharacterSet();\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (var _i = 0, _a = modes.SignatureHelpProviderRegistry.ordered(model); _i < _a.length; _i++) {\r\n            var support = _a[_i];\r\n            for (var _b = 0, _c = support.signatureHelpTriggerCharacters || []; _b < _c.length; _b++) {\r\n                var ch = _c[_b];\r\n                this.triggerChars.add(ch.charCodeAt(0));\r\n                // All trigger characters are also considered retrigger characters\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n            for (var _d = 0, _e = support.signatureHelpRetriggerCharacters || []; _d < _e.length; _d++) {\r\n                var ch = _e[_d];\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onDidType = function (text) {\r\n        if (!this.triggerOnType) {\r\n            return;\r\n        }\r\n        var lastCharIndex = text.length - 1;\r\n        var triggerCharCode = text.charCodeAt(lastCharIndex);\r\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\r\n            this.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.TriggerCharacter,\r\n                triggerCharacter: text.charAt(lastCharIndex),\r\n            });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onCursorChange = function (e) {\r\n        if (e.source === 'mouse') {\r\n            this.cancel();\r\n        }\r\n        else if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onModelContentChange = function () {\r\n        if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.onEditorConfigurationChange = function () {\r\n        this.triggerOnType = this.editor.getOption(64 /* parameterHints */).enabled;\r\n        if (!this.triggerOnType) {\r\n            this.cancel();\r\n        }\r\n    };\r\n    ParameterHintsModel.prototype.dispose = function () {\r\n        this.cancel(true);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ParameterHintsModel.DEFAULT_DELAY = 120; // ms\r\n    return ParameterHintsModel;\r\n}(Disposable));\r\nexport { ParameterHintsModel };\r\nfunction mergeTriggerContexts(previous, current) {\r\n    switch (current.triggerKind) {\r\n        case modes.SignatureHelpTriggerKind.Invoke:\r\n            // Invoke overrides previous triggers.\r\n            return current;\r\n        case modes.SignatureHelpTriggerKind.ContentChange:\r\n            // Ignore content changes triggers\r\n            return previous;\r\n        case modes.SignatureHelpTriggerKind.TriggerCharacter:\r\n        default:\r\n            return current;\r\n    }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { domEvent, stop } from '../../../base/browser/event.js';\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport './parameterHints.css';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { MarkdownRenderer } from '../markdown/markdownRenderer.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, textCodeBlockBackground, textLinkForeground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { HIGH_CONTRAST, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ParameterHintsModel } from './parameterHintsModel.js';\r\nimport { pad } from '../../../base/common/strings.js';\r\nvar $ = dom.$;\r\nvar ParameterHintsWidget = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsWidget, _super);\r\n    function ParameterHintsWidget(editor, contextKeyService, openerService, modeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.renderDisposeables = _this._register(new DisposableStore());\r\n        _this.visible = false;\r\n        _this.announcedLabel = null;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        _this.allowEditorOverflow = true;\r\n        _this.markdownRenderer = _this._register(new MarkdownRenderer(editor, modeService, openerService));\r\n        _this.model = _this._register(new ParameterHintsModel(editor));\r\n        _this.keyVisible = Context.Visible.bindTo(contextKeyService);\r\n        _this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\r\n        _this._register(_this.model.onChangedHints(function (newParameterHints) {\r\n            if (newParameterHints) {\r\n                _this.show();\r\n                _this.render(newParameterHints);\r\n            }\r\n            else {\r\n                _this.hide();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ParameterHintsWidget.prototype.createParamaterHintDOMNodes = function () {\r\n        var _this = this;\r\n        var element = $('.editor-widget.parameter-hints-widget');\r\n        var wrapper = dom.append(element, $('.wrapper'));\r\n        wrapper.tabIndex = -1;\r\n        var controls = dom.append(wrapper, $('.controls'));\r\n        var previous = dom.append(controls, $('.button.codicon.codicon-chevron-up'));\r\n        var overloads = dom.append(controls, $('.overloads'));\r\n        var next = dom.append(controls, $('.button.codicon.codicon-chevron-down'));\r\n        var onPreviousClick = stop(domEvent(previous, 'click'));\r\n        this._register(onPreviousClick(this.previous, this));\r\n        var onNextClick = stop(domEvent(next, 'click'));\r\n        this._register(onNextClick(this.next, this));\r\n        var body = $('.body');\r\n        var scrollbar = new DomScrollableElement(body, {});\r\n        this._register(scrollbar);\r\n        wrapper.appendChild(scrollbar.getDomNode());\r\n        var signature = dom.append(body, $('.signature'));\r\n        var docs = dom.append(body, $('.docs'));\r\n        element.style.userSelect = 'text';\r\n        this.domNodes = {\r\n            element: element,\r\n            signature: signature,\r\n            overloads: overloads,\r\n            docs: docs,\r\n            scrollbar: scrollbar,\r\n        };\r\n        this.editor.addContentWidget(this);\r\n        this.hide();\r\n        this._register(this.editor.onDidChangeCursorSelection(function (e) {\r\n            if (_this.visible) {\r\n                _this.editor.layoutContentWidget(_this);\r\n            }\r\n        }));\r\n        var updateFont = function () {\r\n            if (!_this.domNodes) {\r\n                return;\r\n            }\r\n            var fontInfo = _this.editor.getOption(34 /* fontInfo */);\r\n            _this.domNodes.element.style.fontSize = fontInfo.fontSize + \"px\";\r\n        };\r\n        updateFont();\r\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(function (e) { return e.hasChanged(34 /* fontInfo */); })\r\n            .on(updateFont, null));\r\n        this._register(this.editor.onDidLayoutChange(function (e) { return _this.updateMaxHeight(); }));\r\n        this.updateMaxHeight();\r\n    };\r\n    ParameterHintsWidget.prototype.show = function () {\r\n        var _this = this;\r\n        if (this.visible) {\r\n            return;\r\n        }\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        this.keyVisible.set(true);\r\n        this.visible = true;\r\n        setTimeout(function () {\r\n            if (_this.domNodes) {\r\n                dom.addClass(_this.domNodes.element, 'visible');\r\n            }\r\n        }, 100);\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.hide = function () {\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n        this.keyVisible.reset();\r\n        this.visible = false;\r\n        this.announcedLabel = null;\r\n        if (this.domNodes) {\r\n            dom.removeClass(this.domNodes.element, 'visible');\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    };\r\n    ParameterHintsWidget.prototype.getPosition = function () {\r\n        if (this.visible) {\r\n            return {\r\n                position: this.editor.getPosition(),\r\n                preference: [1 /* ABOVE */, 2 /* BELOW */]\r\n            };\r\n        }\r\n        return null;\r\n    };\r\n    ParameterHintsWidget.prototype.render = function (hints) {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var multiple = hints.signatures.length > 1;\r\n        dom.toggleClass(this.domNodes.element, 'multiple', multiple);\r\n        this.keyMultipleSignatures.set(multiple);\r\n        this.domNodes.signature.innerHTML = '';\r\n        this.domNodes.docs.innerHTML = '';\r\n        var signature = hints.signatures[hints.activeSignature];\r\n        if (!signature) {\r\n            return;\r\n        }\r\n        var code = dom.append(this.domNodes.signature, $('.code'));\r\n        var hasParameters = signature.parameters.length > 0;\r\n        var fontInfo = this.editor.getOption(34 /* fontInfo */);\r\n        code.style.fontSize = fontInfo.fontSize + \"px\";\r\n        code.style.fontFamily = fontInfo.fontFamily;\r\n        if (!hasParameters) {\r\n            var label = dom.append(code, $('span'));\r\n            label.textContent = signature.label;\r\n        }\r\n        else {\r\n            this.renderParameters(code, signature, hints.activeParameter);\r\n        }\r\n        this.renderDisposeables.clear();\r\n        var activeParameter = signature.parameters[hints.activeParameter];\r\n        if (activeParameter && activeParameter.documentation) {\r\n            var documentation = $('span.documentation');\r\n            if (typeof activeParameter.documentation === 'string') {\r\n                documentation.textContent = activeParameter.documentation;\r\n            }\r\n            else {\r\n                var renderedContents = this.markdownRenderer.render(activeParameter.documentation);\r\n                dom.addClass(renderedContents.element, 'markdown-docs');\r\n                this.renderDisposeables.add(renderedContents);\r\n                documentation.appendChild(renderedContents.element);\r\n            }\r\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\r\n        }\r\n        if (signature.documentation === undefined) { /** no op */ }\r\n        else if (typeof signature.documentation === 'string') {\r\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\r\n        }\r\n        else {\r\n            var renderedContents = this.markdownRenderer.render(signature.documentation);\r\n            dom.addClass(renderedContents.element, 'markdown-docs');\r\n            this.renderDisposeables.add(renderedContents);\r\n            dom.append(this.domNodes.docs, renderedContents.element);\r\n        }\r\n        var hasDocs = this.hasDocs(signature, activeParameter);\r\n        dom.toggleClass(this.domNodes.signature, 'has-docs', hasDocs);\r\n        dom.toggleClass(this.domNodes.docs, 'empty', !hasDocs);\r\n        this.domNodes.overloads.textContent =\r\n            pad(hints.activeSignature + 1, hints.signatures.length.toString().length) + '/' + hints.signatures.length;\r\n        if (activeParameter) {\r\n            var labelToAnnounce = this.getParameterLabel(signature, hints.activeParameter);\r\n            // Select method gets called on every user type while parameter hints are visible.\r\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\r\n            if (this.announcedLabel !== labelToAnnounce) {\r\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\r\n                this.announcedLabel = labelToAnnounce;\r\n            }\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n        this.domNodes.scrollbar.scanDomNode();\r\n    };\r\n    ParameterHintsWidget.prototype.hasDocs = function (signature, activeParameter) {\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'string' && activeParameter.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (activeParameter && typeof (activeParameter.documentation) === 'object' && activeParameter.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'string' && signature.documentation.length > 0) {\r\n            return true;\r\n        }\r\n        if (typeof (signature.documentation) === 'object' && signature.documentation.value.length > 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ParameterHintsWidget.prototype.renderParameters = function (parent, signature, currentParameter) {\r\n        var _a = this.getParameterLabelOffsets(signature, currentParameter), start = _a[0], end = _a[1];\r\n        var beforeSpan = document.createElement('span');\r\n        beforeSpan.textContent = signature.label.substring(0, start);\r\n        var paramSpan = document.createElement('span');\r\n        paramSpan.textContent = signature.label.substring(start, end);\r\n        paramSpan.className = 'parameter active';\r\n        var afterSpan = document.createElement('span');\r\n        afterSpan.textContent = signature.label.substring(end);\r\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabel = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (typeof param.label === 'string') {\r\n            return param.label;\r\n        }\r\n        else {\r\n            return signature.label.substring(param.label[0], param.label[1]);\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.getParameterLabelOffsets = function (signature, paramIdx) {\r\n        var param = signature.parameters[paramIdx];\r\n        if (!param) {\r\n            return [0, 0];\r\n        }\r\n        else if (Array.isArray(param.label)) {\r\n            return param.label;\r\n        }\r\n        else {\r\n            var idx = signature.label.lastIndexOf(param.label);\r\n            return idx >= 0\r\n                ? [idx, idx + param.label.length]\r\n                : [0, 0];\r\n        }\r\n    };\r\n    ParameterHintsWidget.prototype.next = function () {\r\n        this.editor.focus();\r\n        this.model.next();\r\n    };\r\n    ParameterHintsWidget.prototype.previous = function () {\r\n        this.editor.focus();\r\n        this.model.previous();\r\n    };\r\n    ParameterHintsWidget.prototype.cancel = function () {\r\n        this.model.cancel();\r\n    };\r\n    ParameterHintsWidget.prototype.getDomNode = function () {\r\n        if (!this.domNodes) {\r\n            this.createParamaterHintDOMNodes();\r\n        }\r\n        return this.domNodes.element;\r\n    };\r\n    ParameterHintsWidget.prototype.getId = function () {\r\n        return ParameterHintsWidget.ID;\r\n    };\r\n    ParameterHintsWidget.prototype.trigger = function (context) {\r\n        this.model.trigger(context, 0);\r\n    };\r\n    ParameterHintsWidget.prototype.updateMaxHeight = function () {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        var height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\r\n        var maxHeight = height + \"px\";\r\n        this.domNodes.element.style.maxHeight = maxHeight;\r\n        var wrapper = this.domNodes.element.getElementsByClassName('wrapper');\r\n        if (wrapper.length) {\r\n            wrapper[0].style.maxHeight = maxHeight;\r\n        }\r\n    };\r\n    ParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\r\n    ParameterHintsWidget = __decorate([\r\n        __param(1, IContextKeyService),\r\n        __param(2, IOpenerService),\r\n        __param(3, IModeService)\r\n    ], ParameterHintsWidget);\r\n    return ParameterHintsWidget;\r\n}(Disposable));\r\nexport { ParameterHintsWidget };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        var borderWidth = theme.type === HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { border: \" + borderWidth + \"px solid \" + border + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid \" + border.transparent(0.5) + \"; }\");\r\n    }\r\n    var background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { background-color: \" + background + \"; }\");\r\n    }\r\n    var link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget a { color: \" + link + \"; }\");\r\n    }\r\n    var foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget { color: \" + foreground + \"; }\");\r\n    }\r\n    var codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(\".monaco-editor .parameter-hints-widget code { background-color: \" + codeBackground + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as modes from '../../common/modes.js';\r\nvar ParameterHintsController = /** @class */ (function (_super) {\r\n    __extends(ParameterHintsController, _super);\r\n    function ParameterHintsController(editor, instantiationService) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this.widget = _this._register(instantiationService.createInstance(ParameterHintsWidget, _this.editor));\r\n        return _this;\r\n    }\r\n    ParameterHintsController.get = function (editor) {\r\n        return editor.getContribution(ParameterHintsController.ID);\r\n    };\r\n    ParameterHintsController.prototype.cancel = function () {\r\n        this.widget.cancel();\r\n    };\r\n    ParameterHintsController.prototype.previous = function () {\r\n        this.widget.previous();\r\n    };\r\n    ParameterHintsController.prototype.next = function () {\r\n        this.widget.next();\r\n    };\r\n    ParameterHintsController.prototype.trigger = function (context) {\r\n        this.widget.trigger(context);\r\n    };\r\n    ParameterHintsController.ID = 'editor.controller.parameterHints';\r\n    ParameterHintsController = __decorate([\r\n        __param(1, IInstantiationService)\r\n    ], ParameterHintsController);\r\n    return ParameterHintsController;\r\n}(Disposable));\r\nvar TriggerParameterHintsAction = /** @class */ (function (_super) {\r\n    __extends(TriggerParameterHintsAction, _super);\r\n    function TriggerParameterHintsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.triggerParameterHints',\r\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\r\n            alias: 'Trigger Parameter Hints',\r\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 10 /* Space */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TriggerParameterHintsAction.prototype.run = function (accessor, editor) {\r\n        var controller = ParameterHintsController.get(editor);\r\n        if (controller) {\r\n            controller.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.Invoke\r\n            });\r\n        }\r\n    };\r\n    return TriggerParameterHintsAction;\r\n}(EditorAction));\r\nexport { TriggerParameterHintsAction };\r\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController);\r\nregisterEditorAction(TriggerParameterHintsAction);\r\nvar weight = 100 /* EditorContrib */ + 75;\r\nvar ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'closeParameterHints',\r\n    precondition: Context.Visible,\r\n    handler: function (x) { return x.cancel(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showPrevParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.previous(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [512 /* Alt */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showNextParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: function (x) { return x.next(); },\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [512 /* Alt */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nvar CopyLinesCommand = /** @class */ (function () {\r\n    function CopyLinesCommand(selection, isCopyingDown) {\r\n        this._selection = selection;\r\n        this._isCopyingDown = isCopyingDown;\r\n        this._selectionDirection = 0 /* LTR */;\r\n        this._selectionId = null;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n    }\r\n    CopyLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var s = this._selection;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._endLineNumberDelta = 1;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var sourceLines = [];\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            sourceLines.push(model.getLineContent(i));\r\n        }\r\n        var sourceText = sourceLines.join('\\n');\r\n        if (sourceText === '') {\r\n            // Duplicating empty line\r\n            if (this._isCopyingDown) {\r\n                this._startLineNumberDelta++;\r\n                this._endLineNumberDelta++;\r\n            }\r\n        }\r\n        if (!this._isCopyingDown) {\r\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\r\n        }\r\n        else {\r\n            builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        this._selectionDirection = this._selection.getDirection();\r\n    };\r\n    CopyLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\r\n            var startLineNumber = result.startLineNumber;\r\n            var startColumn = result.startColumn;\r\n            var endLineNumber = result.endLineNumber;\r\n            var endColumn = result.endColumn;\r\n            if (this._startLineNumberDelta !== 0) {\r\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\r\n                startColumn = 1;\r\n            }\r\n            if (this._endLineNumberDelta !== 0) {\r\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\r\n                endColumn = 1;\r\n            }\r\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\r\n        }\r\n        return result;\r\n    };\r\n    return CopyLinesCommand;\r\n}());\r\nexport { CopyLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function getSpaceCnt(str, tabSize) {\r\n    var spacesCnt = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        if (str.charAt(i) === '\\t') {\r\n            spacesCnt += tabSize;\r\n        }\r\n        else {\r\n            spacesCnt++;\r\n        }\r\n    }\r\n    return spacesCnt;\r\n}\r\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\r\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\r\n    var result = '';\r\n    if (!insertSpaces) {\r\n        var tabsCnt = Math.floor(spacesCnt / tabSize);\r\n        spacesCnt = spacesCnt % tabSize;\r\n        for (var i = 0; i < tabsCnt; i++) {\r\n            result += '\\t';\r\n        }\r\n    }\r\n    for (var i = 0; i < spacesCnt; i++) {\r\n        result += ' ';\r\n    }\r\n    return result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ShiftCommand } from '../../common/commands/shiftCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { IndentAction } from '../../common/modes/languageConfiguration.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport * as indentUtils from '../indentation/indentUtils.js';\r\nvar MoveLinesCommand = /** @class */ (function () {\r\n    function MoveLinesCommand(selection, isMovingDown, autoIndent) {\r\n        this._selection = selection;\r\n        this._isMovingDown = isMovingDown;\r\n        this._autoIndent = autoIndent;\r\n        this._selectionId = null;\r\n        this._moveEndLineSelectionShrink = false;\r\n    }\r\n    MoveLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var modelLineCount = model.getLineCount();\r\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        this._moveEndPositionDown = false;\r\n        var s = this._selection;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        var _a = model.getOptions(), tabSize = _a.tabSize, indentSize = _a.indentSize, insertSpaces = _a.insertSpaces;\r\n        var indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\r\n        var virtualModel = {\r\n            getLineTokens: function (lineNumber) {\r\n                return model.getLineTokens(lineNumber);\r\n            },\r\n            getLanguageIdentifier: function () {\r\n                return model.getLanguageIdentifier();\r\n            },\r\n            getLanguageIdAtPosition: function (lineNumber, column) {\r\n                return model.getLanguageIdAtPosition(lineNumber, column);\r\n            },\r\n            getLineContent: null,\r\n        };\r\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\r\n            // Current line is empty\r\n            var lineNumber = s.startLineNumber;\r\n            var otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\r\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\r\n                // Other line number is empty too, so no editing is needed\r\n                // Add a no-op to force running by the model\r\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\r\n            }\r\n            else {\r\n                // Type content from other line number on line number\r\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\r\n                // Remove content from other line number\r\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\r\n            }\r\n            // Track selection at the other line number\r\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\r\n        }\r\n        else {\r\n            var movingLineNumber_1;\r\n            var movingLineText = void 0;\r\n            if (this._isMovingDown) {\r\n                movingLineNumber_1 = s.endLineNumber + 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1 - 1, model.getLineMaxColumn(movingLineNumber_1 - 1), movingLineNumber_1, model.getLineMaxColumn(movingLineNumber_1)), null);\r\n                var insertingText_1 = movingLineText;\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    var movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber_1, s.startLineNumber - 1);\r\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\r\n                    if (movingLineMatchResult !== null) {\r\n                        var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                        var newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                        var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                        insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                    }\r\n                    else {\r\n                        // no enter rule matches, let's check indentatin rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return model.getLineContent(movingLineNumber_1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var indentOfMovingLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber, indentConverter);\r\n                        if (indentOfMovingLine !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber_1));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                                insertingText_1 = newIndentation + this.trimLeft(movingLineText);\r\n                            }\r\n                        }\r\n                    }\r\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\r\n                    // to s.startLineNumber\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber, insertingText_1);\r\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match onEnter rules, let's check indentation rules then.\r\n                        virtualModel.getLineContent = function (lineNumber) {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return insertingText_1;\r\n                            }\r\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\r\n                                return model.getLineContent(lineNumber - 1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        var newIndentatOfMovingBlock = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber_1, 1), s.startLineNumber + 1, indentConverter);\r\n                        if (newIndentatOfMovingBlock !== null) {\r\n                            var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Insert line that needs to be moved before\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText_1 + '\\n');\r\n                }\r\n            }\r\n            else {\r\n                movingLineNumber_1 = s.startLineNumber - 1;\r\n                movingLineText = model.getLineContent(movingLineNumber_1);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber_1, 1, movingLineNumber_1 + 1, 1), null);\r\n                // Insert line that needs to be moved after\r\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    virtualModel.getLineContent = function (lineNumber) {\r\n                        if (lineNumber === movingLineNumber_1) {\r\n                            return model.getLineContent(s.startLineNumber);\r\n                        }\r\n                        else {\r\n                            return model.getLineContent(lineNumber);\r\n                        }\r\n                    };\r\n                    var ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\r\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\r\n                        var indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber_1, indentConverter);\r\n                        if (indentOfFirstLine !== null) {\r\n                            // adjust the indentation of the moving block\r\n                            var oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            var newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\r\n                            var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                var spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    };\r\n    MoveLinesCommand.prototype.buildIndentConverter = function (tabSize, indentSize, insertSpaces) {\r\n        return {\r\n            shiftIndent: function (indentation) {\r\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            },\r\n            unshiftIndent: function (indentation) {\r\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            }\r\n        };\r\n    };\r\n    MoveLinesCommand.prototype.matchEnterRule = function (model, indentConverter, tabSize, line, oneLineAbove, oneLineAboveText) {\r\n        var validPrecedingLine = oneLineAbove;\r\n        while (validPrecedingLine >= 1) {\r\n            // ship empty lines as empty lines just inherit indentation\r\n            var lineContent = void 0;\r\n            if (validPrecedingLine === oneLineAbove && oneLineAboveText !== undefined) {\r\n                lineContent = oneLineAboveText;\r\n            }\r\n            else {\r\n                lineContent = model.getLineContent(validPrecedingLine);\r\n            }\r\n            var nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\r\n            if (nonWhitespaceIdx >= 0) {\r\n                break;\r\n            }\r\n            validPrecedingLine--;\r\n        }\r\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\r\n            return null;\r\n        }\r\n        var maxColumn = model.getLineMaxColumn(validPrecedingLine);\r\n        var enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn));\r\n        if (enter) {\r\n            var enterPrefix = enter.indentation;\r\n            if (enter.indentAction === IndentAction.None) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Indent) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\r\n                enterPrefix = enter.indentation;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Outdent) {\r\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\r\n            }\r\n            var movingLineText = model.getLineContent(line);\r\n            if (this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix)) >= 0) {\r\n                var oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\r\n                var newIndentation = strings.getLeadingWhitespace(enterPrefix);\r\n                var indentMetadataOfMovelingLine = LanguageConfigurationRegistry.getIndentMetadata(model, line);\r\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* DECREASE_MASK */) {\r\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\r\n                }\r\n                var newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\r\n                var oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                return newSpaceCnt - oldSpaceCnt;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    MoveLinesCommand.prototype.trimLeft = function (str) {\r\n        return str.replace(/^\\s+/, '');\r\n    };\r\n    MoveLinesCommand.prototype.shouldAutoIndent = function (model, selection) {\r\n        if (this._autoIndent < 4 /* Full */) {\r\n            return false;\r\n        }\r\n        // if it's not easy to tokenize, we stop auto indent.\r\n        if (!model.isCheapToTokenize(selection.startLineNumber)) {\r\n            return false;\r\n        }\r\n        var languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\r\n        var languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\r\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\r\n            return false;\r\n        }\r\n        if (LanguageConfigurationRegistry.getIndentRulesSupport(languageAtSelectionStart) === null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    MoveLinesCommand.prototype.getIndentEditsOfMovingBlock = function (model, builder, s, tabSize, insertSpaces, offset) {\r\n        for (var i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            var lineContent = model.getLineContent(i);\r\n            var originalIndent = strings.getLeadingWhitespace(lineContent);\r\n            var originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\r\n            var newSpacesCnt = originalSpacesCnt + offset;\r\n            var newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\r\n            if (newIndent !== originalIndent) {\r\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\r\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\r\n                    // as users select part of the original indent white spaces\r\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\r\n                    this._moveEndLineSelectionShrink = true;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    MoveLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        var result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\r\n            result = result.setEndPosition(result.endLineNumber, 2);\r\n        }\r\n        return result;\r\n    };\r\n    return MoveLinesCommand;\r\n}());\r\nexport { MoveLinesCommand };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar SortLinesCommand = /** @class */ (function () {\r\n    function SortLinesCommand(selection, descending) {\r\n        this.selection = selection;\r\n        this.descending = descending;\r\n        this.selectionId = null;\r\n    }\r\n    SortLinesCommand.getCollator = function () {\r\n        if (!SortLinesCommand._COLLATOR) {\r\n            SortLinesCommand._COLLATOR = new Intl.Collator();\r\n        }\r\n        return SortLinesCommand._COLLATOR;\r\n    };\r\n    SortLinesCommand.prototype.getEditOperations = function (model, builder) {\r\n        var op = sortLines(model, this.selection, this.descending);\r\n        if (op) {\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n    };\r\n    SortLinesCommand.prototype.computeCursorState = function (model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    };\r\n    SortLinesCommand.canRun = function (model, selection, descending) {\r\n        if (model === null) {\r\n            return false;\r\n        }\r\n        var data = getSortData(model, selection, descending);\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        for (var i = 0, len = data.before.length; i < len; i++) {\r\n            if (data.before[i] !== data.after[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    SortLinesCommand._COLLATOR = null;\r\n    return SortLinesCommand;\r\n}());\r\nexport { SortLinesCommand };\r\nfunction getSortData(model, selection, descending) {\r\n    var startLineNumber = selection.startLineNumber;\r\n    var endLineNumber = selection.endLineNumber;\r\n    if (selection.endColumn === 1) {\r\n        endLineNumber--;\r\n    }\r\n    // Nothing to sort if user didn't select anything.\r\n    if (startLineNumber >= endLineNumber) {\r\n        return null;\r\n    }\r\n    var linesToSort = [];\r\n    // Get the contents of the selection to be sorted.\r\n    for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n        linesToSort.push(model.getLineContent(lineNumber));\r\n    }\r\n    var sorted = linesToSort.slice(0);\r\n    sorted.sort(SortLinesCommand.getCollator().compare);\r\n    // If descending, reverse the order.\r\n    if (descending === true) {\r\n        sorted = sorted.reverse();\r\n    }\r\n    return {\r\n        startLineNumber: startLineNumber,\r\n        endLineNumber: endLineNumber,\r\n        before: linesToSort,\r\n        after: sorted\r\n    };\r\n}\r\n/**\r\n * Generate commands for sorting lines on a model.\r\n */\r\nfunction sortLines(model, selection, descending) {\r\n    var data = getSortData(model, selection, descending);\r\n    if (!data) {\r\n        return null;\r\n    }\r\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { CoreEditingCommands } from '../../browser/controller/coreCommands.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../common/commands/replaceCommand.js';\r\nimport { TrimTrailingWhitespaceCommand } from '../../common/commands/trimTrailingWhitespaceCommand.js';\r\nimport { TypeOperations } from '../../common/controller/cursorTypeOperations.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CopyLinesCommand } from './copyLinesCommand.js';\r\nimport { MoveLinesCommand } from './moveLinesCommand.js';\r\nimport { SortLinesCommand } from './sortLinesCommand.js';\r\n// copy lines\r\nvar AbstractCopyLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCopyLinesAction, _super);\r\n    function AbstractCopyLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractCopyLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var selection = selections_1[_i];\r\n            commands.push(new CopyLinesCommand(selection, this.down));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCopyLinesAction;\r\n}(EditorAction));\r\nvar CopyLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesUpAction, _super);\r\n    function CopyLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.copyLinesUpAction',\r\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\r\n            alias: 'Copy Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\r\n                order: 1\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesUpAction;\r\n}(AbstractCopyLinesAction));\r\nvar CopyLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(CopyLinesDownAction, _super);\r\n    function CopyLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.copyLinesDownAction',\r\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\r\n            alias: 'Copy Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    return CopyLinesDownAction;\r\n}(AbstractCopyLinesAction));\r\nvar DuplicateSelectionAction = /** @class */ (function (_super) {\r\n    __extends(DuplicateSelectionAction, _super);\r\n    function DuplicateSelectionAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.duplicateSelection',\r\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\r\n            alias: 'Duplicate Selection',\r\n            precondition: EditorContextKeys.writable,\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    DuplicateSelectionAction.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        var selections = editor.getSelections();\r\n        var model = editor.getModel();\r\n        for (var _i = 0, selections_2 = selections; _i < selections_2.length; _i++) {\r\n            var selection = selections_2[_i];\r\n            if (selection.isEmpty()) {\r\n                commands.push(new CopyLinesCommand(selection, true));\r\n            }\r\n            else {\r\n                var insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\r\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return DuplicateSelectionAction;\r\n}(EditorAction));\r\nexport { DuplicateSelectionAction };\r\n// move lines\r\nvar AbstractMoveLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractMoveLinesAction, _super);\r\n    function AbstractMoveLinesAction(down, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.down = down;\r\n        return _this;\r\n    }\r\n    AbstractMoveLinesAction.prototype.run = function (_accessor, editor) {\r\n        var commands = [];\r\n        var selections = editor.getSelections() || [];\r\n        var autoIndent = editor.getOption(8 /* autoIndent */);\r\n        for (var _i = 0, selections_3 = selections; _i < selections_3.length; _i++) {\r\n            var selection = selections_3[_i];\r\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractMoveLinesAction;\r\n}(EditorAction));\r\nvar MoveLinesUpAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesUpAction, _super);\r\n    function MoveLinesUpAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.moveLinesUpAction',\r\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\r\n            alias: 'Move Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: { primary: 512 /* Alt */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesUpAction;\r\n}(AbstractMoveLinesAction));\r\nvar MoveLinesDownAction = /** @class */ (function (_super) {\r\n    __extends(MoveLinesDownAction, _super);\r\n    function MoveLinesDownAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.moveLinesDownAction',\r\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\r\n            alias: 'Move Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: { primary: 512 /* Alt */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    return MoveLinesDownAction;\r\n}(AbstractMoveLinesAction));\r\nvar AbstractSortLinesAction = /** @class */ (function (_super) {\r\n    __extends(AbstractSortLinesAction, _super);\r\n    function AbstractSortLinesAction(descending, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this.descending = descending;\r\n        return _this;\r\n    }\r\n    AbstractSortLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections() || [];\r\n        for (var _i = 0, selections_4 = selections; _i < selections_4.length; _i++) {\r\n            var selection = selections_4[_i];\r\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\r\n                return;\r\n            }\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractSortLinesAction;\r\n}(EditorAction));\r\nexport { AbstractSortLinesAction };\r\nvar SortLinesAscendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesAscendingAction, _super);\r\n    function SortLinesAscendingAction() {\r\n        return _super.call(this, false, {\r\n            id: 'editor.action.sortLinesAscending',\r\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\r\n            alias: 'Sort Lines Ascending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesAscendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesAscendingAction };\r\nvar SortLinesDescendingAction = /** @class */ (function (_super) {\r\n    __extends(SortLinesDescendingAction, _super);\r\n    function SortLinesDescendingAction() {\r\n        return _super.call(this, true, {\r\n            id: 'editor.action.sortLinesDescending',\r\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\r\n            alias: 'Sort Lines Descending',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    return SortLinesDescendingAction;\r\n}(AbstractSortLinesAction));\r\nexport { SortLinesDescendingAction };\r\nvar TrimTrailingWhitespaceAction = /** @class */ (function (_super) {\r\n    __extends(TrimTrailingWhitespaceAction, _super);\r\n    function TrimTrailingWhitespaceAction() {\r\n        return _super.call(this, {\r\n            id: TrimTrailingWhitespaceAction.ID,\r\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\r\n            alias: 'Trim Trailing Whitespace',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 54 /* KEY_X */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    TrimTrailingWhitespaceAction.prototype.run = function (_accessor, editor, args) {\r\n        var cursors = [];\r\n        if (args.reason === 'auto-save') {\r\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\r\n            // It is very convenient for the editor config extension to invoke this action.\r\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\r\n            cursors = (editor.getSelections() || []).map(function (s) { return new Position(s.positionLineNumber, s.positionColumn); });\r\n        }\r\n        var selection = editor.getSelection();\r\n        if (selection === null) {\r\n            return;\r\n        }\r\n        var command = new TrimTrailingWhitespaceCommand(selection, cursors);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n    };\r\n    TrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\r\n    return TrimTrailingWhitespaceAction;\r\n}(EditorAction));\r\nexport { TrimTrailingWhitespaceAction };\r\nvar DeleteLinesAction = /** @class */ (function (_super) {\r\n    __extends(DeleteLinesAction, _super);\r\n    function DeleteLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.deleteLines',\r\n            label: nls.localize('lines.delete', \"Delete Line\"),\r\n            alias: 'Delete Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 41 /* KEY_K */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteLinesAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var ops = this._getLinesToRemove(editor);\r\n        var model = editor.getModel();\r\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n            // Model is empty\r\n            return;\r\n        }\r\n        var linesDeleted = 0;\r\n        var edits = [];\r\n        var cursorState = [];\r\n        for (var i = 0, len = ops.length; i < len; i++) {\r\n            var op = ops[i];\r\n            var startLineNumber = op.startLineNumber;\r\n            var endLineNumber = op.endLineNumber;\r\n            var startColumn = 1;\r\n            var endColumn = model.getLineMaxColumn(endLineNumber);\r\n            if (endLineNumber < model.getLineCount()) {\r\n                endLineNumber += 1;\r\n                endColumn = 1;\r\n            }\r\n            else if (startLineNumber > 1) {\r\n                startLineNumber -= 1;\r\n                startColumn = model.getLineMaxColumn(startLineNumber);\r\n            }\r\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\r\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\r\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, cursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    DeleteLinesAction.prototype._getLinesToRemove = function (editor) {\r\n        // Construct delete operations\r\n        var operations = editor.getSelections().map(function (s) {\r\n            var endLineNumber = s.endLineNumber;\r\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n                endLineNumber -= 1;\r\n            }\r\n            return {\r\n                startLineNumber: s.startLineNumber,\r\n                selectionStartColumn: s.selectionStartColumn,\r\n                endLineNumber: endLineNumber,\r\n                positionColumn: s.positionColumn\r\n            };\r\n        });\r\n        // Sort delete operations\r\n        operations.sort(function (a, b) {\r\n            if (a.startLineNumber === b.startLineNumber) {\r\n                return a.endLineNumber - b.endLineNumber;\r\n            }\r\n            return a.startLineNumber - b.startLineNumber;\r\n        });\r\n        // Merge delete operations which are adjacent or overlapping\r\n        var mergedOperations = [];\r\n        var previousOperation = operations[0];\r\n        for (var i = 1; i < operations.length; i++) {\r\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\r\n                // Merge current operations into the previous one\r\n                previousOperation.endLineNumber = operations[i].endLineNumber;\r\n            }\r\n            else {\r\n                // Push previous operation\r\n                mergedOperations.push(previousOperation);\r\n                previousOperation = operations[i];\r\n            }\r\n        }\r\n        // Push the last operation\r\n        mergedOperations.push(previousOperation);\r\n        return mergedOperations;\r\n    };\r\n    return DeleteLinesAction;\r\n}(EditorAction));\r\nexport { DeleteLinesAction };\r\nvar IndentLinesAction = /** @class */ (function (_super) {\r\n    __extends(IndentLinesAction, _super);\r\n    function IndentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.indentLines',\r\n            label: nls.localize('lines.indent', \"Indent Line\"),\r\n            alias: 'Indent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    IndentLinesAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.indent(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n        editor.pushUndoStop();\r\n    };\r\n    return IndentLinesAction;\r\n}(EditorAction));\r\nexport { IndentLinesAction };\r\nvar OutdentLinesAction = /** @class */ (function (_super) {\r\n    __extends(OutdentLinesAction, _super);\r\n    function OutdentLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.outdentLines',\r\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\r\n            alias: 'Outdent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    OutdentLinesAction.prototype.run = function (_accessor, editor) {\r\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\r\n    };\r\n    return OutdentLinesAction;\r\n}(EditorAction));\r\nvar InsertLineBeforeAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineBeforeAction, _super);\r\n    function InsertLineBeforeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineBefore',\r\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\r\n            alias: 'Insert Line Above',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineBeforeAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineBeforeAction;\r\n}(EditorAction));\r\nexport { InsertLineBeforeAction };\r\nvar InsertLineAfterAction = /** @class */ (function (_super) {\r\n    __extends(InsertLineAfterAction, _super);\r\n    function InsertLineAfterAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertLineAfter',\r\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\r\n            alias: 'Insert Line Below',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertLineAfterAction.prototype.run = function (_accessor, editor) {\r\n        var cursors = editor._getCursors();\r\n        if (!cursors) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(cursors.context.config, editor.getModel(), editor.getSelections()));\r\n    };\r\n    return InsertLineAfterAction;\r\n}(EditorAction));\r\nexport { InsertLineAfterAction };\r\nvar AbstractDeleteAllToBoundaryAction = /** @class */ (function (_super) {\r\n    __extends(AbstractDeleteAllToBoundaryAction, _super);\r\n    function AbstractDeleteAllToBoundaryAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractDeleteAllToBoundaryAction.prototype.run = function (_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        var rangesToDelete = this._getRangesToDelete(editor);\r\n        // merge overlapping selections\r\n        var effectiveRanges = [];\r\n        for (var i = 0, count = rangesToDelete.length - 1; i < count; i++) {\r\n            var range = rangesToDelete[i];\r\n            var nextRange = rangesToDelete[i + 1];\r\n            if (Range.intersectRanges(range, nextRange) === null) {\r\n                effectiveRanges.push(range);\r\n            }\r\n            else {\r\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\r\n            }\r\n        }\r\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\r\n        var endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\r\n        var edits = effectiveRanges.map(function (range) {\r\n            return EditOperation.replace(range, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractDeleteAllToBoundaryAction;\r\n}(EditorAction));\r\nexport { AbstractDeleteAllToBoundaryAction };\r\nvar DeleteAllLeftAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllLeftAction, _super);\r\n    function DeleteAllLeftAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllLeft',\r\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\r\n            alias: 'Delete All Left',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllLeftAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        var deletedLines = 0;\r\n        rangesToDelete.forEach(function (range) {\r\n            var endCursor;\r\n            if (range.endColumn === 1 && deletedLines > 0) {\r\n                var newStartLine = range.startLineNumber - deletedLines;\r\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\r\n            }\r\n            else {\r\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n            }\r\n            deletedLines += range.endLineNumber - range.startLineNumber;\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        });\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllLeftAction.prototype._getRangesToDelete = function (editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections;\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        rangesToDelete = rangesToDelete.map(function (selection) {\r\n            if (selection.isEmpty()) {\r\n                if (selection.startColumn === 1) {\r\n                    var deleteFromLine = Math.max(1, selection.startLineNumber - 1);\r\n                    var deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineContent(deleteFromLine).length + 1;\r\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\r\n                }\r\n                else {\r\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\r\n                }\r\n            }\r\n            else {\r\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\r\n            }\r\n        });\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllLeftAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllLeftAction };\r\nvar DeleteAllRightAction = /** @class */ (function (_super) {\r\n    __extends(DeleteAllRightAction, _super);\r\n    function DeleteAllRightAction() {\r\n        return _super.call(this, {\r\n            id: 'deleteAllRight',\r\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\r\n            alias: 'Delete All Right',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 41 /* KEY_K */, secondary: [2048 /* CtrlCmd */ | 20 /* Delete */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    DeleteAllRightAction.prototype._getEndCursorState = function (primaryCursor, rangesToDelete) {\r\n        var endPrimaryCursor = null;\r\n        var endCursorState = [];\r\n        for (var i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\r\n            var range = rangesToDelete[i];\r\n            var endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        }\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    };\r\n    DeleteAllRightAction.prototype._getRangesToDelete = function (editor) {\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        var rangesToDelete = selections.map(function (sel) {\r\n            if (sel.isEmpty()) {\r\n                var maxColumn = model.getLineMaxColumn(sel.startLineNumber);\r\n                if (sel.startColumn === maxColumn) {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\r\n                }\r\n                else {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\r\n                }\r\n            }\r\n            return sel;\r\n        });\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        return rangesToDelete;\r\n    };\r\n    return DeleteAllRightAction;\r\n}(AbstractDeleteAllToBoundaryAction));\r\nexport { DeleteAllRightAction };\r\nvar JoinLinesAction = /** @class */ (function (_super) {\r\n    __extends(JoinLinesAction, _super);\r\n    function JoinLinesAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.joinLines',\r\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\r\n            alias: 'Join Lines',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 40 /* KEY_J */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    JoinLinesAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var primaryCursor = editor.getSelection();\r\n        if (primaryCursor === null) {\r\n            return;\r\n        }\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        var reducedSelections = [];\r\n        var lastSelection = selections.reduce(function (previousValue, currentValue) {\r\n            if (previousValue.isEmpty()) {\r\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\r\n                    if (primaryCursor.equalsSelection(previousValue)) {\r\n                        primaryCursor = currentValue;\r\n                    }\r\n                    return currentValue;\r\n                }\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n            else {\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n        });\r\n        reducedSelections.push(lastSelection);\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var edits = [];\r\n        var endCursorState = [];\r\n        var endPrimaryCursor = primaryCursor;\r\n        var lineOffset = 0;\r\n        for (var i = 0, len = reducedSelections.length; i < len; i++) {\r\n            var selection = reducedSelections[i];\r\n            var startLineNumber = selection.startLineNumber;\r\n            var startColumn = 1;\r\n            var columnDeltaOffset = 0;\r\n            var endLineNumber = void 0, endColumn = void 0;\r\n            var selectionEndPositionOffset = model.getLineContent(selection.endLineNumber).length - selection.endColumn;\r\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\r\n                var position = selection.getStartPosition();\r\n                if (position.lineNumber < model.getLineCount()) {\r\n                    endLineNumber = startLineNumber + 1;\r\n                    endColumn = model.getLineMaxColumn(endLineNumber);\r\n                }\r\n                else {\r\n                    endLineNumber = position.lineNumber;\r\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                }\r\n            }\r\n            else {\r\n                endLineNumber = selection.endLineNumber;\r\n                endColumn = model.getLineMaxColumn(endLineNumber);\r\n            }\r\n            var trimmedLinesContent = model.getLineContent(startLineNumber);\r\n            for (var i_1 = startLineNumber + 1; i_1 <= endLineNumber; i_1++) {\r\n                var lineText = model.getLineContent(i_1);\r\n                var firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i_1);\r\n                if (firstNonWhitespaceIdx >= 1) {\r\n                    var insertSpace = true;\r\n                    if (trimmedLinesContent === '') {\r\n                        insertSpace = false;\r\n                    }\r\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\r\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\r\n                        insertSpace = false;\r\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\r\n                    }\r\n                    var lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\r\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\r\n                    if (insertSpace) {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\r\n                    }\r\n                    else {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length;\r\n                    }\r\n                }\r\n                else {\r\n                    columnDeltaOffset = 0;\r\n                }\r\n            }\r\n            var deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n            if (!deleteSelection.isEmpty()) {\r\n                var resultSelection = void 0;\r\n                if (selection.isEmpty()) {\r\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\r\n                }\r\n                else {\r\n                    if (selection.startLineNumber === selection.endLineNumber) {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\r\n                    }\r\n                    else {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\r\n                    }\r\n                }\r\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\r\n                    endPrimaryCursor = resultSelection;\r\n                }\r\n                else {\r\n                    endCursorState.push(resultSelection);\r\n                }\r\n            }\r\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\r\n        }\r\n        endCursorState.unshift(endPrimaryCursor);\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    };\r\n    return JoinLinesAction;\r\n}(EditorAction));\r\nexport { JoinLinesAction };\r\nvar TransposeAction = /** @class */ (function (_super) {\r\n    __extends(TransposeAction, _super);\r\n    function TransposeAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transpose',\r\n            label: nls.localize('editor.transpose', \"Transpose characters around the cursor\"),\r\n            alias: 'Transpose characters around the cursor',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TransposeAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            var cursor = selection.getStartPosition();\r\n            var maxColumn = model.getLineMaxColumn(cursor.lineNumber);\r\n            if (cursor.column >= maxColumn) {\r\n                if (cursor.lineNumber === model.getLineCount()) {\r\n                    continue;\r\n                }\r\n                // The cursor is at the end of current line and current line is not empty\r\n                // then we transpose the character before the cursor and the line break if there is any following line.\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\r\n            }\r\n            else {\r\n                var deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\r\n                var chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return TransposeAction;\r\n}(EditorAction));\r\nexport { TransposeAction };\r\nvar AbstractCaseAction = /** @class */ (function (_super) {\r\n    __extends(AbstractCaseAction, _super);\r\n    function AbstractCaseAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AbstractCaseAction.prototype.run = function (_accessor, editor) {\r\n        var selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        var wordSeparators = editor.getOption(96 /* wordSeparators */);\r\n        var commands = [];\r\n        for (var i = 0, len = selections.length; i < len; i++) {\r\n            var selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                var cursor = selection.getStartPosition();\r\n                var word = model.getWordAtPosition(cursor);\r\n                if (!word) {\r\n                    continue;\r\n                }\r\n                var wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\r\n                var text = model.getValueInRange(wordRange);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(wordRange, this._modifyText(text, wordSeparators), new Selection(cursor.lineNumber, cursor.column, cursor.lineNumber, cursor.column)));\r\n            }\r\n            else {\r\n                var text = model.getValueInRange(selection);\r\n                commands.push(new ReplaceCommandThatPreservesSelection(selection, this._modifyText(text, wordSeparators), selection));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    };\r\n    return AbstractCaseAction;\r\n}(EditorAction));\r\nexport { AbstractCaseAction };\r\nvar UpperCaseAction = /** @class */ (function (_super) {\r\n    __extends(UpperCaseAction, _super);\r\n    function UpperCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToUppercase',\r\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\r\n            alias: 'Transform to Uppercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    UpperCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleUpperCase();\r\n    };\r\n    return UpperCaseAction;\r\n}(AbstractCaseAction));\r\nexport { UpperCaseAction };\r\nvar LowerCaseAction = /** @class */ (function (_super) {\r\n    __extends(LowerCaseAction, _super);\r\n    function LowerCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToLowercase',\r\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\r\n            alias: 'Transform to Lowercase',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    LowerCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        return text.toLocaleLowerCase();\r\n    };\r\n    return LowerCaseAction;\r\n}(AbstractCaseAction));\r\nexport { LowerCaseAction };\r\nvar TitleCaseAction = /** @class */ (function (_super) {\r\n    __extends(TitleCaseAction, _super);\r\n    function TitleCaseAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.transformToTitlecase',\r\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\r\n            alias: 'Transform to Title Case',\r\n            precondition: EditorContextKeys.writable\r\n        }) || this;\r\n    }\r\n    TitleCaseAction.prototype._modifyText = function (text, wordSeparators) {\r\n        var separators = '\\r\\n\\t ' + wordSeparators;\r\n        var excludedChars = separators.split('');\r\n        var title = '';\r\n        var startUpperCase = true;\r\n        for (var i = 0; i < text.length; i++) {\r\n            var currentChar = text[i];\r\n            if (excludedChars.indexOf(currentChar) >= 0) {\r\n                startUpperCase = true;\r\n                title += currentChar;\r\n            }\r\n            else if (startUpperCase) {\r\n                startUpperCase = false;\r\n                title += currentChar.toLocaleUpperCase();\r\n            }\r\n            else {\r\n                title += currentChar.toLocaleLowerCase();\r\n            }\r\n        }\r\n        return title;\r\n    };\r\n    return TitleCaseAction;\r\n}(AbstractCaseAction));\r\nexport { TitleCaseAction };\r\nregisterEditorAction(CopyLinesUpAction);\r\nregisterEditorAction(CopyLinesDownAction);\r\nregisterEditorAction(DuplicateSelectionAction);\r\nregisterEditorAction(MoveLinesUpAction);\r\nregisterEditorAction(MoveLinesDownAction);\r\nregisterEditorAction(SortLinesAscendingAction);\r\nregisterEditorAction(SortLinesDescendingAction);\r\nregisterEditorAction(TrimTrailingWhitespaceAction);\r\nregisterEditorAction(DeleteLinesAction);\r\nregisterEditorAction(IndentLinesAction);\r\nregisterEditorAction(OutdentLinesAction);\r\nregisterEditorAction(InsertLineBeforeAction);\r\nregisterEditorAction(InsertLineAfterAction);\r\nregisterEditorAction(DeleteAllLeftAction);\r\nregisterEditorAction(DeleteAllRightAction);\r\nregisterEditorAction(JoinLinesAction);\r\nregisterEditorAction(TransposeAction);\r\nregisterEditorAction(UpperCaseAction);\r\nregisterEditorAction(LowerCaseAction);\r\nregisterEditorAction(TitleCaseAction);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/peekViewWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { ZoneWidget } from '../zoneWidget/zoneWidget.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { registerColor, contrastBorder, activeContrastBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nexport var IPeekViewService = createDecorator('IPeekViewService');\r\nregisterSingleton(IPeekViewService, /** @class */ (function () {\r\n    function class_1() {\r\n        this._widgets = new Map();\r\n    }\r\n    class_1.prototype.addExclusiveWidget = function (editor, widget) {\r\n        var _this = this;\r\n        var existing = this._widgets.get(editor);\r\n        if (existing) {\r\n            existing.listener.dispose();\r\n            existing.widget.dispose();\r\n        }\r\n        var remove = function () {\r\n            var data = _this._widgets.get(editor);\r\n            if (data && data.widget === widget) {\r\n                data.listener.dispose();\r\n                _this._widgets.delete(editor);\r\n            }\r\n        };\r\n        this._widgets.set(editor, { widget: widget, listener: widget.onDidClose(remove) });\r\n    };\r\n    return class_1;\r\n}()));\r\nexport var PeekContext;\r\n(function (PeekContext) {\r\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true);\r\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\r\n})(PeekContext || (PeekContext = {}));\r\nvar PeekContextController = /** @class */ (function () {\r\n    function PeekContextController(editor, contextKeyService) {\r\n        if (editor instanceof EmbeddedCodeEditorWidget) {\r\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\r\n        }\r\n    }\r\n    PeekContextController.prototype.dispose = function () { };\r\n    PeekContextController.ID = 'editor.contrib.referenceController';\r\n    PeekContextController = __decorate([\r\n        __param(1, IContextKeyService)\r\n    ], PeekContextController);\r\n    return PeekContextController;\r\n}());\r\nregisterEditorContribution(PeekContextController.ID, PeekContextController);\r\nexport function getOuterEditor(accessor) {\r\n    var editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n    if (editor instanceof EmbeddedCodeEditorWidget) {\r\n        return editor.getParentEditor();\r\n    }\r\n    return editor;\r\n}\r\nvar defaultOptions = {\r\n    headerBackgroundColor: Color.white,\r\n    primaryHeadingColor: Color.fromHex('#333333'),\r\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\r\n};\r\nvar PeekViewWidget = /** @class */ (function (_super) {\r\n    __extends(PeekViewWidget, _super);\r\n    function PeekViewWidget(editor, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var _this = _super.call(this, editor, options) || this;\r\n        _this._onDidClose = new Emitter();\r\n        _this.onDidClose = _this._onDidClose.event;\r\n        objects.mixin(_this.options, defaultOptions, false);\r\n        return _this;\r\n    }\r\n    PeekViewWidget.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._onDidClose.fire(this);\r\n    };\r\n    PeekViewWidget.prototype.style = function (styles) {\r\n        var options = this.options;\r\n        if (styles.headerBackgroundColor) {\r\n            options.headerBackgroundColor = styles.headerBackgroundColor;\r\n        }\r\n        if (styles.primaryHeadingColor) {\r\n            options.primaryHeadingColor = styles.primaryHeadingColor;\r\n        }\r\n        if (styles.secondaryHeadingColor) {\r\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\r\n        }\r\n        _super.prototype.style.call(this, styles);\r\n    };\r\n    PeekViewWidget.prototype._applyStyles = function () {\r\n        _super.prototype._applyStyles.call(this);\r\n        var options = this.options;\r\n        if (this._headElement && options.headerBackgroundColor) {\r\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\r\n        }\r\n        if (this._primaryHeading && options.primaryHeadingColor) {\r\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\r\n        }\r\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\r\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\r\n        }\r\n        if (this._bodyElement && options.frameColor) {\r\n            this._bodyElement.style.borderColor = options.frameColor.toString();\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._fillContainer = function (container) {\r\n        this.setCssClass('peekview-widget');\r\n        this._headElement = dom.$('.head');\r\n        this._bodyElement = dom.$('.body');\r\n        this._fillHead(this._headElement);\r\n        this._fillBody(this._bodyElement);\r\n        container.appendChild(this._headElement);\r\n        container.appendChild(this._bodyElement);\r\n    };\r\n    PeekViewWidget.prototype._fillHead = function (container) {\r\n        var _this = this;\r\n        var titleElement = dom.$('.peekview-title');\r\n        dom.append(this._headElement, titleElement);\r\n        dom.addStandardDisposableListener(titleElement, 'click', function (event) { return _this._onTitleClick(event); });\r\n        this._fillTitleIcon(titleElement);\r\n        this._primaryHeading = dom.$('span.filename');\r\n        this._secondaryHeading = dom.$('span.dirname');\r\n        this._metaHeading = dom.$('span.meta');\r\n        dom.append(titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\r\n        var actionsContainer = dom.$('.peekview-actions');\r\n        dom.append(this._headElement, actionsContainer);\r\n        var actionBarOptions = this._getActionBarOptions();\r\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\r\n        this._disposables.add(this._actionbarWidget);\r\n        this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), 'codicon-close', true, function () {\r\n            _this.dispose();\r\n            return Promise.resolve();\r\n        }), { label: false, icon: true });\r\n    };\r\n    PeekViewWidget.prototype._fillTitleIcon = function (container) {\r\n    };\r\n    PeekViewWidget.prototype._getActionBarOptions = function () {\r\n        return {};\r\n    };\r\n    PeekViewWidget.prototype._onTitleClick = function (event) {\r\n        // implement me\r\n    };\r\n    PeekViewWidget.prototype.setTitle = function (primaryHeading, secondaryHeading) {\r\n        if (this._primaryHeading && this._secondaryHeading) {\r\n            this._primaryHeading.innerHTML = strings.escape(primaryHeading);\r\n            this._primaryHeading.setAttribute('aria-label', primaryHeading);\r\n            if (secondaryHeading) {\r\n                this._secondaryHeading.innerHTML = strings.escape(secondaryHeading);\r\n            }\r\n            else {\r\n                dom.clearNode(this._secondaryHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype.setMetaTitle = function (value) {\r\n        if (this._metaHeading) {\r\n            if (value) {\r\n                this._metaHeading.innerHTML = strings.escape(value);\r\n                dom.show(this._metaHeading);\r\n            }\r\n            else {\r\n                dom.hide(this._metaHeading);\r\n            }\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayout = function (heightInPixel, widthInPixel) {\r\n        if (!this._isShowing && heightInPixel < 0) {\r\n            // Looks like the view zone got folded away!\r\n            this.dispose();\r\n            return;\r\n        }\r\n        var headHeight = Math.ceil(this.editor.getOption(49 /* lineHeight */) * 1.2);\r\n        var bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\r\n        this._doLayoutHead(headHeight, widthInPixel);\r\n        this._doLayoutBody(bodyHeight, widthInPixel);\r\n    };\r\n    PeekViewWidget.prototype._doLayoutHead = function (heightInPixel, widthInPixel) {\r\n        if (this._headElement) {\r\n            this._headElement.style.height = heightInPixel + \"px\";\r\n            this._headElement.style.lineHeight = this._headElement.style.height;\r\n        }\r\n    };\r\n    PeekViewWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        if (this._bodyElement) {\r\n            this._bodyElement.style.height = heightInPixel + \"px\";\r\n        }\r\n    };\r\n    return PeekViewWidget;\r\n}(ZoneWidget));\r\nexport { PeekViewWidget };\r\nexport var peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#1E1E1E', light: '#FFFFFF', hc: '#0C141F' }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\r\nexport var peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: '#FFFFFF', light: '#333333', hc: '#FFFFFF' }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\r\nexport var peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161e6', hc: '#FFFFFF99' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\r\nexport var peekViewBorder = registerColor('peekView.border', { dark: '#007acc', light: '#007acc', hc: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\r\nexport var peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hc: Color.black }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\r\nexport var peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hc: Color.white }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\r\nexport var peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hc: Color.white }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\r\nexport var peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hc: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\r\nexport var peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hc: Color.white }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\r\nexport var peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hc: Color.black }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\r\nexport var peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hc: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\r\nexport var peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hc: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\r\nexport var peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hc: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\r\nexport var peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { isDisposable, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nvar Link = /** @class */ (function () {\r\n    function Link(link, provider) {\r\n        this._link = link;\r\n        this._provider = provider;\r\n    }\r\n    Link.prototype.toJSON = function () {\r\n        return {\r\n            range: this.range,\r\n            url: this.url,\r\n            tooltip: this.tooltip\r\n        };\r\n    };\r\n    Object.defineProperty(Link.prototype, \"range\", {\r\n        get: function () {\r\n            return this._link.range;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"url\", {\r\n        get: function () {\r\n            return this._link.url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Link.prototype, \"tooltip\", {\r\n        get: function () {\r\n            return this._link.tooltip;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Link.prototype.resolve = function (token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (this._link.url) {\r\n                    return [2 /*return*/, this._link.url];\r\n                }\r\n                if (typeof this._provider.resolveLink === 'function') {\r\n                    return [2 /*return*/, Promise.resolve(this._provider.resolveLink(this._link, token)).then(function (value) {\r\n                            _this._link = value || _this._link;\r\n                            if (_this._link.url) {\r\n                                // recurse\r\n                                return _this.resolve(token);\r\n                            }\r\n                            return Promise.reject(new Error('missing'));\r\n                        })];\r\n                }\r\n                return [2 /*return*/, Promise.reject(new Error('missing'))];\r\n            });\r\n        });\r\n    };\r\n    return Link;\r\n}());\r\nexport { Link };\r\nvar LinksList = /** @class */ (function (_super) {\r\n    __extends(LinksList, _super);\r\n    function LinksList(tuples) {\r\n        var _this = _super.call(this) || this;\r\n        var links = [];\r\n        var _loop_1 = function (list, provider) {\r\n            // merge all links\r\n            var newLinks = list.links.map(function (link) { return new Link(link, provider); });\r\n            links = LinksList._union(links, newLinks);\r\n            // register disposables\r\n            if (isDisposable(provider)) {\r\n                this_1._register(provider);\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var _i = 0, tuples_1 = tuples; _i < tuples_1.length; _i++) {\r\n            var _a = tuples_1[_i], list = _a[0], provider = _a[1];\r\n            _loop_1(list, provider);\r\n        }\r\n        _this.links = links;\r\n        return _this;\r\n    }\r\n    LinksList._union = function (oldLinks, newLinks) {\r\n        // reunite oldLinks with newLinks and remove duplicates\r\n        var result = [];\r\n        var oldIndex;\r\n        var oldLen;\r\n        var newIndex;\r\n        var newLen;\r\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\r\n            var oldLink = oldLinks[oldIndex];\r\n            var newLink = newLinks[newIndex];\r\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\r\n                // Remove the oldLink\r\n                oldIndex++;\r\n                continue;\r\n            }\r\n            var comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\r\n            if (comparisonResult < 0) {\r\n                // oldLink is before\r\n                result.push(oldLink);\r\n                oldIndex++;\r\n            }\r\n            else {\r\n                // newLink is before\r\n                result.push(newLink);\r\n                newIndex++;\r\n            }\r\n        }\r\n        for (; oldIndex < oldLen; oldIndex++) {\r\n            result.push(oldLinks[oldIndex]);\r\n        }\r\n        for (; newIndex < newLen; newIndex++) {\r\n            result.push(newLinks[newIndex]);\r\n        }\r\n        return result;\r\n    };\r\n    return LinksList;\r\n}(Disposable));\r\nexport { LinksList };\r\nexport function getLinks(model, token) {\r\n    var lists = [];\r\n    // ask all providers for links in parallel\r\n    var promises = LinkProviderRegistry.ordered(model).reverse().map(function (provider, i) {\r\n        return Promise.resolve(provider.provideLinks(model, token)).then(function (result) {\r\n            if (result) {\r\n                lists[i] = [result, provider];\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(function () {\r\n        var result = new LinksList(coalesce(lists));\r\n        if (!token.isCancellationRequested) {\r\n            return result;\r\n        }\r\n        result.dispose();\r\n        return new LinksList([]);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeLinkProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        var uri, model, list, result;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    uri = args[0];\r\n                    if (!(uri instanceof URI)) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    model = accessor.get(IModelService).getModel(uri);\r\n                    if (!model) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    return [4 /*yield*/, getLinks(model, CancellationToken.None)];\r\n                case 1:\r\n                    list = _a.sent();\r\n                    if (!list) {\r\n                        return [2 /*return*/, []];\r\n                    }\r\n                    result = list.links.slice(0);\r\n                    list.dispose();\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    });\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './links.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as async from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\r\nimport { getLinks } from './getLinks.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nfunction getHoverMessage(link, useMetaKey) {\r\n    var executeCmd = link.url && /^command:/i.test(link.url.toString());\r\n    var label = link.tooltip\r\n        ? link.tooltip\r\n        : executeCmd\r\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\r\n            : nls.localize('links.navigate.follow', 'Follow link');\r\n    var kb = useMetaKey\r\n        ? platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\r\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\r\n        : platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\r\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\r\n    if (link.url) {\r\n        var hoverMessage = new MarkdownString('', true).appendMarkdown(\"[\" + label + \"](\" + link.url.toString() + \") (\" + kb + \")\");\r\n        return hoverMessage;\r\n    }\r\n    else {\r\n        return new MarkdownString().appendText(label + \" (\" + kb + \")\");\r\n    }\r\n}\r\nvar decoration = {\r\n    general: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link'\r\n    }),\r\n    active: ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link-active'\r\n    })\r\n};\r\nvar LinkOccurrence = /** @class */ (function () {\r\n    function LinkOccurrence(link, decorationId) {\r\n        this.link = link;\r\n        this.decorationId = decorationId;\r\n    }\r\n    LinkOccurrence.decoration = function (link, useMetaKey) {\r\n        return {\r\n            range: link.range,\r\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\r\n        };\r\n    };\r\n    LinkOccurrence._getOptions = function (link, useMetaKey, isActive) {\r\n        var options = __assign({}, (isActive ? decoration.active : decoration.general));\r\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\r\n        return options;\r\n    };\r\n    LinkOccurrence.prototype.activate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\r\n    };\r\n    LinkOccurrence.prototype.deactivate = function (changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\r\n    };\r\n    return LinkOccurrence;\r\n}());\r\nvar LinkDetector = /** @class */ (function () {\r\n    function LinkDetector(editor, openerService, notificationService) {\r\n        var _this = this;\r\n        this.listenersToRemove = new DisposableStore();\r\n        this.editor = editor;\r\n        this.openerService = openerService;\r\n        this.notificationService = notificationService;\r\n        var clickLinkGesture = new ClickLinkGesture(editor);\r\n        this.listenersToRemove.add(clickLinkGesture);\r\n        this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this._onEditorMouseMove(mouseEvent, keyboardEvent);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onExecute(function (e) {\r\n            _this.onEditorMouseUp(e);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onCancel(function (e) {\r\n            _this.cleanUpActiveLinkDecoration();\r\n        }));\r\n        this.enabled = editor.getOption(52 /* links */);\r\n        this.listenersToRemove.add(editor.onDidChangeConfiguration(function (e) {\r\n            var enabled = editor.getOption(52 /* links */);\r\n            if (_this.enabled === enabled) {\r\n                // No change in our configuration option\r\n                return;\r\n            }\r\n            _this.enabled = enabled;\r\n            // Remove any links (for the getting disabled case)\r\n            _this.updateDecorations([]);\r\n            // Stop any computation (for the getting disabled case)\r\n            _this.stop();\r\n            // Start computing (for the getting enabled case)\r\n            _this.beginCompute();\r\n        }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelContent(function (e) { return _this.onChange(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModel(function (e) { return _this.onModelChanged(); }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelLanguage(function (e) { return _this.onModelModeChanged(); }));\r\n        this.listenersToRemove.add(LinkProviderRegistry.onDidChange(function (e) { return _this.onModelModeChanged(); }));\r\n        this.timeout = new async.TimeoutTimer();\r\n        this.computePromise = null;\r\n        this.activeLinksList = null;\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.beginCompute();\r\n    }\r\n    LinkDetector.get = function (editor) {\r\n        return editor.getContribution(LinkDetector.ID);\r\n    };\r\n    LinkDetector.prototype.onModelChanged = function () {\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onModelModeChanged = function () {\r\n        this.stop();\r\n        this.beginCompute();\r\n    };\r\n    LinkDetector.prototype.onChange = function () {\r\n        var _this = this;\r\n        this.timeout.setIfNotSet(function () { return _this.beginCompute(); }, LinkDetector.RECOMPUTE_TIME);\r\n    };\r\n    LinkDetector.prototype.beginCompute = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var model, _a, err_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.editor.hasModel() || !this.enabled) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        model = this.editor.getModel();\r\n                        if (!LinkProviderRegistry.has(model)) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        if (this.activeLinksList) {\r\n                            this.activeLinksList.dispose();\r\n                            this.activeLinksList = null;\r\n                        }\r\n                        this.computePromise = async.createCancelablePromise(function (token) { return getLinks(model, token); });\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 3, 4, 5]);\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.computePromise];\r\n                    case 2:\r\n                        _a.activeLinksList = _b.sent();\r\n                        this.updateDecorations(this.activeLinksList.links);\r\n                        return [3 /*break*/, 5];\r\n                    case 3:\r\n                        err_1 = _b.sent();\r\n                        onUnexpectedError(err_1);\r\n                        return [3 /*break*/, 5];\r\n                    case 4:\r\n                        this.computePromise = null;\r\n                        return [7 /*endfinally*/];\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    LinkDetector.prototype.updateDecorations = function (links) {\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        var oldDecorations = [];\r\n        var keys = Object.keys(this.currentOccurrences);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var decorationId = keys[i];\r\n            var occurance = this.currentOccurrences[decorationId];\r\n            oldDecorations.push(occurance.decorationId);\r\n        }\r\n        var newDecorations = [];\r\n        if (links) {\r\n            // Not sure why this is sometimes null\r\n            for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n                var link = links_1[_i];\r\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\r\n            }\r\n        }\r\n        var decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var occurance = new LinkOccurrence(links[i], decorations[i]);\r\n            this.currentOccurrences[occurance.decorationId] = occurance;\r\n        }\r\n    };\r\n    LinkDetector.prototype._onEditorMouseMove = function (mouseEvent, withKey) {\r\n        var _this = this;\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        if (this.isEnabled(mouseEvent, withKey)) {\r\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\r\n            var occurrence_1 = this.getLinkOccurrence(mouseEvent.target.position);\r\n            if (occurrence_1) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_1.activate(changeAccessor, useMetaKey);\r\n                    _this.activeLinkDecorationId = occurrence_1.decorationId;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }\r\n    };\r\n    LinkDetector.prototype.cleanUpActiveLinkDecoration = function () {\r\n        var useMetaKey = (this.editor.getOption(59 /* multiCursorModifier */) === 'altKey');\r\n        if (this.activeLinkDecorationId) {\r\n            var occurrence_2 = this.currentOccurrences[this.activeLinkDecorationId];\r\n            if (occurrence_2) {\r\n                this.editor.changeDecorations(function (changeAccessor) {\r\n                    occurrence_2.deactivate(changeAccessor, useMetaKey);\r\n                });\r\n            }\r\n            this.activeLinkDecorationId = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (!this.isEnabled(mouseEvent)) {\r\n            return;\r\n        }\r\n        var occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n        if (!occurrence) {\r\n            return;\r\n        }\r\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\r\n    };\r\n    LinkDetector.prototype.openLinkOccurrence = function (occurrence, openToSide, fromUserGesture) {\r\n        var _this = this;\r\n        if (fromUserGesture === void 0) { fromUserGesture = false; }\r\n        if (!this.openerService) {\r\n            return;\r\n        }\r\n        var link = occurrence.link;\r\n        link.resolve(CancellationToken.None).then(function (uri) {\r\n            // open the uri\r\n            return _this.openerService.open(uri, { openToSide: openToSide, fromUserGesture: fromUserGesture });\r\n        }, function (err) {\r\n            var messageOrError = err instanceof Error ? err.message : err;\r\n            // different error cases\r\n            if (messageOrError === 'invalid') {\r\n                _this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\r\n            }\r\n            else if (messageOrError === 'missing') {\r\n                _this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\r\n            }\r\n            else {\r\n                onUnexpectedError(err);\r\n            }\r\n        });\r\n    };\r\n    LinkDetector.prototype.getLinkOccurrence = function (position) {\r\n        if (!this.editor.hasModel() || !position) {\r\n            return null;\r\n        }\r\n        var decorations = this.editor.getModel().getDecorationsInRange({\r\n            startLineNumber: position.lineNumber,\r\n            startColumn: position.column,\r\n            endLineNumber: position.lineNumber,\r\n            endColumn: position.column\r\n        }, 0, true);\r\n        for (var _i = 0, decorations_1 = decorations; _i < decorations_1.length; _i++) {\r\n            var decoration_1 = decorations_1[_i];\r\n            var currentOccurrence = this.currentOccurrences[decoration_1.id];\r\n            if (currentOccurrence) {\r\n                return currentOccurrence;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    LinkDetector.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return Boolean((mouseEvent.target.type === 6 /* CONTENT_TEXT */)\r\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\r\n    };\r\n    LinkDetector.prototype.stop = function () {\r\n        this.timeout.cancel();\r\n        if (this.activeLinksList) {\r\n            this.activeLinksList.dispose();\r\n        }\r\n        if (this.computePromise) {\r\n            this.computePromise.cancel();\r\n            this.computePromise = null;\r\n        }\r\n    };\r\n    LinkDetector.prototype.dispose = function () {\r\n        this.listenersToRemove.dispose();\r\n        this.stop();\r\n        this.timeout.dispose();\r\n    };\r\n    LinkDetector.ID = 'editor.linkDetector';\r\n    LinkDetector.RECOMPUTE_TIME = 1000; // ms\r\n    LinkDetector = __decorate([\r\n        __param(1, IOpenerService),\r\n        __param(2, INotificationService)\r\n    ], LinkDetector);\r\n    return LinkDetector;\r\n}());\r\nvar OpenLinkAction = /** @class */ (function (_super) {\r\n    __extends(OpenLinkAction, _super);\r\n    function OpenLinkAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.openLink',\r\n            label: nls.localize('label', \"Open Link\"),\r\n            alias: 'Open Link',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    OpenLinkAction.prototype.run = function (accessor, editor) {\r\n        var linkDetector = LinkDetector.get(editor);\r\n        if (!linkDetector) {\r\n            return;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n            var sel = selections_1[_i];\r\n            var link = linkDetector.getLinkOccurrence(sel.getEndPosition());\r\n            if (link) {\r\n                linkDetector.openLinkOccurrence(link, false);\r\n            }\r\n        }\r\n    };\r\n    return OpenLinkAction;\r\n}(EditorAction));\r\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\r\nregisterEditorAction(OpenLinkAction);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .detected-link-active { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { renderMarkdown } from '../../../base/browser/markdownRenderer.js';\r\nimport { IOpenerService, NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { tokenizeToString } from '../../common/modes/textToHtmlTokenizer.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nvar MarkdownRenderer = /** @class */ (function (_super) {\r\n    __extends(MarkdownRenderer, _super);\r\n    function MarkdownRenderer(_editor, _modeService, _openerService) {\r\n        if (_openerService === void 0) { _openerService = NullOpenerService; }\r\n        var _this = _super.call(this) || this;\r\n        _this._editor = _editor;\r\n        _this._modeService = _modeService;\r\n        _this._openerService = _openerService;\r\n        _this._onDidRenderCodeBlock = _this._register(new Emitter());\r\n        _this.onDidRenderCodeBlock = _this._onDidRenderCodeBlock.event;\r\n        return _this;\r\n    }\r\n    MarkdownRenderer.prototype.getOptions = function (disposeables) {\r\n        var _this = this;\r\n        return {\r\n            codeBlockRenderer: function (languageAlias, value) {\r\n                // In markdown,\r\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\r\n                // it is possible no alias is given in which case we fall back to the current editor lang\r\n                var modeId = null;\r\n                if (languageAlias) {\r\n                    modeId = _this._modeService.getModeIdForLanguageName(languageAlias);\r\n                }\r\n                else {\r\n                    var model = _this._editor.getModel();\r\n                    if (model) {\r\n                        modeId = model.getLanguageIdentifier().language;\r\n                    }\r\n                }\r\n                _this._modeService.triggerMode(modeId || '');\r\n                return Promise.resolve(true).then(function (_) {\r\n                    var promise = TokenizationRegistry.getPromise(modeId || '');\r\n                    if (promise) {\r\n                        return promise.then(function (support) { return tokenizeToString(value, support); });\r\n                    }\r\n                    return tokenizeToString(value, undefined);\r\n                }).then(function (code) {\r\n                    return \"<span style=\\\"font-family: \" + _this._editor.getOption(34 /* fontInfo */).fontFamily + \"\\\">\" + code + \"</span>\";\r\n                });\r\n            },\r\n            codeBlockRenderCallback: function () { return _this._onDidRenderCodeBlock.fire(); },\r\n            actionHandler: {\r\n                callback: function (content) {\r\n                    _this._openerService.open(content, { fromUserGesture: true }).catch(onUnexpectedError);\r\n                },\r\n                disposeables: disposeables\r\n            }\r\n        };\r\n    };\r\n    MarkdownRenderer.prototype.render = function (markdown) {\r\n        var disposeables = new DisposableStore();\r\n        var element;\r\n        if (!markdown) {\r\n            element = document.createElement('span');\r\n        }\r\n        else {\r\n            element = renderMarkdown(markdown, this.getOptions(disposeables));\r\n        }\r\n        return {\r\n            element: element,\r\n            dispose: function () { return disposeables.dispose(); }\r\n        };\r\n    };\r\n    MarkdownRenderer = __decorate([\r\n        __param(1, IModeService),\r\n        __param(2, optional(IOpenerService))\r\n    ], MarkdownRenderer);\r\n    return MarkdownRenderer;\r\n}(Disposable));\r\nexport { MarkdownRenderer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CursorMoveCommands } from '../../common/controller/cursorMoveCommands.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { CommonFindController } from '../find/findController.js';\r\nimport { overviewRulerSelectionHighlightForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nvar InsertCursorAbove = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAbove, _super);\r\n    function InsertCursorAbove() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAbove',\r\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\r\n            alias: 'Add Cursor Above',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\r\n                order: 2\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAbove.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorUp(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 1 /* TopMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorAbove;\r\n}(EditorAction));\r\nexport { InsertCursorAbove };\r\nvar InsertCursorBelow = /** @class */ (function (_super) {\r\n    __extends(InsertCursorBelow, _super);\r\n    function InsertCursorBelow() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorBelow',\r\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\r\n            alias: 'Add Cursor Below',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorBelow.prototype.run = function (accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var useLogicalLine = (args && args.logicalLine === true);\r\n        var cursors = editor._getCursors();\r\n        var context = cursors.context;\r\n        if (context.config.readOnly) {\r\n            return;\r\n        }\r\n        context.model.pushStackElement();\r\n        cursors.setStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorDown(context, cursors.getAll(), useLogicalLine));\r\n        cursors.reveal(args.source, true, 2 /* BottomMost */, 0 /* Smooth */);\r\n    };\r\n    return InsertCursorBelow;\r\n}(EditorAction));\r\nexport { InsertCursorBelow };\r\nvar InsertCursorAtEndOfEachLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfEachLineSelected, _super);\r\n    function InsertCursorAtEndOfEachLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\r\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\r\n            alias: 'Add Cursors to Line Ends',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 39 /* KEY_I */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\r\n                order: 4\r\n            }\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfEachLineSelected.prototype.getCursorsForSelection = function (selection, model, result) {\r\n        if (selection.isEmpty()) {\r\n            return;\r\n        }\r\n        for (var i = selection.startLineNumber; i < selection.endLineNumber; i++) {\r\n            var currentLineMaxColumn = model.getLineMaxColumn(i);\r\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\r\n        }\r\n        if (selection.endColumn > 1) {\r\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\r\n        }\r\n    };\r\n    InsertCursorAtEndOfEachLineSelected.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = editor.getModel();\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        selections.forEach(function (sel) { return _this.getCursorsForSelection(sel, model, newSelections); });\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfEachLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtEndOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtEndOfLineSelected, _super);\r\n    function InsertCursorAtEndOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToBottom',\r\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\r\n            alias: 'Add Cursors To Bottom',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtEndOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var lineCount = editor.getModel().getLineCount();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i <= lineCount; i++) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtEndOfLineSelected;\r\n}(EditorAction));\r\nvar InsertCursorAtTopOfLineSelected = /** @class */ (function (_super) {\r\n    __extends(InsertCursorAtTopOfLineSelected, _super);\r\n    function InsertCursorAtTopOfLineSelected() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addCursorsToTop',\r\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\r\n            alias: 'Add Cursors To Top',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    InsertCursorAtTopOfLineSelected.prototype.run = function (accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        var selections = editor.getSelections();\r\n        var newSelections = [];\r\n        for (var i = selections[0].startLineNumber; i >= 1; i--) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n    };\r\n    return InsertCursorAtTopOfLineSelected;\r\n}(EditorAction));\r\nvar MultiCursorSessionResult = /** @class */ (function () {\r\n    function MultiCursorSessionResult(selections, revealRange, revealScrollType) {\r\n        this.selections = selections;\r\n        this.revealRange = revealRange;\r\n        this.revealScrollType = revealScrollType;\r\n    }\r\n    return MultiCursorSessionResult;\r\n}());\r\nexport { MultiCursorSessionResult };\r\nvar MultiCursorSession = /** @class */ (function () {\r\n    function MultiCursorSession(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\r\n        this._editor = _editor;\r\n        this.findController = findController;\r\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\r\n        this.searchText = searchText;\r\n        this.wholeWord = wholeWord;\r\n        this.matchCase = matchCase;\r\n        this.currentMatch = currentMatch;\r\n    }\r\n    MultiCursorSession.create = function (editor, findController) {\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var findState = findController.getState();\r\n        // Find widget owns entirely what we search for if:\r\n        //  - focus is not in the editor (i.e. it is in the find widget)\r\n        //  - and the search widget is visible\r\n        //  - and the search string is non-empty\r\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\r\n            // Find widget owns what is searched for\r\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\r\n        }\r\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\r\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\r\n        var isDisconnectedFromFindController = false;\r\n        var wholeWord;\r\n        var matchCase;\r\n        var selections = editor.getSelections();\r\n        if (selections.length === 1 && selections[0].isEmpty()) {\r\n            isDisconnectedFromFindController = true;\r\n            wholeWord = true;\r\n            matchCase = true;\r\n        }\r\n        else {\r\n            wholeWord = findState.wholeWord;\r\n            matchCase = findState.matchCase;\r\n        }\r\n        // Selection owns what is searched for\r\n        var s = editor.getSelection();\r\n        var searchText;\r\n        var currentMatch = null;\r\n        if (s.isEmpty()) {\r\n            // selection is empty => expand to current word\r\n            var word = editor.getModel().getWordAtPosition(s.getStartPosition());\r\n            if (!word) {\r\n                return null;\r\n            }\r\n            searchText = word.word;\r\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\r\n        }\r\n        else {\r\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\r\n        }\r\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToNextFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getNextMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.addSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype.moveSelectionToPreviousFindMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        var allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    };\r\n    MultiCursorSession.prototype._getPreviousMatch = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            var result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        var allSelections = this._editor.getSelections();\r\n        var lastAddedSelection = allSelections[allSelections.length - 1];\r\n        var previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false);\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\r\n    };\r\n    MultiCursorSession.prototype.selectAll = function () {\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        return this._editor.getModel().findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n    };\r\n    return MultiCursorSession;\r\n}());\r\nexport { MultiCursorSession };\r\nvar MultiCursorSelectionController = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionController, _super);\r\n    function MultiCursorSelectionController(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._sessionDispose = _this._register(new DisposableStore());\r\n        _this._editor = editor;\r\n        _this._ignoreSelectionChange = false;\r\n        _this._session = null;\r\n        return _this;\r\n    }\r\n    MultiCursorSelectionController.get = function (editor) {\r\n        return editor.getContribution(MultiCursorSelectionController.ID);\r\n    };\r\n    MultiCursorSelectionController.prototype.dispose = function () {\r\n        this._endSession();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MultiCursorSelectionController.prototype._beginSessionIfNeeded = function (findController) {\r\n        var _this = this;\r\n        if (!this._session) {\r\n            // Create a new session\r\n            var session = MultiCursorSession.create(this._editor, findController);\r\n            if (!session) {\r\n                return;\r\n            }\r\n            this._session = session;\r\n            var newState = { searchString: this._session.searchText };\r\n            if (this._session.isDisconnectedFromFindController) {\r\n                newState.wholeWordOverride = 1 /* True */;\r\n                newState.matchCaseOverride = 1 /* True */;\r\n                newState.isRegexOverride = 2 /* False */;\r\n            }\r\n            findController.getState().change(newState, false);\r\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection(function (e) {\r\n                if (_this._ignoreSelectionChange) {\r\n                    return;\r\n                }\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(function () {\r\n                _this._endSession();\r\n            }));\r\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange(function (e) {\r\n                if (e.matchCase || e.wholeWord) {\r\n                    _this._endSession();\r\n                }\r\n            }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype._endSession = function () {\r\n        this._sessionDispose.clear();\r\n        if (this._session && this._session.isDisconnectedFromFindController) {\r\n            var newState = {\r\n                wholeWordOverride: 0 /* NotSet */,\r\n                matchCaseOverride: 0 /* NotSet */,\r\n                isRegexOverride: 0 /* NotSet */,\r\n            };\r\n            this._session.findController.getState().change(newState, false);\r\n        }\r\n        this._session = null;\r\n    };\r\n    MultiCursorSelectionController.prototype._setSelections = function (selections) {\r\n        this._ignoreSelectionChange = true;\r\n        this._editor.setSelections(selections);\r\n        this._ignoreSelectionChange = false;\r\n    };\r\n    MultiCursorSelectionController.prototype._expandEmptyToWord = function (model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        var word = model.getWordAtPosition(selection.getStartPosition());\r\n        if (!word) {\r\n            return selection;\r\n        }\r\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n    };\r\n    MultiCursorSelectionController.prototype._applySessionResult = function (result) {\r\n        if (!result) {\r\n            return;\r\n        }\r\n        this._setSelections(result.selections);\r\n        if (result.revealRange) {\r\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.getSession = function (findController) {\r\n        return this._session;\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToNextFindMatch = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._session) {\r\n            // If there are multiple cursors, handle the case where they do not all select the same text.\r\n            var allSelections = this._editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState = findController.getState();\r\n                var matchCase = findState.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    var model = this._editor.getModel();\r\n                    var resultingSelections = [];\r\n                    for (var i = 0, len = allSelections.length; i < len; i++) {\r\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\r\n                    }\r\n                    this._editor.setSelections(resultingSelections);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.addSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToNextFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.moveSelectionToPreviousFindMatch = function (findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\r\n        }\r\n    };\r\n    MultiCursorSelectionController.prototype.selectAll = function (findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        var matches = null;\r\n        var findState = findController.getState();\r\n        // Special case: find widget owns entirely what we search for if:\r\n        // - focus is not in the editor (i.e. it is in the find widget)\r\n        // - and the search widget is visible\r\n        // - and the search string is non-empty\r\n        // - and we're searching for a regex\r\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\r\n            matches = this._editor.getModel().findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(96 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        }\r\n        else {\r\n            this._beginSessionIfNeeded(findController);\r\n            if (!this._session) {\r\n                return;\r\n            }\r\n            matches = this._session.selectAll();\r\n        }\r\n        if (findState.searchScope) {\r\n            var state = findState.searchScope;\r\n            var inSelection = [];\r\n            for (var i = 0; i < matches.length; i++) {\r\n                if (matches[i].range.endLineNumber <= state.endLineNumber && matches[i].range.startLineNumber >= state.startLineNumber) {\r\n                    inSelection.push(matches[i]);\r\n                }\r\n            }\r\n            matches = inSelection;\r\n        }\r\n        if (matches.length > 0) {\r\n            var editorSelection = this._editor.getSelection();\r\n            // Have the primary cursor remain the one where the action was invoked\r\n            for (var i = 0, len = matches.length; i < len; i++) {\r\n                var match = matches[i];\r\n                var intersection = match.range.intersectRanges(editorSelection);\r\n                if (intersection) {\r\n                    // bingo!\r\n                    matches[i] = matches[0];\r\n                    matches[0] = match;\r\n                    break;\r\n                }\r\n            }\r\n            this._setSelections(matches.map(function (m) { return new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn); }));\r\n        }\r\n    };\r\n    MultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\r\n    return MultiCursorSelectionController;\r\n}(Disposable));\r\nexport { MultiCursorSelectionController };\r\nvar MultiCursorSelectionControllerAction = /** @class */ (function (_super) {\r\n    __extends(MultiCursorSelectionControllerAction, _super);\r\n    function MultiCursorSelectionControllerAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    MultiCursorSelectionControllerAction.prototype.run = function (accessor, editor) {\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return;\r\n        }\r\n        this._run(multiCursorController, findController);\r\n    };\r\n    return MultiCursorSelectionControllerAction;\r\n}(EditorAction));\r\nexport { MultiCursorSelectionControllerAction };\r\nvar AddSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToNextFindMatchAction, _super);\r\n    function AddSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToNextFindMatch',\r\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\r\n            alias: 'Add Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 34 /* KEY_D */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\r\n                order: 5\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToNextFindMatch(findController);\r\n    };\r\n    return AddSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToNextFindMatchAction };\r\nvar AddSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(AddSelectionToPreviousFindMatchAction, _super);\r\n    function AddSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.addSelectionToPreviousFindMatch',\r\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\r\n            alias: 'Add Selection To Previous Find Match',\r\n            precondition: undefined,\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    AddSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return AddSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { AddSelectionToPreviousFindMatchAction };\r\nvar MoveSelectionToNextFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToNextFindMatchAction, _super);\r\n    function MoveSelectionToNextFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToNextFindMatch',\r\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\r\n            alias: 'Move Last Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 34 /* KEY_D */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    MoveSelectionToNextFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToNextFindMatch(findController);\r\n    };\r\n    return MoveSelectionToNextFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToNextFindMatchAction };\r\nvar MoveSelectionToPreviousFindMatchAction = /** @class */ (function (_super) {\r\n    __extends(MoveSelectionToPreviousFindMatchAction, _super);\r\n    function MoveSelectionToPreviousFindMatchAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\r\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\r\n            alias: 'Move Last Selection To Previous Find Match',\r\n            precondition: undefined\r\n        }) || this;\r\n    }\r\n    MoveSelectionToPreviousFindMatchAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\r\n    };\r\n    return MoveSelectionToPreviousFindMatchAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { MoveSelectionToPreviousFindMatchAction };\r\nvar SelectHighlightsAction = /** @class */ (function (_super) {\r\n    __extends(SelectHighlightsAction, _super);\r\n    function SelectHighlightsAction() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.selectHighlights',\r\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\r\n            alias: 'Select All Occurrences of Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 42 /* KEY_L */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: 25 /* MenubarSelectionMenu */,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\r\n                order: 7\r\n            }\r\n        }) || this;\r\n    }\r\n    SelectHighlightsAction.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return SelectHighlightsAction;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { SelectHighlightsAction };\r\nvar CompatChangeAll = /** @class */ (function (_super) {\r\n    __extends(CompatChangeAll, _super);\r\n    function CompatChangeAll() {\r\n        return _super.call(this, {\r\n            id: 'editor.action.changeAll',\r\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\r\n            alias: 'Change All Occurrences',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.2\r\n            }\r\n        }) || this;\r\n    }\r\n    CompatChangeAll.prototype._run = function (multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    };\r\n    return CompatChangeAll;\r\n}(MultiCursorSelectionControllerAction));\r\nexport { CompatChangeAll };\r\nvar SelectionHighlighterState = /** @class */ (function () {\r\n    function SelectionHighlighterState(searchText, matchCase, wordSeparators) {\r\n        this.searchText = searchText;\r\n        this.matchCase = matchCase;\r\n        this.wordSeparators = wordSeparators;\r\n    }\r\n    /**\r\n     * Everything equals except for `lastWordUnderCursor`\r\n     */\r\n    SelectionHighlighterState.softEquals = function (a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.searchText === b.searchText\r\n            && a.matchCase === b.matchCase\r\n            && a.wordSeparators === b.wordSeparators);\r\n    };\r\n    return SelectionHighlighterState;\r\n}());\r\nvar SelectionHighlighter = /** @class */ (function (_super) {\r\n    __extends(SelectionHighlighter, _super);\r\n    function SelectionHighlighter(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this.editor = editor;\r\n        _this._isEnabled = editor.getOption(82 /* selectionHighlight */);\r\n        _this.decorations = [];\r\n        _this.updateSoon = _this._register(new RunOnceScheduler(function () { return _this._update(); }, 300));\r\n        _this.state = null;\r\n        _this._register(editor.onDidChangeConfiguration(function (e) {\r\n            _this._isEnabled = editor.getOption(82 /* selectionHighlight */);\r\n        }));\r\n        _this._register(editor.onDidChangeCursorSelection(function (e) {\r\n            if (!_this._isEnabled) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            if (e.selection.isEmpty()) {\r\n                if (e.reason === 3 /* Explicit */) {\r\n                    if (_this.state) {\r\n                        // no longer valid\r\n                        _this._setState(null);\r\n                    }\r\n                    _this.updateSoon.schedule();\r\n                }\r\n                else {\r\n                    _this._setState(null);\r\n                }\r\n            }\r\n            else {\r\n                _this._update();\r\n            }\r\n        }));\r\n        _this._register(editor.onDidChangeModel(function (e) {\r\n            _this._setState(null);\r\n        }));\r\n        _this._register(CommonFindController.get(editor).getState().onFindReplaceStateChange(function (e) {\r\n            _this._update();\r\n        }));\r\n        return _this;\r\n    }\r\n    SelectionHighlighter.prototype._update = function () {\r\n        this._setState(SelectionHighlighter._createState(this._isEnabled, this.editor));\r\n    };\r\n    SelectionHighlighter._createState = function (isEnabled, editor) {\r\n        if (!isEnabled) {\r\n            return null;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        var s = editor.getSelection();\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            // multiline forbidden for perf reasons\r\n            return null;\r\n        }\r\n        var multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return null;\r\n        }\r\n        var findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return null;\r\n        }\r\n        var r = multiCursorController.getSession(findController);\r\n        if (!r) {\r\n            var allSelections = editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                var findState_1 = findController.getState();\r\n                var matchCase = findState_1.matchCase;\r\n                var selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    return null;\r\n                }\r\n            }\r\n            r = MultiCursorSession.create(editor, findController);\r\n        }\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        if (r.currentMatch) {\r\n            // This is an empty selection\r\n            // Do not interfere with semantic word highlighting in the no selection case\r\n            return null;\r\n        }\r\n        if (/^[ \\t]+$/.test(r.searchText)) {\r\n            // whitespace only selection\r\n            return null;\r\n        }\r\n        if (r.searchText.length > 200) {\r\n            // very long selection\r\n            return null;\r\n        }\r\n        // TODO: better handling of this case\r\n        var findState = findController.getState();\r\n        var caseSensitive = findState.matchCase;\r\n        // Return early if the find widget shows the exact same matches\r\n        if (findState.isRevealed) {\r\n            var findStateSearchString = findState.searchString;\r\n            if (!caseSensitive) {\r\n                findStateSearchString = findStateSearchString.toLowerCase();\r\n            }\r\n            var mySearchString = r.searchText;\r\n            if (!caseSensitive) {\r\n                mySearchString = mySearchString.toLowerCase();\r\n            }\r\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\r\n                return null;\r\n            }\r\n        }\r\n        return new SelectionHighlighterState(r.searchText, r.matchCase, r.wholeWord ? editor.getOption(96 /* wordSeparators */) : null);\r\n    };\r\n    SelectionHighlighter.prototype._setState = function (state) {\r\n        if (SelectionHighlighterState.softEquals(this.state, state)) {\r\n            this.state = state;\r\n            return;\r\n        }\r\n        this.state = state;\r\n        if (!this.state) {\r\n            this.decorations = this.editor.deltaDecorations(this.decorations, []);\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        var model = this.editor.getModel();\r\n        if (model.isTooLargeForTokenization()) {\r\n            // the file is too large, so searching word under cursor in the whole document takes is blocking the UI.\r\n            return;\r\n        }\r\n        var hasFindOccurrences = DocumentHighlightProviderRegistry.has(model);\r\n        var allMatches = model.findMatches(this.state.searchText, true, false, this.state.matchCase, this.state.wordSeparators, false).map(function (m) { return m.range; });\r\n        allMatches.sort(Range.compareRangesUsingStarts);\r\n        var selections = this.editor.getSelections();\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        // do not overlap with selection (issue #64 and #512)\r\n        var matches = [];\r\n        for (var i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\r\n            var match = allMatches[i];\r\n            if (j >= lenJ) {\r\n                // finished all editor selections\r\n                matches.push(match);\r\n                i++;\r\n            }\r\n            else {\r\n                var cmp = Range.compareRangesUsingStarts(match, selections[j]);\r\n                if (cmp < 0) {\r\n                    // match is before sel\r\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\r\n                        matches.push(match);\r\n                    }\r\n                    i++;\r\n                }\r\n                else if (cmp > 0) {\r\n                    // sel is before match\r\n                    j++;\r\n                }\r\n                else {\r\n                    // sel is equal to match\r\n                    i++;\r\n                    j++;\r\n                }\r\n            }\r\n        }\r\n        var decorations = matches.map(function (r) {\r\n            return {\r\n                range: r,\r\n                // Show in overviewRuler only if model has no semantic highlighting\r\n                options: (hasFindOccurrences ? SelectionHighlighter._SELECTION_HIGHLIGHT : SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW)\r\n            };\r\n        });\r\n        this.decorations = this.editor.deltaDecorations(this.decorations, decorations);\r\n    };\r\n    SelectionHighlighter.prototype.dispose = function () {\r\n        this._setState(null);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    SelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n        overviewRuler: {\r\n            color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n            position: OverviewRulerLane.Center\r\n        }\r\n    });\r\n    SelectionHighlighter._SELECTION_HIGHLIGHT = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'selectionHighlight',\r\n    });\r\n    return SelectionHighlighter;\r\n}(Disposable));\r\nexport { SelectionHighlighter };\r\nfunction modelRangesContainSameText(model, ranges, matchCase) {\r\n    var selectedText = getValueInRange(model, ranges[0], !matchCase);\r\n    for (var i = 1, len = ranges.length; i < len; i++) {\r\n        var range = ranges[i];\r\n        if (range.isEmpty()) {\r\n            return false;\r\n        }\r\n        var thisSelectedText = getValueInRange(model, range, !matchCase);\r\n        if (selectedText !== thisSelectedText) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction getValueInRange(model, range, toLowerCase) {\r\n    var text = model.getValueInRange(range);\r\n    return (toLowerCase ? text.toLowerCase() : text);\r\n}\r\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController);\r\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter);\r\nregisterEditorAction(InsertCursorAbove);\r\nregisterEditorAction(InsertCursorBelow);\r\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\r\nregisterEditorAction(AddSelectionToNextFindMatchAction);\r\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\r\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(SelectHighlightsAction);\r\nregisterEditorAction(CompatChangeAll);\r\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\r\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { OutlineModel, OutlineElement } from '../documentSymbols/outlineModel.js';\r\nimport { values } from '../../../base/common/collections.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport function getDocumentSymbols(document, flat, token) {\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var model, roots, _i, _a, child, flatEntries;\r\n        return __generator(this, function (_b) {\r\n            switch (_b.label) {\r\n                case 0: return [4 /*yield*/, OutlineModel.create(document, token)];\r\n                case 1:\r\n                    model = _b.sent();\r\n                    roots = [];\r\n                    for (_i = 0, _a = values(model.children); _i < _a.length; _i++) {\r\n                        child = _a[_i];\r\n                        if (child instanceof OutlineElement) {\r\n                            roots.push(child.symbol);\r\n                        }\r\n                        else {\r\n                            roots.push.apply(roots, values(child.children).map(function (child) { return child.symbol; }));\r\n                        }\r\n                    }\r\n                    flatEntries = [];\r\n                    if (token.isCancellationRequested) {\r\n                        return [2 /*return*/, flatEntries];\r\n                    }\r\n                    if (flat) {\r\n                        flatten(flatEntries, roots, '');\r\n                    }\r\n                    else {\r\n                        flatEntries = roots;\r\n                    }\r\n                    return [2 /*return*/, flatEntries.sort(compareEntriesUsingStart)];\r\n            }\r\n        });\r\n    });\r\n}\r\nfunction compareEntriesUsingStart(a, b) {\r\n    return Range.compareRangesUsingStarts(a.range, b.range);\r\n}\r\nfunction flatten(bucket, entries, overrideContainerLabel) {\r\n    for (var _i = 0, entries_1 = entries; _i < entries_1.length; _i++) {\r\n        var entry = entries_1[_i];\r\n        bucket.push({\r\n            kind: entry.kind,\r\n            tags: entry.tags,\r\n            name: entry.name,\r\n            detail: entry.detail,\r\n            containerName: entry.containerName || overrideContainerLabel,\r\n            range: entry.range,\r\n            selectionRange: entry.selectionRange,\r\n            children: undefined,\r\n        });\r\n        if (entry.children) {\r\n            flatten(bucket, entry.children, entry.name);\r\n        }\r\n    }\r\n}\r\nCommandsRegistry.registerCommand('_executeDocumentSymbolProvider', function (accessor) {\r\n    var args = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        args[_i - 1] = arguments[_i];\r\n    }\r\n    return __awaiter(this, void 0, void 0, function () {\r\n        var resource, model, reference;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    resource = args[0];\r\n                    assertType(URI.isUri(resource));\r\n                    model = accessor.get(IModelService).getModel(resource);\r\n                    if (model) {\r\n                        return [2 /*return*/, getDocumentSymbols(model, false, CancellationToken.None)];\r\n                    }\r\n                    return [4 /*yield*/, accessor.get(ITextModelService).createModelReference(resource)];\r\n                case 1:\r\n                    reference = _a.sent();\r\n                    _a.label = 2;\r\n                case 2:\r\n                    _a.trys.push([2, , 4, 5]);\r\n                    return [4 /*yield*/, getDocumentSymbols(reference.object.textEditorModel, false, CancellationToken.None)];\r\n                case 3: return [2 /*return*/, _a.sent()];\r\n                case 4:\r\n                    reference.dispose();\r\n                    return [7 /*endfinally*/];\r\n                case 5: return [2 /*return*/];\r\n            }\r\n        });\r\n    });\r\n});\r\n"],"sourceRoot":""}