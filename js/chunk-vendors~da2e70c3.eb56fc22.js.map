{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesTree.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesWidget.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesController.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/clickLinkGesture.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoErrorWidget.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToSymbol.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/symbolNavigation.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToCommands.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/referencesModel.js"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","GotoDefinitionAtPositionEditorContribution","editor","textModelResolverService","modeService","_this","this","toUnhook","toUnhookForKeyboard","linkDecorations","currentWordAtPosition","previousPromise","linkGesture","add","onMouseMoveOrRelevantKeyDown","_a","mouseEvent","keyboardEvent","startFindDefinitionFromMouse","onExecute","isEnabled","gotoDefinition","position","hasSideBySideModifier","then","removeLinkDecorations","error","onCancel","get","getContribution","ID","prototype","startFindDefinitionFromCursor","startFindDefinition","onDidChangeCursorPosition","clear","onKeyDown","e","withKey","type","hasModel","word","getModel","getWordAtPosition","Promise","resolve","startColumn","endColumn","state","cancel","token","findDefinition","results","validate","addDecoration","lineNumber","appendText","result_1","uri","createModelReference","ref","object","textEditorModel","startLineNumber","range","getLineCount","dispose","wordRange","previewValue","getPreviewValue","originSelectionRange","lift","modeId","getModeIdByFilepathOrFirstLine","appendCodeblock","undefined","result","rangeToUse","targetSelectionRange","getPreviewRangeBasedOnBrackets","numberOfLinesInRange","endLineNumber","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","startIndent","getLineFirstNonWhitespaceColumn","minIndent","endIndent","Math","min","getValueInRange","replace","RegExp","trim","maxLineNumber","brackets","ignoreFirstEmpty","currentBracket","findNextBracket","push","lastBracket","open","isOpen","pop","maxColumn","getLineMaxColumn","nextLineNumber","nextColumn","hoverMessage","newDecorations","options","inlineClassName","deltaDecorations","isNoneOrSingleMouseDown","hasTriggerModifier","keyCodeIsTriggerKey","has","model","openToSide","setPosition","action","openInPeek","muteMessage","alias","label","id","precondition","invokeWithinContext","accessor","run","theme","collector","activeLinkForeground","getColor","addRule","__extends","extendStatics","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","DataSource","_resolverService","hasChildren","element","failure","getChildren","groups","val","children","Error","Delegate","getHeight","getTemplateId","OneReferenceRenderer","StringRepresentationProvider","_keybindingService","getKeyboardNavigationLabel","preview","parent","parts","value","IdentityProvider","getId","_super","FileReferencesTemplate","container","_uriLabel","themeService","call","document","createElement","dom","file","_register","supportHighlights","badge","appendChild","set","matches","setLabel","getUriLabel","relative","title","len","setCount","setTitleFormat","FileReferencesRenderer","_instantiationService","templateId","renderTemplate","createInstance","renderElement","node","index","template","filterData","disposeTemplate","templateData","OneReferenceTemplate","score","filePreview","highlight","isDefault","AriaProvider","getAriaLabel","ariaMessage","__awaiter","thisArg","_arguments","P","generator","adopt","reject","fulfilled","step","next","rejected","done","apply","__generator","body","f","y","t","g","_","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","DecorationsManager","_editor","_model","_decorations","Map","_decorationIgnoreSet","Set","_callOnDispose","_callOnModelChange","onDidChangeModel","_onModelChanged","removeDecorations","_i","_addDecorations","reference","onDidChangeDecorations","event","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","decorations","toRemove","forEach","decorationId","newRange","getDecorationRange","ignore","equalsRange","spansMultipleLines","lineLength","newLineLength","delete","register","stickiness","className","LayoutData","ratio","heightInLines","fromJSON","raw","data","JSON","parse","ReferenceWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","showFrame","showArrow","isResizeable","isAccessible","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","height","width","_applyTheme","getTheme","onThemeChange","bind","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","peekView","transparent","style","arrowColor","frameColor","headerBackgroundColor","primaryHeadingColor","secondaryHeadingColor","show","where","revealRangeInCenterIfOutsideViewport","focusOnReferenceTree","domFocus","focusOnPreviewEditor","focus","isPreviewEditorFocused","hasTextFocus","_onTitleClick","fire","_getFocusedReference","kind","ctrlKey","metaKey","altKey","source","_fillBody","containerElement","setCssClass","_messageContainer","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalScrollbarSize","horizontal","useShadows","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","minimap","enabled","createFromString","nls","_treeContainer","treeOptions","ariaLabel","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","overrideStyles","listBackground","addView","onDidChange","None","minimumSize","maximumSize","Number","MAX_VALUE","layout","Distribute","_disposables","onDidSashChange","getViewSize","onEvent","_revealReference","onDidChangeFocus","elements","onDidOpen","browserEvent","MouseEvent","KeyboardEvent","detail","tapCount","_onWidth","_doLayoutBody","heightInPixel","widthInPixel","_viewZone","resizeView","setSelection","selection","setFocus","newModel","_onNewModel","isEmpty","setTitle","innerHTML","_decorationsManager","onDidChangeReferenceRange","rerender","onMouseDown","setInput","getFocus","revealParent","promise","scrollType","sel","_revealedReference","scheme","inMemory","getInput","reveal","expand","collapseToStart","revealRangeInCenter","findMatchHighlightColor","referenceHighlightColor","referenceHighlightBorder","hcOutline","resultsBackground","resultsMatchForeground","resultsFileForeground","resultsSelectedBackground","resultsSelectedForeground","editorBackground","editorGutterBackground","ctxReferenceSearchVisible","ReferencesController","contextKeyService","_editorService","_notificationService","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","bindTo","reset","_widget","toggleWidget","modelPromise","peekMode","widgetPosition","closeWidget","containsPosition","_peekMode","onDidChangeModelLanguage","storageKey","onDidClose","store","stringify","getValue","openReference","_gotoReference","requestId","setMetaTitle","references","pos","nearestReference","getOption","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","fwd","currentPosition","editorFocus","previewEditorFocus","nextOrPreviousReference","focusEditor","hide","openCodeEditor","resource","openedEditor","other","model_1","clone","err","sideBySide","withController","fn","outerEditor","controller","registerCommandAndKeybindingRule","weight","primary","when","or","inPeekEditor","handler","secondary","registerCommandAlias","registerCommand","registerKeybindingRule","and","not","mac","listService","lastFocusedList","isArray","hasModifier","modifier","ClickLinkMouseEvent","opts","triggerModifier","triggerSideBySideModifier","ClickLinkKeyboardEvent","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","equals","createOptions","multiCursorModifier","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","_onExecute","_onCancel","_opts","lastMouseMoveEvent","hasTriggerKeyOnMouseDown","onDidChangeConfiguration","hasChanged","newOpts","onMouseMove","onEditorMouseMove","onEditorMouseDown","onMouseUp","onEditorMouseUp","onEditorKeyDown","onKeyUp","onEditorKeyUp","onMouseDrag","resetHandler","onDidChangeCursorSelection","onDidChangeModelContent","onDidScrollChange","scrollTopChanged","scrollLeftChanged","MessageWidget","onRelatedInformation","_openerService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","setAttribute","_messageBlock","_relatedBlock","preventDefault","related","_scrollable","vertical","horizontalScrollbarSize","getDomNode","onScroll","left","scrollLeft","top","scrollTop","update","message","relatedInformation","code","sourceAndCodeLength","lines","split","lines_1","line","max","applyFontInfo","lastLineElement","_b","lines_2","innerText","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","link","toString","onclick","stopPropagation","relatedInformationNode","paddingTop","floor","_c","relatedInformation_1","relatedResource","relatedMessage","fontInfo","scrollWidth","ceil","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","getHeightInLines","MarkerNavigationWidget","actions","_themeService","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","Warning","_backgroundColor","white","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","editorMarkerNavigationWarning","Info","editorMarkerNavigationInfo","_applyStyles","_parentContainer","backgroundColor","_fillHead","_actionbarWidget","icon","_fillTitleIcon","_icon","_getActionBarOptions","tabIndex","_container","_message","showAtMarker","marker","markerIdx","markerCount","classList","remove","severity","editorPosition","getPosition","getStartPosition","computeRequiredHeight","toSeverity","revealPositionInCenter","updateMarker","showStale","_relayout","_heightInPixel","errorDefault","warningDefault","infoDefault","dark","light","hc","linkFg","MarkerModel","markers","_toUnbind","_markers","_nextIdx","_ignoreSelectionChange","_onCurrentMarkerChanged","_onMarkerSetChanged","setMarkers","onDidDispose","currentMarker","enumerable","configurable","oldMarker","sort","compareMarker","withoutWatchingEditorPosition","callback","_initIdx","found","isBeforeOrEqual","canNavigate","idx","indexOf","move","inCircles","oldIdx","atEdge","findMarkerAtPosition","MarkerController","_markerService","_contextKeyService","_disposeOnClose","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","getOrCreateModel","_getMarkers","onMarkerChanged","_onMarkerChanged","prevMarkerKeybinding","lookupKeybinding","nextMarkerKeybinding","LABEL","getLabel","closeMarkersNavigation","actions_1","pinned","revealIfOpened","onCurrentMarkerChanged","total","onMarkerSetChanged","changedResources","editorModel","some","read","severities","MarkerNavigationAction","multiFile","_isNext","_multiFile","markerService","editorService","newMarker","revealInCenterIfOutsideViewport","getAction","a","res","compare","compareRangesUsingStarts","NextMarkerAction","writable","kbOpts","kbExpr","PrevMarkerAction","NextMarkerInFilesAction","PrevMarkerInFilesAction","MarkerCommand","bindToContribution","x","appendMenuItem","group","command","comment","order","getLocationLinks","registry","provide","provider","ordered","promises","map","all","getDefinitionsAtPosition","provideDefinition","getDeclarationsAtPosition","provideDeclaration","getImplementationsAtPosition","provideImplementation","getTypeDefinitionsAtPosition","provideTypeDefinition","getReferencesAtPosition","compact","resultWithoutDeclaration","provideReferences","includeDeclaration","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","put","anchor","refModel","_showMessage","editorState","listener","getActiveCodeEditor","seenUri","seenPosition","revealNext","finally","kb","status","class_1","runEditorCommand","_d","_e","_f","_g","_h","EditorState","_listener","_onDidChange","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","submenu","SymbolNavigationAction","configuration","_configuration","notificationService","progressService","symbolNavService","cts","_getLocationModel","altAction","altActionId","referenceCount","info","isCancellationRequested","referenceAt","_getAlternativeCommand","showMessage","_getNoResultFoundMessage","_onResult","showWhile","gotoLocation","peek","targetEditor","_getGoToPreference","_openInPeek","firstReference","_openReference","modelNow_1","ids_1","setTimeout","getSelection","DefinitionAction","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","GoToDefinitionAction","hasDefinitionProvider","isInEmbeddedEditor","toNegated","editorTextFocus","contextMenuOpts","menuOpts","menuId","OpenDefinitionToSideAction","PeekDefinitionAction","notInPeekEditor","linux","DeclarationAction","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","hasDeclarationProvider","PeekDeclarationAction","TypeDefinitionAction","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","hasTypeDefinitionProvider","PeekTypeDefinitionAction","ImplementationAction","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","hasImplementationProvider","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","GoToReferencesAction","hasReferenceProvider","PeekReferencesAction","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","description","args","name","constraint","isIPosition","multiple","isUri","getFocusedCodeEditor","revealPositionInCenterIfOutsideViewport","Boolean","invokeFunction","executeCommand","codeEditorService","control","column","OneReference","isProviderFirst","_range","_rangeCallback","nextId","FilePreview","_modelReference","getWordUntilPosition","beforeRange","afterRange","before","inside","after","start","end","FileReferences","_loadFailure","fsPath","_resolved","modelReference","ReferencesModel","links","_onDidChangeReferenceRange","_links","_title","current","providersFirst","_compareReferences","links_1","oneRef","childCount","groupCount","nearest","prefixLen","offsetDist","abs"],"mappings":"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","file":"js/chunk-vendors~da2e70c3.eb56fc22.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './goToDefinitionAtPosition.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { DefinitionProviderRegistry } from '../../../common/modes.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\r\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { editorActiveLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { EditorState } from '../../../browser/core/editorState.js';\r\nimport { DefinitionAction } from '../goToCommands.js';\r\nimport { ClickLinkGesture } from './clickLinkGesture.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\r\nvar GotoDefinitionAtPositionEditorContribution = /** @class */ (function () {\r\n    function GotoDefinitionAtPositionEditorContribution(editor, textModelResolverService, modeService) {\r\n        var _this = this;\r\n        this.textModelResolverService = textModelResolverService;\r\n        this.modeService = modeService;\r\n        this.toUnhook = new DisposableStore();\r\n        this.toUnhookForKeyboard = new DisposableStore();\r\n        this.linkDecorations = [];\r\n        this.currentWordAtPosition = null;\r\n        this.previousPromise = null;\r\n        this.editor = editor;\r\n        var linkGesture = new ClickLinkGesture(editor);\r\n        this.toUnhook.add(linkGesture);\r\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(function (_a) {\r\n            var mouseEvent = _a[0], keyboardEvent = _a[1];\r\n            _this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\r\n        }));\r\n        this.toUnhook.add(linkGesture.onExecute(function (mouseEvent) {\r\n            if (_this.isEnabled(mouseEvent)) {\r\n                _this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(function () {\r\n                    _this.removeLinkDecorations();\r\n                }, function (error) {\r\n                    _this.removeLinkDecorations();\r\n                    onUnexpectedError(error);\r\n                });\r\n            }\r\n        }));\r\n        this.toUnhook.add(linkGesture.onCancel(function () {\r\n            _this.removeLinkDecorations();\r\n            _this.currentWordAtPosition = null;\r\n        }));\r\n    }\r\n    GotoDefinitionAtPositionEditorContribution.get = function (editor) {\r\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromCursor = function (position) {\r\n        // For issue: https://github.com/microsoft/vscode/issues/46257\r\n        // equivalent to mouse move with meta/ctrl key\r\n        var _this = this;\r\n        // First find the definition and add decorations\r\n        // to the editor to be shown with the content hover widget\r\n        return this.startFindDefinition(position).then(function () {\r\n            // Add listeners for editor cursor move and key down events\r\n            // Dismiss the \"extended\" editor decorations when the user hides\r\n            // the hover widget. There is no event for the widget itself so these\r\n            // serve as a best effort. After removing the link decorations, the hover\r\n            // widget is clean and will only show declarations per next request.\r\n            _this.toUnhookForKeyboard.add(_this.editor.onDidChangeCursorPosition(function () {\r\n                _this.currentWordAtPosition = null;\r\n                _this.removeLinkDecorations();\r\n                _this.toUnhookForKeyboard.clear();\r\n            }));\r\n            _this.toUnhookForKeyboard.add(_this.editor.onKeyDown(function (e) {\r\n                if (e) {\r\n                    _this.currentWordAtPosition = null;\r\n                    _this.removeLinkDecorations();\r\n                    _this.toUnhookForKeyboard.clear();\r\n                }\r\n            }));\r\n        });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinitionFromMouse = function (mouseEvent, withKey) {\r\n        // check if we are active and on a content widget\r\n        if (mouseEvent.target.type === 9 /* CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return;\r\n        }\r\n        var position = mouseEvent.target.position;\r\n        this.startFindDefinition(position);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.startFindDefinition = function (position) {\r\n        var _this = this;\r\n        var _a;\r\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\r\n        this.toUnhookForKeyboard.clear();\r\n        // Find word at mouse position\r\n        var word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\r\n        if (!word) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return Promise.resolve(0);\r\n        }\r\n        // Return early if word at position is still the same\r\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\r\n            return Promise.resolve(0);\r\n        }\r\n        this.currentWordAtPosition = word;\r\n        // Find definition and decorate word if found\r\n        var state = new EditorState(this.editor, 4 /* Position */ | 1 /* Value */ | 2 /* Selection */ | 8 /* Scroll */);\r\n        if (this.previousPromise) {\r\n            this.previousPromise.cancel();\r\n            this.previousPromise = null;\r\n        }\r\n        this.previousPromise = createCancelablePromise(function (token) { return _this.findDefinition(position, token); });\r\n        return this.previousPromise.then(function (results) {\r\n            if (!results || !results.length || !state.validate(_this.editor)) {\r\n                _this.removeLinkDecorations();\r\n                return;\r\n            }\r\n            // Multiple results\r\n            if (results.length > 1) {\r\n                _this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\r\n            }\r\n            // Single result\r\n            else {\r\n                var result_1 = results[0];\r\n                if (!result_1.uri) {\r\n                    return;\r\n                }\r\n                _this.textModelResolverService.createModelReference(result_1.uri).then(function (ref) {\r\n                    if (!ref.object || !ref.object.textEditorModel) {\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var textEditorModel = ref.object.textEditorModel;\r\n                    var startLineNumber = result_1.range.startLineNumber;\r\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\r\n                        // invalid range\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    var previewValue = _this.getPreviewValue(textEditorModel, startLineNumber, result_1);\r\n                    var wordRange;\r\n                    if (result_1.originSelectionRange) {\r\n                        wordRange = Range.lift(result_1.originSelectionRange);\r\n                    }\r\n                    else {\r\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\r\n                    }\r\n                    var modeId = _this.modeService.getModeIdByFilepathOrFirstLine(textEditorModel.uri);\r\n                    _this.addDecoration(wordRange, new MarkdownString().appendCodeblock(modeId ? modeId : '', previewValue));\r\n                    ref.dispose();\r\n                });\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewValue = function (textEditorModel, startLineNumber, result) {\r\n        var rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\r\n        var numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\r\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\r\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\r\n        }\r\n        var previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.stripIndentationFromPreviewRange = function (textEditorModel, startLineNumber, previewRange) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var minIndent = startIndent;\r\n        for (var endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            minIndent = Math.min(minIndent, endIndent);\r\n        }\r\n        var previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(\"^\\\\s{\" + (minIndent - 1) + \"}\", 'gm'), '').trim();\r\n        return previewValue;\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnIndentation = function (textEditorModel, startLineNumber) {\r\n        var startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var endLineNumber = startLineNumber + 1;\r\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\r\n            var endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            if (startIndent === endIndent) {\r\n                break;\r\n            }\r\n        }\r\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.getPreviewRangeBasedOnBrackets = function (textEditorModel, startLineNumber) {\r\n        var maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        var brackets = [];\r\n        var ignoreFirstEmpty = true;\r\n        var currentBracket = textEditorModel.findNextBracket(new Position(startLineNumber, 1));\r\n        while (currentBracket !== null) {\r\n            if (brackets.length === 0) {\r\n                brackets.push(currentBracket);\r\n            }\r\n            else {\r\n                var lastBracket = brackets[brackets.length - 1];\r\n                if (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\r\n                    brackets.pop();\r\n                }\r\n                else {\r\n                    brackets.push(currentBracket);\r\n                }\r\n                if (brackets.length === 0) {\r\n                    if (ignoreFirstEmpty) {\r\n                        ignoreFirstEmpty = false;\r\n                    }\r\n                    else {\r\n                        return new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\r\n                    }\r\n                }\r\n            }\r\n            var maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\r\n            var nextLineNumber = currentBracket.range.endLineNumber;\r\n            var nextColumn = currentBracket.range.endColumn;\r\n            if (maxColumn === currentBracket.range.endColumn) {\r\n                nextLineNumber++;\r\n                nextColumn = 1;\r\n            }\r\n            if (nextLineNumber > maxLineNumber) {\r\n                return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n            }\r\n            currentBracket = textEditorModel.findNextBracket(new Position(nextLineNumber, nextColumn));\r\n        }\r\n        return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.addDecoration = function (range, hoverMessage) {\r\n        var newDecorations = {\r\n            range: range,\r\n            options: {\r\n                inlineClassName: 'goto-definition-link',\r\n                hoverMessage: hoverMessage\r\n            }\r\n        };\r\n        this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.removeLinkDecorations = function () {\r\n        if (this.linkDecorations.length > 0) {\r\n            this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\r\n        }\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.isEnabled = function (mouseEvent, withKey) {\r\n        return this.editor.hasModel() &&\r\n            mouseEvent.isNoneOrSingleMouseDown &&\r\n            (mouseEvent.target.type === 6 /* CONTENT_TEXT */) &&\r\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\r\n            DefinitionProviderRegistry.has(this.editor.getModel());\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.findDefinition = function (position, token) {\r\n        var model = this.editor.getModel();\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return getDefinitionsAtPosition(model, position, token);\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.gotoDefinition = function (position, openToSide) {\r\n        var _this = this;\r\n        this.editor.setPosition(position);\r\n        var action = new DefinitionAction({ openToSide: openToSide, openInPeek: false, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\r\n        return this.editor.invokeWithinContext(function (accessor) { return action.run(accessor, _this.editor); });\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.prototype.dispose = function () {\r\n        this.toUnhook.dispose();\r\n    };\r\n    GotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\r\n    GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\r\n    GotoDefinitionAtPositionEditorContribution = __decorate([\r\n        __param(1, ITextModelService),\r\n        __param(2, IModeService)\r\n    ], GotoDefinitionAtPositionEditorContribution);\r\n    return GotoDefinitionAtPositionEditorContribution;\r\n}());\r\nexport { GotoDefinitionAtPositionEditorContribution };\r\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(\".monaco-editor .goto-definition-link { color: \" + activeLinkForeground + \" !important; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nimport { getBaseLabel } from '../../../../base/common/labels.js';\r\nimport { dirname, basename } from '../../../../base/common/resources.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\r\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\r\nvar DataSource = /** @class */ (function () {\r\n    function DataSource(_resolverService) {\r\n        this._resolverService = _resolverService;\r\n    }\r\n    DataSource.prototype.hasChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return true;\r\n        }\r\n        if (element instanceof FileReferences && !element.failure) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    DataSource.prototype.getChildren = function (element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return element.groups;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return element.resolve(this._resolverService).then(function (val) {\r\n                // if (element.failure) {\r\n                // \t// refresh the element on failure so that\r\n                // \t// we can update its rendering\r\n                // \treturn tree.refresh(element).then(() => val.children);\r\n                // }\r\n                return val.children;\r\n            });\r\n        }\r\n        throw new Error('bad tree');\r\n    };\r\n    DataSource = __decorate([\r\n        __param(0, ITextModelService)\r\n    ], DataSource);\r\n    return DataSource;\r\n}());\r\nexport { DataSource };\r\n//#endregion\r\nvar Delegate = /** @class */ (function () {\r\n    function Delegate() {\r\n    }\r\n    Delegate.prototype.getHeight = function () {\r\n        return 23;\r\n    };\r\n    Delegate.prototype.getTemplateId = function (element) {\r\n        if (element instanceof FileReferences) {\r\n            return FileReferencesRenderer.id;\r\n        }\r\n        else {\r\n            return OneReferenceRenderer.id;\r\n        }\r\n    };\r\n    return Delegate;\r\n}());\r\nexport { Delegate };\r\nvar StringRepresentationProvider = /** @class */ (function () {\r\n    function StringRepresentationProvider(_keybindingService) {\r\n        this._keybindingService = _keybindingService;\r\n    }\r\n    StringRepresentationProvider.prototype.getKeyboardNavigationLabel = function (element) {\r\n        if (element instanceof OneReference) {\r\n            var preview = element.parent.preview;\r\n            var parts = preview && preview.preview(element.range);\r\n            if (parts) {\r\n                return parts.value;\r\n            }\r\n        }\r\n        // FileReferences or unresolved OneReference\r\n        return basename(element.uri);\r\n    };\r\n    StringRepresentationProvider = __decorate([\r\n        __param(0, IKeybindingService)\r\n    ], StringRepresentationProvider);\r\n    return StringRepresentationProvider;\r\n}());\r\nexport { StringRepresentationProvider };\r\nvar IdentityProvider = /** @class */ (function () {\r\n    function IdentityProvider() {\r\n    }\r\n    IdentityProvider.prototype.getId = function (element) {\r\n        return element instanceof OneReference ? element.id : element.uri;\r\n    };\r\n    return IdentityProvider;\r\n}());\r\nexport { IdentityProvider };\r\n//#region render: File\r\nvar FileReferencesTemplate = /** @class */ (function (_super) {\r\n    __extends(FileReferencesTemplate, _super);\r\n    function FileReferencesTemplate(container, _uriLabel, themeService) {\r\n        var _this = _super.call(this) || this;\r\n        _this._uriLabel = _uriLabel;\r\n        var parent = document.createElement('div');\r\n        dom.addClass(parent, 'reference-file');\r\n        _this.file = _this._register(new IconLabel(parent, { supportHighlights: true }));\r\n        _this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\r\n        _this._register(attachBadgeStyler(_this.badge, themeService));\r\n        container.appendChild(parent);\r\n        return _this;\r\n    }\r\n    FileReferencesTemplate.prototype.set = function (element, matches) {\r\n        var parent = dirname(element.uri);\r\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches: matches });\r\n        var len = element.children.length;\r\n        this.badge.setCount(len);\r\n        if (element.failure) {\r\n            this.badge.setTitleFormat(localize('referencesFailre', \"Failed to resolve file.\"));\r\n        }\r\n        else if (len > 1) {\r\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\r\n        }\r\n        else {\r\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\r\n        }\r\n    };\r\n    FileReferencesTemplate = __decorate([\r\n        __param(1, ILabelService),\r\n        __param(2, IThemeService)\r\n    ], FileReferencesTemplate);\r\n    return FileReferencesTemplate;\r\n}(Disposable));\r\nvar FileReferencesRenderer = /** @class */ (function () {\r\n    function FileReferencesRenderer(_instantiationService) {\r\n        this._instantiationService = _instantiationService;\r\n        this.templateId = FileReferencesRenderer.id;\r\n    }\r\n    FileReferencesRenderer.prototype.renderTemplate = function (container) {\r\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\r\n    };\r\n    FileReferencesRenderer.prototype.renderElement = function (node, index, template) {\r\n        template.set(node.element, createMatches(node.filterData));\r\n    };\r\n    FileReferencesRenderer.prototype.disposeTemplate = function (templateData) {\r\n        templateData.dispose();\r\n    };\r\n    FileReferencesRenderer.id = 'FileReferencesRenderer';\r\n    FileReferencesRenderer = __decorate([\r\n        __param(0, IInstantiationService)\r\n    ], FileReferencesRenderer);\r\n    return FileReferencesRenderer;\r\n}());\r\nexport { FileReferencesRenderer };\r\n//#endregion\r\n//#region render: Reference\r\nvar OneReferenceTemplate = /** @class */ (function () {\r\n    function OneReferenceTemplate(container) {\r\n        this.label = new HighlightedLabel(container, false);\r\n    }\r\n    OneReferenceTemplate.prototype.set = function (element, score) {\r\n        var filePreview = element.parent.preview;\r\n        var preview = filePreview && filePreview.preview(element.range);\r\n        if (!preview) {\r\n            // this means we FAILED to resolve the document...\r\n            this.label.set(basename(element.uri) + \":\" + (element.range.startLineNumber + 1) + \":\" + (element.range.startColumn + 1));\r\n        }\r\n        else {\r\n            // render search match as highlight unless\r\n            // we have score, then render the score\r\n            var value = preview.value, highlight = preview.highlight;\r\n            if (score && !FuzzyScore.isDefault(score)) {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', false);\r\n                this.label.set(value, createMatches(score));\r\n            }\r\n            else {\r\n                dom.toggleClass(this.label.element, 'referenceMatch', true);\r\n                this.label.set(value, [highlight]);\r\n            }\r\n        }\r\n    };\r\n    return OneReferenceTemplate;\r\n}());\r\nvar OneReferenceRenderer = /** @class */ (function () {\r\n    function OneReferenceRenderer() {\r\n        this.templateId = OneReferenceRenderer.id;\r\n    }\r\n    OneReferenceRenderer.prototype.renderTemplate = function (container) {\r\n        return new OneReferenceTemplate(container);\r\n    };\r\n    OneReferenceRenderer.prototype.renderElement = function (node, index, templateData) {\r\n        templateData.set(node.element, node.filterData);\r\n    };\r\n    OneReferenceRenderer.prototype.disposeTemplate = function () {\r\n    };\r\n    OneReferenceRenderer.id = 'OneReferenceRenderer';\r\n    return OneReferenceRenderer;\r\n}());\r\nexport { OneReferenceRenderer };\r\n//#endregion\r\nvar AriaProvider = /** @class */ (function () {\r\n    function AriaProvider() {\r\n    }\r\n    AriaProvider.prototype.getAriaLabel = function (element) {\r\n        return element.ariaMessage;\r\n    };\r\n    return AriaProvider;\r\n}());\r\nexport { AriaProvider };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport './referencesWidget.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Emitter, Event } from '../../../../base/common/event.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../../base/common/network.js';\r\nimport { basenameOrAuthority, dirname, isEqual } from '../../../../base/common/resources.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { AriaProvider, DataSource, Delegate, FileReferencesRenderer, OneReferenceRenderer, StringRepresentationProvider, IdentityProvider } from './referencesTree.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\r\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport * as peekView from '../../peekView/peekView.js';\r\nimport { FileReferences, OneReference } from '../referencesModel.js';\r\nimport { SplitView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\r\nvar DecorationsManager = /** @class */ (function () {\r\n    function DecorationsManager(_editor, _model) {\r\n        var _this = this;\r\n        this._editor = _editor;\r\n        this._model = _model;\r\n        this._decorations = new Map();\r\n        this._decorationIgnoreSet = new Set();\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModelChange = new DisposableStore();\r\n        this._callOnDispose.add(this._editor.onDidChangeModel(function () { return _this._onModelChanged(); }));\r\n        this._onModelChanged();\r\n    }\r\n    DecorationsManager.prototype.dispose = function () {\r\n        this._callOnModelChange.dispose();\r\n        this._callOnDispose.dispose();\r\n        this.removeDecorations();\r\n    };\r\n    DecorationsManager.prototype._onModelChanged = function () {\r\n        this._callOnModelChange.clear();\r\n        var model = this._editor.getModel();\r\n        if (model) {\r\n            for (var _i = 0, _a = this._model.groups; _i < _a.length; _i++) {\r\n                var ref = _a[_i];\r\n                if (isEqual(ref.uri, model.uri)) {\r\n                    this._addDecorations(ref);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    DecorationsManager.prototype._addDecorations = function (reference) {\r\n        var _this = this;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(function (event) { return _this._onDecorationChanged(); }));\r\n        var newDecorations = [];\r\n        var newDecorationsActualIndex = [];\r\n        for (var i = 0, len = reference.children.length; i < len; i++) {\r\n            var oneReference = reference.children[i];\r\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\r\n                continue;\r\n            }\r\n            newDecorations.push({\r\n                range: oneReference.range,\r\n                options: DecorationsManager.DecorationOptions\r\n            });\r\n            newDecorationsActualIndex.push(i);\r\n        }\r\n        var decorations = this._editor.deltaDecorations([], newDecorations);\r\n        for (var i = 0; i < decorations.length; i++) {\r\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\r\n        }\r\n    };\r\n    DecorationsManager.prototype._onDecorationChanged = function () {\r\n        var _this = this;\r\n        var toRemove = [];\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        this._decorations.forEach(function (reference, decorationId) {\r\n            var newRange = model.getDecorationRange(decorationId);\r\n            if (!newRange) {\r\n                return;\r\n            }\r\n            var ignore = false;\r\n            if (Range.equalsRange(newRange, reference.range)) {\r\n                return;\r\n            }\r\n            else if (Range.spansMultipleLines(newRange)) {\r\n                ignore = true;\r\n            }\r\n            else {\r\n                var lineLength = reference.range.endColumn - reference.range.startColumn;\r\n                var newLineLength = newRange.endColumn - newRange.startColumn;\r\n                if (lineLength !== newLineLength) {\r\n                    ignore = true;\r\n                }\r\n            }\r\n            if (ignore) {\r\n                _this._decorationIgnoreSet.add(reference.id);\r\n                toRemove.push(decorationId);\r\n            }\r\n            else {\r\n                reference.range = newRange;\r\n            }\r\n        });\r\n        for (var i = 0, len = toRemove.length; i < len; i++) {\r\n            this._decorations.delete(toRemove[i]);\r\n        }\r\n        this._editor.deltaDecorations(toRemove, []);\r\n    };\r\n    DecorationsManager.prototype.removeDecorations = function () {\r\n        var toRemove = [];\r\n        this._decorations.forEach(function (value, key) {\r\n            toRemove.push(key);\r\n        });\r\n        this._editor.deltaDecorations(toRemove, []);\r\n        this._decorations.clear();\r\n    };\r\n    DecorationsManager.DecorationOptions = ModelDecorationOptions.register({\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        className: 'reference-decoration'\r\n    });\r\n    return DecorationsManager;\r\n}());\r\nvar LayoutData = /** @class */ (function () {\r\n    function LayoutData() {\r\n        this.ratio = 0.7;\r\n        this.heightInLines = 18;\r\n    }\r\n    LayoutData.fromJSON = function (raw) {\r\n        var ratio;\r\n        var heightInLines;\r\n        try {\r\n            var data = JSON.parse(raw);\r\n            ratio = data.ratio;\r\n            heightInLines = data.heightInLines;\r\n        }\r\n        catch (_a) {\r\n            //\r\n        }\r\n        return {\r\n            ratio: ratio || 0.7,\r\n            heightInLines: heightInLines || 18\r\n        };\r\n    };\r\n    return LayoutData;\r\n}());\r\nexport { LayoutData };\r\n/**\r\n * ZoneWidget that is shown inside the editor\r\n */\r\nvar ReferenceWidget = /** @class */ (function (_super) {\r\n    __extends(ReferenceWidget, _super);\r\n    function ReferenceWidget(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel) {\r\n        var _this = _super.call(this, editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true }) || this;\r\n        _this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        _this.layoutData = layoutData;\r\n        _this._textModelResolverService = _textModelResolverService;\r\n        _this._instantiationService = _instantiationService;\r\n        _this._peekViewService = _peekViewService;\r\n        _this._uriLabel = _uriLabel;\r\n        _this._disposeOnNewModel = new DisposableStore();\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectReference = new Emitter();\r\n        _this.onDidSelectReference = _this._onDidSelectReference.event;\r\n        _this._dim = { height: 0, width: 0 };\r\n        _this._applyTheme(themeService.getTheme());\r\n        _this._callOnDispose.add(themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this._peekViewService.addExclusiveWidget(editor, _this);\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    ReferenceWidget.prototype.dispose = function () {\r\n        this.setModel(undefined);\r\n        this._callOnDispose.dispose();\r\n        this._disposeOnNewModel.dispose();\r\n        dispose(this._preview);\r\n        dispose(this._previewNotAvailableMessage);\r\n        dispose(this._tree);\r\n        dispose(this._previewModelReference);\r\n        this._splitView.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ReferenceWidget.prototype._applyTheme = function (theme) {\r\n        var borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\r\n        this.style({\r\n            arrowColor: borderColor,\r\n            frameColor: borderColor,\r\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\r\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.show = function (where) {\r\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\r\n        _super.prototype.show.call(this, where, this.layoutData.heightInLines || 18);\r\n    };\r\n    ReferenceWidget.prototype.focusOnReferenceTree = function () {\r\n        this._tree.domFocus();\r\n    };\r\n    ReferenceWidget.prototype.focusOnPreviewEditor = function () {\r\n        this._preview.focus();\r\n    };\r\n    ReferenceWidget.prototype.isPreviewEditorFocused = function () {\r\n        return this._preview.hasTextFocus();\r\n    };\r\n    ReferenceWidget.prototype._onTitleClick = function (e) {\r\n        if (this._preview && this._preview.getModel()) {\r\n            this._onDidSelectReference.fire({\r\n                element: this._getFocusedReference(),\r\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\r\n                source: 'title'\r\n            });\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._fillBody = function (containerElement) {\r\n        var _this = this;\r\n        this.setCssClass('reference-zone-widget');\r\n        // message pane\r\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\r\n        dom.hide(this._messageContainer);\r\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\r\n        // editor\r\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\r\n        var options = {\r\n            scrollBeyondLastLine: false,\r\n            scrollbar: {\r\n                verticalScrollbarSize: 14,\r\n                horizontal: 'auto',\r\n                useShadows: true,\r\n                verticalHasArrows: false,\r\n                horizontalHasArrows: false,\r\n                alwaysConsumeMouseWheel: false\r\n            },\r\n            overviewRulerLanes: 2,\r\n            fixedOverflowWidgets: true,\r\n            minimap: {\r\n                enabled: false\r\n            }\r\n        };\r\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\r\n        dom.hide(this._previewContainer);\r\n        this._previewNotAvailableMessage = TextModel.createFromString(nls.localize('missingPreviewMessage', \"no preview available\"));\r\n        // tree\r\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\r\n        var treeOptions = {\r\n            ariaLabel: nls.localize('treeAriaLabel', \"References\"),\r\n            keyboardSupport: this._defaultTreeKeyboardSupport,\r\n            accessibilityProvider: new AriaProvider(),\r\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\r\n            identityProvider: new IdentityProvider(),\r\n            overrideStyles: {\r\n                listBackground: peekView.peekViewResultsBackground\r\n            }\r\n        };\r\n        this._tree = this._instantiationService.createInstance(WorkbenchAsyncDataTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\r\n            this._instantiationService.createInstance(FileReferencesRenderer),\r\n            this._instantiationService.createInstance(OneReferenceRenderer),\r\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\r\n        // split stuff\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._previewContainer,\r\n            minimumSize: 200,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._preview.layout({ height: _this._dim.height, width: width });\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._treeContainer,\r\n            minimumSize: 100,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: function (width) {\r\n                _this._treeContainer.style.height = _this._dim.height + \"px\";\r\n                _this._treeContainer.style.width = width + \"px\";\r\n                _this._tree.layout(_this._dim.height, width);\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._disposables.add(this._splitView.onDidSashChange(function () {\r\n            if (_this._dim.width) {\r\n                _this.layoutData.ratio = _this._splitView.getViewSize(0) / _this._dim.width;\r\n            }\r\n        }, undefined));\r\n        // listen on selection and focus\r\n        var onEvent = function (element, kind) {\r\n            if (element instanceof OneReference) {\r\n                if (kind === 'show') {\r\n                    _this._revealReference(element, false);\r\n                }\r\n                _this._onDidSelectReference.fire({ element: element, kind: kind, source: 'tree' });\r\n            }\r\n        };\r\n        this._tree.onDidChangeFocus(function (e) {\r\n            onEvent(e.elements[0], 'show');\r\n        });\r\n        this._tree.onDidOpen(function (e) {\r\n            if (e.browserEvent instanceof MouseEvent && (e.browserEvent.ctrlKey || e.browserEvent.metaKey || e.browserEvent.altKey)) {\r\n                // modifier-click -> open to the side\r\n                onEvent(e.elements[0], 'side');\r\n            }\r\n            else if (e.browserEvent instanceof KeyboardEvent || (e.browserEvent instanceof MouseEvent && e.browserEvent.detail === 2) || e.browserEvent.tapCount === 2) {\r\n                // keybinding (list service command)\r\n                // OR double click\r\n                // OR double tap\r\n                // -> close widget and goto target\r\n                onEvent(e.elements[0], 'goto');\r\n            }\r\n            else {\r\n                // preview location\r\n                onEvent(e.elements[0], 'show');\r\n            }\r\n        });\r\n        dom.hide(this._treeContainer);\r\n    };\r\n    ReferenceWidget.prototype._onWidth = function (width) {\r\n        if (this._dim) {\r\n            this._doLayoutBody(this._dim.height, width);\r\n        }\r\n    };\r\n    ReferenceWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._dim = { height: heightInPixel, width: widthInPixel };\r\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\r\n        this._splitView.layout(widthInPixel);\r\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\r\n    };\r\n    ReferenceWidget.prototype.setSelection = function (selection) {\r\n        var _this = this;\r\n        return this._revealReference(selection, true).then(function () {\r\n            if (!_this._model) {\r\n                // disposed\r\n                return;\r\n            }\r\n            // show in tree\r\n            _this._tree.setSelection([selection]);\r\n            _this._tree.setFocus([selection]);\r\n        });\r\n    };\r\n    ReferenceWidget.prototype.setModel = function (newModel) {\r\n        // clean up\r\n        this._disposeOnNewModel.clear();\r\n        this._model = newModel;\r\n        if (this._model) {\r\n            return this._onNewModel();\r\n        }\r\n        return Promise.resolve();\r\n    };\r\n    ReferenceWidget.prototype._onNewModel = function () {\r\n        var _this = this;\r\n        if (!this._model) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        if (this._model.isEmpty) {\r\n            this.setTitle('');\r\n            this._messageContainer.innerHTML = nls.localize('noResults', \"No results\");\r\n            dom.show(this._messageContainer);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        dom.hide(this._messageContainer);\r\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\r\n        this._disposeOnNewModel.add(this._decorationsManager);\r\n        // listen on model changes\r\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(function (reference) { return _this._tree.rerender(reference); }));\r\n        // listen on editor\r\n        this._disposeOnNewModel.add(this._preview.onMouseDown(function (e) {\r\n            var event = e.event, target = e.target;\r\n            if (event.detail !== 2) {\r\n                return;\r\n            }\r\n            var element = _this._getFocusedReference();\r\n            if (!element) {\r\n                return;\r\n            }\r\n            _this._onDidSelectReference.fire({\r\n                element: { uri: element.uri, range: target.range },\r\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\r\n                source: 'editor'\r\n            });\r\n        }));\r\n        // make sure things are rendered\r\n        dom.addClass(this.container, 'results-loaded');\r\n        dom.show(this._treeContainer);\r\n        dom.show(this._previewContainer);\r\n        this._splitView.layout(this._dim.width);\r\n        this.focusOnReferenceTree();\r\n        // pick input and a reference to begin with\r\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\r\n    };\r\n    ReferenceWidget.prototype._getFocusedReference = function () {\r\n        var element = this._tree.getFocus()[0];\r\n        if (element instanceof OneReference) {\r\n            return element;\r\n        }\r\n        else if (element instanceof FileReferences) {\r\n            if (element.children.length > 0) {\r\n                return element.children[0];\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferenceWidget.prototype._revealReference = function (reference, revealParent) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promise, ref, model, scrollType, sel;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // check if there is anything to do...\r\n                        if (this._revealedReference === reference) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this._revealedReference = reference;\r\n                        // Update widget header\r\n                        if (reference.uri.scheme !== Schemas.inMemory) {\r\n                            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\r\n                        }\r\n                        else {\r\n                            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\r\n                        }\r\n                        promise = this._textModelResolverService.createModelReference(reference.uri);\r\n                        if (!(this._tree.getInput() === reference.parent)) return [3 /*break*/, 1];\r\n                        this._tree.reveal(reference);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        if (revealParent) {\r\n                            this._tree.reveal(reference.parent);\r\n                        }\r\n                        return [4 /*yield*/, this._tree.expand(reference.parent)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        this._tree.reveal(reference);\r\n                        _a.label = 3;\r\n                    case 3: return [4 /*yield*/, promise];\r\n                    case 4:\r\n                        ref = _a.sent();\r\n                        if (!this._model) {\r\n                            // disposed\r\n                            ref.dispose();\r\n                            return [2 /*return*/];\r\n                        }\r\n                        dispose(this._previewModelReference);\r\n                        model = ref.object;\r\n                        if (model) {\r\n                            scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\r\n                            sel = Range.lift(reference.range).collapseToStart();\r\n                            this._previewModelReference = ref;\r\n                            this._preview.setModel(model.textEditorModel);\r\n                            this._preview.setSelection(sel);\r\n                            this._preview.revealRangeInCenter(sel, scrollType);\r\n                        }\r\n                        else {\r\n                            this._preview.setModel(this._previewNotAvailableMessage);\r\n                            ref.dispose();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferenceWidget = __decorate([\r\n        __param(3, IThemeService),\r\n        __param(4, ITextModelService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, peekView.IPeekViewService),\r\n        __param(7, ILabelService)\r\n    ], ReferenceWidget);\r\n    return ReferenceWidget;\r\n}(peekView.PeekViewWidget));\r\nexport { ReferenceWidget };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\r\n    if (findMatchHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: \" + findMatchHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\r\n    if (referenceHighlightColor) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: \" + referenceHighlightColor + \"; }\");\r\n    }\r\n    var referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\r\n    if (referenceHighlightBorder) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid \" + referenceHighlightBorder + \"; box-sizing: border-box; }\");\r\n    }\r\n    var hcOutline = theme.getColor(activeContrastBorder);\r\n    if (hcOutline) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted \" + hcOutline + \"; box-sizing: border-box; }\");\r\n    }\r\n    var resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\r\n    if (resultsBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { background-color: \" + resultsBackground + \"; }\");\r\n    }\r\n    var resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\r\n    if (resultsMatchForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree { color: \" + resultsMatchForeground + \"; }\");\r\n    }\r\n    var resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\r\n    if (resultsFileForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .reference-file { color: \" + resultsFileForeground + \"; }\");\r\n    }\r\n    var resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\r\n    if (resultsSelectedBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: \" + resultsSelectedBackground + \"; }\");\r\n    }\r\n    var resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\r\n    if (resultsSelectedForeground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: \" + resultsSelectedForeground + \" !important; }\");\r\n    }\r\n    var editorBackground = theme.getColor(peekView.peekViewEditorBackground);\r\n    if (editorBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,\" +\r\n            \".monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {\" +\r\n            (\"\\tbackground-color: \" + editorBackground + \";\") +\r\n            \"}\");\r\n    }\r\n    var editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\r\n    if (editorGutterBackground) {\r\n        collector.addRule(\".monaco-editor .reference-zone-widget .preview .monaco-editor .margin {\" +\r\n            (\"\\tbackground-color: \" + editorGutterBackground + \";\") +\r\n            \"}\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../../nls.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IContextKeyService, RawContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nimport { OneReference } from '../referencesModel.js';\r\nimport { ReferenceWidget, LayoutData } from './referencesWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { getOuterEditor, PeekContext } from '../../peekView/peekView.js';\r\nimport { IListService, WorkbenchListFocusContextKey } from '../../../../platform/list/browser/listService.js';\r\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\r\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\r\nexport var ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false);\r\nvar ReferencesController = /** @class */ (function () {\r\n    function ReferencesController(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\r\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        this._editor = _editor;\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._instantiationService = _instantiationService;\r\n        this._storageService = _storageService;\r\n        this._configurationService = _configurationService;\r\n        this._disposables = new DisposableStore();\r\n        this._requestIdPool = 0;\r\n        this._ignoreModelChangeEvent = false;\r\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\r\n    }\r\n    ReferencesController.get = function (editor) {\r\n        return editor.getContribution(ReferencesController.ID);\r\n    };\r\n    ReferencesController.prototype.dispose = function () {\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.dispose();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n    };\r\n    ReferencesController.prototype.toggleWidget = function (range, modelPromise, peekMode) {\r\n        var _this = this;\r\n        // close current widget and return early is position didn't change\r\n        var widgetPosition;\r\n        if (this._widget) {\r\n            widgetPosition = this._widget.position;\r\n        }\r\n        this.closeWidget();\r\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\r\n            return;\r\n        }\r\n        this._peekMode = peekMode;\r\n        this._referenceSearchVisible.set(true);\r\n        // close the widget on model/mode changes\r\n        this._disposables.add(this._editor.onDidChangeModelLanguage(function () { _this.closeWidget(); }));\r\n        this._disposables.add(this._editor.onDidChangeModel(function () {\r\n            if (!_this._ignoreModelChangeEvent) {\r\n                _this.closeWidget();\r\n            }\r\n        }));\r\n        var storageKey = 'peekViewLayout';\r\n        var data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* GLOBAL */, '{}'));\r\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\r\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\r\n        this._widget.show(range);\r\n        this._disposables.add(this._widget.onDidClose(function () {\r\n            modelPromise.cancel();\r\n            if (_this._widget) {\r\n                _this._storageService.store(storageKey, JSON.stringify(_this._widget.layoutData), 0 /* GLOBAL */);\r\n                _this._widget = undefined;\r\n            }\r\n            _this.closeWidget();\r\n        }));\r\n        this._disposables.add(this._widget.onDidSelectReference(function (event) {\r\n            var element = event.element, kind = event.kind;\r\n            if (!element) {\r\n                return;\r\n            }\r\n            switch (kind) {\r\n                case 'open':\r\n                    if (event.source !== 'editor' || !_this._configurationService.getValue('editor.stablePeek')) {\r\n                        // when stable peek is configured we don't close\r\n                        // the peek window on selecting the editor\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n                case 'side':\r\n                    _this.openReference(element, true);\r\n                    break;\r\n                case 'goto':\r\n                    if (peekMode) {\r\n                        _this._gotoReference(element);\r\n                    }\r\n                    else {\r\n                        _this.openReference(element, false);\r\n                    }\r\n                    break;\r\n            }\r\n        }));\r\n        var requestId = ++this._requestIdPool;\r\n        modelPromise.then(function (model) {\r\n            // still current request? widget still open?\r\n            if (requestId !== _this._requestIdPool || !_this._widget) {\r\n                return undefined;\r\n            }\r\n            if (_this._model) {\r\n                _this._model.dispose();\r\n            }\r\n            _this._model = model;\r\n            // show widget\r\n            return _this._widget.setModel(_this._model).then(function () {\r\n                if (_this._widget && _this._model && _this._editor.hasModel()) { // might have been closed\r\n                    // set title\r\n                    if (!_this._model.isEmpty) {\r\n                        _this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", _this._model.title, _this._model.references.length));\r\n                    }\r\n                    else {\r\n                        _this._widget.setMetaTitle('');\r\n                    }\r\n                    // set 'best' selection\r\n                    var uri = _this._editor.getModel().uri;\r\n                    var pos = new Position(range.startLineNumber, range.startColumn);\r\n                    var selection = _this._model.nearestReference(uri, pos);\r\n                    if (selection) {\r\n                        return _this._widget.setSelection(selection).then(function () {\r\n                            if (_this._widget && _this._editor.getOption(65 /* peekWidgetDefaultFocus */) === 'editor') {\r\n                                _this._widget.focusOnPreviewEditor();\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                return undefined;\r\n            });\r\n        }, function (error) {\r\n            _this._notificationService.error(error);\r\n        });\r\n    };\r\n    ReferencesController.prototype.changeFocusBetweenPreviewAndReferences = function () {\r\n        if (!this._widget) {\r\n            // can be called while still resolving...\r\n            return;\r\n        }\r\n        if (this._widget.isPreviewEditorFocused()) {\r\n            this._widget.focusOnReferenceTree();\r\n        }\r\n        else {\r\n            this._widget.focusOnPreviewEditor();\r\n        }\r\n    };\r\n    ReferencesController.prototype.goToNextOrPreviousReference = function (fwd) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var currentPosition, source, target, editorFocus, previewEditorFocus;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._editor.hasModel() || !this._model || !this._widget) {\r\n                            // can be called while still resolving...\r\n                            return [2 /*return*/];\r\n                        }\r\n                        currentPosition = this._widget.position;\r\n                        if (!currentPosition) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\r\n                        if (!source) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        target = this._model.nextOrPreviousReference(source, fwd);\r\n                        editorFocus = this._editor.hasTextFocus();\r\n                        previewEditorFocus = this._widget.isPreviewEditorFocused();\r\n                        return [4 /*yield*/, this._widget.setSelection(target)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, this._gotoReference(target)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        if (editorFocus) {\r\n                            this._editor.focus();\r\n                        }\r\n                        else if (this._widget && previewEditorFocus) {\r\n                            this._widget.focusOnPreviewEditor();\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ReferencesController.prototype.closeWidget = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.clear();\r\n        dispose(this._widget);\r\n        dispose(this._model);\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n        this._requestIdPool += 1; // Cancel pending requests\r\n    };\r\n    ReferencesController.prototype._gotoReference = function (ref) {\r\n        var _this = this;\r\n        if (this._widget) {\r\n            this._widget.hide();\r\n        }\r\n        this._ignoreModelChangeEvent = true;\r\n        var range = Range.lift(ref.range).collapseToStart();\r\n        return this._editorService.openCodeEditor({\r\n            resource: ref.uri,\r\n            options: { selection: range }\r\n        }, this._editor).then(function (openedEditor) {\r\n            var _a;\r\n            _this._ignoreModelChangeEvent = false;\r\n            if (!openedEditor || !_this._widget) {\r\n                // something went wrong...\r\n                _this.closeWidget();\r\n                return;\r\n            }\r\n            if (_this._editor === openedEditor) {\r\n                //\r\n                _this._widget.show(range);\r\n                _this._widget.focusOnReferenceTree();\r\n            }\r\n            else {\r\n                // we opened a different editor instance which means a different controller instance.\r\n                // therefore we stop with this controller and continue with the other\r\n                var other = ReferencesController.get(openedEditor);\r\n                var model_1 = _this._model.clone();\r\n                _this.closeWidget();\r\n                openedEditor.focus();\r\n                other.toggleWidget(range, createCancelablePromise(function (_) { return Promise.resolve(model_1); }), (_a = _this._peekMode) !== null && _a !== void 0 ? _a : false);\r\n            }\r\n        }, function (err) {\r\n            _this._ignoreModelChangeEvent = false;\r\n            onUnexpectedError(err);\r\n        });\r\n    };\r\n    ReferencesController.prototype.openReference = function (ref, sideBySide) {\r\n        // clear stage\r\n        if (!sideBySide) {\r\n            this.closeWidget();\r\n        }\r\n        var uri = ref.uri, range = ref.range;\r\n        this._editorService.openCodeEditor({\r\n            resource: uri,\r\n            options: { selection: range }\r\n        }, this._editor, sideBySide);\r\n    };\r\n    ReferencesController.ID = 'editor.contrib.referencesController';\r\n    ReferencesController = __decorate([\r\n        __param(2, IContextKeyService),\r\n        __param(3, ICodeEditorService),\r\n        __param(4, INotificationService),\r\n        __param(5, IInstantiationService),\r\n        __param(6, IStorageService),\r\n        __param(7, IConfigurationService)\r\n    ], ReferencesController);\r\n    return ReferencesController;\r\n}());\r\nexport { ReferencesController };\r\nfunction withController(accessor, fn) {\r\n    var outerEditor = getOuterEditor(accessor);\r\n    if (!outerEditor) {\r\n        return;\r\n    }\r\n    var controller = ReferencesController.get(outerEditor);\r\n    if (controller) {\r\n        fn(controller);\r\n    }\r\n}\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'togglePeekWidgetFocus',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 60 /* F2 */),\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.changeFocusBetweenPreviewAndReferences();\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToNextReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 62 /* F4 */,\r\n    secondary: [70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(true);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToPreviousReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 1024 /* Shift */ | 62 /* F4 */,\r\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler: function (accessor) {\r\n        withController(accessor, function (controller) {\r\n            controller.goToNextOrPreviousReference(false);\r\n        });\r\n    }\r\n});\r\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\r\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\r\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\r\n// close\r\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\r\nCommandsRegistry.registerCommand('closeReferenceSearch', function (accessor) { return withController(accessor, function (controller) { return controller.closeWidget(); }); });\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 100 /* EditorContrib */ - 101,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'openReferenceToSide',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n    mac: {\r\n        primary: 256 /* WinCtrl */ | 3 /* Enter */\r\n    },\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey),\r\n    handler: function (accessor) {\r\n        var _a;\r\n        var listService = accessor.get(IListService);\r\n        var focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n            withController(accessor, function (controller) { return controller.openReference(focus[0], true); });\r\n        }\r\n    }\r\n});\r\nCommandsRegistry.registerCommand('openReference', function (accessor) {\r\n    var _a;\r\n    var listService = accessor.get(IListService);\r\n    var focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n        withController(accessor, function (controller) { return controller.openReference(focus[0], false); });\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../../base/common/event.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nfunction hasModifier(e, modifier) {\r\n    return !!e[modifier];\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkMouseEvent = /** @class */ (function () {\r\n    function ClickLinkMouseEvent(source, opts) {\r\n        this.target = source.target;\r\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\r\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\r\n        this.isNoneOrSingleMouseDown = (browser.isIE || source.event.detail <= 1); // IE does not support event.detail properly\r\n    }\r\n    return ClickLinkMouseEvent;\r\n}());\r\nexport { ClickLinkMouseEvent };\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nvar ClickLinkKeyboardEvent = /** @class */ (function () {\r\n    function ClickLinkKeyboardEvent(source, opts) {\r\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\r\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\r\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\r\n    }\r\n    return ClickLinkKeyboardEvent;\r\n}());\r\nexport { ClickLinkKeyboardEvent };\r\nvar ClickLinkOptions = /** @class */ (function () {\r\n    function ClickLinkOptions(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\r\n        this.triggerKey = triggerKey;\r\n        this.triggerModifier = triggerModifier;\r\n        this.triggerSideBySideKey = triggerSideBySideKey;\r\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\r\n    }\r\n    ClickLinkOptions.prototype.equals = function (other) {\r\n        return (this.triggerKey === other.triggerKey\r\n            && this.triggerModifier === other.triggerModifier\r\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\r\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\r\n    };\r\n    return ClickLinkOptions;\r\n}());\r\nexport { ClickLinkOptions };\r\nfunction createOptions(multiCursorModifier) {\r\n    if (multiCursorModifier === 'altKey') {\r\n        if (platform.isMacintosh) {\r\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\r\n        }\r\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\r\n    }\r\n    if (platform.isMacintosh) {\r\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\r\n    }\r\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\r\n}\r\nvar ClickLinkGesture = /** @class */ (function (_super) {\r\n    __extends(ClickLinkGesture, _super);\r\n    function ClickLinkGesture(editor) {\r\n        var _this = _super.call(this) || this;\r\n        _this._onMouseMoveOrRelevantKeyDown = _this._register(new Emitter());\r\n        _this.onMouseMoveOrRelevantKeyDown = _this._onMouseMoveOrRelevantKeyDown.event;\r\n        _this._onExecute = _this._register(new Emitter());\r\n        _this.onExecute = _this._onExecute.event;\r\n        _this._onCancel = _this._register(new Emitter());\r\n        _this.onCancel = _this._onCancel.event;\r\n        _this._editor = editor;\r\n        _this._opts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n        _this.lastMouseMoveEvent = null;\r\n        _this.hasTriggerKeyOnMouseDown = false;\r\n        _this._register(_this._editor.onDidChangeConfiguration(function (e) {\r\n            if (e.hasChanged(59 /* multiCursorModifier */)) {\r\n                var newOpts = createOptions(_this._editor.getOption(59 /* multiCursorModifier */));\r\n                if (_this._opts.equals(newOpts)) {\r\n                    return;\r\n                }\r\n                _this._opts = newOpts;\r\n                _this.lastMouseMoveEvent = null;\r\n                _this.hasTriggerKeyOnMouseDown = false;\r\n                _this._onCancel.fire();\r\n            }\r\n        }));\r\n        _this._register(_this._editor.onMouseMove(function (e) { return _this.onEditorMouseMove(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDown(function (e) { return _this.onEditorMouseDown(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseUp(function (e) { return _this.onEditorMouseUp(new ClickLinkMouseEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyDown(function (e) { return _this.onEditorKeyDown(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onKeyUp(function (e) { return _this.onEditorKeyUp(new ClickLinkKeyboardEvent(e, _this._opts)); }));\r\n        _this._register(_this._editor.onMouseDrag(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeCursorSelection(function (e) { return _this.onDidChangeCursorSelection(e); }));\r\n        _this._register(_this._editor.onDidChangeModel(function (e) { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidChangeModelContent(function () { return _this.resetHandler(); }));\r\n        _this._register(_this._editor.onDidScrollChange(function (e) {\r\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n                _this.resetHandler();\r\n            }\r\n        }));\r\n        return _this;\r\n    }\r\n    ClickLinkGesture.prototype.onDidChangeCursorSelection = function (e) {\r\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\r\n            this.resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/Microsoft/vscode/issues/7827)\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseMove = function (mouseEvent) {\r\n        this.lastMouseMoveEvent = mouseEvent;\r\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseDown = function (mouseEvent) {\r\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\r\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\r\n        // release the mouse button without wanting to do the navigation.\r\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\r\n        this.hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\r\n    };\r\n    ClickLinkGesture.prototype.onEditorMouseUp = function (mouseEvent) {\r\n        if (this.hasTriggerKeyOnMouseDown) {\r\n            this._onExecute.fire(mouseEvent);\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyDown = function (e) {\r\n        if (this.lastMouseMoveEvent\r\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\r\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\r\n            )) {\r\n            this._onMouseMoveOrRelevantKeyDown.fire([this.lastMouseMoveEvent, e]);\r\n        }\r\n        else if (e.hasTriggerModifier) {\r\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.onEditorKeyUp = function (e) {\r\n        if (e.keyCodeIsTriggerKey) {\r\n            this._onCancel.fire();\r\n        }\r\n    };\r\n    ClickLinkGesture.prototype.resetHandler = function () {\r\n        this.lastMouseMoveEvent = null;\r\n        this.hasTriggerKeyOnMouseDown = false;\r\n        this._onCancel.fire();\r\n    };\r\n    return ClickLinkGesture;\r\n}(Disposable));\r\nexport { ClickLinkGesture };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './media/gotoErrorWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { getBaseLabel, getPathLabel } from '../../../base/common/labels.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\r\nvar MessageWidget = /** @class */ (function () {\r\n    function MessageWidget(parent, editor, onRelatedInformation, _openerService) {\r\n        var _this = this;\r\n        this._openerService = _openerService;\r\n        this._lines = 0;\r\n        this._longestLineLength = 0;\r\n        this._relatedDiagnostics = new WeakMap();\r\n        this._disposables = new DisposableStore();\r\n        this._editor = editor;\r\n        var domNode = document.createElement('div');\r\n        domNode.className = 'descriptioncontainer';\r\n        domNode.setAttribute('aria-live', 'assertive');\r\n        domNode.setAttribute('role', 'alert');\r\n        this._messageBlock = document.createElement('div');\r\n        dom.addClass(this._messageBlock, 'message');\r\n        domNode.appendChild(this._messageBlock);\r\n        this._relatedBlock = document.createElement('div');\r\n        domNode.appendChild(this._relatedBlock);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', function (event) {\r\n            event.preventDefault();\r\n            var related = _this._relatedDiagnostics.get(event.target);\r\n            if (related) {\r\n                onRelatedInformation(related);\r\n            }\r\n        }));\r\n        this._scrollable = new ScrollableElement(domNode, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: 1 /* Auto */,\r\n            useShadows: false,\r\n            horizontalScrollbarSize: 3,\r\n            verticalScrollbarSize: 3\r\n        });\r\n        parent.appendChild(this._scrollable.getDomNode());\r\n        this._disposables.add(this._scrollable.onScroll(function (e) {\r\n            domNode.style.left = \"-\" + e.scrollLeft + \"px\";\r\n            domNode.style.top = \"-\" + e.scrollTop + \"px\";\r\n        }));\r\n        this._disposables.add(this._scrollable);\r\n    }\r\n    MessageWidget.prototype.dispose = function () {\r\n        dispose(this._disposables);\r\n    };\r\n    MessageWidget.prototype.update = function (_a) {\r\n        var _this = this;\r\n        var source = _a.source, message = _a.message, relatedInformation = _a.relatedInformation, code = _a.code;\r\n        var sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\r\n        if (code) {\r\n            if (typeof code === 'string') {\r\n                sourceAndCodeLength += code.length;\r\n            }\r\n            else {\r\n                sourceAndCodeLength += code.value.length;\r\n            }\r\n        }\r\n        var lines = message.split(/\\r\\n|\\r|\\n/g);\r\n        this._lines = lines.length;\r\n        this._longestLineLength = 0;\r\n        for (var _i = 0, lines_1 = lines; _i < lines_1.length; _i++) {\r\n            var line = lines_1[_i];\r\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\r\n        }\r\n        dom.clearNode(this._messageBlock);\r\n        this._editor.applyFontInfo(this._messageBlock);\r\n        var lastLineElement = this._messageBlock;\r\n        for (var _b = 0, lines_2 = lines; _b < lines_2.length; _b++) {\r\n            var line = lines_2[_b];\r\n            lastLineElement = document.createElement('div');\r\n            lastLineElement.innerText = line;\r\n            if (line === '') {\r\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\r\n            }\r\n            this._messageBlock.appendChild(lastLineElement);\r\n        }\r\n        if (source || code) {\r\n            var detailsElement = document.createElement('span');\r\n            dom.addClass(detailsElement, 'details');\r\n            lastLineElement.appendChild(detailsElement);\r\n            if (source) {\r\n                var sourceElement = document.createElement('span');\r\n                sourceElement.innerText = source;\r\n                dom.addClass(sourceElement, 'source');\r\n                detailsElement.appendChild(sourceElement);\r\n            }\r\n            if (code) {\r\n                if (typeof code === 'string') {\r\n                    var codeElement = document.createElement('span');\r\n                    codeElement.innerText = \"(\" + code + \")\";\r\n                    dom.addClass(codeElement, 'code');\r\n                    detailsElement.appendChild(codeElement);\r\n                }\r\n                else {\r\n                    this._codeLink = dom.$('a.code-link');\r\n                    this._codeLink.setAttribute('href', \"\" + code.link.toString());\r\n                    this._codeLink.onclick = function (e) {\r\n                        _this._openerService.open(code.link);\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    };\r\n                    var codeElement = dom.append(this._codeLink, dom.$('span'));\r\n                    codeElement.innerText = code.value;\r\n                    detailsElement.appendChild(this._codeLink);\r\n                }\r\n            }\r\n        }\r\n        dom.clearNode(this._relatedBlock);\r\n        this._editor.applyFontInfo(this._relatedBlock);\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            var relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\r\n            relatedInformationNode.style.paddingTop = Math.floor(this._editor.getOption(49 /* lineHeight */) * 0.66) + \"px\";\r\n            this._lines += 1;\r\n            for (var _c = 0, relatedInformation_1 = relatedInformation; _c < relatedInformation_1.length; _c++) {\r\n                var related = relatedInformation_1[_c];\r\n                var container = document.createElement('div');\r\n                var relatedResource = document.createElement('a');\r\n                dom.addClass(relatedResource, 'filename');\r\n                relatedResource.innerHTML = getBaseLabel(related.resource) + \"(\" + related.startLineNumber + \", \" + related.startColumn + \"): \";\r\n                relatedResource.title = getPathLabel(related.resource, undefined);\r\n                this._relatedDiagnostics.set(relatedResource, related);\r\n                var relatedMessage = document.createElement('span');\r\n                relatedMessage.innerText = related.message;\r\n                container.appendChild(relatedResource);\r\n                container.appendChild(relatedMessage);\r\n                this._lines += 1;\r\n                relatedInformationNode.appendChild(container);\r\n            }\r\n        }\r\n        var fontInfo = this._editor.getOption(34 /* fontInfo */);\r\n        var scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\r\n        var scrollHeight = fontInfo.lineHeight * this._lines;\r\n        this._scrollable.setScrollDimensions({ scrollWidth: scrollWidth, scrollHeight: scrollHeight });\r\n    };\r\n    MessageWidget.prototype.layout = function (height, width) {\r\n        this._scrollable.getDomNode().style.height = height + \"px\";\r\n        this._scrollable.getDomNode().style.width = width + \"px\";\r\n        this._scrollable.setScrollDimensions({ width: width, height: height });\r\n    };\r\n    MessageWidget.prototype.getHeightInLines = function () {\r\n        return Math.min(17, this._lines);\r\n    };\r\n    return MessageWidget;\r\n}());\r\nvar MarkerNavigationWidget = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationWidget, _super);\r\n    function MarkerNavigationWidget(editor, actions, _themeService, _openerService) {\r\n        var _this = _super.call(this, editor, { showArrow: true, showFrame: true, isAccessible: true }) || this;\r\n        _this.actions = actions;\r\n        _this._themeService = _themeService;\r\n        _this._openerService = _openerService;\r\n        _this._callOnDispose = new DisposableStore();\r\n        _this._onDidSelectRelatedInformation = new Emitter();\r\n        _this.onDidSelectRelatedInformation = _this._onDidSelectRelatedInformation.event;\r\n        _this._severity = MarkerSeverity.Warning;\r\n        _this._backgroundColor = Color.white;\r\n        _this._applyTheme(_themeService.getTheme());\r\n        _this._callOnDispose.add(_themeService.onThemeChange(_this._applyTheme.bind(_this)));\r\n        _this.create();\r\n        return _this;\r\n    }\r\n    MarkerNavigationWidget.prototype._applyTheme = function (theme) {\r\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\r\n        var colorId = editorMarkerNavigationError;\r\n        if (this._severity === MarkerSeverity.Warning) {\r\n            colorId = editorMarkerNavigationWarning;\r\n        }\r\n        else if (this._severity === MarkerSeverity.Info) {\r\n            colorId = editorMarkerNavigationInfo;\r\n        }\r\n        var frameColor = theme.getColor(colorId);\r\n        this.style({\r\n            arrowColor: frameColor,\r\n            frameColor: frameColor,\r\n            headerBackgroundColor: this._backgroundColor,\r\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\r\n        }); // style() will trigger _applyStyles\r\n    };\r\n    MarkerNavigationWidget.prototype._applyStyles = function () {\r\n        if (this._parentContainer) {\r\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\r\n        }\r\n        _super.prototype._applyStyles.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype.dispose = function () {\r\n        this._callOnDispose.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    MarkerNavigationWidget.prototype._fillHead = function (container) {\r\n        _super.prototype._fillHead.call(this, container);\r\n        this._actionbarWidget.push(this.actions, { label: false, icon: true, index: 0 });\r\n    };\r\n    MarkerNavigationWidget.prototype._fillTitleIcon = function (container) {\r\n        this._icon = dom.append(container, dom.$(''));\r\n    };\r\n    MarkerNavigationWidget.prototype._getActionBarOptions = function () {\r\n        return {\r\n            orientation: 0 /* HORIZONTAL */\r\n        };\r\n    };\r\n    MarkerNavigationWidget.prototype._fillBody = function (container) {\r\n        var _this = this;\r\n        this._parentContainer = container;\r\n        dom.addClass(container, 'marker-widget');\r\n        this._parentContainer.tabIndex = 0;\r\n        this._parentContainer.setAttribute('role', 'tooltip');\r\n        this._container = document.createElement('div');\r\n        container.appendChild(this._container);\r\n        this._message = new MessageWidget(this._container, this.editor, function (related) { return _this._onDidSelectRelatedInformation.fire(related); }, this._openerService);\r\n        this._disposables.add(this._message);\r\n    };\r\n    MarkerNavigationWidget.prototype.show = function (where, heightInLines) {\r\n        throw new Error('call showAtMarker');\r\n    };\r\n    MarkerNavigationWidget.prototype.showAtMarker = function (marker, markerIdx, markerCount) {\r\n        // update:\r\n        // * title\r\n        // * message\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n        // update frame color (only applied on 'show')\r\n        this._severity = marker.severity;\r\n        this._applyTheme(this._themeService.getTheme());\r\n        // show\r\n        var range = Range.lift(marker);\r\n        var editorPosition = this.editor.getPosition();\r\n        var position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\r\n        _super.prototype.show.call(this, position, this.computeRequiredHeight());\r\n        var model = this.editor.getModel();\r\n        if (model) {\r\n            var detail = markerCount > 1\r\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\r\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\r\n            this.setTitle(basename(model.uri), detail);\r\n        }\r\n        this._icon.className = \"codicon \" + SeverityIcon.className(MarkerSeverity.toSeverity(this._severity));\r\n        this.editor.revealPositionInCenter(position, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    };\r\n    MarkerNavigationWidget.prototype.updateMarker = function (marker) {\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n    };\r\n    MarkerNavigationWidget.prototype.showStale = function () {\r\n        this._container.classList.add('stale');\r\n        this._relayout();\r\n    };\r\n    MarkerNavigationWidget.prototype._doLayoutBody = function (heightInPixel, widthInPixel) {\r\n        _super.prototype._doLayoutBody.call(this, heightInPixel, widthInPixel);\r\n        this._heightInPixel = heightInPixel;\r\n        this._message.layout(heightInPixel, widthInPixel);\r\n        this._container.style.height = heightInPixel + \"px\";\r\n    };\r\n    MarkerNavigationWidget.prototype._onWidth = function (widthInPixel) {\r\n        this._message.layout(this._heightInPixel, widthInPixel);\r\n    };\r\n    MarkerNavigationWidget.prototype._relayout = function () {\r\n        _super.prototype._relayout.call(this, this.computeRequiredHeight());\r\n    };\r\n    MarkerNavigationWidget.prototype.computeRequiredHeight = function () {\r\n        return 3 + this._message.getHeightInLines();\r\n    };\r\n    return MarkerNavigationWidget;\r\n}(PeekViewWidget));\r\nexport { MarkerNavigationWidget };\r\n// theming\r\nvar errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\r\nvar warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\r\nvar infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\r\nexport var editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hc: errorDefault }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\r\nexport var editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hc: warningDefault }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\r\nexport var editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hc: infoDefault }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\r\nexport var editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: '#2D2D30', light: Color.white, hc: '#0C141F' }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(\".monaco-editor .marker-widget a { color: \" + linkFg + \"; }\");\r\n        collector.addRule(\".monaco-editor .marker-widget a.code-link span:hover { color: \" + linkFg + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\r\nimport { compare } from '../../../base/common/strings.js';\r\nimport { binarySearch, find } from '../../../base/common/arrays.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nvar MarkerModel = /** @class */ (function () {\r\n    function MarkerModel(editor, markers) {\r\n        var _this = this;\r\n        this._toUnbind = new DisposableStore();\r\n        this._editor = editor;\r\n        this._markers = [];\r\n        this._nextIdx = -1;\r\n        this._ignoreSelectionChange = false;\r\n        this._onCurrentMarkerChanged = new Emitter();\r\n        this._onMarkerSetChanged = new Emitter();\r\n        this.setMarkers(markers);\r\n        // listen on editor\r\n        this._toUnbind.add(this._editor.onDidDispose(function () { return _this.dispose(); }));\r\n        this._toUnbind.add(this._editor.onDidChangeCursorPosition(function () {\r\n            if (_this._ignoreSelectionChange) {\r\n                return;\r\n            }\r\n            if (_this.currentMarker && _this._editor.getPosition() && Range.containsPosition(_this.currentMarker, _this._editor.getPosition())) {\r\n                return;\r\n            }\r\n            _this._nextIdx = -1;\r\n        }));\r\n    }\r\n    Object.defineProperty(MarkerModel.prototype, \"onCurrentMarkerChanged\", {\r\n        get: function () {\r\n            return this._onCurrentMarkerChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(MarkerModel.prototype, \"onMarkerSetChanged\", {\r\n        get: function () {\r\n            return this._onMarkerSetChanged.event;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.setMarkers = function (markers) {\r\n        var oldMarker = this._nextIdx >= 0 ? this._markers[this._nextIdx] : undefined;\r\n        this._markers = markers || [];\r\n        this._markers.sort(MarkerNavigationAction.compareMarker);\r\n        if (!oldMarker) {\r\n            this._nextIdx = -1;\r\n        }\r\n        else {\r\n            this._nextIdx = Math.max(-1, binarySearch(this._markers, oldMarker, MarkerNavigationAction.compareMarker));\r\n        }\r\n        this._onMarkerSetChanged.fire(this);\r\n    };\r\n    MarkerModel.prototype.withoutWatchingEditorPosition = function (callback) {\r\n        this._ignoreSelectionChange = true;\r\n        try {\r\n            callback();\r\n        }\r\n        finally {\r\n            this._ignoreSelectionChange = false;\r\n        }\r\n    };\r\n    MarkerModel.prototype._initIdx = function (fwd) {\r\n        var found = false;\r\n        var position = this._editor.getPosition();\r\n        for (var i = 0; i < this._markers.length; i++) {\r\n            var range = Range.lift(this._markers[i]);\r\n            if (range.isEmpty() && this._editor.getModel()) {\r\n                var word = this._editor.getModel().getWordAtPosition(range.getStartPosition());\r\n                if (word) {\r\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\r\n                }\r\n            }\r\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\r\n                this._nextIdx = i;\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\r\n        }\r\n        if (this._nextIdx < 0) {\r\n            this._nextIdx = this._markers.length - 1;\r\n        }\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"currentMarker\", {\r\n        get: function () {\r\n            return this.canNavigate() ? this._markers[this._nextIdx] : undefined;\r\n        },\r\n        set: function (marker) {\r\n            var idx = this._nextIdx;\r\n            this._nextIdx = -1;\r\n            if (marker) {\r\n                this._nextIdx = this.indexOf(marker);\r\n            }\r\n            if (this._nextIdx !== idx) {\r\n                this._onCurrentMarkerChanged.fire(marker);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.move = function (fwd, inCircles) {\r\n        if (!this.canNavigate()) {\r\n            this._onCurrentMarkerChanged.fire(undefined);\r\n            return !inCircles;\r\n        }\r\n        var oldIdx = this._nextIdx;\r\n        var atEdge = false;\r\n        if (this._nextIdx === -1) {\r\n            this._initIdx(fwd);\r\n        }\r\n        else if (fwd) {\r\n            if (inCircles || this._nextIdx + 1 < this._markers.length) {\r\n                this._nextIdx = (this._nextIdx + 1) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        else if (!fwd) {\r\n            if (inCircles || this._nextIdx > 0) {\r\n                this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\r\n            }\r\n            else {\r\n                atEdge = true;\r\n            }\r\n        }\r\n        if (oldIdx !== this._nextIdx) {\r\n            var marker = this._markers[this._nextIdx];\r\n            this._onCurrentMarkerChanged.fire(marker);\r\n        }\r\n        return atEdge;\r\n    };\r\n    MarkerModel.prototype.canNavigate = function () {\r\n        return this._markers.length > 0;\r\n    };\r\n    MarkerModel.prototype.findMarkerAtPosition = function (pos) {\r\n        return find(this._markers, function (marker) { return Range.containsPosition(marker, pos); });\r\n    };\r\n    Object.defineProperty(MarkerModel.prototype, \"total\", {\r\n        get: function () {\r\n            return this._markers.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    MarkerModel.prototype.indexOf = function (marker) {\r\n        return 1 + this._markers.indexOf(marker);\r\n    };\r\n    MarkerModel.prototype.dispose = function () {\r\n        this._toUnbind.dispose();\r\n    };\r\n    return MarkerModel;\r\n}());\r\nvar MarkerController = /** @class */ (function () {\r\n    function MarkerController(editor, _markerService, _contextKeyService, _themeService, _editorService, _keybindingService, _openerService) {\r\n        this._markerService = _markerService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._themeService = _themeService;\r\n        this._editorService = _editorService;\r\n        this._keybindingService = _keybindingService;\r\n        this._openerService = _openerService;\r\n        this._model = null;\r\n        this._widget = null;\r\n        this._disposeOnClose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\r\n    }\r\n    MarkerController.get = function (editor) {\r\n        return editor.getContribution(MarkerController.ID);\r\n    };\r\n    MarkerController.prototype.dispose = function () {\r\n        this._cleanUp();\r\n        this._disposeOnClose.dispose();\r\n    };\r\n    MarkerController.prototype._cleanUp = function () {\r\n        this._widgetVisible.reset();\r\n        this._disposeOnClose.clear();\r\n        this._widget = null;\r\n        this._model = null;\r\n    };\r\n    MarkerController.prototype.getOrCreateModel = function () {\r\n        var _this = this;\r\n        if (this._model) {\r\n            return this._model;\r\n        }\r\n        var markers = this._getMarkers();\r\n        this._model = new MarkerModel(this._editor, markers);\r\n        this._markerService.onMarkerChanged(this._onMarkerChanged, this, this._disposeOnClose);\r\n        var prevMarkerKeybinding = this._keybindingService.lookupKeybinding(PrevMarkerAction.ID);\r\n        var nextMarkerKeybinding = this._keybindingService.lookupKeybinding(NextMarkerAction.ID);\r\n        var actions = [\r\n            new Action(NextMarkerAction.ID, NextMarkerAction.LABEL + (nextMarkerKeybinding ? \" (\" + nextMarkerKeybinding.getLabel() + \")\" : ''), 'show-next-problem codicon-chevron-down', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(true, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); }),\r\n            new Action(PrevMarkerAction.ID, PrevMarkerAction.LABEL + (prevMarkerKeybinding ? \" (\" + prevMarkerKeybinding.getLabel() + \")\" : ''), 'show-previous-problem codicon-chevron-up', this._model.canNavigate(), function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {\r\n                if (this._model) {\r\n                    this._model.move(false, true);\r\n                }\r\n                return [2 /*return*/];\r\n            }); }); })\r\n        ];\r\n        this._widget = new MarkerNavigationWidget(this._editor, actions, this._themeService, this._openerService);\r\n        this._widgetVisible.set(true);\r\n        this._widget.onDidClose(function () { return _this.closeMarkersNavigation(); }, this, this._disposeOnClose);\r\n        this._disposeOnClose.add(this._model);\r\n        this._disposeOnClose.add(this._widget);\r\n        for (var _i = 0, actions_1 = actions; _i < actions_1.length; _i++) {\r\n            var action = actions_1[_i];\r\n            this._disposeOnClose.add(action);\r\n        }\r\n        this._disposeOnClose.add(this._widget.onDidSelectRelatedInformation(function (related) {\r\n            _this._editorService.openCodeEditor({\r\n                resource: related.resource,\r\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\r\n            }, _this._editor).then(undefined, onUnexpectedError);\r\n            _this.closeMarkersNavigation(false);\r\n        }));\r\n        this._disposeOnClose.add(this._editor.onDidChangeModel(function () { return _this._cleanUp(); }));\r\n        this._disposeOnClose.add(this._model.onCurrentMarkerChanged(function (marker) {\r\n            if (!marker || !_this._model) {\r\n                _this._cleanUp();\r\n            }\r\n            else {\r\n                _this._model.withoutWatchingEditorPosition(function () {\r\n                    if (!_this._widget || !_this._model) {\r\n                        return;\r\n                    }\r\n                    _this._widget.showAtMarker(marker, _this._model.indexOf(marker), _this._model.total);\r\n                });\r\n            }\r\n        }));\r\n        this._disposeOnClose.add(this._model.onMarkerSetChanged(function () {\r\n            if (!_this._widget || !_this._widget.position || !_this._model) {\r\n                return;\r\n            }\r\n            var marker = _this._model.findMarkerAtPosition(_this._widget.position);\r\n            if (marker) {\r\n                _this._widget.updateMarker(marker);\r\n            }\r\n            else {\r\n                _this._widget.showStale();\r\n            }\r\n        }));\r\n        return this._model;\r\n    };\r\n    MarkerController.prototype.closeMarkersNavigation = function (focusEditor) {\r\n        if (focusEditor === void 0) { focusEditor = true; }\r\n        this._cleanUp();\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n    };\r\n    MarkerController.prototype.show = function (marker) {\r\n        var model = this.getOrCreateModel();\r\n        model.currentMarker = marker;\r\n    };\r\n    MarkerController.prototype._onMarkerChanged = function (changedResources) {\r\n        var editorModel = this._editor.getModel();\r\n        if (!editorModel) {\r\n            return;\r\n        }\r\n        if (!this._model) {\r\n            return;\r\n        }\r\n        if (!changedResources.some(function (r) { return isEqual(editorModel.uri, r); })) {\r\n            return;\r\n        }\r\n        this._model.setMarkers(this._getMarkers());\r\n    };\r\n    MarkerController.prototype._getMarkers = function () {\r\n        var model = this._editor.getModel();\r\n        if (!model) {\r\n            return [];\r\n        }\r\n        return this._markerService.read({\r\n            resource: model.uri,\r\n            severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\r\n        });\r\n    };\r\n    MarkerController.ID = 'editor.contrib.markerController';\r\n    MarkerController = __decorate([\r\n        __param(1, IMarkerService),\r\n        __param(2, IContextKeyService),\r\n        __param(3, IThemeService),\r\n        __param(4, ICodeEditorService),\r\n        __param(5, IKeybindingService),\r\n        __param(6, IOpenerService)\r\n    ], MarkerController);\r\n    return MarkerController;\r\n}());\r\nexport { MarkerController };\r\nvar MarkerNavigationAction = /** @class */ (function (_super) {\r\n    __extends(MarkerNavigationAction, _super);\r\n    function MarkerNavigationAction(next, multiFile, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._isNext = next;\r\n        _this._multiFile = multiFile;\r\n        return _this;\r\n    }\r\n    MarkerNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        var markerService = accessor.get(IMarkerService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var controller = MarkerController.get(editor);\r\n        if (!controller) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var model = controller.getOrCreateModel();\r\n        var atEdge = model.move(this._isNext, !this._multiFile);\r\n        if (!atEdge || !this._multiFile) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // try with the next/prev file\r\n        var markers = markerService.read({ severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info }).sort(MarkerNavigationAction.compareMarker);\r\n        if (markers.length === 0) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var editorModel = editor.getModel();\r\n        if (!editorModel) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var oldMarker = model.currentMarker || { resource: editorModel.uri, severity: MarkerSeverity.Error, startLineNumber: 1, startColumn: 1, endLineNumber: 1, endColumn: 1 };\r\n        var idx = binarySearch(markers, oldMarker, MarkerNavigationAction.compareMarker);\r\n        if (idx < 0) {\r\n            // find best match...\r\n            idx = ~idx;\r\n            idx %= markers.length;\r\n        }\r\n        else if (this._isNext) {\r\n            idx = (idx + 1) % markers.length;\r\n        }\r\n        else {\r\n            idx = (idx + markers.length - 1) % markers.length;\r\n        }\r\n        var newMarker = markers[idx];\r\n        if (isEqual(newMarker.resource, editorModel.uri)) {\r\n            // the next `resource` is this resource which\r\n            // means we cycle within this file\r\n            model.move(this._isNext, true);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        // close the widget for this editor-instance, open the resource\r\n        // for the next marker and re-start marker navigation in there\r\n        controller.closeMarkersNavigation();\r\n        return editorService.openCodeEditor({\r\n            resource: newMarker.resource,\r\n            options: { pinned: false, revealIfOpened: true, revealInCenterIfOutsideViewport: true, selection: newMarker }\r\n        }, editor).then(function (editor) {\r\n            if (!editor) {\r\n                return undefined;\r\n            }\r\n            return editor.getAction(_this.id).run();\r\n        });\r\n    };\r\n    MarkerNavigationAction.compareMarker = function (a, b) {\r\n        var res = compare(a.resource.toString(), b.resource.toString());\r\n        if (res === 0) {\r\n            res = MarkerSeverity.compare(a.severity, b.severity);\r\n        }\r\n        if (res === 0) {\r\n            res = Range.compareRangesUsingStarts(a, b);\r\n        }\r\n        return res;\r\n    };\r\n    return MarkerNavigationAction;\r\n}(EditorAction));\r\nvar NextMarkerAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerAction, _super);\r\n    function NextMarkerAction() {\r\n        return _super.call(this, true, false, {\r\n            id: NextMarkerAction.ID,\r\n            label: NextMarkerAction.LABEL,\r\n            alias: 'Go to Next Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    NextMarkerAction.ID = 'editor.action.marker.next';\r\n    NextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\r\n    return NextMarkerAction;\r\n}(MarkerNavigationAction));\r\nexport { NextMarkerAction };\r\nvar PrevMarkerAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerAction, _super);\r\n    function PrevMarkerAction() {\r\n        return _super.call(this, false, false, {\r\n            id: PrevMarkerAction.ID,\r\n            label: PrevMarkerAction.LABEL,\r\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: { kbExpr: EditorContextKeys.focus, primary: 1024 /* Shift */ | 512 /* Alt */ | 66 /* F8 */, weight: 100 /* EditorContrib */ }\r\n        }) || this;\r\n    }\r\n    PrevMarkerAction.ID = 'editor.action.marker.prev';\r\n    PrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\r\n    return PrevMarkerAction;\r\n}(MarkerNavigationAction));\r\nvar NextMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(NextMarkerInFilesAction, _super);\r\n    function NextMarkerInFilesAction() {\r\n        return _super.call(this, true, true, {\r\n            id: 'editor.action.marker.nextInFiles',\r\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return NextMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nvar PrevMarkerInFilesAction = /** @class */ (function (_super) {\r\n    __extends(PrevMarkerInFilesAction, _super);\r\n    function PrevMarkerInFilesAction() {\r\n        return _super.call(this, false, true, {\r\n            id: 'editor.action.marker.prevInFiles',\r\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        }) || this;\r\n    }\r\n    return PrevMarkerInFilesAction;\r\n}(MarkerNavigationAction));\r\nregisterEditorContribution(MarkerController.ID, MarkerController);\r\nregisterEditorAction(NextMarkerAction);\r\nregisterEditorAction(PrevMarkerAction);\r\nregisterEditorAction(NextMarkerInFilesAction);\r\nregisterEditorAction(PrevMarkerInFilesAction);\r\nvar CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\r\nvar MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\r\nregisterEditorCommand(new MarkerCommand({\r\n    id: 'closeMarkersNavigation',\r\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\r\n    handler: function (x) { return x.closeMarkersNavigation(); },\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 50,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.nextInFiles',\r\n        title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\")\r\n    },\r\n    order: 1\r\n});\r\nMenuRegistry.appendMenuItem(19 /* MenubarGoMenu */, {\r\n    group: '6_problem_nav',\r\n    command: {\r\n        id: 'editor.action.marker.prevInFiles',\r\n        title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\")\r\n    },\r\n    order: 2\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nimport { flatten, coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { DefinitionProviderRegistry, ImplementationProviderRegistry, TypeDefinitionProviderRegistry, DeclarationProviderRegistry, ReferenceProviderRegistry } from '../../common/modes.js';\r\nfunction getLocationLinks(model, position, registry, provide) {\r\n    var provider = registry.ordered(model);\r\n    // get results\r\n    var promises = provider.map(function (provider) {\r\n        return Promise.resolve(provide(provider, model, position)).then(undefined, function (err) {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises)\r\n        .then(flatten)\r\n        .then(coalesce);\r\n}\r\nexport function getDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getDeclarationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DeclarationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideDeclaration(model, position, token);\r\n    });\r\n}\r\nexport function getImplementationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, ImplementationProviderRegistry, function (provider, model, position) {\r\n        return provider.provideImplementation(model, position, token);\r\n    });\r\n}\r\nexport function getTypeDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, TypeDefinitionProviderRegistry, function (provider, model, position) {\r\n        return provider.provideTypeDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getReferencesAtPosition(model, position, compact, token) {\r\n    var _this = this;\r\n    return getLocationLinks(model, position, ReferenceProviderRegistry, function (provider, model, position) { return __awaiter(_this, void 0, void 0, function () {\r\n        var result, resultWithoutDeclaration;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0: return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: true }, token)];\r\n                case 1:\r\n                    result = _a.sent();\r\n                    if (!compact || !result || result.length !== 2) {\r\n                        return [2 /*return*/, result];\r\n                    }\r\n                    return [4 /*yield*/, provider.provideReferences(model, position, { includeDeclaration: false }, token)];\r\n                case 2:\r\n                    resultWithoutDeclaration = _a.sent();\r\n                    if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\r\n                        return [2 /*return*/, resultWithoutDeclaration];\r\n                    }\r\n                    return [2 /*return*/, result];\r\n            }\r\n        });\r\n    }); });\r\n}\r\nregisterModelAndPositionCommand('_executeDefinitionProvider', function (model, position) { return getDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeDeclarationProvider', function (model, position) { return getDeclarationsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeImplementationProvider', function (model, position) { return getImplementationsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', function (model, position) { return getTypeDefinitionsAtPosition(model, position, CancellationToken.None); });\r\nregisterModelAndPositionCommand('_executeReferenceProvider', function (model, position) { return getReferencesAtPosition(model, position, false, CancellationToken.None); });\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { registerEditorCommand, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { dispose, combinedDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport var ctxHasSymbols = new RawContextKey('hasSymbols', false);\r\nexport var ISymbolNavigationService = createDecorator('ISymbolNavigationService');\r\nvar SymbolNavigationService = /** @class */ (function () {\r\n    function SymbolNavigationService(contextKeyService, _editorService, _notificationService, _keybindingService) {\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._keybindingService = _keybindingService;\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n        this._ignoreEditorChange = false;\r\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\r\n    }\r\n    SymbolNavigationService.prototype.reset = function () {\r\n        this._ctxHasSymbols.reset();\r\n        dispose(this._currentState);\r\n        dispose(this._currentMessage);\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n    };\r\n    SymbolNavigationService.prototype.put = function (anchor) {\r\n        var _this = this;\r\n        var refModel = anchor.parent.parent;\r\n        if (refModel.references.length <= 1) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._currentModel = refModel;\r\n        this._currentIdx = refModel.references.indexOf(anchor);\r\n        this._ctxHasSymbols.set(true);\r\n        this._showMessage();\r\n        var editorState = new EditorState(this._editorService);\r\n        var listener = editorState.onDidChange(function (_) {\r\n            if (_this._ignoreEditorChange) {\r\n                return;\r\n            }\r\n            var editor = _this._editorService.getActiveCodeEditor();\r\n            if (!editor) {\r\n                return;\r\n            }\r\n            var model = editor.getModel();\r\n            var position = editor.getPosition();\r\n            if (!model || !position) {\r\n                return;\r\n            }\r\n            var seenUri = false;\r\n            var seenPosition = false;\r\n            for (var _i = 0, _a = refModel.references; _i < _a.length; _i++) {\r\n                var reference = _a[_i];\r\n                if (isEqual(reference.uri, model.uri)) {\r\n                    seenUri = true;\r\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\r\n                }\r\n                else if (seenUri) {\r\n                    break;\r\n                }\r\n            }\r\n            if (!seenUri || !seenPosition) {\r\n                _this.reset();\r\n            }\r\n        });\r\n        this._currentState = combinedDisposable(editorState, listener);\r\n    };\r\n    SymbolNavigationService.prototype.revealNext = function (source) {\r\n        var _this = this;\r\n        if (!this._currentModel) {\r\n            return Promise.resolve();\r\n        }\r\n        // get next result and advance\r\n        this._currentIdx += 1;\r\n        this._currentIdx %= this._currentModel.references.length;\r\n        var reference = this._currentModel.references[this._currentIdx];\r\n        // status\r\n        this._showMessage();\r\n        // open editor, ignore events while that happens\r\n        this._ignoreEditorChange = true;\r\n        return this._editorService.openCodeEditor({\r\n            resource: reference.uri,\r\n            options: {\r\n                selection: Range.collapseToStart(reference.range),\r\n                revealInCenterIfOutsideViewport: true\r\n            }\r\n        }, source).finally(function () {\r\n            _this._ignoreEditorChange = false;\r\n        });\r\n    };\r\n    SymbolNavigationService.prototype._showMessage = function () {\r\n        dispose(this._currentMessage);\r\n        var kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\r\n        var message = kb\r\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\r\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\r\n        this._currentMessage = this._notificationService.status(message);\r\n    };\r\n    SymbolNavigationService = __decorate([\r\n        __param(0, IContextKeyService),\r\n        __param(1, ICodeEditorService),\r\n        __param(2, INotificationService),\r\n        __param(3, IKeybindingService)\r\n    ], SymbolNavigationService);\r\n    return SymbolNavigationService;\r\n}());\r\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\r\nregisterEditorCommand(new /** @class */ (function (_super) {\r\n    __extends(class_1, _super);\r\n    function class_1() {\r\n        return _super.call(this, {\r\n            id: 'editor.gotoNextSymbolFromResult',\r\n            precondition: ctxHasSymbols,\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 70 /* F12 */\r\n            }\r\n        }) || this;\r\n    }\r\n    class_1.prototype.runEditorCommand = function (accessor, editor) {\r\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\r\n    };\r\n    return class_1;\r\n}(EditorCommand)));\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'editor.gotoNextSymbolFromResult.cancel',\r\n    weight: 100 /* EditorContrib */,\r\n    when: ctxHasSymbols,\r\n    primary: 9 /* Escape */,\r\n    handler: function (accessor) {\r\n        accessor.get(ISymbolNavigationService).reset();\r\n    }\r\n});\r\n//\r\nvar EditorState = /** @class */ (function () {\r\n    function EditorState(editorService) {\r\n        this._listener = new Map();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\r\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\r\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\r\n    }\r\n    EditorState.prototype.dispose = function () {\r\n        this._disposables.dispose();\r\n        this._onDidChange.dispose();\r\n        this._listener.forEach(dispose);\r\n    };\r\n    EditorState.prototype._onDidAddEditor = function (editor) {\r\n        var _this = this;\r\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(function (_) { return _this._onDidChange.fire({ editor: editor }); }), editor.onDidChangeModelContent(function (_) { return _this._onDidChange.fire({ editor: editor }); })));\r\n    };\r\n    EditorState.prototype._onDidRemoveEditor = function (editor) {\r\n        dispose(this._listener.get(editor));\r\n        this._listener.delete(editor);\r\n    };\r\n    EditorState = __decorate([\r\n        __param(0, ICodeEditorService)\r\n    ], EditorState);\r\n    return EditorState;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar _a, _b, _c, _d, _e, _f, _g, _h;\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { createCancelablePromise, raceCancellation } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { isWeb } from '../../../base/common/platform.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport * as corePosition from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { isLocationLink } from '../../common/modes.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { PeekContext } from '../peekView/peekView.js';\r\nimport { ReferencesController } from './peek/referencesController.js';\r\nimport { ReferencesModel } from './referencesModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from './goToSymbol.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { ISymbolNavigationService } from './symbolNavigation.js';\r\nimport { isStandalone } from '../../../base/browser/browser.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nMenuRegistry.appendMenuItem(7 /* EditorContext */, {\r\n    submenu: 8 /* EditorContextPeek */,\r\n    title: nls.localize('peek.submenu', \"Peek\"),\r\n    group: 'navigation',\r\n    order: 100\r\n});\r\nvar SymbolNavigationAction = /** @class */ (function (_super) {\r\n    __extends(SymbolNavigationAction, _super);\r\n    function SymbolNavigationAction(configuration, opts) {\r\n        var _this = _super.call(this, opts) || this;\r\n        _this._configuration = configuration;\r\n        return _this;\r\n    }\r\n    SymbolNavigationAction.prototype.run = function (accessor, editor) {\r\n        var _this = this;\r\n        if (!editor.hasModel()) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        var notificationService = accessor.get(INotificationService);\r\n        var editorService = accessor.get(ICodeEditorService);\r\n        var progressService = accessor.get(IEditorProgressService);\r\n        var symbolNavService = accessor.get(ISymbolNavigationService);\r\n        var model = editor.getModel();\r\n        var pos = editor.getPosition();\r\n        var cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\r\n        var promise = raceCancellation(this._getLocationModel(model, pos, cts.token), cts.token).then(function (references) { return __awaiter(_this, void 0, void 0, function () {\r\n            var altAction, altActionId, referenceCount, info;\r\n            return __generator(this, function (_a) {\r\n                if (!references || cts.token.isCancellationRequested) {\r\n                    return [2 /*return*/];\r\n                }\r\n                alert(references.ariaMessage);\r\n                if (references.referenceAt(model.uri, pos)) {\r\n                    altActionId = this._getAlternativeCommand(editor);\r\n                    if (altActionId !== this.id) {\r\n                        altAction = editor.getAction(altActionId);\r\n                    }\r\n                }\r\n                referenceCount = references.references.length;\r\n                if (referenceCount === 0) {\r\n                    // no result -> show message\r\n                    if (!this._configuration.muteMessage) {\r\n                        info = model.getWordAtPosition(pos);\r\n                        MessageController.get(editor).showMessage(this._getNoResultFoundMessage(info), pos);\r\n                    }\r\n                }\r\n                else if (referenceCount === 1 && altAction) {\r\n                    // already at the only result, run alternative\r\n                    altAction.run();\r\n                }\r\n                else {\r\n                    // normal results handling\r\n                    return [2 /*return*/, this._onResult(editorService, symbolNavService, editor, references)];\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        }); }, function (err) {\r\n            // report an error\r\n            notificationService.error(err);\r\n        }).finally(function () {\r\n            cts.dispose();\r\n        });\r\n        progressService.showWhile(promise, 250);\r\n        return promise;\r\n    };\r\n    SymbolNavigationAction.prototype._onResult = function (editorService, symbolNavService, editor, model) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var gotoLocation, next, peek, targetEditor;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        gotoLocation = this._getGoToPreference(editor);\r\n                        if (!(!(editor instanceof EmbeddedCodeEditorWidget) && (this._configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1)))) return [3 /*break*/, 1];\r\n                        this._openInPeek(editor, model);\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        next = model.firstReference();\r\n                        peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\r\n                        return [4 /*yield*/, this._openReference(editor, editorService, next, this._configuration.openToSide, !peek)];\r\n                    case 2:\r\n                        targetEditor = _a.sent();\r\n                        if (peek && targetEditor) {\r\n                            this._openInPeek(targetEditor, model);\r\n                        }\r\n                        else {\r\n                            model.dispose();\r\n                        }\r\n                        // keep remaining locations around when using\r\n                        // 'goto'-mode\r\n                        if (gotoLocation === 'goto') {\r\n                            symbolNavService.put(next);\r\n                        }\r\n                        _a.label = 3;\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openReference = function (editor, editorService, reference, sideBySide, highlight) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var range, targetEditor, modelNow_1, ids_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        range = undefined;\r\n                        if (isLocationLink(reference)) {\r\n                            range = reference.targetSelectionRange;\r\n                        }\r\n                        if (!range) {\r\n                            range = reference.range;\r\n                        }\r\n                        return [4 /*yield*/, editorService.openCodeEditor({\r\n                                resource: reference.uri,\r\n                                options: {\r\n                                    selection: Range.collapseToStart(range),\r\n                                    revealInCenterIfOutsideViewport: true\r\n                                }\r\n                            }, editor, sideBySide)];\r\n                    case 1:\r\n                        targetEditor = _a.sent();\r\n                        if (!targetEditor) {\r\n                            return [2 /*return*/, undefined];\r\n                        }\r\n                        if (highlight) {\r\n                            modelNow_1 = targetEditor.getModel();\r\n                            ids_1 = targetEditor.deltaDecorations([], [{ range: range, options: { className: 'symbolHighlight' } }]);\r\n                            setTimeout(function () {\r\n                                if (targetEditor.getModel() === modelNow_1) {\r\n                                    targetEditor.deltaDecorations(ids_1, []);\r\n                                }\r\n                            }, 350);\r\n                        }\r\n                        return [2 /*return*/, targetEditor];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    SymbolNavigationAction.prototype._openInPeek = function (target, model) {\r\n        var controller = ReferencesController.get(target);\r\n        if (controller && target.hasModel()) {\r\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(function (_) { return Promise.resolve(model); }), this._configuration.openInPeek);\r\n        }\r\n        else {\r\n            model.dispose();\r\n        }\r\n    };\r\n    return SymbolNavigationAction;\r\n}(EditorAction));\r\n//#region --- DEFINITION\r\nvar DefinitionAction = /** @class */ (function (_super) {\r\n    __extends(DefinitionAction, _super);\r\n    function DefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('def.title', 'Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\r\n            : nls.localize('generic.noResults', \"No definition found\");\r\n    };\r\n    DefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeDefinitionCommand;\r\n    };\r\n    DefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleDefinitions;\r\n    };\r\n    return DefinitionAction;\r\n}(SymbolNavigationAction));\r\nexport { DefinitionAction };\r\nvar goToDefinitionKb = isWeb && !isStandalone\r\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\r\n    : 70 /* F12 */;\r\nregisterEditorAction((_a = /** @class */ (function (_super) {\r\n        __extends(GoToDefinitionAction, _super);\r\n        function GoToDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDefinitionAction.id,\r\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\r\n                alias: 'Go to Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: goToDefinitionKb,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.1\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 2,\r\n                    title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return GoToDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _a.id = 'editor.action.revealDefinition',\r\n    _a));\r\nregisterEditorAction((_b = /** @class */ (function (_super) {\r\n        __extends(OpenDefinitionToSideAction, _super);\r\n        function OpenDefinitionToSideAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: true,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: OpenDefinitionToSideAction.id,\r\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\r\n                alias: 'Open Definition to the Side',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, goToDefinitionKb),\r\n                    weight: 100 /* EditorContrib */\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\r\n            return _this;\r\n        }\r\n        return OpenDefinitionToSideAction;\r\n    }(DefinitionAction)),\r\n    _b.id = 'editor.action.revealDefinitionAside',\r\n    _b));\r\nregisterEditorAction((_c = /** @class */ (function (_super) {\r\n        __extends(PeekDefinitionAction, _super);\r\n        function PeekDefinitionAction() {\r\n            var _this = _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekDefinitionAction.id,\r\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\r\n                alias: 'Peek Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 512 /* Alt */ | 70 /* F12 */,\r\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 2\r\n                }\r\n            }) || this;\r\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\r\n            return _this;\r\n        }\r\n        return PeekDefinitionAction;\r\n    }(DefinitionAction)),\r\n    _c.id = 'editor.action.peekDefinition',\r\n    _c));\r\n//#endregion\r\n//#region --- DECLARATION\r\nvar DeclarationAction = /** @class */ (function (_super) {\r\n    __extends(DeclarationAction, _super);\r\n    function DeclarationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DeclarationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getDeclarationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('decl.title', 'Declarations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    DeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n    };\r\n    DeclarationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeDeclarationCommand;\r\n    };\r\n    DeclarationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleDeclarations;\r\n    };\r\n    return DeclarationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_d = /** @class */ (function (_super) {\r\n        __extends(GoToDeclarationAction, _super);\r\n        function GoToDeclarationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDeclarationAction.id,\r\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\r\n                alias: 'Go to Declaration',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.3\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\r\n                },\r\n            }) || this;\r\n        }\r\n        GoToDeclarationAction.prototype._getNoResultFoundMessage = function (info) {\r\n            return info && info.word\r\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n        };\r\n        return GoToDeclarationAction;\r\n    }(DeclarationAction)),\r\n    _d.id = 'editor.action.revealDeclaration',\r\n    _d));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekDeclarationAction, _super);\r\n    function PeekDeclarationAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.peekDeclaration',\r\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\r\n            alias: 'Peek Declaration',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 3\r\n            }\r\n        }) || this;\r\n    }\r\n    return PeekDeclarationAction;\r\n}(DeclarationAction)));\r\n//#endregion\r\n//#region --- TYPE DEFINITION\r\nvar TypeDefinitionAction = /** @class */ (function (_super) {\r\n    __extends(TypeDefinitionAction, _super);\r\n    function TypeDefinitionAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    TypeDefinitionAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getTypeDefinitionsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('typedef.title', 'Type Definitions')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TypeDefinitionAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\r\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\r\n    };\r\n    TypeDefinitionAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeTypeDefinitionCommand;\r\n    };\r\n    TypeDefinitionAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleTypeDefinitions;\r\n    };\r\n    return TypeDefinitionAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_e = /** @class */ (function (_super) {\r\n        __extends(GoToTypeDefinitionAction, _super);\r\n        function GoToTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\r\n                alias: 'Go to Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 0,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.4\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _e.ID = 'editor.action.goToTypeDefinition',\r\n    _e));\r\nregisterEditorAction((_f = /** @class */ (function (_super) {\r\n        __extends(PeekTypeDefinitionAction, _super);\r\n        function PeekTypeDefinitionAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\r\n                alias: 'Peek Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 4\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekTypeDefinitionAction;\r\n    }(TypeDefinitionAction)),\r\n    _f.ID = 'editor.action.peekTypeDefinition',\r\n    _f));\r\n//#endregion\r\n//#region --- IMPLEMENTATION\r\nvar ImplementationAction = /** @class */ (function (_super) {\r\n    __extends(ImplementationAction, _super);\r\n    function ImplementationAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ImplementationAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getImplementationsAtPosition(model, position, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('impl.title', 'Implementations')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ImplementationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && info.word\r\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\r\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\r\n    };\r\n    ImplementationAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeImplementationCommand;\r\n    };\r\n    ImplementationAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleImplementations;\r\n    };\r\n    return ImplementationAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction((_g = /** @class */ (function (_super) {\r\n        __extends(GoToImplementationAction, _super);\r\n        function GoToImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToImplementationAction.ID,\r\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\r\n                alias: 'Go to Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                menuOpts: {\r\n                    menuId: 19 /* MenubarGoMenu */,\r\n                    group: '4_symbol_nav',\r\n                    order: 4,\r\n                    title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.45\r\n                }\r\n            }) || this;\r\n        }\r\n        return GoToImplementationAction;\r\n    }(ImplementationAction)),\r\n    _g.ID = 'editor.action.goToImplementation',\r\n    _g));\r\nregisterEditorAction((_h = /** @class */ (function (_super) {\r\n        __extends(PeekImplementationAction, _super);\r\n        function PeekImplementationAction() {\r\n            return _super.call(this, {\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekImplementationAction.ID,\r\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\r\n                alias: 'Peek Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: 8 /* EditorContextPeek */,\r\n                    group: 'peek',\r\n                    order: 5\r\n                }\r\n            }) || this;\r\n        }\r\n        return PeekImplementationAction;\r\n    }(ImplementationAction)),\r\n    _h.ID = 'editor.action.peekImplementation',\r\n    _h));\r\n//#endregion\r\n//#region --- REFERENCES\r\nvar ReferencesAction = /** @class */ (function (_super) {\r\n    __extends(ReferencesAction, _super);\r\n    function ReferencesAction() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ReferencesAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info\r\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\r\n            : nls.localize('references.noGeneric', \"No references found\");\r\n    };\r\n    ReferencesAction.prototype._getAlternativeCommand = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).alternativeReferenceCommand;\r\n    };\r\n    ReferencesAction.prototype._getGoToPreference = function (editor) {\r\n        return editor.getOption(41 /* gotoLocation */).multipleReferences;\r\n    };\r\n    return ReferencesAction;\r\n}(SymbolNavigationAction));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(GoToReferencesAction, _super);\r\n    function GoToReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: false,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.goToReferences',\r\n            label: nls.localize('goToReferences.label', \"Go to References\"),\r\n            alias: 'Go to References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 70 /* F12 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 1.45\r\n            },\r\n            menuOpts: {\r\n                menuId: 19 /* MenubarGoMenu */,\r\n                group: '4_symbol_nav',\r\n                order: 5,\r\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\r\n            },\r\n        }) || this;\r\n    }\r\n    GoToReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, true, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return GoToReferencesAction;\r\n}(ReferencesAction)));\r\nregisterEditorAction(/** @class */ (function (_super) {\r\n    __extends(PeekReferencesAction, _super);\r\n    function PeekReferencesAction() {\r\n        return _super.call(this, {\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.referenceSearch.trigger',\r\n            label: nls.localize('references.action.label', \"Peek References\"),\r\n            alias: 'Peek References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: 8 /* EditorContextPeek */,\r\n                group: 'peek',\r\n                order: 6\r\n            }\r\n        }) || this;\r\n    }\r\n    PeekReferencesAction.prototype._getLocationModel = function (model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        _a = ReferencesModel.bind;\r\n                        return [4 /*yield*/, getReferencesAtPosition(model, position, false, token)];\r\n                    case 1: return [2 /*return*/, new (_a.apply(ReferencesModel, [void 0, _b.sent(), nls.localize('ref.title', 'References')]))()];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    return PeekReferencesAction;\r\n}(ReferencesAction)));\r\n//#endregion\r\n//#region --- GENERIC goto symbols command\r\nvar GenericGoToLocationAction = /** @class */ (function (_super) {\r\n    __extends(GenericGoToLocationAction, _super);\r\n    function GenericGoToLocationAction(config, _references, _gotoMultipleBehaviour) {\r\n        var _this = _super.call(this, config, {\r\n            id: 'editor.action.goToLocation',\r\n            label: nls.localize('label.generic', \"Go To Any Symbol\"),\r\n            alias: 'Go To Any Symbol',\r\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\r\n        }) || this;\r\n        _this._references = _references;\r\n        _this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\r\n        return _this;\r\n    }\r\n    GenericGoToLocationAction.prototype._getLocationModel = function (_model, _position, _token) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/, new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'))];\r\n            });\r\n        });\r\n    };\r\n    GenericGoToLocationAction.prototype._getNoResultFoundMessage = function (info) {\r\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\r\n    };\r\n    GenericGoToLocationAction.prototype._getGoToPreference = function (editor) {\r\n        var _a;\r\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(41 /* gotoLocation */).multipleReferences;\r\n    };\r\n    GenericGoToLocationAction.prototype._getAlternativeCommand = function () { return ''; };\r\n    return GenericGoToLocationAction;\r\n}(SymbolNavigationAction));\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.goToLocations',\r\n    description: {\r\n        description: 'Go to locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: function (accessor, resource, position, references, multiple, openInPeek) { return __awaiter(void 0, void 0, void 0, function () {\r\n        var editorService, editor;\r\n        return __generator(this, function (_a) {\r\n            switch (_a.label) {\r\n                case 0:\r\n                    assertType(URI.isUri(resource));\r\n                    assertType(corePosition.Position.isIPosition(position));\r\n                    assertType(Array.isArray(references));\r\n                    assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\r\n                    assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\r\n                    editorService = accessor.get(ICodeEditorService);\r\n                    return [4 /*yield*/, editorService.openCodeEditor({ resource: resource }, editorService.getFocusedCodeEditor())];\r\n                case 1:\r\n                    editor = _a.sent();\r\n                    if (isCodeEditor(editor)) {\r\n                        editor.setPosition(position);\r\n                        editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n                        return [2 /*return*/, editor.invokeWithinContext(function (accessor) {\r\n                                var command = new GenericGoToLocationAction({ muteMessage: true, openInPeek: Boolean(openInPeek), openToSide: false }, references, multiple);\r\n                                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\r\n                            })];\r\n                    }\r\n                    return [2 /*return*/];\r\n            }\r\n        });\r\n    }); }\r\n});\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.peekLocations',\r\n    description: {\r\n        description: 'Peek locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: function (accessor, resource, position, references, multiple) { return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, true);\r\n            return [2 /*return*/];\r\n        });\r\n    }); }\r\n});\r\n//#endregion\r\n//#region --- REFERENCE search special commands\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.findReferences',\r\n    handler: function (accessor, resource, position) {\r\n        assertType(URI.isUri(resource));\r\n        assertType(corePosition.Position.isIPosition(position));\r\n        var codeEditorService = accessor.get(ICodeEditorService);\r\n        return codeEditorService.openCodeEditor({ resource: resource }, codeEditorService.getFocusedCodeEditor()).then(function (control) {\r\n            if (!isCodeEditor(control) || !control.hasModel()) {\r\n                return undefined;\r\n            }\r\n            var controller = ReferencesController.get(control);\r\n            if (!controller) {\r\n                return undefined;\r\n            }\r\n            var references = createCancelablePromise(function (token) { return getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(function (references) { return new ReferencesModel(references, nls.localize('ref.title', 'References')); }); });\r\n            var range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n            return Promise.resolve(controller.toggleWidget(range, references, false));\r\n        });\r\n    }\r\n});\r\n// use NEW command\r\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\r\n//#endregion\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { localize } from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { defaultGenerator } from '../../../base/common/idGenerator.js';\r\nimport { Range } from '../../common/core/range.js';\r\nvar OneReference = /** @class */ (function () {\r\n    function OneReference(isProviderFirst, parent, _range, _rangeCallback) {\r\n        this.isProviderFirst = isProviderFirst;\r\n        this.parent = parent;\r\n        this._range = _range;\r\n        this._rangeCallback = _rangeCallback;\r\n        this.id = defaultGenerator.nextId();\r\n    }\r\n    Object.defineProperty(OneReference.prototype, \"uri\", {\r\n        get: function () {\r\n            return this.parent.uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"range\", {\r\n        get: function () {\r\n            return this._range;\r\n        },\r\n        set: function (value) {\r\n            this._range = value;\r\n            this._rangeCallback(this);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OneReference.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return OneReference;\r\n}());\r\nexport { OneReference };\r\nvar FilePreview = /** @class */ (function () {\r\n    function FilePreview(_modelReference) {\r\n        this._modelReference = _modelReference;\r\n    }\r\n    FilePreview.prototype.dispose = function () {\r\n        this._modelReference.dispose();\r\n    };\r\n    FilePreview.prototype.preview = function (range, n) {\r\n        if (n === void 0) { n = 8; }\r\n        var model = this._modelReference.object.textEditorModel;\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        var startLineNumber = range.startLineNumber, startColumn = range.startColumn, endLineNumber = range.endLineNumber, endColumn = range.endColumn;\r\n        var word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\r\n        var beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\r\n        var afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        var before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\r\n        var inside = model.getValueInRange(range);\r\n        var after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\r\n        return {\r\n            value: before + inside + after,\r\n            highlight: { start: before.length, end: before.length + inside.length }\r\n        };\r\n    };\r\n    return FilePreview;\r\n}());\r\nexport { FilePreview };\r\nvar FileReferences = /** @class */ (function () {\r\n    function FileReferences(parent, uri) {\r\n        this.parent = parent;\r\n        this.uri = uri;\r\n        this.children = [];\r\n    }\r\n    FileReferences.prototype.dispose = function () {\r\n        dispose(this._preview);\r\n        this._preview = undefined;\r\n    };\r\n    Object.defineProperty(FileReferences.prototype, \"preview\", {\r\n        get: function () {\r\n            return this._preview;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"failure\", {\r\n        get: function () {\r\n            return this._loadFailure;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FileReferences.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            var len = this.children.length;\r\n            if (len === 1) {\r\n                return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FileReferences.prototype.resolve = function (textModelResolverService) {\r\n        var _this = this;\r\n        if (this._resolved) {\r\n            return Promise.resolve(this);\r\n        }\r\n        return Promise.resolve(textModelResolverService.createModelReference(this.uri).then(function (modelReference) {\r\n            var model = modelReference.object;\r\n            if (!model) {\r\n                modelReference.dispose();\r\n                throw new Error();\r\n            }\r\n            _this._preview = new FilePreview(modelReference);\r\n            _this._resolved = true;\r\n            return _this;\r\n        }, function (err) {\r\n            // something wrong here\r\n            _this.children.length = 0;\r\n            _this._resolved = true;\r\n            _this._loadFailure = err;\r\n            return _this;\r\n        }));\r\n    };\r\n    return FileReferences;\r\n}());\r\nexport { FileReferences };\r\nvar ReferencesModel = /** @class */ (function () {\r\n    function ReferencesModel(links, title) {\r\n        var _this = this;\r\n        this._disposables = new DisposableStore();\r\n        this.groups = [];\r\n        this.references = [];\r\n        this._onDidChangeReferenceRange = new Emitter();\r\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\r\n        this._links = links;\r\n        this._title = title;\r\n        // grouping and sorting\r\n        var providersFirst = links[0];\r\n        links.sort(ReferencesModel._compareReferences);\r\n        var current;\r\n        for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {\r\n            var link = links_1[_i];\r\n            if (!current || current.uri.toString() !== link.uri.toString()) {\r\n                // new group\r\n                current = new FileReferences(this, link.uri);\r\n                this.groups.push(current);\r\n            }\r\n            // append, check for equality first!\r\n            if (current.children.length === 0 || !Range.equalsRange(link.range, current.children[current.children.length - 1].range)) {\r\n                var oneRef = new OneReference(providersFirst === link, current, link.targetSelectionRange || link.range, function (ref) { return _this._onDidChangeReferenceRange.fire(ref); });\r\n                this.references.push(oneRef);\r\n                current.children.push(oneRef);\r\n            }\r\n        }\r\n    }\r\n    ReferencesModel.prototype.dispose = function () {\r\n        dispose(this.groups);\r\n        this._disposables.dispose();\r\n        this._onDidChangeReferenceRange.dispose();\r\n        this.groups.length = 0;\r\n    };\r\n    ReferencesModel.prototype.clone = function () {\r\n        return new ReferencesModel(this._links, this._title);\r\n    };\r\n    Object.defineProperty(ReferencesModel.prototype, \"title\", {\r\n        get: function () {\r\n            return this._title;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"isEmpty\", {\r\n        get: function () {\r\n            return this.groups.length === 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReferencesModel.prototype, \"ariaMessage\", {\r\n        get: function () {\r\n            if (this.isEmpty) {\r\n                return localize('aria.result.0', \"No results found\");\r\n            }\r\n            else if (this.references.length === 1) {\r\n                return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\r\n            }\r\n            else if (this.groups.length === 1) {\r\n                return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\r\n            }\r\n            else {\r\n                return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ReferencesModel.prototype.nextOrPreviousReference = function (reference, next) {\r\n        var parent = reference.parent;\r\n        var idx = parent.children.indexOf(reference);\r\n        var childCount = parent.children.length;\r\n        var groupCount = parent.parent.groups.length;\r\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\r\n            // cycling within one file\r\n            if (next) {\r\n                idx = (idx + 1) % childCount;\r\n            }\r\n            else {\r\n                idx = (idx + childCount - 1) % childCount;\r\n            }\r\n            return parent.children[idx];\r\n        }\r\n        idx = parent.parent.groups.indexOf(parent);\r\n        if (next) {\r\n            idx = (idx + 1) % groupCount;\r\n            return parent.parent.groups[idx].children[0];\r\n        }\r\n        else {\r\n            idx = (idx + groupCount - 1) % groupCount;\r\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\r\n        }\r\n    };\r\n    ReferencesModel.prototype.nearestReference = function (resource, position) {\r\n        var nearest = this.references.map(function (ref, idx) {\r\n            return {\r\n                idx: idx,\r\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\r\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\r\n            };\r\n        }).sort(function (a, b) {\r\n            if (a.prefixLen > b.prefixLen) {\r\n                return -1;\r\n            }\r\n            else if (a.prefixLen < b.prefixLen) {\r\n                return 1;\r\n            }\r\n            else if (a.offsetDist < b.offsetDist) {\r\n                return -1;\r\n            }\r\n            else if (a.offsetDist > b.offsetDist) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        })[0];\r\n        if (nearest) {\r\n            return this.references[nearest.idx];\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.referenceAt = function (resource, position) {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.uri.toString() === resource.toString()) {\r\n                if (Range.containsPosition(ref.range, position)) {\r\n                    return ref;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    ReferencesModel.prototype.firstReference = function () {\r\n        for (var _i = 0, _a = this.references; _i < _a.length; _i++) {\r\n            var ref = _a[_i];\r\n            if (ref.isProviderFirst) {\r\n                return ref;\r\n            }\r\n        }\r\n        return this.references[0];\r\n    };\r\n    ReferencesModel._compareReferences = function (a, b) {\r\n        return strings.compare(a.uri.toString(), b.uri.toString()) || Range.compareRangesUsingStarts(a.range, b.range);\r\n    };\r\n    return ReferencesModel;\r\n}());\r\nexport { ReferencesModel };\r\n"],"sourceRoot":""}