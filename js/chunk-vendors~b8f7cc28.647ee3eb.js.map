{"version":3,"sources":["webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharSheet.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRenderer.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapPreBaked.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/margin/margin.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/rangeUtil.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLine.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/contentWidgets/contentWidgets.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/overviewRuler.js","webpack:///./node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.js"],"names":["allCharCodes","v","i","push","getCharIndex","chCode","fontScale","MinimapCharRenderer","charData","scale","this","charDataNormal","soften","charDataLight","input","ratio","result","Uint8ClampedArray","length","len","prototype","renderChar","target","dx","dy","color","backgroundColor","useLighterFont","charWidth","charHeight","width","height","console","warn","charIndex","destWidth","backgroundR","r","backgroundG","g","backgroundB","b","deltaR","deltaG","deltaB","dest","data","sourceOffset","row","y","column","x","c","blockRenderChar","colorR","colorG","colorB","charTable","A","B","C","D","E","F","decodeData","str","output","prebakedMiniMaps","1","2","MinimapCharRendererFactory","create","fontFamily","lastCreated","lastFontFamily","factory","createFromSampleData","createSampleData","canvas","document","createElement","ctx","getContext","style","fillStyle","font","textBaseline","_i","allCharCodes_1","code","fillText","String","fromCharCode","getImageData","source","expectedLength","Error","_downsample","_downsampleChar","destOffset","targetIndex","brightest","sourceY1","sourceY2","sourceX1","sourceX2","value","samples","sy","sourceRow","Math","floor","yBalance","sx","xBalance","sourceIndex","weight","final","max","pixelsPerCharacter","resultLen","resultOffset","adjust","__extends","extendStatics","d","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","getMinimapLineHeight","renderMinimap","getMinimapCharWidth","MOUSE_DRAG_RESET_DISTANCE","GUTTER_DECORATION_WIDTH","MinimapOptions","configuration","_this","options","pixelRatio","get","layoutInfo","fontInfo","scrollBeyondLastLine","minimapOpts","showSlider","round","charRenderer","typicalHalfwidthCharacterWidth","lineHeight","minimapLeft","minimapWidth","minimapHeight","canvasInnerWidth","canvasInnerHeight","canvasOuterWidth","canvasOuterHeight","equals","other","MinimapLayout","scrollTop","scrollHeight","computedSliderRatio","sliderTop","sliderHeight","startLineNumber","endLineNumber","_computedSliderRatio","getDesiredScrollTopFromDelta","delta","desiredSliderPosition","getDesiredScrollTopFromTouchLocation","pageY","viewportStartLineNumber","viewportEndLineNumber","viewportHeight","viewportContainsWhitespaceGaps","lineCount","previousLayout","maxMinimapSliderTop","minimapLineHeight","minimapLinesFitting","viewportLineCount","expectedViewportLineCount","min","extraLinesAtTheBottom","MinimapLine","onContentChanged","onTokensChanged","INVALID","RenderData","renderedLayout","imageData","lines","_imageData","_renderedLines","_set","linesEquals","layout","scrollEquals","tmp","_get","rendLineNumberStart","onLinesChanged","e","fromLineNumber","toLineNumber","onLinesDeleted","onLinesInserted","ranges","MinimapBuffers","WIDTH","HEIGHT","background","_backgroundFillData","_createBackgroundFillData","_buffers","createImageData","_lastUsedBuffer","getBuffer","set","offset","j","_super","Minimap","context","call","_selections","_renderDecorations","_gestureInProgress","_options","_context","_lastRenderData","_selectionColor","theme","getColor","_domNode","write","setClassName","_getMinimapDomNodeClassName","setPosition","setAttribute","_shadow","appendChild","_canvas","setLeft","_decorationsCanvas","_slider","setLayerHinting","setContain","_sliderHorizontal","_tokensColorTracker","getInstance","_applyLayout","_mouseDownListener","dom","domNode","preventDefault","internalOffsetY","browserEvent","offsetY","lineIndex","lineNumber","model","getLineCount","privateViewEventBus","emit","viewEvents","_sliderMouseMoveMonitor","_sliderMouseDownListener","stopPropagation","leftButton","initialMousePosition_1","posy","initialMouseOrthogonalPosition_1","posx","initialSliderState_1","toggleClassName","startMonitoring","buttons","mouseMoveData","mouseOrthogonalDelta","abs","platform","viewLayout","setScrollPositionNow","mouseDelta","_gestureDisposable","addTarget","_sliderTouchStartListener","Start","scrollDueToTouchEvent","_sliderTouchMoveListener","Change","_sliderTouchEndListener","End","touch","startY","getBoundingClientRect","top","dispose","getDomNode","setWidth","setHeight","_getBuffer","_onOptionsMaybeChanged","opts","onConfigurationChanged","onCursorStateChanged","selections","onFlushed","onScrollChanged","onTokensColorsChanged","onZonesChanged","onDecorationsChanged","onThemeChanged","invalidateMinimapColorCache","prepareRender","render","renderingCtx","scrollLeft","viewportWidth","scrollWidth","visibleRange","viewportData","whitespaceViewportData","setTop","scrollLeftChars","horizontalSliderLeft","renderDecorations","renderLines","decorations","getDecorationsInViewport","getLineMaxColumn","_a","characterWidth","tabSize","getOptions","canvasContext","clearRect","lineOffsetMap","Map","selection","line","renderDecorationOnLine","decoration","minimap","decorationColor","range","position","Inline","Gutter","renderDecoration","decorationRange","lineIndexToXOffset","isFirstDecorationForLine","lineData","getLineContent","charCode","charCodeAt","strings","startColumn","endColumn","endColumnForLine","renderLineHighlight","transparent","toString","fillRect","_lastData","_renderUntouchedLines","_dirtyY1","_dirtyY2","needed","lineInfo","getMinimapLinesRenderingData","backgroundIsLight","renderedLines","_renderLine","dirtyY1","dirtyY2","dirtyHeight","putImageData","lastRenderData","lastTargetData","lastStartLineNumber","lastLines","lastLinesLength","targetData","maxDestPixel","dirtyPixel1","dirtyPixel2","copySourceStart","copySourceEnd","copyDestStart","copyDestEnd","dest_dy","lastLineIndex","source_dy","sourceStart","sourceEnd","destStart","destEnd","subarray","colorTracker","minimapCharRenderer","content","tokens","maxDx","tabsCharDelta","tokenIndex","tokensLen","getCount","tokenEndIndex","getEndOffset","tokenColorId","getForeground","tokenColor","insertSpacesCount","count","collector","sliderBackground","halfSliderBackground","addRule","sliderHoverBackground","halfSliderHoverBackground","sliderActiveBackground","halfSliderActiveBackground","shadow","isRenderedUsingBorder","AbstractLineHighlightOverlay","_lineHeight","_renderLineHighlight","_contentLeft","contentLeft","_contentWidth","contentWidth","_selectionIsEmpty","_cursorLineNumbers","_renderData","addEventHandler","removeEventHandler","_readFromSelections","hasChanged","renderSelections","slice","cursorsLineNumbers","map","s","positionLineNumber","sort","a","selectionIsEmpty","every","isEmpty","scrollWidthChanged","scrollTopChanged","_shouldRenderThis","renderedLine","_renderOne","visibleStartLineNumber","visibleEndLineNumber","index","renderData","CurrentLineHighlightOverlay","apply","arguments","className","_shouldRenderOther","CurrentLineMarginHighlightOverlay","lineHighlight","isTransparent","defines","lineHighlightBorder","type","Margin","_canUseLayerHinting","_glyphMarginLeft","glyphMarginLeft","_glyphMarginWidth","glyphMarginWidth","OUTER_CLASS_NAME","_glyphMarginBackgroundDomNode","CLASS_NAME","adjustedScrollTop","bigNumbersDelta","Rulers","_renderedRulers","_rulers","_typicalHalfwidthCharacterWidth","scrollHeightChanged","_ensureRulersCount","currentCount","desiredCount","rulerWidth","addCount","node","removeCount","pop","removeChild","rulerColor","MarginViewLineDecorationsOverlay","_renderResult","_getDecorations","rLen","marginClassName","toRender","_render","classNames","lineOutput","EditorScrollbar","linesContent","viewDomNode","overflowGuardDomNode","scrollbar","mouseWheelScrollSensitivity","fastScrollSensitivity","scrollbarOptions","listenOnDomNode","useShadows","lazyRender","vertical","horizontal","verticalHasArrows","horizontalHasArrows","verticalScrollbarSize","verticalSliderSize","horizontalScrollbarSize","horizontalSliderSize","handleMouseWheel","alwaysConsumeMouseWheel","arrowSize","_register","getScrollable","scrollbarDomNode","_setLayout","onBrowserDesperateReveal","lookAtScrollTop","lookAtScrollLeft","newScrollPosition","deltaTop","getCurrentScrollTop","deltaLeft","getCurrentScrollLeft","side","getOverviewRulerLayoutInfo","delegateVerticalScrollbarMouseDown","newOpts","updateOptions","updateClassName","renderNow","Settings","config","overviewRulerLanes","renderBorder","borderColor","hideCursor","cursorColor","themeType","minimapEnabled","enabled","minimapSide","getDefaultBackground","Format","CSS","formatHex","overviewRuler","right","domWidth","domHeight","canvasWidth","canvasHeight","_initLanes","w","canvasLeftOffset","laneCount","remainingWidth","leftWidth","rightWidth","centerWidth","leftOffset","centerOffset","rightOffset","DecorationsOverviewRuler","_updateSettings","_tokensColorTrackerListener","onDidChange","changedColorMap","_cursorPositions","newSettings","_settings","setRight","getPosition","compare","invalidateOverviewRulerColorCache","editorCtx","outerHeight","getScrollHeight","heightRatio","getAllOverviewRulerDecorations","minDecorationHeight","halfMinDecorationHeight","canvasCtx","colors","keys","cIndex","cLen","colorDecorations","prevLane","prevY1","prevY2","lane","y1","getVerticalOffsetForLineNumber","y2","yCenter","cursorHeight","halfCursorHeight","cursorX","cursorW","cursor","beginPath","lineWidth","strokeStyle","moveTo","lineTo","stroke","setBackgroundColor","FloatHorizontalRange","left","RangeUtil","_createRange","_handyReadyRange","createRange","_detachRange","endNode","selectNodeContents","_readClientRects","startElement","startOffset","endElement","endOffset","setStart","setEnd","getClientRects","_mergeAdjacentRanges","prevLeft","prevWidth","myLeft","myWidth","_createHorizontalRangesFromClientRects","clientRects","clientRectDeltaLeft","clientRect","readHorizontalRanges","startChildIndex","endChildIndex","children","firstChild","textContent","canUseFastRenderedViewLine","browser","alwaysRenderInlineSelection","DomReadingContext","_clientRectDeltaLeft","_clientRectDeltaLeftRead","defineProperty","enumerable","configurable","ViewLineOptions","renderWhitespace","renderControlCharacters","spaceWidth","middotWidth","useMonospaceOptimizations","isMonospace","canUseHalfwidthRightwardsArrow","stopRenderingLineAfter","fontLigatures","ViewLine","_isMaybeInvalid","_renderedViewLine","setDomNode","onOptionsChanged","newOptions","onSelectionChanged","renderLine","sb","getViewLineRenderingData","actualInlineDecorations","filter","inlineDecorations","minColumn","maxColumn","selectionsOnLine","selections_1","renderLineInput","continuesWithWrappedLine","isBasicASCII","containsRTL","startVisibleColumn","OFF","appendASCIIString","renderedViewLine","containsForeignElements","lineTokens","characterMapping","createRenderedLine","layoutLine","getWidth","getWidthIsFast","getVisibleRangesForRange","lineContent","outsideRenderedLine","horizontalRanges","getColumnOfNodeOffset","spanNode","FastRenderedViewLine","_characterMapping","_charWidth","_getCharPosition","startPosition","endPosition","charOffset","getAbsoluteOffsets","spanNodeTextContentLength","spanIndex","previousSibling","partDataToCharOffset","RenderedViewLine","_isWhitespaceOnly","test","_containsForeignElements","_cachedWidth","_pixelOffsetCache","Int32Array","_getReadingTarget","myDomNode","offsetWidth","_readPixelOffset","_readVisibleRangesForRange","pixelOffset","_readRawVisibleRangesForRange","readingTarget","cachedPixelOffset","_actualReadPixelOffset","r_1","partData","charOffsetToPartData","partIndex","getPartIndex","charOffsetInPart","startPartData","startPartIndex","startCharOffsetInPart","endPartData","endPartIndex","endCharOffsetInPart","WebKitRenderedViewLine","endPixelOffset","lastRange","createWebKitRenderedLine","createNormalRenderedLine","Coordinate","ViewContentWidgets","_viewDomNode","_widgets","overflowingContentWidgetsDomNode","keys_1","widgetId","onLineMappingChanged","keys_2","addWidget","_widget","myWidget","Widget","id","allowEditorOverflow","setShouldRender","setWidgetPosition","widget","preference","getId","removeWidget","parentNode","removeAttribute","shouldSuppressMouseDownOnWidget","suppressMouseDown","onBeforeRender","keys_3","keys_4","keys_5","actual","_actual","_fixedOverflowWidgets","_range","_viewRange","_preference","_cachedDomNodeClientWidth","_cachedDomNodeClientHeight","_maxWidth","_getMaxWidth","_isVisible","setVisibility","setMaxWidth","_setPosition","validModelRange","validateModelRange","coordinatesConverter","modelPositionIsVisible","getStartPosition","getEndPosition","convertModelRangeToViewRange","window","innerWidth","documentElement","clientWidth","body","_layoutBoxInViewport","topLeft","bottomLeft","aboveLineTop","heightAboveLine","underLineTop","heightUnderLine","aboveTop","fitsAbove","belowTop","fitsBelow","actualAboveLeft","actualBelowLeft","aboveLeft","belowLeft","_layoutHorizontalSegmentInPage","windowSize","domNodePosition","MIN_LIMIT","MAX_LIMIT","absoluteLeft","scrollX","_layoutBoxInPage","absoluteAboveTop","scrollY","absoluteBelowTop","absoluteAboveLeft","_b","absoluteBelowLeft","TOP_PADDING","BOTTOM_PADDING","_prepareRenderWidgetAtExactPositionOverflowing","_getTopAndBottomLeft","visibleRangesForRange","linesVisibleRangesForRange","firstLine","lastLine","visibleRangesForRange_1","visibleRangesForLine","firstLineMinLeft","lastLineMinLeft","_c","_d","topForPosition","topForBottomLine","_prepareRenderWidget","placement","clientHeight","pass","pref","LinesDecorationsOverlay","_decorationsLeft","decorationsLeft","_decorationsWidth","decorationsWidth","linesDecorationsClassName","common","DecorationsOverlay","_decorations","decorationsLen","zIndex","aClassName","bClassName","compareRangesUsingStarts","_renderWholeLineDecorations","_renderNormalDecorations","lenI","isWholeLine","decorationOutput","prevClassName","prevShowIfCollapsed","prevRange","showIfCollapsed","Boolean","areIntersectingOrTouching","plusRange","_renderNormalDecoration","linesVisibleRanges","lenJ","lineVisibleRanges","singleVisibleRange","k","lenK","LineNumbersOverlay","_readConfig","_lastCursorModelPosition","lineNumbers","_renderLineNumbers","renderType","_renderCustomLineNumbers","renderFn","_renderFinalNewline","_lineNumbersLeft","lineNumbersLeft","_lineNumbersWidth","lineNumbersWidth","primaryViewPosition","convertViewPositionToModelPosition","_getLineRenderLineNumber","viewLineNumber","modelPosition","modelLineNumber","diff","lineHeightClassName","getLineLength","renderLineNumber","activeLineNumber","LastRenderedData","_currentVisibleRange","getCurrentVisibleRange","setCurrentVisibleRange","currentVisibleRange","HorizontalRevealRequest","startScrollTop","stopScrollTop","scrollType","ViewLines","_linesContent","_textRangeRestingSpot","_visibleLines","conf","wrappingInfo","_isViewportWrapping","isViewportWrapping","_revealHorizontalRightPadding","_cursorSurroundingLines","_cursorSurroundingLinesStyle","_viewLineOptions","applyFontInfo","_maxLineWidth","_asyncUpdateLineWidths","_updateLineWidthsSlow","_lastRenderedData","_horizontalRevealRequest","createVisibleLine","newViewLineOptions","getStartLineNumber","getEndLineNumber","getVisibleLine","rendStartLineNumber","rendEndLineNumber","shouldRender","onRevealRangeRequest","desiredScrollTop","_computeScrollTopToRevealRange","getFutureViewport","verticalType","validateScrollPosition","revealHorizontal","scrollTopDelta","setScrollPositionSmooth","scrollLeftChanged","onMaxLineWidthChanged","getPositionFromDOMInfo","viewLineDomNode","_getViewLineDomNode","_getLineNumberFor","getLineMinColumn","nodeType","parentElement","getLineWidth","includeNewLines","originalEndLineNumber","intersectRanges","visibleRanges","visibleRangesLen","domReadingContext","nextLineModelLineNumber","currentLineModelLineNumber","_visibleRangesForLineRange","visibleRangeForPosition","updateLineWidths","_updateLineWidths","_updateLineWidthsFast","fast","localMaxLineWidth","allWidthsComputed","visibleLine","_ensureMaxLineWidth","renderText","getScrollWidth","revealLineNumber","revealStartColumn","revealEndColumn","onDidRender","newScrollLeft","_computeScrollLeftToRevealRange","maxHorizontalOffset","schedule","iLineWidth","ceil","viewport","boxStartY","boxEndY","viewportStartY","viewportEndY","newScrollTop","shouldIgnoreScrollOff","boxMiddleY","_computeMinimumScrolling","getCurrentViewport","viewportStartX","viewportEndX","boxStartX","boxEndX","HORIZONTAL_EXTRA_PX","viewportStart","viewportEnd","boxStart","boxEnd","revealAtStart","revealAtEnd","viewportLength","boxLength","ViewOverlayWidgets","_verticalScrollbarWidth","verticalScrollbarWidth","_minimapWidth","_horizontalScrollbarHeight","horizontalScrollbarHeight","_editorHeight","_editorWidth","widgetData","_renderWidget","widgetHeight","unsetTop","IndentGuidesOverlay","_primaryLineNumber","_spaceWidth","_enabled","_activeIndentEnabled","_maxIndentLeft","wrappingColumn","newPrimaryLineNumber","onLanguageConfigurationChanged","indentSize","indentWidth","indents","getLinesIndentGuides","activeIndentStartLineNumber","activeIndentEndLineNumber","activeIndentLevel","activeIndentInfo","getActiveIndentGuide","indent","containsActiveIndentGuide","leftMostVisiblePosition","editorIndentGuidesColor","editorActiveIndentGuidesColor","OverviewRuler","cssClassName","_zoneManager","setDOMWidth","setDOMHeight","setOuterHeight","setLineHeight","setPixelRatio","getDOMWidth","getDOMHeight","getCanvasWidth","getCanvasHeight","setLayout","setZones","zones","getOuterHeight","colorZones","resolveColorZones","id2Color","getId2Color","_renderOneLane","currentColorId","currentFrom","currentTo","colorZones_1","zone","zoneColorId","colorId","zoneFrom","from","zoneTo","to","DecorationToRender","DedupOverlay","prevEndLineIndex","startLineIndex","endLineIndex","i_1","GlyphMarginOverlay","_glyphMargin","glyphMarginClassName","join"],"mappings":"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","file":"js/chunk-vendors~b8f7cc28.647ee3eb.js","sourcesContent":["/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport var allCharCodes = (function () {\r\n    var v = [];\r\n    for (var i = 32 /* START_CH_CODE */; i <= 126 /* END_CH_CODE */; i++) {\r\n        v.push(i);\r\n    }\r\n    v.push(65533 /* UNKNOWN_CODE */);\r\n    return v;\r\n})();\r\nexport var getCharIndex = function (chCode, fontScale) {\r\n    chCode -= 32 /* START_CH_CODE */;\r\n    if (chCode < 0 || chCode > 96 /* CHAR_COUNT */) {\r\n        if (fontScale <= 2) {\r\n            // for smaller scales, we can get away with using any ASCII character...\r\n            return (chCode + 96 /* CHAR_COUNT */) % 96 /* CHAR_COUNT */;\r\n        }\r\n        return 96 /* CHAR_COUNT */ - 1; // unknown symbol\r\n    }\r\n    return chCode;\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { getCharIndex } from './minimapCharSheet.js';\r\nvar MinimapCharRenderer = /** @class */ (function () {\r\n    function MinimapCharRenderer(charData, scale) {\r\n        this.scale = scale;\r\n        this.charDataNormal = MinimapCharRenderer.soften(charData, 12 / 15);\r\n        this.charDataLight = MinimapCharRenderer.soften(charData, 50 / 60);\r\n    }\r\n    MinimapCharRenderer.soften = function (input, ratio) {\r\n        var result = new Uint8ClampedArray(input.length);\r\n        for (var i = 0, len = input.length; i < len; i++) {\r\n            result[i] = input[i] * ratio;\r\n        }\r\n        return result;\r\n    };\r\n    MinimapCharRenderer.prototype.renderChar = function (target, dx, dy, chCode, color, backgroundColor, fontScale, useLighterFont) {\r\n        var charWidth = 1 /* BASE_CHAR_WIDTH */ * this.scale;\r\n        var charHeight = 2 /* BASE_CHAR_HEIGHT */ * this.scale;\r\n        if (dx + charWidth > target.width || dy + charHeight > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var charData = useLighterFont ? this.charDataLight : this.charDataNormal;\r\n        var charIndex = getCharIndex(chCode, fontScale);\r\n        var destWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var dest = target.data;\r\n        var sourceOffset = charIndex * charWidth * charHeight;\r\n        var row = dy * destWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        for (var y = 0; y < charHeight; y++) {\r\n            var column = row;\r\n            for (var x = 0; x < charWidth; x++) {\r\n                var c = charData[sourceOffset++] / 255;\r\n                dest[column++] = backgroundR + deltaR * c;\r\n                dest[column++] = backgroundG + deltaG * c;\r\n                dest[column++] = backgroundB + deltaB * c;\r\n                column++;\r\n            }\r\n            row += destWidth;\r\n        }\r\n    };\r\n    MinimapCharRenderer.prototype.blockRenderChar = function (target, dx, dy, color, backgroundColor, useLighterFont) {\r\n        var charWidth = 1 /* BASE_CHAR_WIDTH */ * this.scale;\r\n        var charHeight = 2 /* BASE_CHAR_HEIGHT */ * this.scale;\r\n        if (dx + charWidth > target.width || dy + charHeight > target.height) {\r\n            console.warn('bad render request outside image data');\r\n            return;\r\n        }\r\n        var destWidth = target.width * 4 /* RGBA_CHANNELS_CNT */;\r\n        var c = 0.5;\r\n        var backgroundR = backgroundColor.r;\r\n        var backgroundG = backgroundColor.g;\r\n        var backgroundB = backgroundColor.b;\r\n        var deltaR = color.r - backgroundR;\r\n        var deltaG = color.g - backgroundG;\r\n        var deltaB = color.b - backgroundB;\r\n        var colorR = backgroundR + deltaR * c;\r\n        var colorG = backgroundG + deltaG * c;\r\n        var colorB = backgroundB + deltaB * c;\r\n        var dest = target.data;\r\n        var row = dy * destWidth + dx * 4 /* RGBA_CHANNELS_CNT */;\r\n        for (var y = 0; y < charHeight; y++) {\r\n            var column = row;\r\n            for (var x = 0; x < charWidth; x++) {\r\n                dest[column++] = colorR;\r\n                dest[column++] = colorG;\r\n                dest[column++] = colorB;\r\n                column++;\r\n            }\r\n            row += destWidth;\r\n        }\r\n    };\r\n    return MinimapCharRenderer;\r\n}());\r\nexport { MinimapCharRenderer };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { once } from '../../../../base/common/functional.js';\r\nvar charTable = {\r\n    '0': 0,\r\n    '1': 1,\r\n    '2': 2,\r\n    '3': 3,\r\n    '4': 4,\r\n    '5': 5,\r\n    '6': 6,\r\n    '7': 7,\r\n    '8': 8,\r\n    '9': 9,\r\n    A: 10,\r\n    B: 11,\r\n    C: 12,\r\n    D: 13,\r\n    E: 14,\r\n    F: 15\r\n};\r\nvar decodeData = function (str) {\r\n    var output = new Uint8ClampedArray(str.length / 2);\r\n    for (var i = 0; i < str.length; i += 2) {\r\n        output[i >> 1] = (charTable[str[i]] << 4) | (charTable[str[i + 1]] & 0xF);\r\n    }\r\n    return output;\r\n};\r\n/*\r\nconst encodeData = (data: Uint8ClampedArray, length: string) => {\r\n    const chars = '0123456789ABCDEF';\r\n    let output = '';\r\n    for (let i = 0; i < data.length; i++) {\r\n        output += chars[data[i] >> 4] + chars[data[i] & 0xf];\r\n    }\r\n    return output;\r\n};\r\n*/\r\n/**\r\n * Map of minimap scales to prebaked sample data at those scales. We don't\r\n * sample much larger data, because then font family becomes visible, which\r\n * is use-configurable.\r\n */\r\nexport var prebakedMiniMaps = {\r\n    1: once(function () {\r\n        return decodeData('0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792');\r\n    }),\r\n    2: once(function () {\r\n        return decodeData('000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126');\r\n    })\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { MinimapCharRenderer } from './minimapCharRenderer.js';\r\nimport { allCharCodes } from './minimapCharSheet.js';\r\nimport { prebakedMiniMaps } from './minimapPreBaked.js';\r\n/**\r\n * Creates character renderers. It takes a 'scale' that determines how large\r\n * characters should be drawn. Using this, it draws data into a canvas and\r\n * then downsamples the characters as necessary for the current display.\r\n * This makes rendering more efficient, rather than drawing a full (tiny)\r\n * font, or downsampling in real-time.\r\n */\r\nvar MinimapCharRendererFactory = /** @class */ (function () {\r\n    function MinimapCharRendererFactory() {\r\n    }\r\n    /**\r\n     * Creates a new character renderer factory with the given scale.\r\n     */\r\n    MinimapCharRendererFactory.create = function (scale, fontFamily) {\r\n        // renderers are immutable. By default we'll 'create' a new minimap\r\n        // character renderer whenever we switch editors, no need to do extra work.\r\n        if (this.lastCreated && scale === this.lastCreated.scale && fontFamily === this.lastFontFamily) {\r\n            return this.lastCreated;\r\n        }\r\n        var factory;\r\n        if (prebakedMiniMaps[scale]) {\r\n            factory = new MinimapCharRenderer(prebakedMiniMaps[scale](), scale);\r\n        }\r\n        else {\r\n            factory = MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(fontFamily).data, scale);\r\n        }\r\n        this.lastFontFamily = fontFamily;\r\n        this.lastCreated = factory;\r\n        return factory;\r\n    };\r\n    /**\r\n     * Creates the font sample data, writing to a canvas.\r\n     */\r\n    MinimapCharRendererFactory.createSampleData = function (fontFamily) {\r\n        var canvas = document.createElement('canvas');\r\n        var ctx = canvas.getContext('2d');\r\n        canvas.style.height = 16 /* SAMPLED_CHAR_HEIGHT */ + \"px\";\r\n        canvas.height = 16 /* SAMPLED_CHAR_HEIGHT */;\r\n        canvas.width = 96 /* CHAR_COUNT */ * 10 /* SAMPLED_CHAR_WIDTH */;\r\n        canvas.style.width = 96 /* CHAR_COUNT */ * 10 /* SAMPLED_CHAR_WIDTH */ + 'px';\r\n        ctx.fillStyle = '#ffffff';\r\n        ctx.font = \"bold \" + 16 /* SAMPLED_CHAR_HEIGHT */ + \"px \" + fontFamily;\r\n        ctx.textBaseline = 'middle';\r\n        var x = 0;\r\n        for (var _i = 0, allCharCodes_1 = allCharCodes; _i < allCharCodes_1.length; _i++) {\r\n            var code = allCharCodes_1[_i];\r\n            ctx.fillText(String.fromCharCode(code), x, 16 /* SAMPLED_CHAR_HEIGHT */ / 2);\r\n            x += 10 /* SAMPLED_CHAR_WIDTH */;\r\n        }\r\n        return ctx.getImageData(0, 0, 96 /* CHAR_COUNT */ * 10 /* SAMPLED_CHAR_WIDTH */, 16 /* SAMPLED_CHAR_HEIGHT */);\r\n    };\r\n    /**\r\n     * Creates a character renderer from the canvas sample data.\r\n     */\r\n    MinimapCharRendererFactory.createFromSampleData = function (source, scale) {\r\n        var expectedLength = 16 /* SAMPLED_CHAR_HEIGHT */ * 10 /* SAMPLED_CHAR_WIDTH */ * 4 /* RGBA_CHANNELS_CNT */ * 96 /* CHAR_COUNT */;\r\n        if (source.length !== expectedLength) {\r\n            throw new Error('Unexpected source in MinimapCharRenderer');\r\n        }\r\n        var charData = MinimapCharRendererFactory._downsample(source, scale);\r\n        return new MinimapCharRenderer(charData, scale);\r\n    };\r\n    MinimapCharRendererFactory._downsampleChar = function (source, sourceOffset, dest, destOffset, scale) {\r\n        var width = 1 /* BASE_CHAR_WIDTH */ * scale;\r\n        var height = 2 /* BASE_CHAR_HEIGHT */ * scale;\r\n        var targetIndex = destOffset;\r\n        var brightest = 0;\r\n        // This is essentially an ad-hoc rescaling algorithm. Standard approaches\r\n        // like bicubic interpolation are awesome for scaling between image sizes,\r\n        // but don't work so well when scaling to very small pixel values, we end\r\n        // up with blurry, indistinct forms.\r\n        //\r\n        // The approach taken here is simply mapping each source pixel to the target\r\n        // pixels, and taking the weighted values for all pixels in each, and then\r\n        // averaging them out. Finally we apply an intensity boost in _downsample,\r\n        // since when scaling to the smallest pixel sizes there's more black space\r\n        // which causes characters to be much less distinct.\r\n        for (var y = 0; y < height; y++) {\r\n            // 1. For this destination pixel, get the source pixels we're sampling\r\n            // from (x1, y1) to the next pixel (x2, y2)\r\n            var sourceY1 = (y / height) * 16 /* SAMPLED_CHAR_HEIGHT */;\r\n            var sourceY2 = ((y + 1) / height) * 16 /* SAMPLED_CHAR_HEIGHT */;\r\n            for (var x = 0; x < width; x++) {\r\n                var sourceX1 = (x / width) * 10 /* SAMPLED_CHAR_WIDTH */;\r\n                var sourceX2 = ((x + 1) / width) * 10 /* SAMPLED_CHAR_WIDTH */;\r\n                // 2. Sample all of them, summing them up and weighting them. Similar\r\n                // to bilinear interpolation.\r\n                var value = 0;\r\n                var samples = 0;\r\n                for (var sy = sourceY1; sy < sourceY2; sy++) {\r\n                    var sourceRow = sourceOffset + Math.floor(sy) * 3840 /* RGBA_SAMPLED_ROW_WIDTH */;\r\n                    var yBalance = 1 - (sy - Math.floor(sy));\r\n                    for (var sx = sourceX1; sx < sourceX2; sx++) {\r\n                        var xBalance = 1 - (sx - Math.floor(sx));\r\n                        var sourceIndex = sourceRow + Math.floor(sx) * 4 /* RGBA_CHANNELS_CNT */;\r\n                        var weight = xBalance * yBalance;\r\n                        samples += weight;\r\n                        value += ((source[sourceIndex] * source[sourceIndex + 3]) / 255) * weight;\r\n                    }\r\n                }\r\n                var final = value / samples;\r\n                brightest = Math.max(brightest, final);\r\n                dest[targetIndex++] = final;\r\n            }\r\n        }\r\n        return brightest;\r\n    };\r\n    MinimapCharRendererFactory._downsample = function (data, scale) {\r\n        var pixelsPerCharacter = 2 /* BASE_CHAR_HEIGHT */ * scale * 1 /* BASE_CHAR_WIDTH */ * scale;\r\n        var resultLen = pixelsPerCharacter * 96 /* CHAR_COUNT */;\r\n        var result = new Uint8ClampedArray(resultLen);\r\n        var resultOffset = 0;\r\n        var sourceOffset = 0;\r\n        var brightest = 0;\r\n        for (var charIndex = 0; charIndex < 96 /* CHAR_COUNT */; charIndex++) {\r\n            brightest = Math.max(brightest, this._downsampleChar(data, sourceOffset, result, resultOffset, scale));\r\n            resultOffset += pixelsPerCharacter;\r\n            sourceOffset += 10 /* SAMPLED_CHAR_WIDTH */ * 4 /* RGBA_CHANNELS_CNT */;\r\n        }\r\n        if (brightest > 0) {\r\n            var adjust = 255 / brightest;\r\n            for (var i = 0; i < resultLen; i++) {\r\n                result[i] *= adjust;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return MinimapCharRendererFactory;\r\n}());\r\nexport { MinimapCharRendererFactory };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './minimap.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../../base/browser/globalMouseMoveMonitor.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport * as strings from '../../../../base/common/strings.js';\r\nimport { RenderedLinesCollection } from '../../view/viewLayer.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { MINIMAP_GUTTER_WIDTH } from '../../../common/config/editorOptions.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { MinimapTokensColorTracker } from '../../../common/viewModel/minimapTokensColorTracker.js';\r\nimport * as viewEvents from '../../../common/view/viewEvents.js';\r\nimport { scrollbarShadow, scrollbarSliderActiveBackground, scrollbarSliderBackground, scrollbarSliderHoverBackground, minimapSelection } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { EventType, Gesture } from '../../../../base/browser/touch.js';\r\nimport { MinimapCharRendererFactory } from './minimapCharRendererFactory.js';\r\nimport { MinimapPosition } from '../../../common/model.js';\r\nimport { once } from '../../../../base/common/functional.js';\r\nfunction getMinimapLineHeight(renderMinimap, scale) {\r\n    if (renderMinimap === 1 /* Text */) {\r\n        return 2 /* BASE_CHAR_HEIGHT */ * scale;\r\n    }\r\n    // RenderMinimap.Blocks\r\n    return (2 /* BASE_CHAR_HEIGHT */ + 1) * scale;\r\n}\r\nfunction getMinimapCharWidth(renderMinimap, scale) {\r\n    if (renderMinimap === 1 /* Text */) {\r\n        return 1 /* BASE_CHAR_WIDTH */ * scale;\r\n    }\r\n    // RenderMinimap.Blocks\r\n    return 1 /* BASE_CHAR_WIDTH */ * scale;\r\n}\r\n/**\r\n * The orthogonal distance to the slider at which dragging \"resets\". This implements \"snapping\"\r\n */\r\nvar MOUSE_DRAG_RESET_DISTANCE = 140;\r\nvar GUTTER_DECORATION_WIDTH = 2;\r\nvar MinimapOptions = /** @class */ (function () {\r\n    function MinimapOptions(configuration) {\r\n        var _this = this;\r\n        var options = configuration.options;\r\n        var pixelRatio = options.get(105 /* pixelRatio */);\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        this.renderMinimap = layoutInfo.renderMinimap | 0;\r\n        this.scrollBeyondLastLine = options.get(80 /* scrollBeyondLastLine */);\r\n        var minimapOpts = options.get(54 /* minimap */);\r\n        this.showSlider = minimapOpts.showSlider;\r\n        this.fontScale = Math.round(minimapOpts.scale * pixelRatio);\r\n        this.charRenderer = once(function () { return MinimapCharRendererFactory.create(_this.fontScale, fontInfo.fontFamily); });\r\n        this.pixelRatio = pixelRatio;\r\n        this.typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        this.lineHeight = options.get(49 /* lineHeight */);\r\n        this.minimapLeft = layoutInfo.minimapLeft;\r\n        this.minimapWidth = layoutInfo.minimapWidth;\r\n        this.minimapHeight = layoutInfo.height;\r\n        this.canvasInnerWidth = Math.floor(pixelRatio * this.minimapWidth);\r\n        this.canvasInnerHeight = Math.floor(pixelRatio * this.minimapHeight);\r\n        this.canvasOuterWidth = this.canvasInnerWidth / pixelRatio;\r\n        this.canvasOuterHeight = this.canvasInnerHeight / pixelRatio;\r\n    }\r\n    MinimapOptions.prototype.equals = function (other) {\r\n        return (this.renderMinimap === other.renderMinimap\r\n            && this.scrollBeyondLastLine === other.scrollBeyondLastLine\r\n            && this.showSlider === other.showSlider\r\n            && this.pixelRatio === other.pixelRatio\r\n            && this.typicalHalfwidthCharacterWidth === other.typicalHalfwidthCharacterWidth\r\n            && this.lineHeight === other.lineHeight\r\n            && this.fontScale === other.fontScale\r\n            && this.minimapLeft === other.minimapLeft\r\n            && this.minimapWidth === other.minimapWidth\r\n            && this.minimapHeight === other.minimapHeight\r\n            && this.canvasInnerWidth === other.canvasInnerWidth\r\n            && this.canvasInnerHeight === other.canvasInnerHeight\r\n            && this.canvasOuterWidth === other.canvasOuterWidth\r\n            && this.canvasOuterHeight === other.canvasOuterHeight);\r\n    };\r\n    return MinimapOptions;\r\n}());\r\nvar MinimapLayout = /** @class */ (function () {\r\n    function MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber) {\r\n        this.scrollTop = scrollTop;\r\n        this.scrollHeight = scrollHeight;\r\n        this._computedSliderRatio = computedSliderRatio;\r\n        this.sliderTop = sliderTop;\r\n        this.sliderHeight = sliderHeight;\r\n        this.startLineNumber = startLineNumber;\r\n        this.endLineNumber = endLineNumber;\r\n    }\r\n    /**\r\n     * Compute a desired `scrollPosition` such that the slider moves by `delta`.\r\n     */\r\n    MinimapLayout.prototype.getDesiredScrollTopFromDelta = function (delta) {\r\n        var desiredSliderPosition = this.sliderTop + delta;\r\n        return Math.round(desiredSliderPosition / this._computedSliderRatio);\r\n    };\r\n    MinimapLayout.prototype.getDesiredScrollTopFromTouchLocation = function (pageY) {\r\n        return Math.round((pageY - this.sliderHeight / 2) / this._computedSliderRatio);\r\n    };\r\n    MinimapLayout.create = function (options, viewportStartLineNumber, viewportEndLineNumber, viewportHeight, viewportContainsWhitespaceGaps, lineCount, scrollTop, scrollHeight, previousLayout) {\r\n        var pixelRatio = options.pixelRatio;\r\n        var minimapLineHeight = getMinimapLineHeight(options.renderMinimap, options.fontScale);\r\n        var minimapLinesFitting = Math.floor(options.canvasInnerHeight / minimapLineHeight);\r\n        var lineHeight = options.lineHeight;\r\n        // The visible line count in a viewport can change due to a number of reasons:\r\n        //  a) with the same viewport width, different scroll positions can result in partial lines being visible:\r\n        //    e.g. for a line height of 20, and a viewport height of 600\r\n        //          * scrollTop = 0  => visible lines are [1, 30]\r\n        //          * scrollTop = 10 => visible lines are [1, 31] (with lines 1 and 31 partially visible)\r\n        //          * scrollTop = 20 => visible lines are [2, 31]\r\n        //  b) whitespace gaps might make their way in the viewport (which results in a decrease in the visible line count)\r\n        //  c) we could be in the scroll beyond last line case (which also results in a decrease in the visible line count, down to possibly only one line being visible)\r\n        // We must first establish a desirable slider height.\r\n        var sliderHeight;\r\n        if (viewportContainsWhitespaceGaps && viewportEndLineNumber !== lineCount) {\r\n            // case b) from above: there are whitespace gaps in the viewport.\r\n            // In this case, the height of the slider directly reflects the visible line count.\r\n            var viewportLineCount = viewportEndLineNumber - viewportStartLineNumber + 1;\r\n            sliderHeight = Math.floor(viewportLineCount * minimapLineHeight / pixelRatio);\r\n        }\r\n        else {\r\n            // The slider has a stable height\r\n            var expectedViewportLineCount = viewportHeight / lineHeight;\r\n            sliderHeight = Math.floor(expectedViewportLineCount * minimapLineHeight / pixelRatio);\r\n        }\r\n        var maxMinimapSliderTop;\r\n        if (options.scrollBeyondLastLine) {\r\n            // The minimap slider, when dragged all the way down, will contain the last line at its top\r\n            maxMinimapSliderTop = (lineCount - 1) * minimapLineHeight / pixelRatio;\r\n        }\r\n        else {\r\n            // The minimap slider, when dragged all the way down, will contain the last line at its bottom\r\n            maxMinimapSliderTop = Math.max(0, lineCount * minimapLineHeight / pixelRatio - sliderHeight);\r\n        }\r\n        maxMinimapSliderTop = Math.min(options.minimapHeight - sliderHeight, maxMinimapSliderTop);\r\n        // The slider can move from 0 to `maxMinimapSliderTop`\r\n        // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\r\n        var computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\r\n        var sliderTop = (scrollTop * computedSliderRatio);\r\n        var extraLinesAtTheBottom = 0;\r\n        if (options.scrollBeyondLastLine) {\r\n            var expectedViewportLineCount = viewportHeight / lineHeight;\r\n            extraLinesAtTheBottom = expectedViewportLineCount;\r\n        }\r\n        if (minimapLinesFitting >= lineCount + extraLinesAtTheBottom) {\r\n            // All lines fit in the minimap\r\n            var startLineNumber = 1;\r\n            var endLineNumber = lineCount;\r\n            return new MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber);\r\n        }\r\n        else {\r\n            var startLineNumber = Math.max(1, Math.floor(viewportStartLineNumber - sliderTop * pixelRatio / minimapLineHeight));\r\n            // Avoid flickering caused by a partial viewport start line\r\n            // by being consistent w.r.t. the previous layout decision\r\n            if (previousLayout && previousLayout.scrollHeight === scrollHeight) {\r\n                if (previousLayout.scrollTop > scrollTop) {\r\n                    // Scrolling up => never increase `startLineNumber`\r\n                    startLineNumber = Math.min(startLineNumber, previousLayout.startLineNumber);\r\n                }\r\n                if (previousLayout.scrollTop < scrollTop) {\r\n                    // Scrolling down => never decrease `startLineNumber`\r\n                    startLineNumber = Math.max(startLineNumber, previousLayout.startLineNumber);\r\n                }\r\n            }\r\n            var endLineNumber = Math.min(lineCount, startLineNumber + minimapLinesFitting - 1);\r\n            return new MinimapLayout(scrollTop, scrollHeight, computedSliderRatio, sliderTop, sliderHeight, startLineNumber, endLineNumber);\r\n        }\r\n    };\r\n    return MinimapLayout;\r\n}());\r\nvar MinimapLine = /** @class */ (function () {\r\n    function MinimapLine(dy) {\r\n        this.dy = dy;\r\n    }\r\n    MinimapLine.prototype.onContentChanged = function () {\r\n        this.dy = -1;\r\n    };\r\n    MinimapLine.prototype.onTokensChanged = function () {\r\n        this.dy = -1;\r\n    };\r\n    MinimapLine.INVALID = new MinimapLine(-1);\r\n    return MinimapLine;\r\n}());\r\nvar RenderData = /** @class */ (function () {\r\n    function RenderData(renderedLayout, imageData, lines) {\r\n        this.renderedLayout = renderedLayout;\r\n        this._imageData = imageData;\r\n        this._renderedLines = new RenderedLinesCollection(function () { return MinimapLine.INVALID; });\r\n        this._renderedLines._set(renderedLayout.startLineNumber, lines);\r\n    }\r\n    /**\r\n     * Check if the current RenderData matches accurately the new desired layout and no painting is needed.\r\n     */\r\n    RenderData.prototype.linesEquals = function (layout) {\r\n        if (!this.scrollEquals(layout)) {\r\n            return false;\r\n        }\r\n        var tmp = this._renderedLines._get();\r\n        var lines = tmp.lines;\r\n        for (var i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].dy === -1) {\r\n                // This line is invalid\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Check if the current RenderData matches the new layout's scroll position\r\n     */\r\n    RenderData.prototype.scrollEquals = function (layout) {\r\n        return this.renderedLayout.startLineNumber === layout.startLineNumber\r\n            && this.renderedLayout.endLineNumber === layout.endLineNumber;\r\n    };\r\n    RenderData.prototype._get = function () {\r\n        var tmp = this._renderedLines._get();\r\n        return {\r\n            imageData: this._imageData,\r\n            rendLineNumberStart: tmp.rendLineNumberStart,\r\n            lines: tmp.lines\r\n        };\r\n    };\r\n    RenderData.prototype.onLinesChanged = function (e) {\r\n        return this._renderedLines.onLinesChanged(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onLinesDeleted = function (e) {\r\n        this._renderedLines.onLinesDeleted(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onLinesInserted = function (e) {\r\n        this._renderedLines.onLinesInserted(e.fromLineNumber, e.toLineNumber);\r\n    };\r\n    RenderData.prototype.onTokensChanged = function (e) {\r\n        return this._renderedLines.onTokensChanged(e.ranges);\r\n    };\r\n    return RenderData;\r\n}());\r\n/**\r\n * Some sort of double buffering.\r\n *\r\n * Keeps two buffers around that will be rotated for painting.\r\n * Always gives a buffer that is filled with the background color.\r\n */\r\nvar MinimapBuffers = /** @class */ (function () {\r\n    function MinimapBuffers(ctx, WIDTH, HEIGHT, background) {\r\n        this._backgroundFillData = MinimapBuffers._createBackgroundFillData(WIDTH, HEIGHT, background);\r\n        this._buffers = [\r\n            ctx.createImageData(WIDTH, HEIGHT),\r\n            ctx.createImageData(WIDTH, HEIGHT)\r\n        ];\r\n        this._lastUsedBuffer = 0;\r\n    }\r\n    MinimapBuffers.prototype.getBuffer = function () {\r\n        // rotate buffers\r\n        this._lastUsedBuffer = 1 - this._lastUsedBuffer;\r\n        var result = this._buffers[this._lastUsedBuffer];\r\n        // fill with background color\r\n        result.data.set(this._backgroundFillData);\r\n        return result;\r\n    };\r\n    MinimapBuffers._createBackgroundFillData = function (WIDTH, HEIGHT, background) {\r\n        var backgroundR = background.r;\r\n        var backgroundG = background.g;\r\n        var backgroundB = background.b;\r\n        var result = new Uint8ClampedArray(WIDTH * HEIGHT * 4);\r\n        var offset = 0;\r\n        for (var i = 0; i < HEIGHT; i++) {\r\n            for (var j = 0; j < WIDTH; j++) {\r\n                result[offset] = backgroundR;\r\n                result[offset + 1] = backgroundG;\r\n                result[offset + 2] = backgroundB;\r\n                result[offset + 3] = 255;\r\n                offset += 4;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    return MinimapBuffers;\r\n}());\r\nvar Minimap = /** @class */ (function (_super) {\r\n    __extends(Minimap, _super);\r\n    function Minimap(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._selections = [];\r\n        _this._renderDecorations = false;\r\n        _this._gestureInProgress = false;\r\n        _this._options = new MinimapOptions(_this._context.configuration);\r\n        _this._lastRenderData = null;\r\n        _this._buffers = null;\r\n        _this._selectionColor = _this._context.theme.getColor(minimapSelection);\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this._domNode, 8 /* Minimap */);\r\n        _this._domNode.setClassName(_this._getMinimapDomNodeClassName());\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._shadow = createFastDomNode(document.createElement('div'));\r\n        _this._shadow.setClassName('minimap-shadow-hidden');\r\n        _this._domNode.appendChild(_this._shadow);\r\n        _this._canvas = createFastDomNode(document.createElement('canvas'));\r\n        _this._canvas.setPosition('absolute');\r\n        _this._canvas.setLeft(0);\r\n        _this._domNode.appendChild(_this._canvas);\r\n        _this._decorationsCanvas = createFastDomNode(document.createElement('canvas'));\r\n        _this._decorationsCanvas.setPosition('absolute');\r\n        _this._decorationsCanvas.setClassName('minimap-decorations-layer');\r\n        _this._decorationsCanvas.setLeft(0);\r\n        _this._domNode.appendChild(_this._decorationsCanvas);\r\n        _this._slider = createFastDomNode(document.createElement('div'));\r\n        _this._slider.setPosition('absolute');\r\n        _this._slider.setClassName('minimap-slider');\r\n        _this._slider.setLayerHinting(true);\r\n        _this._slider.setContain('strict');\r\n        _this._domNode.appendChild(_this._slider);\r\n        _this._sliderHorizontal = createFastDomNode(document.createElement('div'));\r\n        _this._sliderHorizontal.setPosition('absolute');\r\n        _this._sliderHorizontal.setClassName('minimap-slider-horizontal');\r\n        _this._slider.appendChild(_this._sliderHorizontal);\r\n        _this._tokensColorTracker = MinimapTokensColorTracker.getInstance();\r\n        _this._applyLayout();\r\n        _this._mouseDownListener = dom.addStandardDisposableListener(_this._domNode.domNode, 'mousedown', function (e) {\r\n            e.preventDefault();\r\n            var renderMinimap = _this._options.renderMinimap;\r\n            if (renderMinimap === 0 /* None */) {\r\n                return;\r\n            }\r\n            if (!_this._lastRenderData) {\r\n                return;\r\n            }\r\n            var minimapLineHeight = getMinimapLineHeight(renderMinimap, _this._options.fontScale);\r\n            var internalOffsetY = _this._options.pixelRatio * e.browserEvent.offsetY;\r\n            var lineIndex = Math.floor(internalOffsetY / minimapLineHeight);\r\n            var lineNumber = lineIndex + _this._lastRenderData.renderedLayout.startLineNumber;\r\n            lineNumber = Math.min(lineNumber, _this._context.model.getLineCount());\r\n            _this._context.privateViewEventBus.emit(new viewEvents.ViewRevealRangeRequestEvent('mouse', new Range(lineNumber, 1, lineNumber, 1), 1 /* Center */, false, 0 /* Smooth */));\r\n        });\r\n        _this._sliderMouseMoveMonitor = new GlobalMouseMoveMonitor();\r\n        _this._sliderMouseDownListener = dom.addStandardDisposableListener(_this._slider.domNode, 'mousedown', function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (e.leftButton && _this._lastRenderData) {\r\n                var initialMousePosition_1 = e.posy;\r\n                var initialMouseOrthogonalPosition_1 = e.posx;\r\n                var initialSliderState_1 = _this._lastRenderData.renderedLayout;\r\n                _this._slider.toggleClassName('active', true);\r\n                _this._sliderMouseMoveMonitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, function (mouseMoveData) {\r\n                    var mouseOrthogonalDelta = Math.abs(mouseMoveData.posx - initialMouseOrthogonalPosition_1);\r\n                    if (platform.isWindows && mouseOrthogonalDelta > MOUSE_DRAG_RESET_DISTANCE) {\r\n                        // The mouse has wondered away from the scrollbar => reset dragging\r\n                        _this._context.viewLayout.setScrollPositionNow({\r\n                            scrollTop: initialSliderState_1.scrollTop\r\n                        });\r\n                        return;\r\n                    }\r\n                    var mouseDelta = mouseMoveData.posy - initialMousePosition_1;\r\n                    _this._context.viewLayout.setScrollPositionNow({\r\n                        scrollTop: initialSliderState_1.getDesiredScrollTopFromDelta(mouseDelta)\r\n                    });\r\n                }, function () {\r\n                    _this._slider.toggleClassName('active', false);\r\n                });\r\n            }\r\n        });\r\n        _this._gestureDisposable = Gesture.addTarget(_this._domNode.domNode);\r\n        _this._sliderTouchStartListener = dom.addDisposableListener(_this._domNode.domNode, EventType.Start, function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (_this._lastRenderData) {\r\n                _this._slider.toggleClassName('active', true);\r\n                _this._gestureInProgress = true;\r\n                _this.scrollDueToTouchEvent(e);\r\n            }\r\n        });\r\n        _this._sliderTouchMoveListener = dom.addStandardDisposableListener(_this._domNode.domNode, EventType.Change, function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            if (_this._lastRenderData && _this._gestureInProgress) {\r\n                _this.scrollDueToTouchEvent(e);\r\n            }\r\n        });\r\n        _this._sliderTouchEndListener = dom.addStandardDisposableListener(_this._domNode.domNode, EventType.End, function (e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            _this._gestureInProgress = false;\r\n            _this._slider.toggleClassName('active', false);\r\n        });\r\n        return _this;\r\n    }\r\n    Minimap.prototype.scrollDueToTouchEvent = function (touch) {\r\n        var startY = this._domNode.domNode.getBoundingClientRect().top;\r\n        var scrollTop = this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(touch.pageY - startY);\r\n        this._context.viewLayout.setScrollPositionNow({\r\n            scrollTop: scrollTop\r\n        });\r\n    };\r\n    Minimap.prototype.dispose = function () {\r\n        this._mouseDownListener.dispose();\r\n        this._sliderMouseMoveMonitor.dispose();\r\n        this._sliderMouseDownListener.dispose();\r\n        this._gestureDisposable.dispose();\r\n        this._sliderTouchStartListener.dispose();\r\n        this._sliderTouchMoveListener.dispose();\r\n        this._sliderTouchEndListener.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Minimap.prototype._getMinimapDomNodeClassName = function () {\r\n        if (this._options.showSlider === 'always') {\r\n            return 'minimap slider-always';\r\n        }\r\n        return 'minimap slider-mouseover';\r\n    };\r\n    Minimap.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    Minimap.prototype._applyLayout = function () {\r\n        this._domNode.setLeft(this._options.minimapLeft);\r\n        this._domNode.setWidth(this._options.minimapWidth);\r\n        this._domNode.setHeight(this._options.minimapHeight);\r\n        this._shadow.setHeight(this._options.minimapHeight);\r\n        this._canvas.setWidth(this._options.canvasOuterWidth);\r\n        this._canvas.setHeight(this._options.canvasOuterHeight);\r\n        this._canvas.domNode.width = this._options.canvasInnerWidth;\r\n        this._canvas.domNode.height = this._options.canvasInnerHeight;\r\n        this._decorationsCanvas.setWidth(this._options.canvasOuterWidth);\r\n        this._decorationsCanvas.setHeight(this._options.canvasOuterHeight);\r\n        this._decorationsCanvas.domNode.width = this._options.canvasInnerWidth;\r\n        this._decorationsCanvas.domNode.height = this._options.canvasInnerHeight;\r\n        this._slider.setWidth(this._options.minimapWidth);\r\n    };\r\n    Minimap.prototype._getBuffer = function () {\r\n        if (!this._buffers) {\r\n            if (this._options.canvasInnerWidth > 0 && this._options.canvasInnerHeight > 0) {\r\n                this._buffers = new MinimapBuffers(this._canvas.domNode.getContext('2d'), this._options.canvasInnerWidth, this._options.canvasInnerHeight, this._tokensColorTracker.getColor(2 /* DefaultBackground */));\r\n            }\r\n        }\r\n        return this._buffers ? this._buffers.getBuffer() : null;\r\n    };\r\n    Minimap.prototype._onOptionsMaybeChanged = function () {\r\n        var opts = new MinimapOptions(this._context.configuration);\r\n        if (this._options.equals(opts)) {\r\n            return false;\r\n        }\r\n        this._options = opts;\r\n        this._lastRenderData = null;\r\n        this._buffers = null;\r\n        this._applyLayout();\r\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\r\n        return true;\r\n    };\r\n    // ---- begin view event handlers\r\n    Minimap.prototype.onConfigurationChanged = function (e) {\r\n        return this._onOptionsMaybeChanged();\r\n    };\r\n    Minimap.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections;\r\n        this._renderDecorations = true;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onFlushed = function (e) {\r\n        this._lastRenderData = null;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onLinesChanged = function (e) {\r\n        if (this._lastRenderData) {\r\n            return this._lastRenderData.onLinesChanged(e);\r\n        }\r\n        return false;\r\n    };\r\n    Minimap.prototype.onLinesDeleted = function (e) {\r\n        if (this._lastRenderData) {\r\n            this._lastRenderData.onLinesDeleted(e);\r\n        }\r\n        return true;\r\n    };\r\n    Minimap.prototype.onLinesInserted = function (e) {\r\n        if (this._lastRenderData) {\r\n            this._lastRenderData.onLinesInserted(e);\r\n        }\r\n        return true;\r\n    };\r\n    Minimap.prototype.onScrollChanged = function (e) {\r\n        this._renderDecorations = true;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onTokensChanged = function (e) {\r\n        if (this._lastRenderData) {\r\n            return this._lastRenderData.onTokensChanged(e);\r\n        }\r\n        return false;\r\n    };\r\n    Minimap.prototype.onTokensColorsChanged = function (e) {\r\n        this._lastRenderData = null;\r\n        this._buffers = null;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onZonesChanged = function (e) {\r\n        this._lastRenderData = null;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onDecorationsChanged = function (e) {\r\n        this._renderDecorations = true;\r\n        return true;\r\n    };\r\n    Minimap.prototype.onThemeChanged = function (e) {\r\n        this._context.model.invalidateMinimapColorCache();\r\n        this._selectionColor = this._context.theme.getColor(minimapSelection);\r\n        this._renderDecorations = true;\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    Minimap.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Minimap.prototype.render = function (renderingCtx) {\r\n        var renderMinimap = this._options.renderMinimap;\r\n        if (renderMinimap === 0 /* None */) {\r\n            this._shadow.setClassName('minimap-shadow-hidden');\r\n            this._sliderHorizontal.setWidth(0);\r\n            this._sliderHorizontal.setHeight(0);\r\n            return;\r\n        }\r\n        if (renderingCtx.scrollLeft + renderingCtx.viewportWidth >= renderingCtx.scrollWidth) {\r\n            this._shadow.setClassName('minimap-shadow-hidden');\r\n        }\r\n        else {\r\n            this._shadow.setClassName('minimap-shadow-visible');\r\n        }\r\n        var layout = MinimapLayout.create(this._options, renderingCtx.visibleRange.startLineNumber, renderingCtx.visibleRange.endLineNumber, renderingCtx.viewportHeight, (renderingCtx.viewportData.whitespaceViewportData.length > 0), this._context.model.getLineCount(), renderingCtx.scrollTop, renderingCtx.scrollHeight, this._lastRenderData ? this._lastRenderData.renderedLayout : null);\r\n        this._slider.setTop(layout.sliderTop);\r\n        this._slider.setHeight(layout.sliderHeight);\r\n        // Compute horizontal slider coordinates\r\n        var scrollLeftChars = renderingCtx.scrollLeft / this._options.typicalHalfwidthCharacterWidth;\r\n        var horizontalSliderLeft = Math.min(this._options.minimapWidth, Math.round(scrollLeftChars * getMinimapCharWidth(this._options.renderMinimap, this._options.fontScale) / this._options.pixelRatio));\r\n        this._sliderHorizontal.setLeft(horizontalSliderLeft);\r\n        this._sliderHorizontal.setWidth(this._options.minimapWidth - horizontalSliderLeft);\r\n        this._sliderHorizontal.setTop(0);\r\n        this._sliderHorizontal.setHeight(layout.sliderHeight);\r\n        this.renderDecorations(layout);\r\n        this._lastRenderData = this.renderLines(layout);\r\n    };\r\n    Minimap.prototype.renderDecorations = function (layout) {\r\n        if (this._renderDecorations) {\r\n            this._renderDecorations = false;\r\n            var decorations = this._context.model.getDecorationsInViewport(new Range(layout.startLineNumber, 1, layout.endLineNumber, this._context.model.getLineMaxColumn(layout.endLineNumber)));\r\n            var _a = this._options, renderMinimap = _a.renderMinimap, canvasInnerWidth = _a.canvasInnerWidth, canvasInnerHeight = _a.canvasInnerHeight;\r\n            var lineHeight = getMinimapLineHeight(renderMinimap, this._options.fontScale);\r\n            var characterWidth = getMinimapCharWidth(renderMinimap, this._options.fontScale);\r\n            var tabSize = this._context.model.getOptions().tabSize;\r\n            var canvasContext = this._decorationsCanvas.domNode.getContext('2d');\r\n            canvasContext.clearRect(0, 0, canvasInnerWidth, canvasInnerHeight);\r\n            var lineOffsetMap = new Map();\r\n            for (var i = 0; i < this._selections.length; i++) {\r\n                var selection = this._selections[i];\r\n                for (var line = selection.startLineNumber; line <= selection.endLineNumber; line++) {\r\n                    this.renderDecorationOnLine(canvasContext, lineOffsetMap, selection, this._selectionColor, layout, line, lineHeight, lineHeight, tabSize, characterWidth);\r\n                }\r\n            }\r\n            // Loop over decorations, ignoring those that don't have the minimap property set and rendering rectangles for each line the decoration spans\r\n            for (var i = 0; i < decorations.length; i++) {\r\n                var decoration = decorations[i];\r\n                if (!decoration.options.minimap) {\r\n                    continue;\r\n                }\r\n                var decorationColor = decoration.options.minimap.getColor(this._context.theme);\r\n                for (var line = decoration.range.startLineNumber; line <= decoration.range.endLineNumber; line++) {\r\n                    switch (decoration.options.minimap.position) {\r\n                        case MinimapPosition.Inline:\r\n                            this.renderDecorationOnLine(canvasContext, lineOffsetMap, decoration.range, decorationColor, layout, line, lineHeight, lineHeight, tabSize, characterWidth);\r\n                            continue;\r\n                        case MinimapPosition.Gutter:\r\n                            var y = (line - layout.startLineNumber) * lineHeight;\r\n                            var x = 2;\r\n                            this.renderDecoration(canvasContext, decorationColor, x, y, GUTTER_DECORATION_WIDTH, lineHeight);\r\n                            continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Minimap.prototype.renderDecorationOnLine = function (canvasContext, lineOffsetMap, decorationRange, decorationColor, layout, lineNumber, height, lineHeight, tabSize, charWidth) {\r\n        var y = (lineNumber - layout.startLineNumber) * lineHeight;\r\n        // Skip rendering the line if it's vertically outside our viewport\r\n        if (y + height < 0 || y > this._options.canvasInnerHeight) {\r\n            return;\r\n        }\r\n        // Cache line offset data so that it is only read once per line\r\n        var lineIndexToXOffset = lineOffsetMap.get(lineNumber);\r\n        var isFirstDecorationForLine = !lineIndexToXOffset;\r\n        if (!lineIndexToXOffset) {\r\n            var lineData = this._context.model.getLineContent(lineNumber);\r\n            lineIndexToXOffset = [MINIMAP_GUTTER_WIDTH];\r\n            for (var i = 1; i < lineData.length + 1; i++) {\r\n                var charCode = lineData.charCodeAt(i - 1);\r\n                var dx = charCode === 9 /* Tab */\r\n                    ? tabSize * charWidth\r\n                    : strings.isFullWidthCharacter(charCode)\r\n                        ? 2 * charWidth\r\n                        : charWidth;\r\n                lineIndexToXOffset[i] = lineIndexToXOffset[i - 1] + dx;\r\n            }\r\n            lineOffsetMap.set(lineNumber, lineIndexToXOffset);\r\n        }\r\n        var startColumn = decorationRange.startColumn, endColumn = decorationRange.endColumn, startLineNumber = decorationRange.startLineNumber, endLineNumber = decorationRange.endLineNumber;\r\n        var x = startLineNumber === lineNumber ? lineIndexToXOffset[startColumn - 1] : MINIMAP_GUTTER_WIDTH;\r\n        var endColumnForLine = endLineNumber > lineNumber ? lineIndexToXOffset.length - 1 : endColumn - 1;\r\n        if (endColumnForLine > 0) {\r\n            // If the decoration starts at the last character of the column and spans over it, ensure it has a width\r\n            var width = lineIndexToXOffset[endColumnForLine] - x || 2;\r\n            this.renderDecoration(canvasContext, decorationColor, x, y, width, height);\r\n        }\r\n        if (isFirstDecorationForLine) {\r\n            this.renderLineHighlight(canvasContext, decorationColor, y, height);\r\n        }\r\n    };\r\n    Minimap.prototype.renderLineHighlight = function (canvasContext, decorationColor, y, height) {\r\n        canvasContext.fillStyle = decorationColor && decorationColor.transparent(0.5).toString() || '';\r\n        canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y, canvasContext.canvas.width, height);\r\n    };\r\n    Minimap.prototype.renderDecoration = function (canvasContext, decorationColor, x, y, width, height) {\r\n        canvasContext.fillStyle = decorationColor && decorationColor.toString() || '';\r\n        canvasContext.fillRect(x, y, width, height);\r\n    };\r\n    Minimap.prototype.renderLines = function (layout) {\r\n        var renderMinimap = this._options.renderMinimap;\r\n        var charRenderer = this._options.charRenderer();\r\n        var startLineNumber = layout.startLineNumber;\r\n        var endLineNumber = layout.endLineNumber;\r\n        var minimapLineHeight = getMinimapLineHeight(renderMinimap, this._options.fontScale);\r\n        // Check if nothing changed w.r.t. lines from last frame\r\n        if (this._lastRenderData && this._lastRenderData.linesEquals(layout)) {\r\n            var _lastData = this._lastRenderData._get();\r\n            // Nice!! Nothing changed from last frame\r\n            return new RenderData(layout, _lastData.imageData, _lastData.lines);\r\n        }\r\n        // Oh well!! We need to repaint some lines...\r\n        var imageData = this._getBuffer();\r\n        if (!imageData) {\r\n            // 0 width or 0 height canvas, nothing to do\r\n            return null;\r\n        }\r\n        // Render untouched lines by using last rendered data.\r\n        var _a = Minimap._renderUntouchedLines(imageData, startLineNumber, endLineNumber, minimapLineHeight, this._lastRenderData), _dirtyY1 = _a[0], _dirtyY2 = _a[1], needed = _a[2];\r\n        // Fetch rendering info from view model for rest of lines that need rendering.\r\n        var lineInfo = this._context.model.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed);\r\n        var tabSize = lineInfo.tabSize;\r\n        var background = this._tokensColorTracker.getColor(2 /* DefaultBackground */);\r\n        var useLighterFont = this._tokensColorTracker.backgroundIsLight();\r\n        // Render the rest of lines\r\n        var dy = 0;\r\n        var renderedLines = [];\r\n        for (var lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\r\n            if (needed[lineIndex]) {\r\n                Minimap._renderLine(imageData, background, useLighterFont, renderMinimap, this._tokensColorTracker, charRenderer, dy, tabSize, lineInfo.data[lineIndex], this._options.fontScale);\r\n            }\r\n            renderedLines[lineIndex] = new MinimapLine(dy);\r\n            dy += minimapLineHeight;\r\n        }\r\n        var dirtyY1 = (_dirtyY1 === -1 ? 0 : _dirtyY1);\r\n        var dirtyY2 = (_dirtyY2 === -1 ? imageData.height : _dirtyY2);\r\n        var dirtyHeight = dirtyY2 - dirtyY1;\r\n        // Finally, paint to the canvas\r\n        var ctx = this._canvas.domNode.getContext('2d');\r\n        ctx.putImageData(imageData, 0, 0, 0, dirtyY1, imageData.width, dirtyHeight);\r\n        // Save rendered data for reuse on next frame if possible\r\n        return new RenderData(layout, imageData, renderedLines);\r\n    };\r\n    Minimap._renderUntouchedLines = function (target, startLineNumber, endLineNumber, minimapLineHeight, lastRenderData) {\r\n        var needed = [];\r\n        if (!lastRenderData) {\r\n            for (var i = 0, len = endLineNumber - startLineNumber + 1; i < len; i++) {\r\n                needed[i] = true;\r\n            }\r\n            return [-1, -1, needed];\r\n        }\r\n        var _lastData = lastRenderData._get();\r\n        var lastTargetData = _lastData.imageData.data;\r\n        var lastStartLineNumber = _lastData.rendLineNumberStart;\r\n        var lastLines = _lastData.lines;\r\n        var lastLinesLength = lastLines.length;\r\n        var WIDTH = target.width;\r\n        var targetData = target.data;\r\n        var maxDestPixel = (endLineNumber - startLineNumber + 1) * minimapLineHeight * WIDTH * 4;\r\n        var dirtyPixel1 = -1; // the pixel offset up to which all the data is equal to the prev frame\r\n        var dirtyPixel2 = -1; // the pixel offset after which all the data is equal to the prev frame\r\n        var copySourceStart = -1;\r\n        var copySourceEnd = -1;\r\n        var copyDestStart = -1;\r\n        var copyDestEnd = -1;\r\n        var dest_dy = 0;\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - startLineNumber;\r\n            var lastLineIndex = lineNumber - lastStartLineNumber;\r\n            var source_dy = (lastLineIndex >= 0 && lastLineIndex < lastLinesLength ? lastLines[lastLineIndex].dy : -1);\r\n            if (source_dy === -1) {\r\n                needed[lineIndex] = true;\r\n                dest_dy += minimapLineHeight;\r\n                continue;\r\n            }\r\n            var sourceStart = source_dy * WIDTH * 4;\r\n            var sourceEnd = (source_dy + minimapLineHeight) * WIDTH * 4;\r\n            var destStart = dest_dy * WIDTH * 4;\r\n            var destEnd = (dest_dy + minimapLineHeight) * WIDTH * 4;\r\n            if (copySourceEnd === sourceStart && copyDestEnd === destStart) {\r\n                // contiguous zone => extend copy request\r\n                copySourceEnd = sourceEnd;\r\n                copyDestEnd = destEnd;\r\n            }\r\n            else {\r\n                if (copySourceStart !== -1) {\r\n                    // flush existing copy request\r\n                    targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\r\n                    if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\r\n                        dirtyPixel1 = copySourceEnd;\r\n                    }\r\n                    if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\r\n                        dirtyPixel2 = copySourceStart;\r\n                    }\r\n                }\r\n                copySourceStart = sourceStart;\r\n                copySourceEnd = sourceEnd;\r\n                copyDestStart = destStart;\r\n                copyDestEnd = destEnd;\r\n            }\r\n            needed[lineIndex] = false;\r\n            dest_dy += minimapLineHeight;\r\n        }\r\n        if (copySourceStart !== -1) {\r\n            // flush existing copy request\r\n            targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\r\n            if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\r\n                dirtyPixel1 = copySourceEnd;\r\n            }\r\n            if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\r\n                dirtyPixel2 = copySourceStart;\r\n            }\r\n        }\r\n        var dirtyY1 = (dirtyPixel1 === -1 ? -1 : dirtyPixel1 / (WIDTH * 4));\r\n        var dirtyY2 = (dirtyPixel2 === -1 ? -1 : dirtyPixel2 / (WIDTH * 4));\r\n        return [dirtyY1, dirtyY2, needed];\r\n    };\r\n    Minimap._renderLine = function (target, backgroundColor, useLighterFont, renderMinimap, colorTracker, minimapCharRenderer, dy, tabSize, lineData, fontScale) {\r\n        var content = lineData.content;\r\n        var tokens = lineData.tokens;\r\n        var charWidth = getMinimapCharWidth(renderMinimap, fontScale);\r\n        var maxDx = target.width - charWidth;\r\n        var dx = MINIMAP_GUTTER_WIDTH;\r\n        var charIndex = 0;\r\n        var tabsCharDelta = 0;\r\n        for (var tokenIndex = 0, tokensLen = tokens.getCount(); tokenIndex < tokensLen; tokenIndex++) {\r\n            var tokenEndIndex = tokens.getEndOffset(tokenIndex);\r\n            var tokenColorId = tokens.getForeground(tokenIndex);\r\n            var tokenColor = colorTracker.getColor(tokenColorId);\r\n            for (; charIndex < tokenEndIndex; charIndex++) {\r\n                if (dx > maxDx) {\r\n                    // hit edge of minimap\r\n                    return;\r\n                }\r\n                var charCode = content.charCodeAt(charIndex);\r\n                if (charCode === 9 /* Tab */) {\r\n                    var insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\r\n                    tabsCharDelta += insertSpacesCount - 1;\r\n                    // No need to render anything since tab is invisible\r\n                    dx += insertSpacesCount * charWidth;\r\n                }\r\n                else if (charCode === 32 /* Space */) {\r\n                    // No need to render anything since space is invisible\r\n                    dx += charWidth;\r\n                }\r\n                else {\r\n                    // Render twice for a full width character\r\n                    var count = strings.isFullWidthCharacter(charCode) ? 2 : 1;\r\n                    for (var i = 0; i < count; i++) {\r\n                        if (renderMinimap === 2 /* Blocks */) {\r\n                            minimapCharRenderer.blockRenderChar(target, dx, dy, tokenColor, backgroundColor, useLighterFont);\r\n                        }\r\n                        else { // RenderMinimap.Text\r\n                            minimapCharRenderer.renderChar(target, dx, dy, charCode, tokenColor, backgroundColor, fontScale, useLighterFont);\r\n                        }\r\n                        dx += charWidth;\r\n                        if (dx > maxDx) {\r\n                            // hit edge of minimap\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Minimap;\r\n}(ViewPart));\r\nexport { Minimap };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var sliderBackground = theme.getColor(scrollbarSliderBackground);\r\n    if (sliderBackground) {\r\n        var halfSliderBackground = sliderBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider, .monaco-editor .minimap-slider .minimap-slider-horizontal { background: \" + halfSliderBackground + \"; }\");\r\n    }\r\n    var sliderHoverBackground = theme.getColor(scrollbarSliderHoverBackground);\r\n    if (sliderHoverBackground) {\r\n        var halfSliderHoverBackground = sliderHoverBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider:hover, .monaco-editor .minimap-slider:hover .minimap-slider-horizontal { background: \" + halfSliderHoverBackground + \"; }\");\r\n    }\r\n    var sliderActiveBackground = theme.getColor(scrollbarSliderActiveBackground);\r\n    if (sliderActiveBackground) {\r\n        var halfSliderActiveBackground = sliderActiveBackground.transparent(0.5);\r\n        collector.addRule(\".monaco-editor .minimap-slider.active, .monaco-editor .minimap-slider.active .minimap-slider-horizontal { background: \" + halfSliderActiveBackground + \"; }\");\r\n    }\r\n    var shadow = theme.getColor(scrollbarShadow);\r\n    if (shadow) {\r\n        collector.addRule(\".monaco-editor .minimap-shadow-visible { box-shadow: \" + shadow + \" -6px 0 6px -6px inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './currentLineHighlight.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/view/editorColorRegistry.js';\r\nimport * as arrays from '../../../../base/common/arrays.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar isRenderedUsingBorder = true;\r\nvar AbstractLineHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(AbstractLineHighlightOverlay, _super);\r\n    function AbstractLineHighlightOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._renderLineHighlight = options.get(72 /* renderLineHighlight */);\r\n        _this._contentLeft = layoutInfo.contentLeft;\r\n        _this._contentWidth = layoutInfo.contentWidth;\r\n        _this._selectionIsEmpty = true;\r\n        _this._cursorLineNumbers = [];\r\n        _this._selections = [];\r\n        _this._renderData = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    AbstractLineHighlightOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    AbstractLineHighlightOverlay.prototype._readFromSelections = function () {\r\n        var hasChanged = false;\r\n        // Only render the first selection when using border\r\n        var renderSelections = isRenderedUsingBorder ? this._selections.slice(0, 1) : this._selections;\r\n        var cursorsLineNumbers = renderSelections.map(function (s) { return s.positionLineNumber; });\r\n        cursorsLineNumbers.sort(function (a, b) { return a - b; });\r\n        if (!arrays.equals(this._cursorLineNumbers, cursorsLineNumbers)) {\r\n            this._cursorLineNumbers = cursorsLineNumbers;\r\n            hasChanged = true;\r\n        }\r\n        var selectionIsEmpty = renderSelections.every(function (s) { return s.isEmpty(); });\r\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\r\n            this._selectionIsEmpty = selectionIsEmpty;\r\n            hasChanged = true;\r\n        }\r\n        return hasChanged;\r\n    };\r\n    // --- begin event handlers\r\n    AbstractLineHighlightOverlay.prototype.onThemeChanged = function (e) {\r\n        return this._readFromSelections();\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._renderLineHighlight = options.get(72 /* renderLineHighlight */);\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        this._contentWidth = layoutInfo.contentWidth;\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onCursorStateChanged = function (e) {\r\n        this._selections = e.selections;\r\n        return this._readFromSelections();\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollWidthChanged || e.scrollTopChanged;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    AbstractLineHighlightOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._shouldRenderThis()) {\r\n            this._renderData = null;\r\n            return;\r\n        }\r\n        var renderedLine = this._renderOne(ctx);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var len = this._cursorLineNumbers.length;\r\n        var index = 0;\r\n        var renderData = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            while (index < len && this._cursorLineNumbers[index] < lineNumber) {\r\n                index++;\r\n            }\r\n            if (index < len && this._cursorLineNumbers[index] === lineNumber) {\r\n                renderData[lineIndex] = renderedLine;\r\n            }\r\n            else {\r\n                renderData[lineIndex] = '';\r\n            }\r\n        }\r\n        this._renderData = renderData;\r\n    };\r\n    AbstractLineHighlightOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderData) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex >= this._renderData.length) {\r\n            return '';\r\n        }\r\n        return this._renderData[lineIndex];\r\n    };\r\n    return AbstractLineHighlightOverlay;\r\n}(DynamicViewOverlay));\r\nexport { AbstractLineHighlightOverlay };\r\nvar CurrentLineHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineHighlightOverlay, _super);\r\n    function CurrentLineHighlightOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CurrentLineHighlightOverlay.prototype._renderOne = function (ctx) {\r\n        var className = 'current-line' + (this._shouldRenderOther() ? ' current-line-both' : '');\r\n        return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + Math.max(ctx.scrollWidth, this._contentWidth) + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._shouldRenderThis = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    CurrentLineHighlightOverlay.prototype._shouldRenderOther = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    return CurrentLineHighlightOverlay;\r\n}(AbstractLineHighlightOverlay));\r\nexport { CurrentLineHighlightOverlay };\r\nvar CurrentLineMarginHighlightOverlay = /** @class */ (function (_super) {\r\n    __extends(CurrentLineMarginHighlightOverlay, _super);\r\n    function CurrentLineMarginHighlightOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    CurrentLineMarginHighlightOverlay.prototype._renderOne = function (ctx) {\r\n        var className = 'current-line current-line-margin' + (this._shouldRenderOther() ? ' current-line-margin-both' : '');\r\n        return \"<div class=\\\"\" + className + \"\\\" style=\\\"width:\" + this._contentLeft + \"px; height:\" + this._lineHeight + \"px;\\\"></div>\";\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._shouldRenderThis = function () {\r\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all'));\r\n    };\r\n    CurrentLineMarginHighlightOverlay.prototype._shouldRenderOther = function () {\r\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\r\n            && this._selectionIsEmpty);\r\n    };\r\n    return CurrentLineMarginHighlightOverlay;\r\n}(AbstractLineHighlightOverlay));\r\nexport { CurrentLineMarginHighlightOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    isRenderedUsingBorder = false;\r\n    var lineHighlight = theme.getColor(editorLineHighlight);\r\n    if (lineHighlight) {\r\n        collector.addRule(\".monaco-editor .view-overlays .current-line { background-color: \" + lineHighlight + \"; }\");\r\n        collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { background-color: \" + lineHighlight + \"; border: none; }\");\r\n    }\r\n    if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\r\n        var lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\r\n        if (lineHighlightBorder) {\r\n            isRenderedUsingBorder = true;\r\n            collector.addRule(\".monaco-editor .view-overlays .current-line { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n            collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid \" + lineHighlightBorder + \"; }\");\r\n            if (theme.type === 'hc') {\r\n                collector.addRule(\".monaco-editor .view-overlays .current-line { border-width: 1px; }\");\r\n                collector.addRule(\".monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }\");\r\n            }\r\n        }\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nvar Margin = /** @class */ (function (_super) {\r\n    __extends(Margin, _super);\r\n    function Margin(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._canUseLayerHinting = !options.get(22 /* disableLayerHinting */);\r\n        _this._contentLeft = layoutInfo.contentLeft;\r\n        _this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\r\n        _this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        _this._domNode.setClassName(Margin.OUTER_CLASS_NAME);\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setAttribute('role', 'presentation');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._glyphMarginBackgroundDomNode = createFastDomNode(document.createElement('div'));\r\n        _this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME);\r\n        _this._domNode.appendChild(_this._glyphMarginBackgroundDomNode);\r\n        return _this;\r\n    }\r\n    Margin.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    Margin.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // --- begin event handlers\r\n    Margin.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._canUseLayerHinting = !options.get(22 /* disableLayerHinting */);\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\r\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\r\n        return true;\r\n    };\r\n    Margin.prototype.onScrollChanged = function (e) {\r\n        return _super.prototype.onScrollChanged.call(this, e) || e.scrollTopChanged;\r\n    };\r\n    // --- end event handlers\r\n    Margin.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Margin.prototype.render = function (ctx) {\r\n        this._domNode.setLayerHinting(this._canUseLayerHinting);\r\n        this._domNode.setContain('strict');\r\n        var adjustedScrollTop = ctx.scrollTop - ctx.bigNumbersDelta;\r\n        this._domNode.setTop(-adjustedScrollTop);\r\n        var height = Math.min(ctx.scrollHeight, 1000000);\r\n        this._domNode.setHeight(height);\r\n        this._domNode.setWidth(this._contentLeft);\r\n        this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft);\r\n        this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth);\r\n        this._glyphMarginBackgroundDomNode.setHeight(height);\r\n    };\r\n    Margin.CLASS_NAME = 'glyph-margin';\r\n    Margin.OUTER_CLASS_NAME = 'margin';\r\n    return Margin;\r\n}(ViewPart));\r\nexport { Margin };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './rulers.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { editorRuler } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar Rulers = /** @class */ (function (_super) {\r\n    __extends(Rulers, _super);\r\n    function Rulers(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        _this.domNode.setAttribute('role', 'presentation');\r\n        _this.domNode.setAttribute('aria-hidden', 'true');\r\n        _this.domNode.setClassName('view-rulers');\r\n        _this._renderedRulers = [];\r\n        var options = _this._context.configuration.options;\r\n        _this._rulers = options.get(77 /* rulers */);\r\n        _this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        return _this;\r\n    }\r\n    Rulers.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    Rulers.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._rulers = options.get(77 /* rulers */);\r\n        this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        return true;\r\n    };\r\n    Rulers.prototype.onScrollChanged = function (e) {\r\n        return e.scrollHeightChanged;\r\n    };\r\n    // --- end event handlers\r\n    Rulers.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    Rulers.prototype._ensureRulersCount = function () {\r\n        var currentCount = this._renderedRulers.length;\r\n        var desiredCount = this._rulers.length;\r\n        if (currentCount === desiredCount) {\r\n            // Nothing to do\r\n            return;\r\n        }\r\n        if (currentCount < desiredCount) {\r\n            var tabSize = this._context.model.getOptions().tabSize;\r\n            var rulerWidth = tabSize;\r\n            var addCount = desiredCount - currentCount;\r\n            while (addCount > 0) {\r\n                var node = createFastDomNode(document.createElement('div'));\r\n                node.setClassName('view-ruler');\r\n                node.setWidth(rulerWidth);\r\n                this.domNode.appendChild(node);\r\n                this._renderedRulers.push(node);\r\n                addCount--;\r\n            }\r\n            return;\r\n        }\r\n        var removeCount = currentCount - desiredCount;\r\n        while (removeCount > 0) {\r\n            var node = this._renderedRulers.pop();\r\n            this.domNode.removeChild(node);\r\n            removeCount--;\r\n        }\r\n    };\r\n    Rulers.prototype.render = function (ctx) {\r\n        this._ensureRulersCount();\r\n        for (var i = 0, len = this._rulers.length; i < len; i++) {\r\n            var node = this._renderedRulers[i];\r\n            node.setHeight(Math.min(ctx.scrollHeight, 1000000));\r\n            node.setLeft(this._rulers[i] * this._typicalHalfwidthCharacterWidth);\r\n        }\r\n    };\r\n    return Rulers;\r\n}(ViewPart));\r\nexport { Rulers };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var rulerColor = theme.getColor(editorRuler);\r\n    if (rulerColor) {\r\n        collector.addRule(\".monaco-editor .view-ruler { box-shadow: 1px 0 0 0 \" + rulerColor + \" inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './marginDecorations.css';\r\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\r\nvar MarginViewLineDecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(MarginViewLineDecorationsOverlay, _super);\r\n    function MarginViewLineDecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    MarginViewLineDecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    MarginViewLineDecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    MarginViewLineDecorationsOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var marginClassName = d.options.marginClassName;\r\n            if (marginClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, marginClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            var lineOutput = '';\r\n            for (var i = 0, len = classNames.length; i < len; i++) {\r\n                lineOutput += '<div class=\"cmdr ' + classNames[i] + '\" style=\"\"></div>';\r\n            }\r\n            output[lineIndex] = lineOutput;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    MarginViewLineDecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineNumber - startLineNumber];\r\n    };\r\n    return MarginViewLineDecorationsOverlay;\r\n}(DedupOverlay));\r\nexport { MarginViewLineDecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\r\nvar EditorScrollbar = /** @class */ (function (_super) {\r\n    __extends(EditorScrollbar, _super);\r\n    function EditorScrollbar(context, linesContent, viewDomNode, overflowGuardDomNode) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var scrollbar = options.get(78 /* scrollbar */);\r\n        var mouseWheelScrollSensitivity = options.get(56 /* mouseWheelScrollSensitivity */);\r\n        var fastScrollSensitivity = options.get(27 /* fastScrollSensitivity */);\r\n        var scrollbarOptions = {\r\n            listenOnDomNode: viewDomNode.domNode,\r\n            className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\r\n            useShadows: false,\r\n            lazyRender: true,\r\n            vertical: scrollbar.vertical,\r\n            horizontal: scrollbar.horizontal,\r\n            verticalHasArrows: scrollbar.verticalHasArrows,\r\n            horizontalHasArrows: scrollbar.horizontalHasArrows,\r\n            verticalScrollbarSize: scrollbar.verticalScrollbarSize,\r\n            verticalSliderSize: scrollbar.verticalSliderSize,\r\n            horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\r\n            horizontalSliderSize: scrollbar.horizontalSliderSize,\r\n            handleMouseWheel: scrollbar.handleMouseWheel,\r\n            alwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\r\n            arrowSize: scrollbar.arrowSize,\r\n            mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\r\n            fastScrollSensitivity: fastScrollSensitivity,\r\n        };\r\n        _this.scrollbar = _this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, _this._context.viewLayout.getScrollable()));\r\n        PartFingerprints.write(_this.scrollbar.getDomNode(), 5 /* ScrollableElement */);\r\n        _this.scrollbarDomNode = createFastDomNode(_this.scrollbar.getDomNode());\r\n        _this.scrollbarDomNode.setPosition('absolute');\r\n        _this._setLayout();\r\n        // When having a zone widget that calls .focus() on one of its dom elements,\r\n        // the browser will try desperately to reveal that dom node, unexpectedly\r\n        // changing the .scrollTop of this.linesContent\r\n        var onBrowserDesperateReveal = function (domNode, lookAtScrollTop, lookAtScrollLeft) {\r\n            var newScrollPosition = {};\r\n            if (lookAtScrollTop) {\r\n                var deltaTop = domNode.scrollTop;\r\n                if (deltaTop) {\r\n                    newScrollPosition.scrollTop = _this._context.viewLayout.getCurrentScrollTop() + deltaTop;\r\n                    domNode.scrollTop = 0;\r\n                }\r\n            }\r\n            if (lookAtScrollLeft) {\r\n                var deltaLeft = domNode.scrollLeft;\r\n                if (deltaLeft) {\r\n                    newScrollPosition.scrollLeft = _this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\r\n                    domNode.scrollLeft = 0;\r\n                }\r\n            }\r\n            _this._context.viewLayout.setScrollPositionNow(newScrollPosition);\r\n        };\r\n        // I've seen this happen both on the view dom node & on the lines content dom node.\r\n        _this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(viewDomNode.domNode, true, true); }));\r\n        _this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(linesContent.domNode, true, false); }));\r\n        _this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false); }));\r\n        _this._register(dom.addDisposableListener(_this.scrollbarDomNode.domNode, 'scroll', function (e) { return onBrowserDesperateReveal(_this.scrollbarDomNode.domNode, true, false); }));\r\n        return _this;\r\n    }\r\n    EditorScrollbar.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    EditorScrollbar.prototype._setLayout = function () {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\r\n        var minimap = options.get(54 /* minimap */);\r\n        var side = minimap.side;\r\n        if (side === 'right') {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimapWidth);\r\n        }\r\n        else {\r\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\r\n        }\r\n        this.scrollbarDomNode.setHeight(layoutInfo.height);\r\n    };\r\n    EditorScrollbar.prototype.getOverviewRulerLayoutInfo = function () {\r\n        return this.scrollbar.getOverviewRulerLayoutInfo();\r\n    };\r\n    EditorScrollbar.prototype.getDomNode = function () {\r\n        return this.scrollbarDomNode;\r\n    };\r\n    EditorScrollbar.prototype.delegateVerticalScrollbarMouseDown = function (browserEvent) {\r\n        this.scrollbar.delegateVerticalScrollbarMouseDown(browserEvent);\r\n    };\r\n    // --- begin event handlers\r\n    EditorScrollbar.prototype.onConfigurationChanged = function (e) {\r\n        if (e.hasChanged(78 /* scrollbar */)\r\n            || e.hasChanged(56 /* mouseWheelScrollSensitivity */)\r\n            || e.hasChanged(27 /* fastScrollSensitivity */)) {\r\n            var options = this._context.configuration.options;\r\n            var scrollbar = options.get(78 /* scrollbar */);\r\n            var mouseWheelScrollSensitivity = options.get(56 /* mouseWheelScrollSensitivity */);\r\n            var fastScrollSensitivity = options.get(27 /* fastScrollSensitivity */);\r\n            var newOpts = {\r\n                handleMouseWheel: scrollbar.handleMouseWheel,\r\n                mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\r\n                fastScrollSensitivity: fastScrollSensitivity\r\n            };\r\n            this.scrollbar.updateOptions(newOpts);\r\n        }\r\n        if (e.hasChanged(107 /* layoutInfo */)) {\r\n            this._setLayout();\r\n        }\r\n        return true;\r\n    };\r\n    EditorScrollbar.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    EditorScrollbar.prototype.onThemeChanged = function (e) {\r\n        this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    EditorScrollbar.prototype.prepareRender = function (ctx) {\r\n        // Nothing to do\r\n    };\r\n    EditorScrollbar.prototype.render = function (ctx) {\r\n        this.scrollbar.renderNow();\r\n    };\r\n    return EditorScrollbar;\r\n}(ViewPart));\r\nexport { EditorScrollbar };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { ViewPart } from '../../view/viewPart.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { TokenizationRegistry } from '../../../common/modes.js';\r\nimport { editorCursorForeground, editorOverviewRulerBorder } from '../../../common/view/editorColorRegistry.js';\r\nvar Settings = /** @class */ (function () {\r\n    function Settings(config, theme) {\r\n        var options = config.options;\r\n        this.lineHeight = options.get(49 /* lineHeight */);\r\n        this.pixelRatio = options.get(105 /* pixelRatio */);\r\n        this.overviewRulerLanes = options.get(63 /* overviewRulerLanes */);\r\n        this.renderBorder = options.get(62 /* overviewRulerBorder */);\r\n        var borderColor = theme.getColor(editorOverviewRulerBorder);\r\n        this.borderColor = borderColor ? borderColor.toString() : null;\r\n        this.hideCursor = options.get(42 /* hideCursorInOverviewRuler */);\r\n        var cursorColor = theme.getColor(editorCursorForeground);\r\n        this.cursorColor = cursorColor ? cursorColor.transparent(0.7).toString() : null;\r\n        this.themeType = theme.type;\r\n        var minimapOpts = options.get(54 /* minimap */);\r\n        var minimapEnabled = minimapOpts.enabled;\r\n        var minimapSide = minimapOpts.side;\r\n        var backgroundColor = (minimapEnabled ? TokenizationRegistry.getDefaultBackground() : null);\r\n        if (backgroundColor === null || minimapSide === 'left') {\r\n            this.backgroundColor = null;\r\n        }\r\n        else {\r\n            this.backgroundColor = Color.Format.CSS.formatHex(backgroundColor);\r\n        }\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        var position = layoutInfo.overviewRuler;\r\n        this.top = position.top;\r\n        this.right = position.right;\r\n        this.domWidth = position.width;\r\n        this.domHeight = position.height;\r\n        if (this.overviewRulerLanes === 0) {\r\n            // overview ruler is off\r\n            this.canvasWidth = 0;\r\n            this.canvasHeight = 0;\r\n        }\r\n        else {\r\n            this.canvasWidth = (this.domWidth * this.pixelRatio) | 0;\r\n            this.canvasHeight = (this.domHeight * this.pixelRatio) | 0;\r\n        }\r\n        var _a = this._initLanes(1, this.canvasWidth, this.overviewRulerLanes), x = _a[0], w = _a[1];\r\n        this.x = x;\r\n        this.w = w;\r\n    }\r\n    Settings.prototype._initLanes = function (canvasLeftOffset, canvasWidth, laneCount) {\r\n        var remainingWidth = canvasWidth - canvasLeftOffset;\r\n        if (laneCount >= 3) {\r\n            var leftWidth = Math.floor(remainingWidth / 3);\r\n            var rightWidth = Math.floor(remainingWidth / 3);\r\n            var centerWidth = remainingWidth - leftWidth - rightWidth;\r\n            var leftOffset = canvasLeftOffset;\r\n            var centerOffset = leftOffset + leftWidth;\r\n            var rightOffset = leftOffset + leftWidth + centerWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    leftOffset,\r\n                    centerOffset,\r\n                    leftOffset,\r\n                    rightOffset,\r\n                    leftOffset,\r\n                    centerOffset,\r\n                    leftOffset,\r\n                ], [\r\n                    0,\r\n                    leftWidth,\r\n                    centerWidth,\r\n                    leftWidth + centerWidth,\r\n                    rightWidth,\r\n                    leftWidth + centerWidth + rightWidth,\r\n                    centerWidth + rightWidth,\r\n                    leftWidth + centerWidth + rightWidth,\r\n                ]\r\n            ];\r\n        }\r\n        else if (laneCount === 2) {\r\n            var leftWidth = Math.floor(remainingWidth / 2);\r\n            var rightWidth = remainingWidth - leftWidth;\r\n            var leftOffset = canvasLeftOffset;\r\n            var rightOffset = leftOffset + leftWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    rightOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                    leftOffset,\r\n                ], [\r\n                    0,\r\n                    leftWidth,\r\n                    leftWidth,\r\n                    leftWidth,\r\n                    rightWidth,\r\n                    leftWidth + rightWidth,\r\n                    leftWidth + rightWidth,\r\n                    leftWidth + rightWidth,\r\n                ]\r\n            ];\r\n        }\r\n        else {\r\n            var offset = canvasLeftOffset;\r\n            var width = remainingWidth;\r\n            return [\r\n                [\r\n                    0,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                    offset,\r\n                ], [\r\n                    0,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                    width,\r\n                ]\r\n            ];\r\n        }\r\n    };\r\n    Settings.prototype.equals = function (other) {\r\n        return (this.lineHeight === other.lineHeight\r\n            && this.pixelRatio === other.pixelRatio\r\n            && this.overviewRulerLanes === other.overviewRulerLanes\r\n            && this.renderBorder === other.renderBorder\r\n            && this.borderColor === other.borderColor\r\n            && this.hideCursor === other.hideCursor\r\n            && this.cursorColor === other.cursorColor\r\n            && this.themeType === other.themeType\r\n            && this.backgroundColor === other.backgroundColor\r\n            && this.top === other.top\r\n            && this.right === other.right\r\n            && this.domWidth === other.domWidth\r\n            && this.domHeight === other.domHeight\r\n            && this.canvasWidth === other.canvasWidth\r\n            && this.canvasHeight === other.canvasHeight);\r\n    };\r\n    return Settings;\r\n}());\r\nvar DecorationsOverviewRuler = /** @class */ (function (_super) {\r\n    __extends(DecorationsOverviewRuler, _super);\r\n    function DecorationsOverviewRuler(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._domNode = createFastDomNode(document.createElement('canvas'));\r\n        _this._domNode.setClassName('decorationsOverviewRuler');\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setLayerHinting(true);\r\n        _this._domNode.setContain('strict');\r\n        _this._domNode.setAttribute('aria-hidden', 'true');\r\n        _this._updateSettings(false);\r\n        _this._tokensColorTrackerListener = TokenizationRegistry.onDidChange(function (e) {\r\n            if (e.changedColorMap) {\r\n                _this._updateSettings(true);\r\n            }\r\n        });\r\n        _this._cursorPositions = [];\r\n        return _this;\r\n    }\r\n    DecorationsOverviewRuler.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._tokensColorTrackerListener.dispose();\r\n    };\r\n    DecorationsOverviewRuler.prototype._updateSettings = function (renderNow) {\r\n        var newSettings = new Settings(this._context.configuration, this._context.theme);\r\n        if (this._settings && this._settings.equals(newSettings)) {\r\n            // nothing to do\r\n            return false;\r\n        }\r\n        this._settings = newSettings;\r\n        this._domNode.setTop(this._settings.top);\r\n        this._domNode.setRight(this._settings.right);\r\n        this._domNode.setWidth(this._settings.domWidth);\r\n        this._domNode.setHeight(this._settings.domHeight);\r\n        this._domNode.domNode.width = this._settings.canvasWidth;\r\n        this._domNode.domNode.height = this._settings.canvasHeight;\r\n        if (renderNow) {\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    // ---- begin view event handlers\r\n    DecorationsOverviewRuler.prototype.onConfigurationChanged = function (e) {\r\n        return this._updateSettings(false);\r\n    };\r\n    DecorationsOverviewRuler.prototype.onCursorStateChanged = function (e) {\r\n        this._cursorPositions = [];\r\n        for (var i = 0, len = e.selections.length; i < len; i++) {\r\n            this._cursorPositions[i] = e.selections[i].getPosition();\r\n        }\r\n        this._cursorPositions.sort(Position.compare);\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onScrollChanged = function (e) {\r\n        return e.scrollHeightChanged;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverviewRuler.prototype.onThemeChanged = function (e) {\r\n        // invalidate color cache\r\n        this._context.model.invalidateOverviewRulerColorCache();\r\n        return this._updateSettings(false);\r\n    };\r\n    // ---- end view event handlers\r\n    DecorationsOverviewRuler.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    DecorationsOverviewRuler.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    DecorationsOverviewRuler.prototype.render = function (editorCtx) {\r\n        this._render();\r\n    };\r\n    DecorationsOverviewRuler.prototype._render = function () {\r\n        if (this._settings.overviewRulerLanes === 0) {\r\n            // overview ruler is off\r\n            this._domNode.setBackgroundColor(this._settings.backgroundColor ? this._settings.backgroundColor : '');\r\n            return;\r\n        }\r\n        var canvasWidth = this._settings.canvasWidth;\r\n        var canvasHeight = this._settings.canvasHeight;\r\n        var lineHeight = this._settings.lineHeight;\r\n        var viewLayout = this._context.viewLayout;\r\n        var outerHeight = this._context.viewLayout.getScrollHeight();\r\n        var heightRatio = canvasHeight / outerHeight;\r\n        var decorations = this._context.model.getAllOverviewRulerDecorations(this._context.theme);\r\n        var minDecorationHeight = (6 /* MIN_DECORATION_HEIGHT */ * this._settings.pixelRatio) | 0;\r\n        var halfMinDecorationHeight = (minDecorationHeight / 2) | 0;\r\n        var canvasCtx = this._domNode.domNode.getContext('2d');\r\n        if (this._settings.backgroundColor === null) {\r\n            canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n        else {\r\n            canvasCtx.fillStyle = this._settings.backgroundColor;\r\n            canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n        var x = this._settings.x;\r\n        var w = this._settings.w;\r\n        // Avoid flickering by always rendering the colors in the same order\r\n        // colors that don't use transparency will be sorted last (they start with #)\r\n        var colors = Object.keys(decorations);\r\n        colors.sort();\r\n        for (var cIndex = 0, cLen = colors.length; cIndex < cLen; cIndex++) {\r\n            var color = colors[cIndex];\r\n            var colorDecorations = decorations[color];\r\n            canvasCtx.fillStyle = color;\r\n            var prevLane = 0;\r\n            var prevY1 = 0;\r\n            var prevY2 = 0;\r\n            for (var i = 0, len = colorDecorations.length; i < len; i++) {\r\n                var lane = colorDecorations[3 * i];\r\n                var startLineNumber = colorDecorations[3 * i + 1];\r\n                var endLineNumber = colorDecorations[3 * i + 2];\r\n                var y1 = (viewLayout.getVerticalOffsetForLineNumber(startLineNumber) * heightRatio) | 0;\r\n                var y2 = ((viewLayout.getVerticalOffsetForLineNumber(endLineNumber) + lineHeight) * heightRatio) | 0;\r\n                var height = y2 - y1;\r\n                if (height < minDecorationHeight) {\r\n                    var yCenter = ((y1 + y2) / 2) | 0;\r\n                    if (yCenter < halfMinDecorationHeight) {\r\n                        yCenter = halfMinDecorationHeight;\r\n                    }\r\n                    else if (yCenter + halfMinDecorationHeight > canvasHeight) {\r\n                        yCenter = canvasHeight - halfMinDecorationHeight;\r\n                    }\r\n                    y1 = yCenter - halfMinDecorationHeight;\r\n                    y2 = yCenter + halfMinDecorationHeight;\r\n                }\r\n                if (y1 > prevY2 + 1 || lane !== prevLane) {\r\n                    // flush prev\r\n                    if (i !== 0) {\r\n                        canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\r\n                    }\r\n                    prevLane = lane;\r\n                    prevY1 = y1;\r\n                    prevY2 = y2;\r\n                }\r\n                else {\r\n                    // merge into prev\r\n                    if (y2 > prevY2) {\r\n                        prevY2 = y2;\r\n                    }\r\n                }\r\n            }\r\n            canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\r\n        }\r\n        // Draw cursors\r\n        if (!this._settings.hideCursor && this._settings.cursorColor) {\r\n            var cursorHeight = (2 * this._settings.pixelRatio) | 0;\r\n            var halfCursorHeight = (cursorHeight / 2) | 0;\r\n            var cursorX = this._settings.x[7 /* Full */];\r\n            var cursorW = this._settings.w[7 /* Full */];\r\n            canvasCtx.fillStyle = this._settings.cursorColor;\r\n            var prevY1 = -100;\r\n            var prevY2 = -100;\r\n            for (var i = 0, len = this._cursorPositions.length; i < len; i++) {\r\n                var cursor = this._cursorPositions[i];\r\n                var yCenter = (viewLayout.getVerticalOffsetForLineNumber(cursor.lineNumber) * heightRatio) | 0;\r\n                if (yCenter < halfCursorHeight) {\r\n                    yCenter = halfCursorHeight;\r\n                }\r\n                else if (yCenter + halfCursorHeight > canvasHeight) {\r\n                    yCenter = canvasHeight - halfCursorHeight;\r\n                }\r\n                var y1 = yCenter - halfCursorHeight;\r\n                var y2 = y1 + cursorHeight;\r\n                if (y1 > prevY2 + 1) {\r\n                    // flush prev\r\n                    if (i !== 0) {\r\n                        canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\r\n                    }\r\n                    prevY1 = y1;\r\n                    prevY2 = y2;\r\n                }\r\n                else {\r\n                    // merge into prev\r\n                    if (y2 > prevY2) {\r\n                        prevY2 = y2;\r\n                    }\r\n                }\r\n            }\r\n            canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\r\n        }\r\n        if (this._settings.renderBorder && this._settings.borderColor && this._settings.overviewRulerLanes > 0) {\r\n            canvasCtx.beginPath();\r\n            canvasCtx.lineWidth = 1;\r\n            canvasCtx.strokeStyle = this._settings.borderColor;\r\n            canvasCtx.moveTo(0, 0);\r\n            canvasCtx.lineTo(0, canvasHeight);\r\n            canvasCtx.stroke();\r\n            canvasCtx.moveTo(0, 0);\r\n            canvasCtx.lineTo(canvasWidth, 0);\r\n            canvasCtx.stroke();\r\n        }\r\n    };\r\n    return DecorationsOverviewRuler;\r\n}(ViewPart));\r\nexport { DecorationsOverviewRuler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { HorizontalRange } from '../../../common/view/renderingContext.js';\r\nvar FloatHorizontalRange = /** @class */ (function () {\r\n    function FloatHorizontalRange(left, width) {\r\n        this.left = left;\r\n        this.width = width;\r\n    }\r\n    FloatHorizontalRange.prototype.toString = function () {\r\n        return \"[\" + this.left + \",\" + this.width + \"]\";\r\n    };\r\n    FloatHorizontalRange.compare = function (a, b) {\r\n        return a.left - b.left;\r\n    };\r\n    return FloatHorizontalRange;\r\n}());\r\nvar RangeUtil = /** @class */ (function () {\r\n    function RangeUtil() {\r\n    }\r\n    RangeUtil._createRange = function () {\r\n        if (!this._handyReadyRange) {\r\n            this._handyReadyRange = document.createRange();\r\n        }\r\n        return this._handyReadyRange;\r\n    };\r\n    RangeUtil._detachRange = function (range, endNode) {\r\n        // Move range out of the span node, IE doesn't like having many ranges in\r\n        // the same spot and will act badly for lines containing dashes ('-')\r\n        range.selectNodeContents(endNode);\r\n    };\r\n    RangeUtil._readClientRects = function (startElement, startOffset, endElement, endOffset, endNode) {\r\n        var range = this._createRange();\r\n        try {\r\n            range.setStart(startElement, startOffset);\r\n            range.setEnd(endElement, endOffset);\r\n            return range.getClientRects();\r\n        }\r\n        catch (e) {\r\n            // This is life ...\r\n            return null;\r\n        }\r\n        finally {\r\n            this._detachRange(range, endNode);\r\n        }\r\n    };\r\n    RangeUtil._mergeAdjacentRanges = function (ranges) {\r\n        if (ranges.length === 1) {\r\n            // There is nothing to merge\r\n            return [new HorizontalRange(ranges[0].left, ranges[0].width)];\r\n        }\r\n        ranges.sort(FloatHorizontalRange.compare);\r\n        var result = [], resultLen = 0;\r\n        var prevLeft = ranges[0].left;\r\n        var prevWidth = ranges[0].width;\r\n        for (var i = 1, len = ranges.length; i < len; i++) {\r\n            var range = ranges[i];\r\n            var myLeft = range.left;\r\n            var myWidth = range.width;\r\n            if (prevLeft + prevWidth + 0.9 /* account for browser's rounding errors*/ >= myLeft) {\r\n                prevWidth = Math.max(prevWidth, myLeft + myWidth - prevLeft);\r\n            }\r\n            else {\r\n                result[resultLen++] = new HorizontalRange(prevLeft, prevWidth);\r\n                prevLeft = myLeft;\r\n                prevWidth = myWidth;\r\n            }\r\n        }\r\n        result[resultLen++] = new HorizontalRange(prevLeft, prevWidth);\r\n        return result;\r\n    };\r\n    RangeUtil._createHorizontalRangesFromClientRects = function (clientRects, clientRectDeltaLeft) {\r\n        if (!clientRects || clientRects.length === 0) {\r\n            return null;\r\n        }\r\n        // We go through FloatHorizontalRange because it has been observed in bi-di text\r\n        // that the clientRects are not coming in sorted from the browser\r\n        var result = [];\r\n        for (var i = 0, len = clientRects.length; i < len; i++) {\r\n            var clientRect = clientRects[i];\r\n            result[i] = new FloatHorizontalRange(Math.max(0, clientRect.left - clientRectDeltaLeft), clientRect.width);\r\n        }\r\n        return this._mergeAdjacentRanges(result);\r\n    };\r\n    RangeUtil.readHorizontalRanges = function (domNode, startChildIndex, startOffset, endChildIndex, endOffset, clientRectDeltaLeft, endNode) {\r\n        // Panic check\r\n        var min = 0;\r\n        var max = domNode.children.length - 1;\r\n        if (min > max) {\r\n            return null;\r\n        }\r\n        startChildIndex = Math.min(max, Math.max(min, startChildIndex));\r\n        endChildIndex = Math.min(max, Math.max(min, endChildIndex));\r\n        // If crossing over to a span only to select offset 0, then use the previous span's maximum offset\r\n        // Chrome is buggy and doesn't handle 0 offsets well sometimes.\r\n        if (startChildIndex !== endChildIndex) {\r\n            if (endChildIndex > 0 && endOffset === 0) {\r\n                endChildIndex--;\r\n                endOffset = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n            }\r\n        }\r\n        var startElement = domNode.children[startChildIndex].firstChild;\r\n        var endElement = domNode.children[endChildIndex].firstChild;\r\n        if (!startElement || !endElement) {\r\n            // When having an empty <span> (without any text content), try to move to the previous <span>\r\n            if (!startElement && startOffset === 0 && startChildIndex > 0) {\r\n                startElement = domNode.children[startChildIndex - 1].firstChild;\r\n                startOffset = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n            }\r\n            if (!endElement && endOffset === 0 && endChildIndex > 0) {\r\n                endElement = domNode.children[endChildIndex - 1].firstChild;\r\n                endOffset = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n            }\r\n        }\r\n        if (!startElement || !endElement) {\r\n            return null;\r\n        }\r\n        startOffset = Math.min(startElement.textContent.length, Math.max(0, startOffset));\r\n        endOffset = Math.min(endElement.textContent.length, Math.max(0, endOffset));\r\n        var clientRects = this._readClientRects(startElement, startOffset, endElement, endOffset, endNode);\r\n        return this._createHorizontalRangesFromClientRects(clientRects, clientRectDeltaLeft);\r\n    };\r\n    return RangeUtil;\r\n}());\r\nexport { RangeUtil };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as browser from '../../../../base/browser/browser.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport { RangeUtil } from './rangeUtil.js';\r\nimport { HorizontalRange, VisibleRanges } from '../../../common/view/renderingContext.js';\r\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\r\nimport { CharacterMapping, RenderLineInput, renderViewLine, LineRange } from '../../../common/viewLayout/viewLineRenderer.js';\r\nimport { HIGH_CONTRAST } from '../../../../platform/theme/common/themeService.js';\r\nimport { EditorFontLigatures } from '../../../common/config/editorOptions.js';\r\nvar canUseFastRenderedViewLine = (function () {\r\n    if (platform.isNative) {\r\n        // In VSCode we know very well when the zoom level changes\r\n        return true;\r\n    }\r\n    if (platform.isLinux || browser.isFirefox || browser.isSafari) {\r\n        // On Linux, it appears that zooming affects char widths (in pixels), which is unexpected.\r\n        // --\r\n        // Even though we read character widths correctly, having read them at a specific zoom level\r\n        // does not mean they are the same at the current zoom level.\r\n        // --\r\n        // This could be improved if we ever figure out how to get an event when browsers zoom,\r\n        // but until then we have to stick with reading client rects.\r\n        // --\r\n        // The same has been observed with Firefox on Windows7\r\n        // --\r\n        // The same has been oversved with Safari\r\n        return false;\r\n    }\r\n    return true;\r\n})();\r\nvar alwaysRenderInlineSelection = (browser.isEdgeOrIE);\r\nvar DomReadingContext = /** @class */ (function () {\r\n    function DomReadingContext(domNode, endNode) {\r\n        this._domNode = domNode;\r\n        this._clientRectDeltaLeft = 0;\r\n        this._clientRectDeltaLeftRead = false;\r\n        this.endNode = endNode;\r\n    }\r\n    Object.defineProperty(DomReadingContext.prototype, \"clientRectDeltaLeft\", {\r\n        get: function () {\r\n            if (!this._clientRectDeltaLeftRead) {\r\n                this._clientRectDeltaLeftRead = true;\r\n                this._clientRectDeltaLeft = this._domNode.getBoundingClientRect().left;\r\n            }\r\n            return this._clientRectDeltaLeft;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DomReadingContext;\r\n}());\r\nexport { DomReadingContext };\r\nvar ViewLineOptions = /** @class */ (function () {\r\n    function ViewLineOptions(config, themeType) {\r\n        this.themeType = themeType;\r\n        var options = config.options;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        this.renderWhitespace = options.get(74 /* renderWhitespace */);\r\n        this.renderControlCharacters = options.get(69 /* renderControlCharacters */);\r\n        this.spaceWidth = fontInfo.spaceWidth;\r\n        this.middotWidth = fontInfo.middotWidth;\r\n        this.useMonospaceOptimizations = (fontInfo.isMonospace\r\n            && !options.get(23 /* disableMonospaceOptimizations */));\r\n        this.canUseHalfwidthRightwardsArrow = fontInfo.canUseHalfwidthRightwardsArrow;\r\n        this.lineHeight = options.get(49 /* lineHeight */);\r\n        this.stopRenderingLineAfter = options.get(88 /* stopRenderingLineAfter */);\r\n        this.fontLigatures = options.get(35 /* fontLigatures */);\r\n    }\r\n    ViewLineOptions.prototype.equals = function (other) {\r\n        return (this.themeType === other.themeType\r\n            && this.renderWhitespace === other.renderWhitespace\r\n            && this.renderControlCharacters === other.renderControlCharacters\r\n            && this.spaceWidth === other.spaceWidth\r\n            && this.middotWidth === other.middotWidth\r\n            && this.useMonospaceOptimizations === other.useMonospaceOptimizations\r\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\r\n            && this.lineHeight === other.lineHeight\r\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter\r\n            && this.fontLigatures === other.fontLigatures);\r\n    };\r\n    return ViewLineOptions;\r\n}());\r\nexport { ViewLineOptions };\r\nvar ViewLine = /** @class */ (function () {\r\n    function ViewLine(options) {\r\n        this._options = options;\r\n        this._isMaybeInvalid = true;\r\n        this._renderedViewLine = null;\r\n    }\r\n    // --- begin IVisibleLineData\r\n    ViewLine.prototype.getDomNode = function () {\r\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\r\n            return this._renderedViewLine.domNode.domNode;\r\n        }\r\n        return null;\r\n    };\r\n    ViewLine.prototype.setDomNode = function (domNode) {\r\n        if (this._renderedViewLine) {\r\n            this._renderedViewLine.domNode = createFastDomNode(domNode);\r\n        }\r\n        else {\r\n            throw new Error('I have no rendered view line to set the dom node to...');\r\n        }\r\n    };\r\n    ViewLine.prototype.onContentChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onTokensChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onDecorationsChanged = function () {\r\n        this._isMaybeInvalid = true;\r\n    };\r\n    ViewLine.prototype.onOptionsChanged = function (newOptions) {\r\n        this._isMaybeInvalid = true;\r\n        this._options = newOptions;\r\n    };\r\n    ViewLine.prototype.onSelectionChanged = function () {\r\n        if (alwaysRenderInlineSelection || this._options.themeType === HIGH_CONTRAST || this._options.renderWhitespace === 'selection') {\r\n            this._isMaybeInvalid = true;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewLine.prototype.renderLine = function (lineNumber, deltaTop, viewportData, sb) {\r\n        if (this._isMaybeInvalid === false) {\r\n            // it appears that nothing relevant has changed\r\n            return false;\r\n        }\r\n        this._isMaybeInvalid = false;\r\n        var lineData = viewportData.getViewLineRenderingData(lineNumber);\r\n        var options = this._options;\r\n        var actualInlineDecorations = LineDecoration.filter(lineData.inlineDecorations, lineNumber, lineData.minColumn, lineData.maxColumn);\r\n        // Only send selection information when needed for rendering whitespace\r\n        var selectionsOnLine = null;\r\n        if (alwaysRenderInlineSelection || options.themeType === HIGH_CONTRAST || this._options.renderWhitespace === 'selection') {\r\n            var selections = viewportData.selections;\r\n            for (var _i = 0, selections_1 = selections; _i < selections_1.length; _i++) {\r\n                var selection = selections_1[_i];\r\n                if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\r\n                    // Selection does not intersect line\r\n                    continue;\r\n                }\r\n                var startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\r\n                var endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\r\n                if (startColumn < endColumn) {\r\n                    if (this._options.renderWhitespace !== 'selection') {\r\n                        actualInlineDecorations.push(new LineDecoration(startColumn, endColumn, 'inline-selected-text', 0 /* Regular */));\r\n                    }\r\n                    else {\r\n                        if (!selectionsOnLine) {\r\n                            selectionsOnLine = [];\r\n                        }\r\n                        selectionsOnLine.push(new LineRange(startColumn - 1, endColumn - 1));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var renderLineInput = new RenderLineInput(options.useMonospaceOptimizations, options.canUseHalfwidthRightwardsArrow, lineData.content, lineData.continuesWithWrappedLine, lineData.isBasicASCII, lineData.containsRTL, lineData.minColumn - 1, lineData.tokens, actualInlineDecorations, lineData.tabSize, lineData.startVisibleColumn, options.spaceWidth, options.middotWidth, options.stopRenderingLineAfter, options.renderWhitespace, options.renderControlCharacters, options.fontLigatures !== EditorFontLigatures.OFF, selectionsOnLine);\r\n        if (this._renderedViewLine && this._renderedViewLine.input.equals(renderLineInput)) {\r\n            // no need to do anything, we have the same render input\r\n            return false;\r\n        }\r\n        sb.appendASCIIString('<div style=\"top:');\r\n        sb.appendASCIIString(String(deltaTop));\r\n        sb.appendASCIIString('px;height:');\r\n        sb.appendASCIIString(String(this._options.lineHeight));\r\n        sb.appendASCIIString('px;\" class=\"');\r\n        sb.appendASCIIString(ViewLine.CLASS_NAME);\r\n        sb.appendASCIIString('\">');\r\n        var output = renderViewLine(renderLineInput, sb);\r\n        sb.appendASCIIString('</div>');\r\n        var renderedViewLine = null;\r\n        if (canUseFastRenderedViewLine && lineData.isBasicASCII && options.useMonospaceOptimizations && output.containsForeignElements === 0 /* None */) {\r\n            if (lineData.content.length < 300 && renderLineInput.lineTokens.getCount() < 100) {\r\n                // Browser rounding errors have been observed in Chrome and IE, so using the fast\r\n                // view line only for short lines. Please test before removing the length check...\r\n                // ---\r\n                // Another rounding error has been observed on Linux in VSCode, where <span> width\r\n                // rounding errors add up to an observable large number...\r\n                // ---\r\n                // Also see another example of rounding errors on Windows in\r\n                // https://github.com/Microsoft/vscode/issues/33178\r\n                renderedViewLine = new FastRenderedViewLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping);\r\n            }\r\n        }\r\n        if (!renderedViewLine) {\r\n            renderedViewLine = createRenderedLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping, output.containsRTL, output.containsForeignElements);\r\n        }\r\n        this._renderedViewLine = renderedViewLine;\r\n        return true;\r\n    };\r\n    ViewLine.prototype.layoutLine = function (lineNumber, deltaTop) {\r\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\r\n            this._renderedViewLine.domNode.setTop(deltaTop);\r\n            this._renderedViewLine.domNode.setHeight(this._options.lineHeight);\r\n        }\r\n    };\r\n    // --- end IVisibleLineData\r\n    ViewLine.prototype.getWidth = function () {\r\n        if (!this._renderedViewLine) {\r\n            return 0;\r\n        }\r\n        return this._renderedViewLine.getWidth();\r\n    };\r\n    ViewLine.prototype.getWidthIsFast = function () {\r\n        if (!this._renderedViewLine) {\r\n            return true;\r\n        }\r\n        return this._renderedViewLine.getWidthIsFast();\r\n    };\r\n    ViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (!this._renderedViewLine) {\r\n            return null;\r\n        }\r\n        startColumn = startColumn | 0; // @perf\r\n        endColumn = endColumn | 0; // @perf\r\n        startColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, startColumn));\r\n        endColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, endColumn));\r\n        var stopRenderingLineAfter = this._renderedViewLine.input.stopRenderingLineAfter | 0; // @perf\r\n        var outsideRenderedLine = false;\r\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1 && endColumn > stopRenderingLineAfter + 1) {\r\n            // This range is obviously not visible\r\n            outsideRenderedLine = true;\r\n        }\r\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1) {\r\n            startColumn = stopRenderingLineAfter + 1;\r\n        }\r\n        if (stopRenderingLineAfter !== -1 && endColumn > stopRenderingLineAfter + 1) {\r\n            endColumn = stopRenderingLineAfter + 1;\r\n        }\r\n        var horizontalRanges = this._renderedViewLine.getVisibleRangesForRange(startColumn, endColumn, context);\r\n        if (horizontalRanges && horizontalRanges.length > 0) {\r\n            return new VisibleRanges(outsideRenderedLine, horizontalRanges);\r\n        }\r\n        return null;\r\n    };\r\n    ViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        if (!this._renderedViewLine) {\r\n            return 1;\r\n        }\r\n        return this._renderedViewLine.getColumnOfNodeOffset(lineNumber, spanNode, offset);\r\n    };\r\n    ViewLine.CLASS_NAME = 'view-line';\r\n    return ViewLine;\r\n}());\r\nexport { ViewLine };\r\n/**\r\n * A rendered line which is guaranteed to contain only regular ASCII and is rendered with a monospace font.\r\n */\r\nvar FastRenderedViewLine = /** @class */ (function () {\r\n    function FastRenderedViewLine(domNode, renderLineInput, characterMapping) {\r\n        this.domNode = domNode;\r\n        this.input = renderLineInput;\r\n        this._characterMapping = characterMapping;\r\n        this._charWidth = renderLineInput.spaceWidth;\r\n    }\r\n    FastRenderedViewLine.prototype.getWidth = function () {\r\n        return this._getCharPosition(this._characterMapping.length);\r\n    };\r\n    FastRenderedViewLine.prototype.getWidthIsFast = function () {\r\n        return true;\r\n    };\r\n    FastRenderedViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        var startPosition = this._getCharPosition(startColumn);\r\n        var endPosition = this._getCharPosition(endColumn);\r\n        return [new HorizontalRange(startPosition, endPosition - startPosition)];\r\n    };\r\n    FastRenderedViewLine.prototype._getCharPosition = function (column) {\r\n        var charOffset = this._characterMapping.getAbsoluteOffsets();\r\n        if (charOffset.length === 0) {\r\n            // No characters on this line\r\n            return 0;\r\n        }\r\n        return Math.round(this._charWidth * charOffset[column - 1]);\r\n    };\r\n    FastRenderedViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        var spanNodeTextContentLength = spanNode.textContent.length;\r\n        var spanIndex = -1;\r\n        while (spanNode) {\r\n            spanNode = spanNode.previousSibling;\r\n            spanIndex++;\r\n        }\r\n        var charOffset = this._characterMapping.partDataToCharOffset(spanIndex, spanNodeTextContentLength, offset);\r\n        return charOffset + 1;\r\n    };\r\n    return FastRenderedViewLine;\r\n}());\r\n/**\r\n * Every time we render a line, we save what we have rendered in an instance of this class.\r\n */\r\nvar RenderedViewLine = /** @class */ (function () {\r\n    function RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n        this.domNode = domNode;\r\n        this.input = renderLineInput;\r\n        this._characterMapping = characterMapping;\r\n        this._isWhitespaceOnly = /^\\s*$/.test(renderLineInput.lineContent);\r\n        this._containsForeignElements = containsForeignElements;\r\n        this._cachedWidth = -1;\r\n        this._pixelOffsetCache = null;\r\n        if (!containsRTL || this._characterMapping.length === 0 /* the line is empty */) {\r\n            this._pixelOffsetCache = new Int32Array(Math.max(2, this._characterMapping.length + 1));\r\n            for (var column = 0, len = this._characterMapping.length; column <= len; column++) {\r\n                this._pixelOffsetCache[column] = -1;\r\n            }\r\n        }\r\n    }\r\n    // --- Reading from the DOM methods\r\n    RenderedViewLine.prototype._getReadingTarget = function (myDomNode) {\r\n        return myDomNode.domNode.firstChild;\r\n    };\r\n    /**\r\n     * Width of the line in pixels\r\n     */\r\n    RenderedViewLine.prototype.getWidth = function () {\r\n        if (!this.domNode) {\r\n            return 0;\r\n        }\r\n        if (this._cachedWidth === -1) {\r\n            this._cachedWidth = this._getReadingTarget(this.domNode).offsetWidth;\r\n        }\r\n        return this._cachedWidth;\r\n    };\r\n    RenderedViewLine.prototype.getWidthIsFast = function () {\r\n        if (this._cachedWidth === -1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Visible ranges for a model range\r\n     */\r\n    RenderedViewLine.prototype.getVisibleRangesForRange = function (startColumn, endColumn, context) {\r\n        if (!this.domNode) {\r\n            return null;\r\n        }\r\n        if (this._pixelOffsetCache !== null) {\r\n            // the text is LTR\r\n            var startOffset = this._readPixelOffset(this.domNode, startColumn, context);\r\n            if (startOffset === -1) {\r\n                return null;\r\n            }\r\n            var endOffset = this._readPixelOffset(this.domNode, endColumn, context);\r\n            if (endOffset === -1) {\r\n                return null;\r\n            }\r\n            return [new HorizontalRange(startOffset, endOffset - startOffset)];\r\n        }\r\n        return this._readVisibleRangesForRange(this.domNode, startColumn, endColumn, context);\r\n    };\r\n    RenderedViewLine.prototype._readVisibleRangesForRange = function (domNode, startColumn, endColumn, context) {\r\n        if (startColumn === endColumn) {\r\n            var pixelOffset = this._readPixelOffset(domNode, startColumn, context);\r\n            if (pixelOffset === -1) {\r\n                return null;\r\n            }\r\n            else {\r\n                return [new HorizontalRange(pixelOffset, 0)];\r\n            }\r\n        }\r\n        else {\r\n            return this._readRawVisibleRangesForRange(domNode, startColumn, endColumn, context);\r\n        }\r\n    };\r\n    RenderedViewLine.prototype._readPixelOffset = function (domNode, column, context) {\r\n        if (this._characterMapping.length === 0) {\r\n            // This line has no content\r\n            if (this._containsForeignElements === 0 /* None */) {\r\n                // We can assume the line is really empty\r\n                return 0;\r\n            }\r\n            if (this._containsForeignElements === 2 /* After */) {\r\n                // We have foreign elements after the (empty) line\r\n                return 0;\r\n            }\r\n            if (this._containsForeignElements === 1 /* Before */) {\r\n                // We have foreign elements before the (empty) line\r\n                return this.getWidth();\r\n            }\r\n            // We have foreign elements before & after the (empty) line\r\n            var readingTarget = this._getReadingTarget(domNode);\r\n            if (readingTarget.firstChild) {\r\n                return readingTarget.firstChild.offsetWidth;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        }\r\n        if (this._pixelOffsetCache !== null) {\r\n            // the text is LTR\r\n            var cachedPixelOffset = this._pixelOffsetCache[column];\r\n            if (cachedPixelOffset !== -1) {\r\n                return cachedPixelOffset;\r\n            }\r\n            var result = this._actualReadPixelOffset(domNode, column, context);\r\n            this._pixelOffsetCache[column] = result;\r\n            return result;\r\n        }\r\n        return this._actualReadPixelOffset(domNode, column, context);\r\n    };\r\n    RenderedViewLine.prototype._actualReadPixelOffset = function (domNode, column, context) {\r\n        if (this._characterMapping.length === 0) {\r\n            // This line has no content\r\n            var r_1 = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), 0, 0, 0, 0, context.clientRectDeltaLeft, context.endNode);\r\n            if (!r_1 || r_1.length === 0) {\r\n                return -1;\r\n            }\r\n            return r_1[0].left;\r\n        }\r\n        if (column === this._characterMapping.length && this._isWhitespaceOnly && this._containsForeignElements === 0 /* None */) {\r\n            // This branch helps in the case of whitespace only lines which have a width set\r\n            return this.getWidth();\r\n        }\r\n        var partData = this._characterMapping.charOffsetToPartData(column - 1);\r\n        var partIndex = CharacterMapping.getPartIndex(partData);\r\n        var charOffsetInPart = CharacterMapping.getCharIndex(partData);\r\n        var r = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), partIndex, charOffsetInPart, partIndex, charOffsetInPart, context.clientRectDeltaLeft, context.endNode);\r\n        if (!r || r.length === 0) {\r\n            return -1;\r\n        }\r\n        return r[0].left;\r\n    };\r\n    RenderedViewLine.prototype._readRawVisibleRangesForRange = function (domNode, startColumn, endColumn, context) {\r\n        if (startColumn === 1 && endColumn === this._characterMapping.length) {\r\n            // This branch helps IE with bidi text & gives a performance boost to other browsers when reading visible ranges for an entire line\r\n            return [new HorizontalRange(0, this.getWidth())];\r\n        }\r\n        var startPartData = this._characterMapping.charOffsetToPartData(startColumn - 1);\r\n        var startPartIndex = CharacterMapping.getPartIndex(startPartData);\r\n        var startCharOffsetInPart = CharacterMapping.getCharIndex(startPartData);\r\n        var endPartData = this._characterMapping.charOffsetToPartData(endColumn - 1);\r\n        var endPartIndex = CharacterMapping.getPartIndex(endPartData);\r\n        var endCharOffsetInPart = CharacterMapping.getCharIndex(endPartData);\r\n        return RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), startPartIndex, startCharOffsetInPart, endPartIndex, endCharOffsetInPart, context.clientRectDeltaLeft, context.endNode);\r\n    };\r\n    /**\r\n     * Returns the column for the text found at a specific offset inside a rendered dom node\r\n     */\r\n    RenderedViewLine.prototype.getColumnOfNodeOffset = function (lineNumber, spanNode, offset) {\r\n        var spanNodeTextContentLength = spanNode.textContent.length;\r\n        var spanIndex = -1;\r\n        while (spanNode) {\r\n            spanNode = spanNode.previousSibling;\r\n            spanIndex++;\r\n        }\r\n        var charOffset = this._characterMapping.partDataToCharOffset(spanIndex, spanNodeTextContentLength, offset);\r\n        return charOffset + 1;\r\n    };\r\n    return RenderedViewLine;\r\n}());\r\nvar WebKitRenderedViewLine = /** @class */ (function (_super) {\r\n    __extends(WebKitRenderedViewLine, _super);\r\n    function WebKitRenderedViewLine() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WebKitRenderedViewLine.prototype._readVisibleRangesForRange = function (domNode, startColumn, endColumn, context) {\r\n        var output = _super.prototype._readVisibleRangesForRange.call(this, domNode, startColumn, endColumn, context);\r\n        if (!output || output.length === 0 || startColumn === endColumn || (startColumn === 1 && endColumn === this._characterMapping.length)) {\r\n            return output;\r\n        }\r\n        // WebKit is buggy and returns an expanded range (to contain words in some cases)\r\n        // The last client rect is enlarged (I think)\r\n        if (!this.input.containsRTL) {\r\n            // This is an attempt to patch things up\r\n            // Find position of last column\r\n            var endPixelOffset = this._readPixelOffset(domNode, endColumn, context);\r\n            if (endPixelOffset !== -1) {\r\n                var lastRange = output[output.length - 1];\r\n                if (lastRange.left < endPixelOffset) {\r\n                    // Trim down the width of the last visible range to not go after the last column's position\r\n                    lastRange.width = endPixelOffset - lastRange.left;\r\n                }\r\n            }\r\n        }\r\n        return output;\r\n    };\r\n    return WebKitRenderedViewLine;\r\n}(RenderedViewLine));\r\nvar createRenderedLine = (function () {\r\n    if (browser.isWebKit) {\r\n        return createWebKitRenderedLine;\r\n    }\r\n    return createNormalRenderedLine;\r\n})();\r\nfunction createWebKitRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n    return new WebKitRenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\r\n}\r\nfunction createNormalRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\r\n    return new RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nvar Coordinate = /** @class */ (function () {\r\n    function Coordinate(top, left) {\r\n        this.top = top;\r\n        this.left = left;\r\n    }\r\n    return Coordinate;\r\n}());\r\nvar ViewContentWidgets = /** @class */ (function (_super) {\r\n    __extends(ViewContentWidgets, _super);\r\n    function ViewContentWidgets(context, viewDomNode) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._viewDomNode = viewDomNode;\r\n        _this._widgets = {};\r\n        _this.domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this.domNode, 1 /* ContentWidgets */);\r\n        _this.domNode.setClassName('contentWidgets');\r\n        _this.domNode.setPosition('absolute');\r\n        _this.domNode.setTop(0);\r\n        _this.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this.overflowingContentWidgetsDomNode, 2 /* OverflowingContentWidgets */);\r\n        _this.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\r\n        return _this;\r\n    }\r\n    ViewContentWidgets.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._widgets = {};\r\n    };\r\n    // --- begin event handlers\r\n    ViewContentWidgets.prototype.onConfigurationChanged = function (e) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n            var widgetId = keys_1[_i];\r\n            this._widgets[widgetId].onConfigurationChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations that can end up relayouting text\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLineMappingChanged = function (e) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {\r\n            var widgetId = keys_2[_i];\r\n            this._widgets[widgetId].onLineMappingChanged(e);\r\n        }\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onScrollChanged = function (e) {\r\n        return true;\r\n    };\r\n    ViewContentWidgets.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewContentWidgets.prototype.addWidget = function (_widget) {\r\n        var myWidget = new Widget(this._context, this._viewDomNode, _widget);\r\n        this._widgets[myWidget.id] = myWidget;\r\n        if (myWidget.allowEditorOverflow) {\r\n            this.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\r\n        }\r\n        else {\r\n            this.domNode.appendChild(myWidget.domNode);\r\n        }\r\n        this.setShouldRender();\r\n    };\r\n    ViewContentWidgets.prototype.setWidgetPosition = function (widget, range, preference) {\r\n        var myWidget = this._widgets[widget.getId()];\r\n        myWidget.setPosition(range, preference);\r\n        this.setShouldRender();\r\n    };\r\n    ViewContentWidgets.prototype.removeWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            var myWidget = this._widgets[widgetId];\r\n            delete this._widgets[widgetId];\r\n            var domNode = myWidget.domNode.domNode;\r\n            domNode.parentNode.removeChild(domNode);\r\n            domNode.removeAttribute('monaco-visible-content-widget');\r\n            this.setShouldRender();\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.shouldSuppressMouseDownOnWidget = function (widgetId) {\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            return this._widgets[widgetId].suppressMouseDown;\r\n        }\r\n        return false;\r\n    };\r\n    ViewContentWidgets.prototype.onBeforeRender = function (viewportData) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var _i = 0, keys_3 = keys; _i < keys_3.length; _i++) {\r\n            var widgetId = keys_3[_i];\r\n            this._widgets[widgetId].onBeforeRender(viewportData);\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.prepareRender = function (ctx) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var _i = 0, keys_4 = keys; _i < keys_4.length; _i++) {\r\n            var widgetId = keys_4[_i];\r\n            this._widgets[widgetId].prepareRender(ctx);\r\n        }\r\n    };\r\n    ViewContentWidgets.prototype.render = function (ctx) {\r\n        var keys = Object.keys(this._widgets);\r\n        for (var _i = 0, keys_5 = keys; _i < keys_5.length; _i++) {\r\n            var widgetId = keys_5[_i];\r\n            this._widgets[widgetId].render(ctx);\r\n        }\r\n    };\r\n    return ViewContentWidgets;\r\n}(ViewPart));\r\nexport { ViewContentWidgets };\r\nvar Widget = /** @class */ (function () {\r\n    function Widget(context, viewDomNode, actual) {\r\n        this._context = context;\r\n        this._viewDomNode = viewDomNode;\r\n        this._actual = actual;\r\n        this.domNode = createFastDomNode(this._actual.getDomNode());\r\n        this.id = this._actual.getId();\r\n        this.allowEditorOverflow = this._actual.allowEditorOverflow || false;\r\n        this.suppressMouseDown = this._actual.suppressMouseDown || false;\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._fixedOverflowWidgets = options.get(29 /* fixedOverflowWidgets */);\r\n        this._contentWidth = layoutInfo.contentWidth;\r\n        this._contentLeft = layoutInfo.contentLeft;\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._range = null;\r\n        this._viewRange = null;\r\n        this._preference = [];\r\n        this._cachedDomNodeClientWidth = -1;\r\n        this._cachedDomNodeClientHeight = -1;\r\n        this._maxWidth = this._getMaxWidth();\r\n        this._isVisible = false;\r\n        this._renderData = null;\r\n        this.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\r\n        this.domNode.setVisibility('hidden');\r\n        this.domNode.setAttribute('widgetId', this.id);\r\n        this.domNode.setMaxWidth(this._maxWidth);\r\n    }\r\n    Widget.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        if (e.hasChanged(107 /* layoutInfo */)) {\r\n            var layoutInfo = options.get(107 /* layoutInfo */);\r\n            this._contentLeft = layoutInfo.contentLeft;\r\n            this._contentWidth = layoutInfo.contentWidth;\r\n            this._maxWidth = this._getMaxWidth();\r\n        }\r\n    };\r\n    Widget.prototype.onLineMappingChanged = function (e) {\r\n        this._setPosition(this._range);\r\n    };\r\n    Widget.prototype._setPosition = function (range) {\r\n        this._range = range;\r\n        this._viewRange = null;\r\n        if (this._range) {\r\n            // Do not trust that widgets give a valid position\r\n            var validModelRange = this._context.model.validateModelRange(this._range);\r\n            if (this._context.model.coordinatesConverter.modelPositionIsVisible(validModelRange.getStartPosition()) || this._context.model.coordinatesConverter.modelPositionIsVisible(validModelRange.getEndPosition())) {\r\n                this._viewRange = this._context.model.coordinatesConverter.convertModelRangeToViewRange(validModelRange);\r\n            }\r\n        }\r\n    };\r\n    Widget.prototype._getMaxWidth = function () {\r\n        return (this.allowEditorOverflow\r\n            ? window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth\r\n            : this._contentWidth);\r\n    };\r\n    Widget.prototype.setPosition = function (range, preference) {\r\n        this._setPosition(range);\r\n        this._preference = preference;\r\n        this._cachedDomNodeClientWidth = -1;\r\n        this._cachedDomNodeClientHeight = -1;\r\n    };\r\n    Widget.prototype._layoutBoxInViewport = function (topLeft, bottomLeft, width, height, ctx) {\r\n        // Our visible box is split horizontally by the current line => 2 boxes\r\n        // a) the box above the line\r\n        var aboveLineTop = topLeft.top;\r\n        var heightAboveLine = aboveLineTop;\r\n        // b) the box under the line\r\n        var underLineTop = bottomLeft.top + this._lineHeight;\r\n        var heightUnderLine = ctx.viewportHeight - underLineTop;\r\n        var aboveTop = aboveLineTop - height;\r\n        var fitsAbove = (heightAboveLine >= height);\r\n        var belowTop = underLineTop;\r\n        var fitsBelow = (heightUnderLine >= height);\r\n        // And its left\r\n        var actualAboveLeft = topLeft.left;\r\n        var actualBelowLeft = bottomLeft.left;\r\n        if (actualAboveLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\r\n            actualAboveLeft = ctx.scrollLeft + ctx.viewportWidth - width;\r\n        }\r\n        if (actualBelowLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\r\n            actualBelowLeft = ctx.scrollLeft + ctx.viewportWidth - width;\r\n        }\r\n        if (actualAboveLeft < ctx.scrollLeft) {\r\n            actualAboveLeft = ctx.scrollLeft;\r\n        }\r\n        if (actualBelowLeft < ctx.scrollLeft) {\r\n            actualBelowLeft = ctx.scrollLeft;\r\n        }\r\n        return {\r\n            fitsAbove: fitsAbove,\r\n            aboveTop: aboveTop,\r\n            aboveLeft: actualAboveLeft,\r\n            fitsBelow: fitsBelow,\r\n            belowTop: belowTop,\r\n            belowLeft: actualBelowLeft,\r\n        };\r\n    };\r\n    Widget.prototype._layoutHorizontalSegmentInPage = function (windowSize, domNodePosition, left, width) {\r\n        // Initially, the limits are defined as the dom node limits\r\n        var MIN_LIMIT = Math.max(0, domNodePosition.left - width);\r\n        var MAX_LIMIT = Math.min(domNodePosition.left + domNodePosition.width + width, windowSize.width);\r\n        var absoluteLeft = domNodePosition.left + left - dom.StandardWindow.scrollX;\r\n        if (absoluteLeft + width > MAX_LIMIT) {\r\n            var delta = absoluteLeft - (MAX_LIMIT - width);\r\n            absoluteLeft -= delta;\r\n            left -= delta;\r\n        }\r\n        if (absoluteLeft < MIN_LIMIT) {\r\n            var delta = absoluteLeft - MIN_LIMIT;\r\n            absoluteLeft -= delta;\r\n            left -= delta;\r\n        }\r\n        return [left, absoluteLeft];\r\n    };\r\n    Widget.prototype._layoutBoxInPage = function (topLeft, bottomLeft, width, height, ctx) {\r\n        var aboveTop = topLeft.top - height;\r\n        var belowTop = bottomLeft.top + this._lineHeight;\r\n        var domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\r\n        var absoluteAboveTop = domNodePosition.top + aboveTop - dom.StandardWindow.scrollY;\r\n        var absoluteBelowTop = domNodePosition.top + belowTop - dom.StandardWindow.scrollY;\r\n        var windowSize = dom.getClientArea(document.body);\r\n        var _a = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, topLeft.left - ctx.scrollLeft + this._contentLeft, width), aboveLeft = _a[0], absoluteAboveLeft = _a[1];\r\n        var _b = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, bottomLeft.left - ctx.scrollLeft + this._contentLeft, width), belowLeft = _b[0], absoluteBelowLeft = _b[1];\r\n        // Leave some clearance to the top/bottom\r\n        var TOP_PADDING = 22;\r\n        var BOTTOM_PADDING = 22;\r\n        var fitsAbove = (absoluteAboveTop >= TOP_PADDING);\r\n        var fitsBelow = (absoluteBelowTop + height <= windowSize.height - BOTTOM_PADDING);\r\n        if (this._fixedOverflowWidgets) {\r\n            return {\r\n                fitsAbove: fitsAbove,\r\n                aboveTop: Math.max(absoluteAboveTop, TOP_PADDING),\r\n                aboveLeft: absoluteAboveLeft,\r\n                fitsBelow: fitsBelow,\r\n                belowTop: absoluteBelowTop,\r\n                belowLeft: absoluteBelowLeft\r\n            };\r\n        }\r\n        return {\r\n            fitsAbove: fitsAbove,\r\n            aboveTop: Math.max(aboveTop, TOP_PADDING),\r\n            aboveLeft: aboveLeft,\r\n            fitsBelow: fitsBelow,\r\n            belowTop: belowTop,\r\n            belowLeft: belowLeft\r\n        };\r\n    };\r\n    Widget.prototype._prepareRenderWidgetAtExactPositionOverflowing = function (topLeft) {\r\n        return new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\r\n    };\r\n    /**\r\n     * Compute `this._topLeft`\r\n     */\r\n    Widget.prototype._getTopAndBottomLeft = function (ctx) {\r\n        if (!this._viewRange) {\r\n            return [null, null];\r\n        }\r\n        var visibleRangesForRange = ctx.linesVisibleRangesForRange(this._viewRange, false);\r\n        if (!visibleRangesForRange || visibleRangesForRange.length === 0) {\r\n            return [null, null];\r\n        }\r\n        var firstLine = visibleRangesForRange[0];\r\n        var lastLine = visibleRangesForRange[0];\r\n        for (var _i = 0, visibleRangesForRange_1 = visibleRangesForRange; _i < visibleRangesForRange_1.length; _i++) {\r\n            var visibleRangesForLine = visibleRangesForRange_1[_i];\r\n            if (visibleRangesForLine.lineNumber < firstLine.lineNumber) {\r\n                firstLine = visibleRangesForLine;\r\n            }\r\n            if (visibleRangesForLine.lineNumber > lastLine.lineNumber) {\r\n                lastLine = visibleRangesForLine;\r\n            }\r\n        }\r\n        var firstLineMinLeft = 1073741824 /* MAX_SAFE_SMALL_INTEGER */; //firstLine.Constants.MAX_SAFE_SMALL_INTEGER;\r\n        for (var _a = 0, _b = firstLine.ranges; _a < _b.length; _a++) {\r\n            var visibleRange = _b[_a];\r\n            if (visibleRange.left < firstLineMinLeft) {\r\n                firstLineMinLeft = visibleRange.left;\r\n            }\r\n        }\r\n        var lastLineMinLeft = 1073741824 /* MAX_SAFE_SMALL_INTEGER */; //lastLine.Constants.MAX_SAFE_SMALL_INTEGER;\r\n        for (var _c = 0, _d = lastLine.ranges; _c < _d.length; _c++) {\r\n            var visibleRange = _d[_c];\r\n            if (visibleRange.left < lastLineMinLeft) {\r\n                lastLineMinLeft = visibleRange.left;\r\n            }\r\n        }\r\n        var topForPosition = ctx.getVerticalOffsetForLineNumber(firstLine.lineNumber) - ctx.scrollTop;\r\n        var topLeft = new Coordinate(topForPosition, firstLineMinLeft);\r\n        var topForBottomLine = ctx.getVerticalOffsetForLineNumber(lastLine.lineNumber) - ctx.scrollTop;\r\n        var bottomLeft = new Coordinate(topForBottomLine, lastLineMinLeft);\r\n        return [topLeft, bottomLeft];\r\n    };\r\n    Widget.prototype._prepareRenderWidget = function (ctx) {\r\n        var _a = this._getTopAndBottomLeft(ctx), topLeft = _a[0], bottomLeft = _a[1];\r\n        if (!topLeft || !bottomLeft) {\r\n            return null;\r\n        }\r\n        if (this._cachedDomNodeClientWidth === -1 || this._cachedDomNodeClientHeight === -1) {\r\n            var domNode = this.domNode.domNode;\r\n            this._cachedDomNodeClientWidth = domNode.clientWidth;\r\n            this._cachedDomNodeClientHeight = domNode.clientHeight;\r\n        }\r\n        var placement;\r\n        if (this.allowEditorOverflow) {\r\n            placement = this._layoutBoxInPage(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\r\n        }\r\n        else {\r\n            placement = this._layoutBoxInViewport(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\r\n        }\r\n        // Do two passes, first for perfect fit, second picks first option\r\n        if (this._preference) {\r\n            for (var pass = 1; pass <= 2; pass++) {\r\n                for (var _i = 0, _b = this._preference; _i < _b.length; _i++) {\r\n                    var pref = _b[_i];\r\n                    // placement\r\n                    if (pref === 1 /* ABOVE */) {\r\n                        if (!placement) {\r\n                            // Widget outside of viewport\r\n                            return null;\r\n                        }\r\n                        if (pass === 2 || placement.fitsAbove) {\r\n                            return new Coordinate(placement.aboveTop, placement.aboveLeft);\r\n                        }\r\n                    }\r\n                    else if (pref === 2 /* BELOW */) {\r\n                        if (!placement) {\r\n                            // Widget outside of viewport\r\n                            return null;\r\n                        }\r\n                        if (pass === 2 || placement.fitsBelow) {\r\n                            return new Coordinate(placement.belowTop, placement.belowLeft);\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (this.allowEditorOverflow) {\r\n                            return this._prepareRenderWidgetAtExactPositionOverflowing(topLeft);\r\n                        }\r\n                        else {\r\n                            return topLeft;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\r\n     */\r\n    Widget.prototype.onBeforeRender = function (viewportData) {\r\n        if (!this._viewRange || !this._preference) {\r\n            return;\r\n        }\r\n        if (this._viewRange.endLineNumber < viewportData.startLineNumber || this._viewRange.startLineNumber > viewportData.endLineNumber) {\r\n            // Outside of viewport\r\n            return;\r\n        }\r\n        this.domNode.setMaxWidth(this._maxWidth);\r\n    };\r\n    Widget.prototype.prepareRender = function (ctx) {\r\n        this._renderData = this._prepareRenderWidget(ctx);\r\n    };\r\n    Widget.prototype.render = function (ctx) {\r\n        if (!this._renderData) {\r\n            // This widget should be invisible\r\n            if (this._isVisible) {\r\n                this.domNode.removeAttribute('monaco-visible-content-widget');\r\n                this._isVisible = false;\r\n                this.domNode.setVisibility('hidden');\r\n            }\r\n            return;\r\n        }\r\n        // This widget should be visible\r\n        if (this.allowEditorOverflow) {\r\n            this.domNode.setTop(this._renderData.top);\r\n            this.domNode.setLeft(this._renderData.left);\r\n        }\r\n        else {\r\n            this.domNode.setTop(this._renderData.top + ctx.scrollTop - ctx.bigNumbersDelta);\r\n            this.domNode.setLeft(this._renderData.left);\r\n        }\r\n        if (!this._isVisible) {\r\n            this.domNode.setVisibility('inherit');\r\n            this.domNode.setAttribute('monaco-visible-content-widget', 'true');\r\n            this._isVisible = true;\r\n        }\r\n    };\r\n    return Widget;\r\n}());\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './linesDecorations.css';\r\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\r\nvar LinesDecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(LinesDecorationsOverlay, _super);\r\n    function LinesDecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._decorationsLeft = layoutInfo.decorationsLeft;\r\n        _this._decorationsWidth = layoutInfo.decorationsWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    LinesDecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    LinesDecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._decorationsLeft = layoutInfo.decorationsLeft;\r\n        this._decorationsWidth = layoutInfo.decorationsWidth;\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    LinesDecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    LinesDecorationsOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var linesDecorationsClassName = d.options.linesDecorationsClassName;\r\n            if (linesDecorationsClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, linesDecorationsClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    LinesDecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var left = this._decorationsLeft.toString();\r\n        var width = this._decorationsWidth.toString();\r\n        var common = '\" style=\"left:' + left + 'px;width:' + width + 'px;\"></div>';\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            var lineOutput = '';\r\n            for (var i = 0, len = classNames.length; i < len; i++) {\r\n                lineOutput += '<div class=\"cldr ' + classNames[i] + common;\r\n            }\r\n            output[lineIndex] = lineOutput;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    LinesDecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineNumber - startLineNumber];\r\n    };\r\n    return LinesDecorationsOverlay;\r\n}(DedupOverlay));\r\nexport { LinesDecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './decorations.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { HorizontalRange } from '../../../common/view/renderingContext.js';\r\nvar DecorationsOverlay = /** @class */ (function (_super) {\r\n    __extends(DecorationsOverlay, _super);\r\n    function DecorationsOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    DecorationsOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    DecorationsOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._typicalHalfwidthCharacterWidth = options.get(34 /* fontInfo */).typicalHalfwidthCharacterWidth;\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    DecorationsOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged || e.scrollWidthChanged;\r\n    };\r\n    DecorationsOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    DecorationsOverlay.prototype.prepareRender = function (ctx) {\r\n        var _decorations = ctx.getDecorationsInViewport();\r\n        // Keep only decorations with `className`\r\n        var decorations = [], decorationsLen = 0;\r\n        for (var i = 0, len = _decorations.length; i < len; i++) {\r\n            var d = _decorations[i];\r\n            if (d.options.className) {\r\n                decorations[decorationsLen++] = d;\r\n            }\r\n        }\r\n        // Sort decorations for consistent render output\r\n        decorations = decorations.sort(function (a, b) {\r\n            if (a.options.zIndex < b.options.zIndex) {\r\n                return -1;\r\n            }\r\n            if (a.options.zIndex > b.options.zIndex) {\r\n                return 1;\r\n            }\r\n            var aClassName = a.options.className;\r\n            var bClassName = b.options.className;\r\n            if (aClassName < bClassName) {\r\n                return -1;\r\n            }\r\n            if (aClassName > bClassName) {\r\n                return 1;\r\n            }\r\n            return Range.compareRangesUsingStarts(a.range, b.range);\r\n        });\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = '';\r\n        }\r\n        // Render first whole line decorations and then regular decorations\r\n        this._renderWholeLineDecorations(ctx, decorations, output);\r\n        this._renderNormalDecorations(ctx, decorations, output);\r\n        this._renderResult = output;\r\n    };\r\n    DecorationsOverlay.prototype._renderWholeLineDecorations = function (ctx, decorations, output) {\r\n        var lineHeight = String(this._lineHeight);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        for (var i = 0, lenI = decorations.length; i < lenI; i++) {\r\n            var d = decorations[i];\r\n            if (!d.options.isWholeLine) {\r\n                continue;\r\n            }\r\n            var decorationOutput = ('<div class=\"cdr '\r\n                + d.options.className\r\n                + '\" style=\"left:0;width:100%;height:'\r\n                + lineHeight\r\n                + 'px;\"></div>');\r\n            var startLineNumber = Math.max(d.range.startLineNumber, visibleStartLineNumber);\r\n            var endLineNumber = Math.min(d.range.endLineNumber, visibleEndLineNumber);\r\n            for (var j = startLineNumber; j <= endLineNumber; j++) {\r\n                var lineIndex = j - visibleStartLineNumber;\r\n                output[lineIndex] += decorationOutput;\r\n            }\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype._renderNormalDecorations = function (ctx, decorations, output) {\r\n        var lineHeight = String(this._lineHeight);\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var prevClassName = null;\r\n        var prevShowIfCollapsed = false;\r\n        var prevRange = null;\r\n        for (var i = 0, lenI = decorations.length; i < lenI; i++) {\r\n            var d = decorations[i];\r\n            if (d.options.isWholeLine) {\r\n                continue;\r\n            }\r\n            var className = d.options.className;\r\n            var showIfCollapsed = Boolean(d.options.showIfCollapsed);\r\n            var range = d.range;\r\n            if (showIfCollapsed && range.endColumn === 1 && range.endLineNumber !== range.startLineNumber) {\r\n                range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber - 1, this._context.model.getLineMaxColumn(range.endLineNumber - 1));\r\n            }\r\n            if (prevClassName === className && prevShowIfCollapsed === showIfCollapsed && Range.areIntersectingOrTouching(prevRange, range)) {\r\n                // merge into previous decoration\r\n                prevRange = Range.plusRange(prevRange, range);\r\n                continue;\r\n            }\r\n            // flush previous decoration\r\n            if (prevClassName !== null) {\r\n                this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\r\n            }\r\n            prevClassName = className;\r\n            prevShowIfCollapsed = showIfCollapsed;\r\n            prevRange = range;\r\n        }\r\n        if (prevClassName !== null) {\r\n            this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype._renderNormalDecoration = function (ctx, range, className, showIfCollapsed, lineHeight, visibleStartLineNumber, output) {\r\n        var linesVisibleRanges = ctx.linesVisibleRangesForRange(range, /*TODO@Alex*/ className === 'findMatch');\r\n        if (!linesVisibleRanges) {\r\n            return;\r\n        }\r\n        for (var j = 0, lenJ = linesVisibleRanges.length; j < lenJ; j++) {\r\n            var lineVisibleRanges = linesVisibleRanges[j];\r\n            if (lineVisibleRanges.outsideRenderedLine) {\r\n                continue;\r\n            }\r\n            var lineIndex = lineVisibleRanges.lineNumber - visibleStartLineNumber;\r\n            if (showIfCollapsed && lineVisibleRanges.ranges.length === 1) {\r\n                var singleVisibleRange = lineVisibleRanges.ranges[0];\r\n                if (singleVisibleRange.width === 0) {\r\n                    // collapsed range case => make the decoration visible by faking its width\r\n                    lineVisibleRanges.ranges[0] = new HorizontalRange(singleVisibleRange.left, this._typicalHalfwidthCharacterWidth);\r\n                }\r\n            }\r\n            for (var k = 0, lenK = lineVisibleRanges.ranges.length; k < lenK; k++) {\r\n                var visibleRange = lineVisibleRanges.ranges[k];\r\n                var decorationOutput = ('<div class=\"cdr '\r\n                    + className\r\n                    + '\" style=\"left:'\r\n                    + String(visibleRange.left)\r\n                    + 'px;width:'\r\n                    + String(visibleRange.width)\r\n                    + 'px;height:'\r\n                    + lineHeight\r\n                    + 'px;\"></div>');\r\n                output[lineIndex] += decorationOutput;\r\n            }\r\n        }\r\n    };\r\n    DecorationsOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return DecorationsOverlay;\r\n}(DynamicViewOverlay));\r\nexport { DecorationsOverlay };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './lineNumbers.css';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { editorActiveLineNumber, editorLineNumbers } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar LineNumbersOverlay = /** @class */ (function (_super) {\r\n    __extends(LineNumbersOverlay, _super);\r\n    function LineNumbersOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._readConfig();\r\n        _this._lastCursorModelPosition = new Position(1, 1);\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    LineNumbersOverlay.prototype._readConfig = function () {\r\n        var options = this._context.configuration.options;\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        var lineNumbers = options.get(50 /* lineNumbers */);\r\n        this._renderLineNumbers = lineNumbers.renderType;\r\n        this._renderCustomLineNumbers = lineNumbers.renderFn;\r\n        this._renderFinalNewline = options.get(71 /* renderFinalNewline */);\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._lineNumbersLeft = layoutInfo.lineNumbersLeft;\r\n        this._lineNumbersWidth = layoutInfo.lineNumbersWidth;\r\n    };\r\n    LineNumbersOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    LineNumbersOverlay.prototype.onConfigurationChanged = function (e) {\r\n        this._readConfig();\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var primaryViewPosition = e.selections[0].getPosition();\r\n        this._lastCursorModelPosition = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(primaryViewPosition);\r\n        if (this._renderLineNumbers === 2 /* Relative */ || this._renderLineNumbers === 3 /* Interval */) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    LineNumbersOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    LineNumbersOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    LineNumbersOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    LineNumbersOverlay.prototype._getLineRenderLineNumber = function (viewLineNumber) {\r\n        var modelPosition = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(viewLineNumber, 1));\r\n        if (modelPosition.column !== 1) {\r\n            return '';\r\n        }\r\n        var modelLineNumber = modelPosition.lineNumber;\r\n        if (this._renderCustomLineNumbers) {\r\n            return this._renderCustomLineNumbers(modelLineNumber);\r\n        }\r\n        if (this._renderLineNumbers === 2 /* Relative */) {\r\n            var diff = Math.abs(this._lastCursorModelPosition.lineNumber - modelLineNumber);\r\n            if (diff === 0) {\r\n                return '<span class=\"relative-current-line-number\">' + modelLineNumber + '</span>';\r\n            }\r\n            return String(diff);\r\n        }\r\n        if (this._renderLineNumbers === 3 /* Interval */) {\r\n            if (this._lastCursorModelPosition.lineNumber === modelLineNumber) {\r\n                return String(modelLineNumber);\r\n            }\r\n            if (modelLineNumber % 10 === 0) {\r\n                return String(modelLineNumber);\r\n            }\r\n            return '';\r\n        }\r\n        return String(modelLineNumber);\r\n    };\r\n    LineNumbersOverlay.prototype.prepareRender = function (ctx) {\r\n        if (this._renderLineNumbers === 0 /* Off */) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var lineHeightClassName = (platform.isLinux ? (this._lineHeight % 2 === 0 ? ' lh-even' : ' lh-odd') : '');\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var common = '<div class=\"' + LineNumbersOverlay.CLASS_NAME + lineHeightClassName + '\" style=\"left:' + this._lineNumbersLeft.toString() + 'px;width:' + this._lineNumbersWidth.toString() + 'px;\">';\r\n        var lineCount = this._context.model.getLineCount();\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            if (!this._renderFinalNewline) {\r\n                if (lineNumber === lineCount && this._context.model.getLineLength(lineNumber) === 0) {\r\n                    // Do not render last (empty) line\r\n                    output[lineIndex] = '';\r\n                    continue;\r\n                }\r\n            }\r\n            var renderLineNumber = this._getLineRenderLineNumber(lineNumber);\r\n            if (renderLineNumber) {\r\n                output[lineIndex] = (common\r\n                    + renderLineNumber\r\n                    + '</div>');\r\n            }\r\n            else {\r\n                output[lineIndex] = '';\r\n            }\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    LineNumbersOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    LineNumbersOverlay.CLASS_NAME = 'line-numbers';\r\n    return LineNumbersOverlay;\r\n}(DynamicViewOverlay));\r\nexport { LineNumbersOverlay };\r\n// theming\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var lineNumbers = theme.getColor(editorLineNumbers);\r\n    if (lineNumbers) {\r\n        collector.addRule(\".monaco-editor .line-numbers { color: \" + lineNumbers + \"; }\");\r\n    }\r\n    var activeLineNumber = theme.getColor(editorActiveLineNumber);\r\n    if (activeLineNumber) {\r\n        collector.addRule(\".monaco-editor .current-line ~ .line-numbers { color: \" + activeLineNumber + \"; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './viewLines.css';\r\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\r\nimport { Configuration } from '../../config/configuration.js';\r\nimport { VisibleLinesCollection } from '../../view/viewLayer.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nimport { DomReadingContext, ViewLine, ViewLineOptions } from './viewLine.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { LineVisibleRanges, HorizontalPosition } from '../../../common/view/renderingContext.js';\r\nvar LastRenderedData = /** @class */ (function () {\r\n    function LastRenderedData() {\r\n        this._currentVisibleRange = new Range(1, 1, 1, 1);\r\n    }\r\n    LastRenderedData.prototype.getCurrentVisibleRange = function () {\r\n        return this._currentVisibleRange;\r\n    };\r\n    LastRenderedData.prototype.setCurrentVisibleRange = function (currentVisibleRange) {\r\n        this._currentVisibleRange = currentVisibleRange;\r\n    };\r\n    return LastRenderedData;\r\n}());\r\nvar HorizontalRevealRequest = /** @class */ (function () {\r\n    function HorizontalRevealRequest(lineNumber, startColumn, endColumn, startScrollTop, stopScrollTop, scrollType) {\r\n        this.lineNumber = lineNumber;\r\n        this.startColumn = startColumn;\r\n        this.endColumn = endColumn;\r\n        this.startScrollTop = startScrollTop;\r\n        this.stopScrollTop = stopScrollTop;\r\n        this.scrollType = scrollType;\r\n    }\r\n    return HorizontalRevealRequest;\r\n}());\r\nvar ViewLines = /** @class */ (function (_super) {\r\n    __extends(ViewLines, _super);\r\n    function ViewLines(context, linesContent) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._linesContent = linesContent;\r\n        _this._textRangeRestingSpot = document.createElement('div');\r\n        _this._visibleLines = new VisibleLinesCollection(_this);\r\n        _this.domNode = _this._visibleLines.domNode;\r\n        var conf = _this._context.configuration;\r\n        var options = _this._context.configuration.options;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var wrappingInfo = options.get(108 /* wrappingInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        _this._isViewportWrapping = wrappingInfo.isViewportWrapping;\r\n        _this._revealHorizontalRightPadding = options.get(75 /* revealHorizontalRightPadding */);\r\n        _this._cursorSurroundingLines = options.get(19 /* cursorSurroundingLines */);\r\n        _this._cursorSurroundingLinesStyle = options.get(20 /* cursorSurroundingLinesStyle */);\r\n        _this._canUseLayerHinting = !options.get(22 /* disableLayerHinting */);\r\n        _this._viewLineOptions = new ViewLineOptions(conf, _this._context.theme.type);\r\n        PartFingerprints.write(_this.domNode, 7 /* ViewLines */);\r\n        _this.domNode.setClassName('view-lines');\r\n        Configuration.applyFontInfo(_this.domNode, fontInfo);\r\n        // --- width & height\r\n        _this._maxLineWidth = 0;\r\n        _this._asyncUpdateLineWidths = new RunOnceScheduler(function () {\r\n            _this._updateLineWidthsSlow();\r\n        }, 200);\r\n        _this._lastRenderedData = new LastRenderedData();\r\n        _this._horizontalRevealRequest = null;\r\n        return _this;\r\n    }\r\n    ViewLines.prototype.dispose = function () {\r\n        this._asyncUpdateLineWidths.dispose();\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    ViewLines.prototype.getDomNode = function () {\r\n        return this.domNode;\r\n    };\r\n    // ---- begin IVisibleLinesHost\r\n    ViewLines.prototype.createVisibleLine = function () {\r\n        return new ViewLine(this._viewLineOptions);\r\n    };\r\n    // ---- end IVisibleLinesHost\r\n    // ---- begin view event handlers\r\n    ViewLines.prototype.onConfigurationChanged = function (e) {\r\n        this._visibleLines.onConfigurationChanged(e);\r\n        if (e.hasChanged(108 /* wrappingInfo */)) {\r\n            this._maxLineWidth = 0;\r\n        }\r\n        var options = this._context.configuration.options;\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        var wrappingInfo = options.get(108 /* wrappingInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\r\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\r\n        this._revealHorizontalRightPadding = options.get(75 /* revealHorizontalRightPadding */);\r\n        this._cursorSurroundingLines = options.get(19 /* cursorSurroundingLines */);\r\n        this._cursorSurroundingLinesStyle = options.get(20 /* cursorSurroundingLinesStyle */);\r\n        this._canUseLayerHinting = !options.get(22 /* disableLayerHinting */);\r\n        Configuration.applyFontInfo(this.domNode, fontInfo);\r\n        this._onOptionsMaybeChanged();\r\n        if (e.hasChanged(107 /* layoutInfo */)) {\r\n            this._maxLineWidth = 0;\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype._onOptionsMaybeChanged = function () {\r\n        var conf = this._context.configuration;\r\n        var newViewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\r\n        if (!this._viewLineOptions.equals(newViewLineOptions)) {\r\n            this._viewLineOptions = newViewLineOptions;\r\n            var startLineNumber = this._visibleLines.getStartLineNumber();\r\n            var endLineNumber = this._visibleLines.getEndLineNumber();\r\n            for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n                var line = this._visibleLines.getVisibleLine(lineNumber);\r\n                line.onOptionsChanged(this._viewLineOptions);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    ViewLines.prototype.onCursorStateChanged = function (e) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        var r = false;\r\n        for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n            r = this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged() || r;\r\n        }\r\n        return r;\r\n    };\r\n    ViewLines.prototype.onDecorationsChanged = function (e) {\r\n        if (true /*e.inlineDecorationsChanged*/) {\r\n            var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n            var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n            for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n                this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged();\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype.onFlushed = function (e) {\r\n        var shouldRender = this._visibleLines.onFlushed(e);\r\n        this._maxLineWidth = 0;\r\n        return shouldRender;\r\n    };\r\n    ViewLines.prototype.onLinesChanged = function (e) {\r\n        return this._visibleLines.onLinesChanged(e);\r\n    };\r\n    ViewLines.prototype.onLinesDeleted = function (e) {\r\n        return this._visibleLines.onLinesDeleted(e);\r\n    };\r\n    ViewLines.prototype.onLinesInserted = function (e) {\r\n        return this._visibleLines.onLinesInserted(e);\r\n    };\r\n    ViewLines.prototype.onRevealRangeRequest = function (e) {\r\n        // Using the future viewport here in order to handle multiple\r\n        // incoming reveal range requests that might all desire to be animated\r\n        var desiredScrollTop = this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(), e.source, e.range, e.verticalType);\r\n        // validate the new desired scroll top\r\n        var newScrollPosition = this._context.viewLayout.validateScrollPosition({ scrollTop: desiredScrollTop });\r\n        if (e.revealHorizontal) {\r\n            if (e.range.startLineNumber !== e.range.endLineNumber) {\r\n                // Two or more lines? => scroll to base (That's how you see most of the two lines)\r\n                newScrollPosition = {\r\n                    scrollTop: newScrollPosition.scrollTop,\r\n                    scrollLeft: 0\r\n                };\r\n            }\r\n            else {\r\n                // We don't necessarily know the horizontal offset of this range since the line might not be in the view...\r\n                this._horizontalRevealRequest = new HorizontalRevealRequest(e.range.startLineNumber, e.range.startColumn, e.range.endColumn, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\r\n            }\r\n        }\r\n        else {\r\n            this._horizontalRevealRequest = null;\r\n        }\r\n        var scrollTopDelta = Math.abs(this._context.viewLayout.getCurrentScrollTop() - newScrollPosition.scrollTop);\r\n        if (e.scrollType === 0 /* Smooth */ && scrollTopDelta > this._lineHeight) {\r\n            this._context.viewLayout.setScrollPositionSmooth(newScrollPosition);\r\n        }\r\n        else {\r\n            this._context.viewLayout.setScrollPositionNow(newScrollPosition);\r\n        }\r\n        return true;\r\n    };\r\n    ViewLines.prototype.onScrollChanged = function (e) {\r\n        if (this._horizontalRevealRequest && e.scrollLeftChanged) {\r\n            // cancel any outstanding horizontal reveal request if someone else scrolls horizontally.\r\n            this._horizontalRevealRequest = null;\r\n        }\r\n        if (this._horizontalRevealRequest && e.scrollTopChanged) {\r\n            var min = Math.min(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\r\n            var max = Math.max(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\r\n            if (e.scrollTop < min || e.scrollTop > max) {\r\n                // cancel any outstanding horizontal reveal request if someone else scrolls vertically.\r\n                this._horizontalRevealRequest = null;\r\n            }\r\n        }\r\n        this.domNode.setWidth(e.scrollWidth);\r\n        return this._visibleLines.onScrollChanged(e) || true;\r\n    };\r\n    ViewLines.prototype.onTokensChanged = function (e) {\r\n        return this._visibleLines.onTokensChanged(e);\r\n    };\r\n    ViewLines.prototype.onZonesChanged = function (e) {\r\n        this._context.viewLayout.onMaxLineWidthChanged(this._maxLineWidth);\r\n        return this._visibleLines.onZonesChanged(e);\r\n    };\r\n    ViewLines.prototype.onThemeChanged = function (e) {\r\n        return this._onOptionsMaybeChanged();\r\n    };\r\n    // ---- end view event handlers\r\n    // ----------- HELPERS FOR OTHERS\r\n    ViewLines.prototype.getPositionFromDOMInfo = function (spanNode, offset) {\r\n        var viewLineDomNode = this._getViewLineDomNode(spanNode);\r\n        if (viewLineDomNode === null) {\r\n            // Couldn't find view line node\r\n            return null;\r\n        }\r\n        var lineNumber = this._getLineNumberFor(viewLineDomNode);\r\n        if (lineNumber === -1) {\r\n            // Couldn't find view line node\r\n            return null;\r\n        }\r\n        if (lineNumber < 1 || lineNumber > this._context.model.getLineCount()) {\r\n            // lineNumber is outside range\r\n            return null;\r\n        }\r\n        if (this._context.model.getLineMaxColumn(lineNumber) === 1) {\r\n            // Line is empty\r\n            return new Position(lineNumber, 1);\r\n        }\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n            // Couldn't find line\r\n            return null;\r\n        }\r\n        var column = this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber, spanNode, offset);\r\n        var minColumn = this._context.model.getLineMinColumn(lineNumber);\r\n        if (column < minColumn) {\r\n            column = minColumn;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    };\r\n    ViewLines.prototype._getViewLineDomNode = function (node) {\r\n        while (node && node.nodeType === 1) {\r\n            if (node.className === ViewLine.CLASS_NAME) {\r\n                return node;\r\n            }\r\n            node = node.parentElement;\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * @returns the line number of this view line dom node.\r\n     */\r\n    ViewLines.prototype._getLineNumberFor = function (domNode) {\r\n        var startLineNumber = this._visibleLines.getStartLineNumber();\r\n        var endLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n            var line = this._visibleLines.getVisibleLine(lineNumber);\r\n            if (domNode === line.getDomNode()) {\r\n                return lineNumber;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    ViewLines.prototype.getLineWidth = function (lineNumber) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n            // Couldn't find line\r\n            return -1;\r\n        }\r\n        return this._visibleLines.getVisibleLine(lineNumber).getWidth();\r\n    };\r\n    ViewLines.prototype.linesVisibleRangesForRange = function (_range, includeNewLines) {\r\n        if (this.shouldRender()) {\r\n            // Cannot read from the DOM because it is dirty\r\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\r\n            return null;\r\n        }\r\n        var originalEndLineNumber = _range.endLineNumber;\r\n        var range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\r\n        if (!range) {\r\n            return null;\r\n        }\r\n        var visibleRanges = [], visibleRangesLen = 0;\r\n        var domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\r\n        var nextLineModelLineNumber = 0;\r\n        if (includeNewLines) {\r\n            nextLineModelLineNumber = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(range.startLineNumber, 1)).lineNumber;\r\n        }\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        for (var lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\r\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\r\n                continue;\r\n            }\r\n            var startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\r\n            var endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.model.getLineMaxColumn(lineNumber);\r\n            var visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(startColumn, endColumn, domReadingContext);\r\n            if (!visibleRangesForLine) {\r\n                continue;\r\n            }\r\n            if (includeNewLines && lineNumber < originalEndLineNumber) {\r\n                var currentLineModelLineNumber = nextLineModelLineNumber;\r\n                nextLineModelLineNumber = this._context.model.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber + 1, 1)).lineNumber;\r\n                if (currentLineModelLineNumber !== nextLineModelLineNumber) {\r\n                    visibleRangesForLine.ranges[visibleRangesForLine.ranges.length - 1].width += this._typicalHalfwidthCharacterWidth;\r\n                }\r\n            }\r\n            visibleRanges[visibleRangesLen++] = new LineVisibleRanges(visibleRangesForLine.outsideRenderedLine, lineNumber, visibleRangesForLine.ranges);\r\n        }\r\n        if (visibleRangesLen === 0) {\r\n            return null;\r\n        }\r\n        return visibleRanges;\r\n    };\r\n    ViewLines.prototype._visibleRangesForLineRange = function (lineNumber, startColumn, endColumn) {\r\n        if (this.shouldRender()) {\r\n            // Cannot read from the DOM because it is dirty\r\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\r\n            return null;\r\n        }\r\n        if (lineNumber < this._visibleLines.getStartLineNumber() || lineNumber > this._visibleLines.getEndLineNumber()) {\r\n            return null;\r\n        }\r\n        return this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(startColumn, endColumn, new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot));\r\n    };\r\n    ViewLines.prototype.visibleRangeForPosition = function (position) {\r\n        var visibleRanges = this._visibleRangesForLineRange(position.lineNumber, position.column, position.column);\r\n        if (!visibleRanges) {\r\n            return null;\r\n        }\r\n        return new HorizontalPosition(visibleRanges.outsideRenderedLine, visibleRanges.ranges[0].left);\r\n    };\r\n    // --- implementation\r\n    ViewLines.prototype.updateLineWidths = function () {\r\n        this._updateLineWidths(false);\r\n    };\r\n    /**\r\n     * Updates the max line width if it is fast to compute.\r\n     * Returns true if all lines were taken into account.\r\n     * Returns false if some lines need to be reevaluated (in a slow fashion).\r\n     */\r\n    ViewLines.prototype._updateLineWidthsFast = function () {\r\n        return this._updateLineWidths(true);\r\n    };\r\n    ViewLines.prototype._updateLineWidthsSlow = function () {\r\n        this._updateLineWidths(false);\r\n    };\r\n    ViewLines.prototype._updateLineWidths = function (fast) {\r\n        var rendStartLineNumber = this._visibleLines.getStartLineNumber();\r\n        var rendEndLineNumber = this._visibleLines.getEndLineNumber();\r\n        var localMaxLineWidth = 1;\r\n        var allWidthsComputed = true;\r\n        for (var lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\r\n            var visibleLine = this._visibleLines.getVisibleLine(lineNumber);\r\n            if (fast && !visibleLine.getWidthIsFast()) {\r\n                // Cannot compute width in a fast way for this line\r\n                allWidthsComputed = false;\r\n                continue;\r\n            }\r\n            localMaxLineWidth = Math.max(localMaxLineWidth, visibleLine.getWidth());\r\n        }\r\n        if (allWidthsComputed && rendStartLineNumber === 1 && rendEndLineNumber === this._context.model.getLineCount()) {\r\n            // we know the max line width for all the lines\r\n            this._maxLineWidth = 0;\r\n        }\r\n        this._ensureMaxLineWidth(localMaxLineWidth);\r\n        return allWidthsComputed;\r\n    };\r\n    ViewLines.prototype.prepareRender = function () {\r\n        throw new Error('Not supported');\r\n    };\r\n    ViewLines.prototype.render = function () {\r\n        throw new Error('Not supported');\r\n    };\r\n    ViewLines.prototype.renderText = function (viewportData) {\r\n        // (1) render lines - ensures lines are in the DOM\r\n        this._visibleLines.renderLines(viewportData);\r\n        this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange);\r\n        this.domNode.setWidth(this._context.viewLayout.getScrollWidth());\r\n        this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(), 1000000));\r\n        // (2) compute horizontal scroll position:\r\n        //  - this must happen after the lines are in the DOM since it might need a line that rendered just now\r\n        //  - it might change `scrollWidth` and `scrollLeft`\r\n        if (this._horizontalRevealRequest) {\r\n            var revealLineNumber = this._horizontalRevealRequest.lineNumber;\r\n            var revealStartColumn = this._horizontalRevealRequest.startColumn;\r\n            var revealEndColumn = this._horizontalRevealRequest.endColumn;\r\n            var scrollType = this._horizontalRevealRequest.scrollType;\r\n            // Check that we have the line that contains the horizontal range in the viewport\r\n            if (viewportData.startLineNumber <= revealLineNumber && revealLineNumber <= viewportData.endLineNumber) {\r\n                this._horizontalRevealRequest = null;\r\n                // allow `visibleRangesForRange2` to work\r\n                this.onDidRender();\r\n                // compute new scroll position\r\n                var newScrollLeft = this._computeScrollLeftToRevealRange(revealLineNumber, revealStartColumn, revealEndColumn);\r\n                var isViewportWrapping = this._isViewportWrapping;\r\n                if (!isViewportWrapping) {\r\n                    // ensure `scrollWidth` is large enough\r\n                    this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\r\n                }\r\n                // set `scrollLeft`\r\n                if (scrollType === 0 /* Smooth */) {\r\n                    this._context.viewLayout.setScrollPositionSmooth({\r\n                        scrollLeft: newScrollLeft.scrollLeft\r\n                    });\r\n                }\r\n                else {\r\n                    this._context.viewLayout.setScrollPositionNow({\r\n                        scrollLeft: newScrollLeft.scrollLeft\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        // Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\r\n        if (!this._updateLineWidthsFast()) {\r\n            // Computing the width of some lines would be slow => delay it\r\n            this._asyncUpdateLineWidths.schedule();\r\n        }\r\n        // (3) handle scrolling\r\n        this._linesContent.setLayerHinting(this._canUseLayerHinting);\r\n        this._linesContent.setContain('strict');\r\n        var adjustedScrollTop = this._context.viewLayout.getCurrentScrollTop() - viewportData.bigNumbersDelta;\r\n        this._linesContent.setTop(-adjustedScrollTop);\r\n        this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft());\r\n    };\r\n    // --- width\r\n    ViewLines.prototype._ensureMaxLineWidth = function (lineWidth) {\r\n        var iLineWidth = Math.ceil(lineWidth);\r\n        if (this._maxLineWidth < iLineWidth) {\r\n            this._maxLineWidth = iLineWidth;\r\n            this._context.viewLayout.onMaxLineWidthChanged(this._maxLineWidth);\r\n        }\r\n    };\r\n    ViewLines.prototype._computeScrollTopToRevealRange = function (viewport, source, range, verticalType) {\r\n        var viewportStartY = viewport.top;\r\n        var viewportHeight = viewport.height;\r\n        var viewportEndY = viewportStartY + viewportHeight;\r\n        var boxStartY;\r\n        var boxEndY;\r\n        // Have a box that includes one extra line height (for the horizontal scrollbar)\r\n        boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber);\r\n        boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber) + this._lineHeight;\r\n        var shouldIgnoreScrollOff = source === 'mouse' && this._cursorSurroundingLinesStyle === 'default';\r\n        if (!shouldIgnoreScrollOff) {\r\n            var context = Math.min((viewportHeight / this._lineHeight) / 2, this._cursorSurroundingLines);\r\n            boxStartY -= context * this._lineHeight;\r\n            boxEndY += Math.max(0, (context - 1)) * this._lineHeight;\r\n        }\r\n        if (verticalType === 0 /* Simple */ || verticalType === 4 /* Bottom */) {\r\n            // Reveal one line more when the last line would be covered by the scrollbar - arrow down case or revealing a line explicitly at bottom\r\n            boxEndY += this._lineHeight;\r\n        }\r\n        var newScrollTop;\r\n        if (boxEndY - boxStartY > viewportHeight) {\r\n            // the box is larger than the viewport ... scroll to its top\r\n            newScrollTop = boxStartY;\r\n        }\r\n        else if (verticalType === 1 /* Center */ || verticalType === 2 /* CenterIfOutsideViewport */) {\r\n            if (verticalType === 2 /* CenterIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\r\n                // Box is already in the viewport... do nothing\r\n                newScrollTop = viewportStartY;\r\n            }\r\n            else {\r\n                // Box is outside the viewport... center it\r\n                var boxMiddleY = (boxStartY + boxEndY) / 2;\r\n                newScrollTop = Math.max(0, boxMiddleY - viewportHeight / 2);\r\n            }\r\n        }\r\n        else {\r\n            newScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY, verticalType === 3 /* Top */, verticalType === 4 /* Bottom */);\r\n        }\r\n        return newScrollTop;\r\n    };\r\n    ViewLines.prototype._computeScrollLeftToRevealRange = function (lineNumber, startColumn, endColumn) {\r\n        var maxHorizontalOffset = 0;\r\n        var viewport = this._context.viewLayout.getCurrentViewport();\r\n        var viewportStartX = viewport.left;\r\n        var viewportEndX = viewportStartX + viewport.width;\r\n        var visibleRanges = this._visibleRangesForLineRange(lineNumber, startColumn, endColumn);\r\n        var boxStartX = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        var boxEndX = 0;\r\n        if (!visibleRanges) {\r\n            // Unknown\r\n            return {\r\n                scrollLeft: viewportStartX,\r\n                maxHorizontalOffset: maxHorizontalOffset\r\n            };\r\n        }\r\n        for (var _i = 0, _a = visibleRanges.ranges; _i < _a.length; _i++) {\r\n            var visibleRange = _a[_i];\r\n            if (visibleRange.left < boxStartX) {\r\n                boxStartX = visibleRange.left;\r\n            }\r\n            if (visibleRange.left + visibleRange.width > boxEndX) {\r\n                boxEndX = visibleRange.left + visibleRange.width;\r\n            }\r\n        }\r\n        maxHorizontalOffset = boxEndX;\r\n        boxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\r\n        boxEndX += this._revealHorizontalRightPadding;\r\n        var newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\r\n        return {\r\n            scrollLeft: newScrollLeft,\r\n            maxHorizontalOffset: maxHorizontalOffset\r\n        };\r\n    };\r\n    ViewLines.prototype._computeMinimumScrolling = function (viewportStart, viewportEnd, boxStart, boxEnd, revealAtStart, revealAtEnd) {\r\n        viewportStart = viewportStart | 0;\r\n        viewportEnd = viewportEnd | 0;\r\n        boxStart = boxStart | 0;\r\n        boxEnd = boxEnd | 0;\r\n        revealAtStart = !!revealAtStart;\r\n        revealAtEnd = !!revealAtEnd;\r\n        var viewportLength = viewportEnd - viewportStart;\r\n        var boxLength = boxEnd - boxStart;\r\n        if (boxLength < viewportLength) {\r\n            // The box would fit in the viewport\r\n            if (revealAtStart) {\r\n                return boxStart;\r\n            }\r\n            if (revealAtEnd) {\r\n                return Math.max(0, boxEnd - viewportLength);\r\n            }\r\n            if (boxStart < viewportStart) {\r\n                // The box is above the viewport\r\n                return boxStart;\r\n            }\r\n            else if (boxEnd > viewportEnd) {\r\n                // The box is below the viewport\r\n                return Math.max(0, boxEnd - viewportLength);\r\n            }\r\n        }\r\n        else {\r\n            // The box would not fit in the viewport\r\n            // Reveal the beginning of the box\r\n            return boxStart;\r\n        }\r\n        return viewportStart;\r\n    };\r\n    /**\r\n     * Adds this amount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\r\n     */\r\n    ViewLines.HORIZONTAL_EXTRA_PX = 30;\r\n    return ViewLines;\r\n}(ViewPart));\r\nexport { ViewLines };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './overlayWidgets.css';\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\r\nvar ViewOverlayWidgets = /** @class */ (function (_super) {\r\n    __extends(ViewOverlayWidgets, _super);\r\n    function ViewOverlayWidgets(context) {\r\n        var _this = _super.call(this, context) || this;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._widgets = {};\r\n        _this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\r\n        _this._minimapWidth = layoutInfo.minimapWidth;\r\n        _this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\r\n        _this._editorHeight = layoutInfo.height;\r\n        _this._editorWidth = layoutInfo.width;\r\n        _this._domNode = createFastDomNode(document.createElement('div'));\r\n        PartFingerprints.write(_this._domNode, 4 /* OverlayWidgets */);\r\n        _this._domNode.setClassName('overlayWidgets');\r\n        return _this;\r\n    }\r\n    ViewOverlayWidgets.prototype.dispose = function () {\r\n        _super.prototype.dispose.call(this);\r\n        this._widgets = {};\r\n    };\r\n    ViewOverlayWidgets.prototype.getDomNode = function () {\r\n        return this._domNode;\r\n    };\r\n    // ---- begin view event handlers\r\n    ViewOverlayWidgets.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\r\n        this._minimapWidth = layoutInfo.minimapWidth;\r\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\r\n        this._editorHeight = layoutInfo.height;\r\n        this._editorWidth = layoutInfo.width;\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    ViewOverlayWidgets.prototype.addWidget = function (widget) {\r\n        var domNode = createFastDomNode(widget.getDomNode());\r\n        this._widgets[widget.getId()] = {\r\n            widget: widget,\r\n            preference: null,\r\n            domNode: domNode\r\n        };\r\n        // This is sync because a widget wants to be in the dom\r\n        domNode.setPosition('absolute');\r\n        domNode.setAttribute('widgetId', widget.getId());\r\n        this._domNode.appendChild(domNode);\r\n        this.setShouldRender();\r\n    };\r\n    ViewOverlayWidgets.prototype.setWidgetPosition = function (widget, preference) {\r\n        var widgetData = this._widgets[widget.getId()];\r\n        if (widgetData.preference === preference) {\r\n            return false;\r\n        }\r\n        widgetData.preference = preference;\r\n        this.setShouldRender();\r\n        return true;\r\n    };\r\n    ViewOverlayWidgets.prototype.removeWidget = function (widget) {\r\n        var widgetId = widget.getId();\r\n        if (this._widgets.hasOwnProperty(widgetId)) {\r\n            var widgetData = this._widgets[widgetId];\r\n            var domNode = widgetData.domNode.domNode;\r\n            delete this._widgets[widgetId];\r\n            domNode.parentNode.removeChild(domNode);\r\n            this.setShouldRender();\r\n        }\r\n    };\r\n    ViewOverlayWidgets.prototype._renderWidget = function (widgetData) {\r\n        var domNode = widgetData.domNode;\r\n        if (widgetData.preference === null) {\r\n            domNode.unsetTop();\r\n            return;\r\n        }\r\n        if (widgetData.preference === 0 /* TOP_RIGHT_CORNER */) {\r\n            domNode.setTop(0);\r\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\r\n        }\r\n        else if (widgetData.preference === 1 /* BOTTOM_RIGHT_CORNER */) {\r\n            var widgetHeight = domNode.domNode.clientHeight;\r\n            domNode.setTop((this._editorHeight - widgetHeight - 2 * this._horizontalScrollbarHeight));\r\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\r\n        }\r\n        else if (widgetData.preference === 2 /* TOP_CENTER */) {\r\n            domNode.setTop(0);\r\n            domNode.domNode.style.right = '50%';\r\n        }\r\n    };\r\n    ViewOverlayWidgets.prototype.prepareRender = function (ctx) {\r\n        // Nothing to read\r\n    };\r\n    ViewOverlayWidgets.prototype.render = function (ctx) {\r\n        this._domNode.setWidth(this._editorWidth);\r\n        var keys = Object.keys(this._widgets);\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var widgetId = keys[i];\r\n            this._renderWidget(this._widgets[widgetId]);\r\n        }\r\n    };\r\n    return ViewOverlayWidgets;\r\n}(ViewPart));\r\nexport { ViewOverlayWidgets };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './indentGuides.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { editorActiveIndentGuides, editorIndentGuides } from '../../../common/view/editorColorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nvar IndentGuidesOverlay = /** @class */ (function (_super) {\r\n    __extends(IndentGuidesOverlay, _super);\r\n    function IndentGuidesOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        _this._primaryLineNumber = 0;\r\n        var options = _this._context.configuration.options;\r\n        var wrappingInfo = options.get(108 /* wrappingInfo */);\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._spaceWidth = fontInfo.spaceWidth;\r\n        _this._enabled = options.get(70 /* renderIndentGuides */);\r\n        _this._activeIndentEnabled = options.get(43 /* highlightActiveIndentGuide */);\r\n        _this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    IndentGuidesOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    IndentGuidesOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var wrappingInfo = options.get(108 /* wrappingInfo */);\r\n        var fontInfo = options.get(34 /* fontInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._spaceWidth = fontInfo.spaceWidth;\r\n        this._enabled = options.get(70 /* renderIndentGuides */);\r\n        this._activeIndentEnabled = options.get(43 /* highlightActiveIndentGuide */);\r\n        this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onCursorStateChanged = function (e) {\r\n        var selection = e.selections[0];\r\n        var newPrimaryLineNumber = selection.isEmpty() ? selection.positionLineNumber : 0;\r\n        if (this._primaryLineNumber !== newPrimaryLineNumber) {\r\n            this._primaryLineNumber = newPrimaryLineNumber;\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IndentGuidesOverlay.prototype.onDecorationsChanged = function (e) {\r\n        // true for inline decorations\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged; // || e.scrollWidthChanged;\r\n    };\r\n    IndentGuidesOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    IndentGuidesOverlay.prototype.onLanguageConfigurationChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    IndentGuidesOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._enabled) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var indentSize = this._context.model.getOptions().indentSize;\r\n        var indentWidth = indentSize * this._spaceWidth;\r\n        var scrollWidth = ctx.scrollWidth;\r\n        var lineHeight = this._lineHeight;\r\n        var indents = this._context.model.getLinesIndentGuides(visibleStartLineNumber, visibleEndLineNumber);\r\n        var activeIndentStartLineNumber = 0;\r\n        var activeIndentEndLineNumber = 0;\r\n        var activeIndentLevel = 0;\r\n        if (this._activeIndentEnabled && this._primaryLineNumber) {\r\n            var activeIndentInfo = this._context.model.getActiveIndentGuide(this._primaryLineNumber, visibleStartLineNumber, visibleEndLineNumber);\r\n            activeIndentStartLineNumber = activeIndentInfo.startLineNumber;\r\n            activeIndentEndLineNumber = activeIndentInfo.endLineNumber;\r\n            activeIndentLevel = activeIndentInfo.indent;\r\n        }\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var containsActiveIndentGuide = (activeIndentStartLineNumber <= lineNumber && lineNumber <= activeIndentEndLineNumber);\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var indent = indents[lineIndex];\r\n            var result = '';\r\n            if (indent >= 1) {\r\n                var leftMostVisiblePosition = ctx.visibleRangeForPosition(new Position(lineNumber, 1));\r\n                var left = leftMostVisiblePosition ? leftMostVisiblePosition.left : 0;\r\n                for (var i = 1; i <= indent; i++) {\r\n                    var className = (containsActiveIndentGuide && i === activeIndentLevel ? 'cigra' : 'cigr');\r\n                    result += \"<div class=\\\"\" + className + \"\\\" style=\\\"left:\" + left + \"px;height:\" + lineHeight + \"px;width:\" + indentWidth + \"px\\\"></div>\";\r\n                    left += indentWidth;\r\n                    if (left > scrollWidth || (this._maxIndentLeft > 0 && left > this._maxIndentLeft)) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            output[lineIndex] = result;\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    IndentGuidesOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return IndentGuidesOverlay;\r\n}(DynamicViewOverlay));\r\nexport { IndentGuidesOverlay };\r\nregisterThemingParticipant(function (theme, collector) {\r\n    var editorIndentGuidesColor = theme.getColor(editorIndentGuides);\r\n    if (editorIndentGuidesColor) {\r\n        collector.addRule(\".monaco-editor .lines-content .cigr { box-shadow: 1px 0 0 0 \" + editorIndentGuidesColor + \" inset; }\");\r\n    }\r\n    var editorActiveIndentGuidesColor = theme.getColor(editorActiveIndentGuides) || editorIndentGuidesColor;\r\n    if (editorActiveIndentGuidesColor) {\r\n        collector.addRule(\".monaco-editor .lines-content .cigra { box-shadow: 1px 0 0 0 \" + editorActiveIndentGuidesColor + \" inset; }\");\r\n    }\r\n});\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\r\nimport { OverviewZoneManager } from '../../../common/view/overviewZoneManager.js';\r\nimport { ViewEventHandler } from '../../../common/viewModel/viewEventHandler.js';\r\nvar OverviewRuler = /** @class */ (function (_super) {\r\n    __extends(OverviewRuler, _super);\r\n    function OverviewRuler(context, cssClassName) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        _this._domNode = createFastDomNode(document.createElement('canvas'));\r\n        _this._domNode.setClassName(cssClassName);\r\n        _this._domNode.setPosition('absolute');\r\n        _this._domNode.setLayerHinting(true);\r\n        _this._domNode.setContain('strict');\r\n        _this._zoneManager = new OverviewZoneManager(function (lineNumber) { return _this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber); });\r\n        _this._zoneManager.setDOMWidth(0);\r\n        _this._zoneManager.setDOMHeight(0);\r\n        _this._zoneManager.setOuterHeight(_this._context.viewLayout.getScrollHeight());\r\n        _this._zoneManager.setLineHeight(options.get(49 /* lineHeight */));\r\n        _this._zoneManager.setPixelRatio(options.get(105 /* pixelRatio */));\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    OverviewRuler.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // ---- begin view event handlers\r\n    OverviewRuler.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        if (e.hasChanged(49 /* lineHeight */)) {\r\n            this._zoneManager.setLineHeight(options.get(49 /* lineHeight */));\r\n            this._render();\r\n        }\r\n        if (e.hasChanged(105 /* pixelRatio */)) {\r\n            this._zoneManager.setPixelRatio(options.get(105 /* pixelRatio */));\r\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\r\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\r\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\r\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onFlushed = function (e) {\r\n        this._render();\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onScrollChanged = function (e) {\r\n        if (e.scrollHeightChanged) {\r\n            this._zoneManager.setOuterHeight(e.scrollHeight);\r\n            this._render();\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype.onZonesChanged = function (e) {\r\n        this._render();\r\n        return true;\r\n    };\r\n    // ---- end view event handlers\r\n    OverviewRuler.prototype.getDomNode = function () {\r\n        return this._domNode.domNode;\r\n    };\r\n    OverviewRuler.prototype.setLayout = function (position) {\r\n        this._domNode.setTop(position.top);\r\n        this._domNode.setRight(position.right);\r\n        var hasChanged = false;\r\n        hasChanged = this._zoneManager.setDOMWidth(position.width) || hasChanged;\r\n        hasChanged = this._zoneManager.setDOMHeight(position.height) || hasChanged;\r\n        if (hasChanged) {\r\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\r\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\r\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\r\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\r\n            this._render();\r\n        }\r\n    };\r\n    OverviewRuler.prototype.setZones = function (zones) {\r\n        this._zoneManager.setZones(zones);\r\n        this._render();\r\n    };\r\n    OverviewRuler.prototype._render = function () {\r\n        if (this._zoneManager.getOuterHeight() === 0) {\r\n            return false;\r\n        }\r\n        var width = this._zoneManager.getCanvasWidth();\r\n        var height = this._zoneManager.getCanvasHeight();\r\n        var colorZones = this._zoneManager.resolveColorZones();\r\n        var id2Color = this._zoneManager.getId2Color();\r\n        var ctx = this._domNode.domNode.getContext('2d');\r\n        ctx.clearRect(0, 0, width, height);\r\n        if (colorZones.length > 0) {\r\n            this._renderOneLane(ctx, colorZones, id2Color, width);\r\n        }\r\n        return true;\r\n    };\r\n    OverviewRuler.prototype._renderOneLane = function (ctx, colorZones, id2Color, width) {\r\n        var currentColorId = 0;\r\n        var currentFrom = 0;\r\n        var currentTo = 0;\r\n        for (var _i = 0, colorZones_1 = colorZones; _i < colorZones_1.length; _i++) {\r\n            var zone = colorZones_1[_i];\r\n            var zoneColorId = zone.colorId;\r\n            var zoneFrom = zone.from;\r\n            var zoneTo = zone.to;\r\n            if (zoneColorId !== currentColorId) {\r\n                ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n                currentColorId = zoneColorId;\r\n                ctx.fillStyle = id2Color[currentColorId];\r\n                currentFrom = zoneFrom;\r\n                currentTo = zoneTo;\r\n            }\r\n            else {\r\n                if (currentTo >= zoneFrom) {\r\n                    currentTo = Math.max(currentTo, zoneTo);\r\n                }\r\n                else {\r\n                    ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n                    currentFrom = zoneFrom;\r\n                    currentTo = zoneTo;\r\n                }\r\n            }\r\n        }\r\n        ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\r\n    };\r\n    return OverviewRuler;\r\n}(ViewEventHandler));\r\nexport { OverviewRuler };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport './glyphMargin.css';\r\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\r\nvar DecorationToRender = /** @class */ (function () {\r\n    function DecorationToRender(startLineNumber, endLineNumber, className) {\r\n        this.startLineNumber = +startLineNumber;\r\n        this.endLineNumber = +endLineNumber;\r\n        this.className = String(className);\r\n    }\r\n    return DecorationToRender;\r\n}());\r\nexport { DecorationToRender };\r\nvar DedupOverlay = /** @class */ (function (_super) {\r\n    __extends(DedupOverlay, _super);\r\n    function DedupOverlay() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DedupOverlay.prototype._render = function (visibleStartLineNumber, visibleEndLineNumber, decorations) {\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            output[lineIndex] = [];\r\n        }\r\n        if (decorations.length === 0) {\r\n            return output;\r\n        }\r\n        decorations.sort(function (a, b) {\r\n            if (a.className === b.className) {\r\n                if (a.startLineNumber === b.startLineNumber) {\r\n                    return a.endLineNumber - b.endLineNumber;\r\n                }\r\n                return a.startLineNumber - b.startLineNumber;\r\n            }\r\n            return (a.className < b.className ? -1 : 1);\r\n        });\r\n        var prevClassName = null;\r\n        var prevEndLineIndex = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var className = d.className;\r\n            var startLineIndex = Math.max(d.startLineNumber, visibleStartLineNumber) - visibleStartLineNumber;\r\n            var endLineIndex = Math.min(d.endLineNumber, visibleEndLineNumber) - visibleStartLineNumber;\r\n            if (prevClassName === className) {\r\n                startLineIndex = Math.max(prevEndLineIndex + 1, startLineIndex);\r\n                prevEndLineIndex = Math.max(prevEndLineIndex, endLineIndex);\r\n            }\r\n            else {\r\n                prevClassName = className;\r\n                prevEndLineIndex = endLineIndex;\r\n            }\r\n            for (var i_1 = startLineIndex; i_1 <= prevEndLineIndex; i_1++) {\r\n                output[i_1].push(prevClassName);\r\n            }\r\n        }\r\n        return output;\r\n    };\r\n    return DedupOverlay;\r\n}(DynamicViewOverlay));\r\nexport { DedupOverlay };\r\nvar GlyphMarginOverlay = /** @class */ (function (_super) {\r\n    __extends(GlyphMarginOverlay, _super);\r\n    function GlyphMarginOverlay(context) {\r\n        var _this = _super.call(this) || this;\r\n        _this._context = context;\r\n        var options = _this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        _this._lineHeight = options.get(49 /* lineHeight */);\r\n        _this._glyphMargin = options.get(40 /* glyphMargin */);\r\n        _this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\r\n        _this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\r\n        _this._renderResult = null;\r\n        _this._context.addEventHandler(_this);\r\n        return _this;\r\n    }\r\n    GlyphMarginOverlay.prototype.dispose = function () {\r\n        this._context.removeEventHandler(this);\r\n        this._renderResult = null;\r\n        _super.prototype.dispose.call(this);\r\n    };\r\n    // --- begin event handlers\r\n    GlyphMarginOverlay.prototype.onConfigurationChanged = function (e) {\r\n        var options = this._context.configuration.options;\r\n        var layoutInfo = options.get(107 /* layoutInfo */);\r\n        this._lineHeight = options.get(49 /* lineHeight */);\r\n        this._glyphMargin = options.get(40 /* glyphMargin */);\r\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\r\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onDecorationsChanged = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onFlushed = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesChanged = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesDeleted = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onLinesInserted = function (e) {\r\n        return true;\r\n    };\r\n    GlyphMarginOverlay.prototype.onScrollChanged = function (e) {\r\n        return e.scrollTopChanged;\r\n    };\r\n    GlyphMarginOverlay.prototype.onZonesChanged = function (e) {\r\n        return true;\r\n    };\r\n    // --- end event handlers\r\n    GlyphMarginOverlay.prototype._getDecorations = function (ctx) {\r\n        var decorations = ctx.getDecorationsInViewport();\r\n        var r = [], rLen = 0;\r\n        for (var i = 0, len = decorations.length; i < len; i++) {\r\n            var d = decorations[i];\r\n            var glyphMarginClassName = d.options.glyphMarginClassName;\r\n            if (glyphMarginClassName) {\r\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, glyphMarginClassName);\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    GlyphMarginOverlay.prototype.prepareRender = function (ctx) {\r\n        if (!this._glyphMargin) {\r\n            this._renderResult = null;\r\n            return;\r\n        }\r\n        var visibleStartLineNumber = ctx.visibleRange.startLineNumber;\r\n        var visibleEndLineNumber = ctx.visibleRange.endLineNumber;\r\n        var toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\r\n        var lineHeight = this._lineHeight.toString();\r\n        var left = this._glyphMarginLeft.toString();\r\n        var width = this._glyphMarginWidth.toString();\r\n        var common = '\" style=\"left:' + left + 'px;width:' + width + 'px' + ';height:' + lineHeight + 'px;\"></div>';\r\n        var output = [];\r\n        for (var lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\r\n            var lineIndex = lineNumber - visibleStartLineNumber;\r\n            var classNames = toRender[lineIndex];\r\n            if (classNames.length === 0) {\r\n                output[lineIndex] = '';\r\n            }\r\n            else {\r\n                output[lineIndex] = ('<div class=\"cgmr codicon '\r\n                    + classNames.join(' ')\r\n                    + common);\r\n            }\r\n        }\r\n        this._renderResult = output;\r\n    };\r\n    GlyphMarginOverlay.prototype.render = function (startLineNumber, lineNumber) {\r\n        if (!this._renderResult) {\r\n            return '';\r\n        }\r\n        var lineIndex = lineNumber - startLineNumber;\r\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\r\n            return '';\r\n        }\r\n        return this._renderResult[lineIndex];\r\n    };\r\n    return GlyphMarginOverlay;\r\n}(DedupOverlay));\r\nexport { GlyphMarginOverlay };\r\n"],"sourceRoot":""}